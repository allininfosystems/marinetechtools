require.config({"config": {
        "jsbuild":{"Ess_M2ePro/js/Ebay/Listing/View/Settings/Motors.min.js":"define(['Magento_Ui/js/modal/modal','M2ePro/Common'],function(modal){window.EbayListingViewSettingsMotors=Class.create(Common,{listingId:null,motorsType:null,saveAsGroupPopupHtml:'',setNotePopupHtml:'',selectedData:{items:[],filters:[],groups:[]},initialize:function(listingId,motorsType){this.listingId=listingId;this.motorsType=motorsType;},openAddPopUp:function(listingProductsIds){var self=this;new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/addView'),{method:'get',parameters:{motors_type:self.motorsType},onSuccess:function(transport){var containerEl=$('ebay_settings_motors_manage_popup');if(containerEl){containerEl.remove();}\n$('html-body').insert({bottom:'<div id=\"ebay_settings_motors_manage_popup\"></div>'});$('ebay_settings_motors_manage_popup').update(transport.responseText);self.addPopUp=jQuery('#ebay_settings_motors_manage_popup');var instructions=$('add_custom_motors_record_instruction_container'),popupType='slide',closedAction=function(){EbayListingViewSettingsGridObj.unselectAllAndReload();self.selectedData={items:[],filters:[],groups:[]};},buttons=[];if(instructions){popupType='popup';closedAction='';buttons.push({text:M2ePro.translator.translate('Confirm'),class:'action-primary',click:function(){self.closeInstruction(listingProductsIds);}})}\nmodal({title:M2ePro.translator.translate('Add Compatible Vehicles'),type:popupType,buttons:buttons,closed:closedAction},self.addPopUp);self.addPopUp.modal('openModal');self.addPopUp.listingProductsIds=listingProductsIds;}});},openViewItemPopup:function(entityId,grid){var self=this;new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/viewItem'),{method:'get',parameters:{entity_id:entityId,motors_type:self.motorsType},onSuccess:function(transport){var containerEl=$('ebay_settings_motors_view_item');if(containerEl){containerEl.remove();}\n$('html-body').insert({bottom:'<div id=\"ebay_settings_motors_view_item\"></div>'});$('ebay_settings_motors_view_item').update(transport.responseText);self.viewItemPopup=jQuery('#ebay_settings_motors_view_item');modal({title:M2ePro.translator.translate('View Items'),type:'popup',buttons:[{text:M2ePro.translator.translate('Close'),class:'action-secondary',click:function(){self.viewItemPopup.modal('closeModal')}}],closed:function(){grid.unselectAllAndReload();}},self.viewItemPopup);self.viewItemPopup.modal('openModal');}});},openViewFilterPopup:function(entityId,grid){var self=this;new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/viewFilter'),{method:'get',parameters:{entity_id:entityId,motors_type:self.motorsType},onSuccess:function(transport){var containerEl=$('ebay_settings_motors_view_filter');if(containerEl){containerEl.remove();}\n$('html-body').insert({bottom:'<div id=\"ebay_settings_motors_view_filter\"></div>'});$('ebay_settings_motors_view_filter').update(transport.responseText);self.viewFilterPopup=jQuery('#ebay_settings_motors_view_filter');modal({title:M2ePro.translator.translate('View Filters'),type:'popup',buttons:[{text:M2ePro.translator.translate('Close'),class:'action-secondary',click:function(){self.viewFilterPopup.modal('closeModal')}}],closed:function(){grid.unselectAllAndReload();}},self.viewFilterPopup);self.viewFilterPopup.modal('openModal');}});},openViewGroupPopup:function(entityId,grid){var self=this;new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/viewGroup'),{method:'get',parameters:{entity_id:entityId,motors_type:self.motorsType},onSuccess:function(transport){var containerEl=$('ebay_settings_motors_view_group');if(containerEl){containerEl.remove();}\n$('html-body').insert({bottom:'<div id=\"ebay_settings_motors_view_group\"></div>'});$('ebay_settings_motors_view_group').update(transport.responseText);self.viewGroupPopup=jQuery('#ebay_settings_motors_view_group');modal({title:M2ePro.translator.translate('View Groups'),type:'popup',buttons:[{text:M2ePro.translator.translate('Close'),class:'action-secondary',click:function(){self.viewGroupPopup.modal('closeModal')}}],closed:function(){grid.unselectAllAndReload();}},self.viewGroupPopup);self.viewGroupPopup.modal('openModal');}});},updateSelectedData:function(){var self=this,emptyText=$('motors_empty_text'),addbtn=$('motors_add'),overrideBtn=$('motors_override'),dataEl=$('selected_motors_data');addbtn.addClassName('disabled');overrideBtn.addClassName('disabled');emptyText.show();dataEl.down('.items').hide();if(self.selectedData.items.length>0){emptyText.hide();addbtn.removeClassName('disabled');overrideBtn.removeClassName('disabled');dataEl.down('.items').show();dataEl.down('.items .count').innerHTML=self.selectedData.items.length;}\ndataEl.down('.filters').hide();if(self.selectedData.filters.length>0){emptyText.hide();addbtn.removeClassName('disabled');overrideBtn.removeClassName('disabled');dataEl.down('.filters').show();dataEl.down('.filters .count').innerHTML=self.selectedData.filters.length;}\ndataEl.down('.groups').hide();if(self.selectedData.groups.length>0){emptyText.hide();addbtn.removeClassName('disabled');overrideBtn.removeClassName('disabled');dataEl.down('.groups').show();dataEl.down('.groups .count').innerHTML=self.selectedData.groups.length;}},viewSelectedItemPopup:function(){var self=this;var containerEl=$('selected_items_popup');if(containerEl){containerEl.remove();}\n$('html-body').insert({bottom:'<div id=\"selected_items_popup\"></div>'});self.viewSelectedItemsPopup=jQuery('#selected_items_popup');modal({title:M2ePro.translator.translate('Selected Items'),type:'popup',buttons:[{text:M2ePro.translator.translate('Close'),class:'action-secondary',click:function(){self.viewSelectedItemsPopup.modal('closeModal');}}]},self.viewSelectedItemsPopup);self.viewSelectedItemsPopup.modal('openModal');var table=new Element('table',{cellspacing:'0',cellpadding:'0',class:'data-grid data-grid-not-hovered'});table.update('<thead> '+'<tr class=\"headings\">'+'<th class=\"data-grid-th\" style=\"width: 75px; font-weight: bold;\">'+\nM2ePro.translator.translate('Motor Item')+'</th>'+'<th class=\"data-grid-th\" style=\"font-weight: bold;\">'+\nM2ePro.translator.translate('Note')+'</th>'+'<th class=\"data-grid-th type-butt last\" style=\"width: 20px;\"></th>'+'</tr>'+'</thead>'+'<tbody></tbody>');var tbody=table.down('tbody');self.selectedData.items.each(function(item){var tr=new Element('tr'),tdItem=new Element('td',{style:'text-align: center'}),tdNote=new Element('td',{}),tdRemove=new Element('td',{});tdItem.innerHTML=item;if(EbayListingViewSettingsMotorsAddItemGridObj.savedNotes[item]){tdNote.innerHTML=EbayListingViewSettingsMotorsAddItemGridObj.savedNotes[item];}\nvar removeLink=new Element('a',{title:M2ePro.translator.translate('Remove'),href:'javascript:void(0)',class:'ebay-listing-view-icon ebay-listing-view-remove'});removeLink.observe('click',function(){tr.remove();var index=self.selectedData.items.indexOf(item);self.selectedData.items.splice(index,1);EbayListingViewSettingsMotorsObj.updateSelectedData();if(self.selectedData.items.length==0){self.viewSelectedItemsPopup.modal('closeModal');}},self);tdRemove.insert({bottom:removeLink});tr.insert({bottom:tdItem});tr.insert({bottom:tdNote});tr.insert({bottom:tdRemove});tbody.insert({bottom:tr});});var dialogContent=$('selected_items_popup');dialogContent.insert({bottom:new Element('div',{class:'admin__data-grid-wrap admin__data-grid-wrap-static'}).insert({bottom:table})});},viewSelectedFilterPopup:function(){var self=this;new Ajax.Request(M2ePro.url.get('general/modelGetAll'),{method:'get',parameters:{model:'Ebay_Motor_Filter',id_field:'id',data_field:'title'},onSuccess:function(transport){if(!transport.responseText.isJSON()){alert(transport.responseText);return;}\nvar filters=transport.responseText.evalJSON();var containerEl=$('selected_filters_popup');if(containerEl){containerEl.remove();}\n$('html-body').insert({bottom:'<div id=\"selected_filters_popup\"></div>'});self.viewSelectedFiltersPopup=jQuery('#selected_filters_popup');modal({title:M2ePro.translator.translate('Selected Filters'),type:'popup',buttons:[{text:M2ePro.translator.translate('Close'),class:'action-secondary',click:function(){self.viewSelectedFiltersPopup.modal('closeModal')}}]},self.viewSelectedFiltersPopup);self.viewSelectedFiltersPopup.modal('openModal');var table=new Element('table',{cellspacing:'0',cellpadding:'0',class:'data-grid data-grid-not-hovered'});table.update('<thead> '+'<tr class=\"headings\">'+'<th class=\"data-grid-th\" style=\"font-weight: bold;\">'+\nM2ePro.translator.translate('Filter')+'</th>'+'<th class=\"data-grid-th type-butt last\" style=\"width: 20px;\"></th>'+'</tr>'+'</thead>'+'<tbody></tbody>');var tbody=table.down('tbody');filters.each(function(filter){if(self.selectedData.filters.indexOf(filter.id)==-1){return;}\nvar tr=new Element('tr'),tdTitle=new Element('td',{}),tdRemove=new Element('td',{});tdTitle.innerHTML=filter.title;var removeLink=new Element('a',{title:M2ePro.translator.translate('Remove'),href:'javascript:void(0)',class:'ebay-listing-view-icon ebay-listing-view-remove'});removeLink.observe('click',function(){tr.remove();var index=self.selectedData.filters.indexOf(filter.id);self.selectedData.filters.splice(index,1);EbayListingViewSettingsMotorsObj.updateSelectedData();if(self.selectedData.filters.length==0){self.viewSelectedFiltersPopup.modal('closeModal');}},self);tdRemove.insert({bottom:removeLink});tr.insert({bottom:tdTitle});tr.insert({bottom:tdRemove});tbody.insert({bottom:tr});});var dialogContent=$('selected_filters_popup');dialogContent.insert({bottom:new Element('div',{class:'admin__data-grid-wrap admin__data-grid-wrap-static'}).insert({bottom:table})});}});},viewSelectedGroupPopup:function(){var self=this;new Ajax.Request(M2ePro.url.get('general/modelGetAll'),{method:'get',parameters:{model:'Ebay_Motor_Group',id_field:'id',data_field:'title'},onSuccess:function(transport){if(!transport.responseText.isJSON()){alert(transport.responseText);return;}\nvar groups=transport.responseText.evalJSON();var containerEl=$('selected_groups_popup');if(containerEl){containerEl.remove();}\n$('html-body').insert({bottom:'<div id=\"selected_groups_popup\"></div>'});self.viewSelectedGroupsPopup=jQuery('#selected_groups_popup');modal({title:M2ePro.translator.translate('Selected Groups'),type:'popup',buttons:[{text:M2ePro.translator.translate('Close'),class:'action-secondary',click:function(){self.viewSelectedGroupsPopup.modal('closeModal')}}]},self.viewSelectedGroupsPopup);self.viewSelectedGroupsPopup.modal('openModal');var table=new Element('table',{cellspacing:'0',cellpadding:'0',class:'data-grid data-grid-not-hovered'});table.update('<thead> '+'<tr class=\"headings\">'+'<th class=\"data-grid-th\" style=\"font-weight: bold;\">'+\nM2ePro.translator.translate('Filter')+'</th>'+'<th class=\"data-grid-th type-butt last\" style=\"width: 20px;\"></th>'+'</tr>'+'</thead>'+'<tbody></tbody>');var tbody=table.down('tbody');groups.each(function(group){if(self.selectedData.groups.indexOf(group.id)==-1){return;}\nvar tr=new Element('tr'),tdTitle=new Element('td',{}),tdRemove=new Element('td',{});tdTitle.innerHTML=group.title;var removeLink=new Element('a',{title:M2ePro.translator.translate('Remove'),href:'javascript:void(0)',class:'ebay-listing-view-icon ebay-listing-view-remove'});removeLink.observe('click',function(){tr.remove();var index=self.selectedData.groups.indexOf(group.id);self.selectedData.groups.splice(index,1);EbayListingViewSettingsMotorsObj.updateSelectedData();if(self.selectedData.groups.length==0){self.viewSelectedGroupsPopup.modal('closeModal');}},self);tdRemove.insert({bottom:removeLink});tr.insert({bottom:tdTitle});tr.insert({bottom:tdRemove});tbody.insert({bottom:tr});});var dialogContent=$('selected_groups_popup');dialogContent.insert({bottom:new Element('div',{class:'admin__data-grid-wrap admin__data-grid-wrap-static'}).insert({bottom:table})});}});},updateMotorsData:function(override){var self=this;self.confirm({actions:{confirm:function(){var items={};self.selectedData.items.each(function(item){items[item]=EbayListingViewSettingsMotorsAddItemGridObj.savedNotes[item];});new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/updateMotorsData'),{method:'post',parameters:{listing_id:self.listingId,'listing_products_ids[]':self.addPopUp.listingProductsIds,motors_type:self.motorsType,overwrite:override,items:Object.toQueryString(items),filters_ids:implode(',',self.selectedData.filters),groups_ids:implode(',',self.selectedData.groups)},onSuccess:function(transport){if(transport.responseText=='0'){self.addPopUp.modal('closeModal');}}});},cancel:function(){return false;}}});},openAddRecordPopup:function(){var self=this;new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/getAddCustomItemForm'),{method:'get',parameters:{motors_type:self.motorsType},onSuccess:function(transport){var containerEl=$('ebay_settings_motors_custom_item_form');if(containerEl){containerEl.remove();}\n$('html-body').insert({bottom:'<div id=\"ebay_settings_motors_custom_item_form\"></div>'});$('ebay_settings_motors_custom_item_form').update(transport.responseText);self.addRecordPopUp=jQuery('#ebay_settings_motors_custom_item_form');modal({title:M2ePro.translator.translate('Add Custom Compatible Vehicle'),type:'popup',buttons:[{text:M2ePro.translator.translate('Close'),class:'action-secondary',click:function(){self.addRecordPopUp.modal('closeModal');}},{text:M2ePro.translator.translate('Confirm'),class:'action-primary',click:function(){if(!jQuery('#motors_custom_item').valid()){return;}\nnew Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/saveCustomItem'),{method:'post',parameters:$$('#ebay_settings_motors_custom_item_form form').first().serialize(true),onSuccess:function(transport){var result=transport.responseText.evalJSON();if(!result.result){return self.alert(result.message);}\nself.addRecordPopUp.modal('closeModal');EbayListingViewSettingsMotorsAddItemGridObj.unselectAllAndReload();}});}}]},self.addRecordPopUp);self.addRecordPopUp.modal('openModal');self.initFormValidation('#motors_custom_item');}});},removeCustomMotorsRecord:function(motorsType,keyId){var self=this;var index=self.selectedData.items.indexOf(''+keyId);if(index>-1){self.selectedData.items.splice(index,1);}\nnew Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/removeCustomItem'),{method:'post',asynchronous:true,parameters:{motors_type:motorsType,key_id:keyId},onSuccess:function(transport){var result=transport.responseText.evalJSON();if(!result.result){return alert(result.message);}\nself.updateSelectedData();EbayListingViewSettingsMotorsAddItemGridObj.unselectAllAndReload();EbayListingViewSettingsMotorsAddGroupGridObj.unselectAllAndReload();}});},closeInstruction:function(listingProductsIds){var self=this;new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/closeInstruction'),{method:'post',onSuccess:function(transport){self.addPopUp.modal('closeModal');self.openAddPopUp(listingProductsIds);}});}});});","Ess_M2ePro/js/Ebay/Listing/View/Settings/Motors/Add/Filter/Grid.min.js":"define(['Magento_Ui/js/modal/modal','M2ePro/Grid'],function(modal){window.EbayListingViewSettingsMotorsAddFilterGrid=Class.create(Grid,{filtersConditions:{},initialize:function($super,gridId){$super(gridId);},prepareActions:function(){this.actions={selectAction:this.selectFilters.bind(this),setNoteAction:this.setNote.bind(this),resetNoteAction:this.resetNote.bind(this),saveAsGroupAction:this.saveAsGroup.bind(this),removeFilterAction:this.removeFilter.bind(this)};},selectFilters:function(){var self=this,filters=self.getGridMassActionObj().checkedString.split(',');filters.each(function(filter){for(var i=0;i<EbayListingViewSettingsMotorsObj.selectedData.filters.length;i++){if(EbayListingViewSettingsMotorsObj.selectedData.filters[i]==filter){return;}}\nEbayListingViewSettingsMotorsObj.selectedData.filters.push(filter);});self.unselectAll();EbayListingViewSettingsMotorsObj.updateSelectedData();},setNote:function(){var self=this;new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/getNoteForm'),{method:'get',onSuccess:function(transport){var containerEl=$('ebay_settings_motors_note_form');if(containerEl){containerEl.remove();}\n$('html-body').insert({bottom:'<div id=\"ebay_settings_motors_note_form\"></div>'});$('ebay_settings_motors_note_form').insert({bottom:transport.responseText});self.notePopup=jQuery('#ebay_settings_motors_note_form');modal({title:M2ePro.translator.translate('Set Note'),type:'popup',buttons:[{text:M2ePro.translator.translate('Close'),class:'action-secondary',click:function(){self.notePopup.modal('closeModal');}},{text:M2ePro.translator.translate('Save'),class:'action-primary',click:function(){if(!self.validatePopupForm('motors_note')){return;}\nvar data=$('motors_note').serialize(true);data['filters_ids']=self.getGridMassActionObj().checkedString;new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/setNoteToFilters'),{method:'post',parameters:data,onSuccess:function(transport){if(transport.responseText=='0'){self.unselectAllAndReload();}\nself.notePopup.modal('closeModal');}});}}]},self.notePopup);self.notePopup.modal('openModal');self.initFormValidation('#motors_note');}});},resetNote:function(){var self=this;new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/setNoteToFilters'),{method:'post',parameters:{filters_ids:self.getGridMassActionObj().checkedString,note:''},onSuccess:function(transport){if(transport.responseText=='0'){self.unselectAllAndReload();}\nself.notePopup.modal('closeModal');}});},saveAsGroup:function(){var self=this;new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/getSaveAsGroupForm'),{method:'get',onSuccess:function(transport){var containerEl=$('ebay_settings_motors_save_group');if(containerEl){containerEl.remove();}\n$('html-body').insert({bottom:'<div id=\"ebay_settings_motors_save_group\"></div>'});$('ebay_settings_motors_save_group').insert({bottom:transport.responseText});self.groupPopup=jQuery('#ebay_settings_motors_save_group');modal({title:M2ePro.translator.translate('Save as Group'),type:'popup',buttons:[{text:M2ePro.translator.translate('Close'),class:'action-secondary',click:function(){self.groupPopup.modal('closeModal');}},{text:M2ePro.translator.translate('Save'),class:'action-primary',click:function(){if(!self.validatePopupForm('motors_group')){return;}\nvar data=$('motors_group').serialize(true);data.items=self.getGridMassActionObj().checkedString;data.type=EbayListingViewSettingsMotorsObj.motorsType;data.mode=M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Motor_Group::MODE_FILTER');new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/saveAsGroup'),{method:'post',parameters:data,onSuccess:function(transport){if(transport.responseText=='0'){self.unselectAll();$(self.getGridMassActionObj().select).value='';EbayListingViewSettingsMotorsAddGroupGridObj.unselectAllAndReload();}\nself.groupPopup.modal('closeModal');}});}}]},self.groupPopup);self.groupPopup.modal('openModal');self.initFormValidation('#motors_group');}});},removeFilter:function(){var self=this,filters=self.getGridMassActionObj().checkedString.split(',');filters.each(function(filter){var index=EbayListingViewSettingsMotorsObj.selectedData.filters.indexOf(filter);if(index>-1){EbayListingViewSettingsMotorsObj.selectedData.filters.splice(index,1);}});EbayListingViewSettingsMotorsObj.updateSelectedData();new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/removeFilter'),{method:'post',parameters:{filters_ids:self.getGridMassActionObj().checkedString},onSuccess:function(transport){if(transport.responseText=='0'){self.unselectAllAndReload();EbayListingViewSettingsMotorsAddGroupGridObj.unselectAllAndReload();}}});},showFilterResult:function(filterId){jQuery('#ebayMotorAddTabs').tabs({active:0});EbayListingViewSettingsMotorsAddItemGridObj.showFilterResult(this.filtersConditions[filterId]);},validatePopupForm:function(formId){return jQuery('#'+formId).valid();},});});","Ess_M2ePro/js/Ebay/Listing/View/Settings/Motors/Add/Item/Grid.min.js":"define(['Magento_Ui/js/modal/modal','M2ePro/Grid'],function(modal){window.EbayListingViewSettingsMotorsAddItemGrid=Class.create(Grid,{savedNotes:{},initialize:function($super,gridId){$super(gridId);this.savedNotes={};},prepareActions:function(){this.actions={selectAction:this.selectItems.bind(this),setNoteAction:this.setNote.bind(this),resetNoteAction:this.resetNote.bind(this),saveAsGroupAction:this.saveAsGroup.bind(this)};},afterInitPage:function(){var self=this;Grid.prototype.afterInitPage.call(this);$(self.gridId).down('.data-grid-filters').on('change',function(e){self.checkFilterValues();});$(self.gridId).down('.data-grid-filters').on('keyup',function(e){self.checkFilterValues();});self.checkFilterValues();$H(self.savedNotes).each(function(note){var noteEl=$('note_'+note.key);if(noteEl&&note.value!=''){noteEl.show();noteEl.down('.note-view').innerHTML=note.value;}});var select=$(self.getGridMassActionObj().containerId+'-mass-select');self.bindEventAtFirstPosition(select,'change',self.massactionOnChange.bind(self));},checkFilterValues:function(){var self=this;$('save_filter_btn').addClassName('disabled');$(self.gridId).down('.data-grid-filters').select('select','input').each(function(el){if(el.name=='massaction'){return;}\nif(el.value!=''){$('save_filter_btn').removeClassName('disabled');throw $break;}});},selectItems:function(){var self=this,items=self.getGridMassActionObj().checkedString.split(',');items.each(function(item){for(var i=0;i<EbayListingViewSettingsMotorsObj.selectedData.items.length;i++){if(EbayListingViewSettingsMotorsObj.selectedData.items[i]==item){return;}}\nEbayListingViewSettingsMotorsObj.selectedData.items.push(item);});self.unselectAll();EbayListingViewSettingsMotorsObj.updateSelectedData();},setNote:function(){var self=this;new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/getNoteForm'),{method:'get',onSuccess:function(transport){var containerEl=$('ebay_settings_motors_note_form');if(containerEl){containerEl.remove();}\n$('html-body').insert({bottom:'<div id=\"ebay_settings_motors_note_form\"></div>'});$('ebay_settings_motors_note_form').insert({bottom:transport.responseText});self.notePopup=jQuery('#ebay_settings_motors_note_form');modal({title:M2ePro.translator.translate('Set Note'),type:'popup',buttons:[{text:M2ePro.translator.translate('Close'),class:'action-secondary',click:function(){self.notePopup.modal('closeModal');}},{text:M2ePro.translator.translate('Save'),class:'action-primary',click:function(){if(!self.validatePopupForm('motors_note')){return;}\nvar note=$('motors_note').down('[name=note]').value;note=note.trim();self.getGridMassActionObj().getCheckedValues().split(',').each(function(id){self.savedNotes[id]=note;var noteEl=$('note_'+id);if(noteEl){noteEl.hide();if(note!=''){noteEl.show();noteEl.down('.note-view').innerHTML=note;}}});$(self.getGridMassActionObj().select).value='';self.notePopup.modal('closeModal');}}]},self.notePopup);self.notePopup.modal('openModal');self.initFormValidation('#motors_note');}});},resetNote:function(){var self=this;self.getGridMassActionObj().getCheckedValues().split(',').each(function(id){self.savedNotes[id]='';var noteEl=$('note_'+id);if(noteEl){noteEl.hide();noteEl.down('.note-view').innerHTML='';}});$(self.getGridMassActionObj().select).value='';self.unselectAll();},saveAsGroup:function(){var self=this;new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/getSaveAsGroupForm'),{method:'get',onSuccess:function(transport){var containerEl=$('ebay_settings_motors_save_group');if(containerEl){containerEl.remove();}\n$('html-body').insert({bottom:'<div id=\"ebay_settings_motors_save_group\"></div>'});$('ebay_settings_motors_save_group').insert({bottom:transport.responseText});self.groupPopup=jQuery('#ebay_settings_motors_save_group');modal({title:M2ePro.translator.translate('Save as Group'),type:'popup',buttons:[{text:M2ePro.translator.translate('Close'),class:'action-secondary',click:function(){self.groupPopup.modal('closeModal');}},{text:M2ePro.translator.translate('Save'),class:'action-primary',click:function(){if(!self.validatePopupForm('motors_group')){return;}\nvar data=$('motors_group').serialize(true);data.items=self.getGridMassActionObj().checkedString.split(',');data.type=EbayListingViewSettingsMotorsObj.motorsType;data.mode=M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Motor_Group::MODE_ITEM');var items={};data.items.each(function(item){items[item]=self.savedNotes[item];});data.items=Object.toQueryString(items);new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/saveAsGroup'),{method:'post',parameters:data,onSuccess:function(transport){if(transport.responseText=='0'){self.unselectAll();$(self.getGridMassActionObj().select).value='';EbayListingViewSettingsMotorsAddGroupGridObj.unselectAllAndReload();}\nself.groupPopup.modal('closeModal');}});}}]},self.groupPopup);self.groupPopup.modal('openModal');self.initFormValidation('#motors_group');}});},saveFilter:function(){var self=this;if($('save_filter_btn').hasClassName('disabled')){return;}\nnew Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/getSaveFilterForm'),{method:'get',onSuccess:function(transport){var containerEl=$('ebay_settings_motors_save_filter');if(containerEl){containerEl.remove();}\n$('html-body').insert({bottom:'<div id=\"ebay_settings_motors_save_filter\"></div>'});$('ebay_settings_motors_save_filter').insert({bottom:transport.responseText});self.filterPopup=jQuery('#ebay_settings_motors_save_filter');modal({title:M2ePro.translator.translate('Save Filter'),type:'popup',buttons:[{text:M2ePro.translator.translate('Close'),class:'action-secondary',click:function(){self.filterPopup.modal('closeModal');}},{text:M2ePro.translator.translate('Save'),class:'action-primary',click:function(){if(!self.validatePopupForm('motors_filter')){return;}\nvar data=$('motors_filter').serialize(true);data.conditions=Form.serialize($(self.gridId).down('.data-grid-filters'));data.type=EbayListingViewSettingsMotorsObj.motorsType;new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/saveFilter'),{method:'post',parameters:data,onSuccess:function(transport){if(transport.responseText=='0'){$(self.getGridMassActionObj().select).value='';EbayListingViewSettingsMotorsAddFilterGridObj.unselectAllAndReload();}\nself.filterPopup.modal('closeModal');}});}}]},self.filterPopup);self.filterPopup.modal('openModal');var conditionsEl=$('ebay_settings_motors_save_filter').down('.filter_conditions');var conditionsData={};$(self.gridId).down('.data-grid-filters').select('select','input').each(function(el){if(el.name=='massaction'){return;}\nif(el.value!=''){var li=new Element('li'),valueText='',valueName=el.name.capitalize().replace('_',' ');if(el.name=='product_type'){valueText=el[el.selectedIndex].text;valueName=M2ePro.translator.translate('Type');}else{valueText=el.value;}\nif(el.name=='epid'){valueName=M2ePro.translator.translate('ePID');}\nif(el.name=='ktype'){valueName=M2ePro.translator.translate('kType');}\nif(el.name=='body_style'){valueName=M2ePro.translator.translate('Body Style');}\nif(el.name=='year[from]'){valueName=M2ePro.translator.translate('Year From');}\nif(el.name=='year[to]'){valueName=M2ePro.translator.translate('Year To');}\nli.update('<b>'+valueName+'</b>: '+valueText);conditionsData[el.name]=el.value;conditionsEl.insert({bottom:li});}});self.initFormValidation('#motors_filter');}});},validatePopupForm:function(formId){return jQuery('#'+formId).valid();},showFilterResult:function(comnditions){var self=this;$(self.gridId).down('.data-grid-filters').select('input','select').each(function(el){el.value='';});$H(comnditions).each(function(item){$(self.gridId).down('.data-grid-filters').select('[name^='+item.key+']').each(function(el){if(item.key!='year'){el.value=item.value;return null;}\nif(typeof item.value=='string'){el.value=item.value;return null;}\n$(self.gridId).down('.data-grid-filters').down('[name=year[from]]').value=item.value.from;$(self.gridId).down('.data-grid-filters').down('[name=year[to]]').value=item.value.to;});});self.getGridObj().doFilter();},massactionOnChange:function(event)\n{if(event.target.value!='selectAll'){return true;}\nvar gridIds=this.getGridMassActionObj().getGridIds().split(',');if(gridIds.length<M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Helper\\\\Component\\\\Ebay\\\\Motors::MAX_ITEMS_COUNT_FOR_ATTRIBUTE')){return true;}\nthis.alert(M2ePro.translator.translate('It is impossible to select all the items.'));event.stopImmediatePropagation();event.target.value='';}});});","Ess_M2ePro/js/Ebay/Listing/View/Settings/Motors/Add/Group/Grid.min.js":"define(['Magento_Ui/js/modal/modal','M2ePro/Grid'],function(modal){window.EbayListingViewSettingsMotorsAddGroupGrid=Class.create(Grid,{initialize:function($super,gridId){$super(gridId);},prepareActions:function(){this.actions={selectAction:this.selectGroups.bind(this),removeGroupAction:this.removeGroup.bind(this)};},selectGroups:function(){var self=this,groups=self.getGridMassActionObj().checkedString.split(',');groups.each(function(group){for(var i=0;i<EbayListingViewSettingsMotorsObj.selectedData.groups.length;i++){if(EbayListingViewSettingsMotorsObj.selectedData.groups[i]==group){return;}}\nEbayListingViewSettingsMotorsObj.selectedData.groups.push(group);});self.unselectAll();EbayListingViewSettingsMotorsObj.updateSelectedData();},removeGroup:function(){var self=this,groups=self.getGridMassActionObj().checkedString.split(',');groups.each(function(group){var index=EbayListingViewSettingsMotorsObj.selectedData.groups.indexOf(group);if(index>-1){EbayListingViewSettingsMotorsObj.selectedData.groups.splice(index,1);}});EbayListingViewSettingsMotorsObj.updateSelectedData();new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/removeGroup'),{method:'post',parameters:{groups_ids:self.getGridMassActionObj().checkedString},onSuccess:function(transport){if(transport.responseText=='0'){self.unselectAllAndReload();}}});},viewGroupContentPopup:function(groupId,title){var self=this;new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/getGroupContentView'),{method:'get',parameters:{group_id:groupId},onSuccess:function(transport){var containerEl=$('ebay_settings_motors_group_content');if(containerEl){containerEl.remove();}\n$('html-body').insert({bottom:'<div id=\"ebay_settings_motors_group_content\"></div>'});$('ebay_settings_motors_group_content').insert({bottom:transport.responseText});self.goupContentPopup=jQuery('#ebay_settings_motors_group_content');modal({title:title,type:'popup',buttons:[{text:M2ePro.translator.translate('Close'),class:'action-secondary',click:function(){self.goupContentPopup.modal('closeModal');}}],closed:function(){EbayListingViewSettingsMotorsAddGroupGridObj.unselectAllAndReload();}},self.goupContentPopup);self.goupContentPopup.modal('openModal');}});},removeItemFromGroup:function(el,itemId,groupId){var self=this;new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/removeItemFromGroup'),{method:'post',parameters:{items_ids:itemId,group_id:groupId},onSuccess:function(transport){if(transport.responseText=='0'){if($(el).up('tbody').select('tr').length==1){var index=EbayListingViewSettingsMotorsObj.selectedData.groups.indexOf(''+groupId);if(index>-1){EbayListingViewSettingsMotorsObj.selectedData.groups.splice(index,1);EbayListingViewSettingsMotorsObj.updateSelectedData();}\nself.goupContentPopup.modal('closeModal');return;}\n$(el).up('tr').remove();}}});},removeFilterFromGroup:function(el,filterId,groupId){var self=this;new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/removeFilterFromGroup'),{method:'post',parameters:{filters_ids:filterId,group_id:groupId},onSuccess:function(transport){if(transport.responseText=='0'){if($(el).up('tbody').select('tr').length==1){var index=EbayListingViewSettingsMotorsObj.selectedData.groups.indexOf(''+groupId);if(index>-1){EbayListingViewSettingsMotorsObj.selectedData.groups.splice(index,1);EbayListingViewSettingsMotorsObj.updateSelectedData();}\nself.goupContentPopup.modal('closeModal');return;}\n$(el).up('tr').remove();}}});}});});","Ess_M2ePro/js/Ebay/Listing/View/Settings/Motors/View/Filter/Grid.min.js":"define(['M2ePro/Grid'],function(){window.EbayListingViewSettingsMotorsViewFilterGrid=Class.create(Grid,{entityId:'',initialize:function($super,gridId,entityId){$super(gridId);this.entityId=entityId;},prepareActions:function(){this.actions={removeFilterAction:this.removeFilter.bind(this)};},removeFilter:function(){var self=this;new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/removeFilterFromProduct'),{method:'post',parameters:{filters_ids:self.getGridMassActionObj().checkedString,entity_id:self.entityId,motors_type:EbayListingViewSettingsMotorsObj.motorsType},onSuccess:function(transport){if(transport.responseText=='0'){self.unselectAllAndReload();}}});},});});","Ess_M2ePro/js/Ebay/Listing/View/Settings/Motors/View/Item/Grid.min.js":"define(['M2ePro/Grid'],function(){window.EbayListingViewSettingsMotorsViewItemGrid=Class.create(Grid,{entityId:'',initialize:function($super,gridId,entityId){$super(gridId);this.entityId=entityId;},prepareActions:function(){this.actions={removeItemAction:this.removeItem.bind(this)};},removeItem:function(){var self=this;new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/removeItemFromProduct'),{method:'post',parameters:{items_ids:self.getGridMassActionObj().checkedString,entity_id:self.entityId,motors_type:EbayListingViewSettingsMotorsObj.motorsType},onSuccess:function(transport){if(transport.responseText=='0'){self.unselectAllAndReload();}}});},});});","Ess_M2ePro/js/Ebay/Listing/View/Settings/Motors/View/Group/Grid.min.js":"define(['M2ePro/Grid'],function(){window.EbayListingViewSettingsMotorsViewGroupGrid=Class.create(Grid,{initialize:function($super,gridId,entityId){$super(gridId);this.entityId=entityId;},prepareActions:function(){this.actions={removeGroupAction:this.removeGroup.bind(this)};},removeGroup:function(){var self=this;new Ajax.Request(M2ePro.url.get('ebay_listing_settings_motors/removeGroupFromListingProduct'),{method:'post',parameters:{groups_ids:self.getGridMassActionObj().checkedString,entity_id:self.entityId,motors_type:EbayListingViewSettingsMotorsObj.motorsType},onSuccess:function(transport){if(transport.responseText=='0'){self.unselectAllAndReload();}}});},});});","Ess_M2ePro/js/Ebay/Listing/View/Ebay/Grid.min.js":"define(['Magento_Ui/js/modal/modal','M2ePro/Plugin/Messages','M2ePro/Ebay/Listing/View/Grid'],function(modal,MessageObj){window.EbayListingViewEbayGrid=Class.create(EbayListingViewGrid,{afterInitPage:function($super)\n{$super();$(this.gridId+'_massaction-select').observe('change',function(){if(!$('get-estimated-fee')){return;}\nif(this.value=='list'){$('get-estimated-fee').show();}else{$('get-estimated-fee').hide();}});},getMaxProductsInPart:function()\n{return 10;},getLogViewUrl:function(rowId)\n{var idField=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Block\\\\Adminhtml\\\\Log\\\\Listing\\\\Product\\\\AbstractGrid::LISTING_PRODUCT_ID_FIELD');var params={};params[idField]=rowId;return M2ePro.url.get('ebay_log_listing_product/index',params);},openFeePopUp:function(content,title)\n{var feePopup=$('fee_popup');if(feePopup){feePopup.remove();}\n$('html-body').insert({bottom:'<div id=\"fee_popup\"></div>'});$('fee_popup').update(content);var popup=jQuery('#fee_popup');modal({title:title,type:'popup',buttons:[{text:M2ePro.translator.translate('Close'),class:'action-secondary',click:function(){popup.modal('closeModal');}}]},popup);popup.modal('openModal');},getEstimatedFees:function(listingProductId)\n{var self=this;new Ajax.Request(M2ePro.url.get('ebay_listing/getEstimatedFees'),{method:'get',asynchronous:true,parameters:{listing_product_id:listingProductId},onSuccess:function(transport){var response=transport.responseText.evalJSON();if(response.error){self.alert('Unable to receive estimated fee.');return;}\nself.openFeePopUp(response.html,response.title);}});},openItemDuplicatePopUp:function(listingProductId)\n{var self=this;new Ajax.Request(M2ePro.url.get('ebay_listing_product_duplicate/getPopup'),{method:'get',asynchronous:true,parameters:{listing_product_id:listingProductId},onSuccess:function(transport){var response=transport.responseText.evalJSON();if(response.error){self.alert(response.error);return;}\nvar duplicatePopup=$('duplicate_popup');if(duplicatePopup){duplicatePopup.remove();}\n$('html-body').insert({bottom:'<div id=\"duplicate_popup\"></div>'});$('duplicate_popup').update(response.html);var popup=jQuery('#duplicate_popup');modal({title:M2ePro.translator.translate('Ebay Item Duplicate'),type:'popup',buttons:[{text:M2ePro.translator.translate('Close'),class:'action-secondary',click:function(){popup.modal('closeModal');}}]},popup);popup.modal('openModal');}});},closeItemDuplicatePopUp:function(reloadGrid)\n{reloadGrid=reloadGrid||false;reloadGrid&&this.getGridObj().reload();jQuery('#duplicate_popup').modal('closeModal')},solveItemDuplicateAction:function(listingProductId,isNeedStop,isNeedList)\n{var self=this;new Ajax.Request(M2ePro.url.get('ebay_listing_product_duplicate/solve'),{method:'get',asynchronous:true,parameters:{listing_product_id:listingProductId,stop_duplicated_item:Number(isNeedStop),list_current_item:Number(isNeedList)},onSuccess:function(transport){var response=transport.responseText.evalJSON();MessageObj.setContainer('#ebay_listing_item_duplicate_fieldset');MessageObj.clear();if(response.message){MessageObj.addErrorMessage(response.message);}\nif(response.result){self.closeItemDuplicatePopUp(true);}}});},showMotorsNotificationPopUp:function(message)\n{var content='<div style=\"padding: 10px 0;\">'+message+'</div>'+'<div style=\"float: right;\">'+'<button onclick=\"Windows.getFocusedWindow().close()\">'+'<span>OK</span>'+'</button>'+'</div> ';var config={draggable:true,resizable:true,closable:true,className:\"magento\",windowClassName:\"popup-window\",title:M2ePro.translator.translate('Compatibility Attribute'),top:250,height:85,width:420,zIndex:100,recenterAuto:true,hideEffect:Element.hide,showEffect:Element.show};Dialog.info(content,config);}});});","Ess_M2ePro/js/Ebay/Listing/View/Ebay/Bids.min.js":"define(['Magento_Ui/js/modal/modal','M2ePro/Plugin/Messages','M2ePro/Action'],function(modal,MessageObj){window.EbayListingViewEbayBids=Class.create(Action,{initialize:function($super,gridHandler){var self=this;$super(gridHandler);},options:{},setOptions:function(options){this.options=Object.extend(this.options,options);return this;},parseResponse:function(response){if(!response.responseText.isJSON()){return;}\nreturn response.responseText.evalJSON();},openPopUp:function(productId,title){var self=this;MessageObj.clear();new Ajax.Request(M2ePro.url.get('ebay_listing/getListingProductBids'),{method:'post',parameters:{product_id:productId},onSuccess:function(transport){var containerEl=$('ebay_listing_product_bids');if(containerEl){containerEl.remove();}\n$('html-body').insert({bottom:'<div id=\"ebay_listing_product_bids\"></div>'});$('ebay_listing_product_bids').update(transport.responseText);self.listingProductBidsPopup=jQuery('#ebay_listing_product_bids');modal({title:title,type:'popup',buttons:[{text:M2ePro.translator.translate('Close'),class:'action-secondary',click:function(){self.listingProductBidsPopup.modal('closeModal')}}]},self.listingProductBidsPopup);self.listingProductBidsPopup.modal('openModal');}});}});});","Ess_M2ePro/js/Ebay/Listing/Product/Add.min.js":"define(['jquery','Magento_Ui/js/modal/modal','M2ePro/Common'],function(jQuery,modal){window.EbayListingProductAdd=Class.create(Common,{options:{show_autoaction_popup:false,get_selected_products:function(callback){}},initialize:function(options){this.options=Object.extend(this.options,options);},continue:function(){var self=this;self.options.get_selected_products(function(selectedProducts){if(!selectedProducts){self.alert(M2ePro.translator.translate('Please select the Products you want to perform the Action on.'));return;}\nif(self.options.show_autoaction_popup){return self.showAutoactionPopup();}\nself.add(selectedProducts);});},add:function(products){var self=this;self.products=products;var parts=self.makeProductsParts();ProgressBarObj.reset();ProgressBarObj.setTitle('Adding Products to Listing');ProgressBarObj.setStatus('Adding in process. Please wait...');ProgressBarObj.show();self.scrollPageToTop();WrapperObj.lock();self.sendPartsProducts(parts,parts.length);},makeProductsParts:function(){var self=this;var productsInPart=50;var productsArray=explode(',',self.products);var parts=new Array();if(productsArray.length<productsInPart){return parts[0]=productsArray;}\nvar result=new Array();for(var i=0;i<productsArray.length;i++){if(result.length==0||result[result.length-1].length==productsInPart){result[result.length]=new Array();}\nresult[result.length-1][result[result.length-1].length]=productsArray[i];}\nreturn result;},sendPartsProducts:function(parts,partsCount){var self=this;if(parts.length==0){return;}\nvar part=parts.splice(0,1);part=part[0];var partString=implode(',',part);var isLastPart='';if(parts.length<=0){isLastPart='yes';}\nnew Ajax.Request(M2ePro.url.get('ebay_listing_product_add/add'),{method:'post',parameters:{is_last_part:isLastPart,products:partString},onSuccess:function(transport){var percents=(100 / partsCount)*(partsCount-parts.length);if(percents<=0){ProgressBarObj.setPercents(0,0);}else if(percents>=100){ProgressBarObj.setPercents(100,0);ProgressBarObj.setStatus('Adding has been completed.');setLocation(M2ePro.url.get('ebay_listing_product_category_settings',{step:1}));}else{ProgressBarObj.setPercents(percents,1);}\nsetTimeout(function(){self.sendPartsProducts(parts,partsCount);},500);}});$$('.loading-mask').invoke('setStyle',{visibility:'hidden'});},showAutoactionPopup:function(){new Ajax.Request(M2ePro.url.get('ebay_listing_product_add/setAutoActionPopupShown'),{method:'get',onSuccess:function(){this.options.show_autoaction_popup=false;var modalDialogMessage=$('modal_auto_action_dialog_message');if(!modalDialogMessage){modalDialogMessage=new Element('div',{id:'modal_auto_action_dialog_message'});this.autoactionPopup=jQuery(modalDialogMessage).modal({title:M2ePro.translator.translate('Auto Add/Remove Rules'),type:'popup',buttons:[{text:M2ePro.translator.translate('Cancel'),class:'action-secondary action-dismiss',click:ListingProductAddObj.cancelAutoActionPopup},{text:M2ePro.translator.translate('Start Configure'),class:'action-primary action-accept',click:function(){ListingProductAddObj.autoactionPopup.modal('closeModal');ListingAutoActionObj.loadAutoActionHtml();}}]});modalDialogMessage.insert($('autoaction_popup_content').show());}\nthis.autoactionPopup.modal('openModal');}.bind(this)});},cancelAutoActionPopup:function(){ListingProductAddObj.autoactionPopup.modal('closeModal');ListingProductAddObj.continue();}});});","Ess_M2ePro/js/Ebay/Listing/Product/Category/Settings/Chooser.min.js":"define(['jquery','Magento_Ui/js/modal/modal','M2ePro/Common','M2ePro/Plugin/Magento/AttributeCreator'],function(jQuery,modal){window.EbayListingProductCategorySettingsChooser=Class.create();EbayListingProductCategorySettingsChooser.prototype=Object.extend(new Common(),{marketplaceId:null,accountId:null,divId:null,selectedCategories:{},categoryTitles:{},attributes:[],selectCallback:null,unselectCallback:null,doneCallback:null,cancelCallback:null,isShowEditLinks:true,categoriesRequiringValidation:{},isSingleCategoryMode:false,singleCategoryType:null,tempUnselectedCategory:{},tempSelectedCategory:{},isWizardMode:false,initialize:function(div,marketplace,account){this.marketplaceId=marketplace;this.accountId=account;this.divId=div;},setSelectCallback:function(callback){this.selectCallback=callback;},setUnselectCallback:function(callback){this.unselectCallback=callback;},getMarketplaceId:function(){var self=EbayListingProductCategorySettingsChooserObj;return self.marketplaceId;},getAccountId:function(){var self=EbayListingProductCategorySettingsChooserObj;return self.accountId;},setAttributes:function(attributes){var self=EbayListingProductCategorySettingsChooserObj;self.attributes=attributes;},getAttributes:function(){var self=EbayListingProductCategorySettingsChooserObj;return self.attributes;},setSingleCategoryMode:function(mode){var self=EbayListingProductCategorySettingsChooserObj;self.isSingleCategoryMode=mode;},setSingleCategoryType:function(type){var self=EbayListingProductCategorySettingsChooserObj;self.singleCategoryType=type;},setShowEditLinks:function(mode){var self=EbayListingProductCategorySettingsChooserObj;self.isShowEditLinks=mode;},setSelectedCategory:function(type,mode,value){var self=EbayListingProductCategorySettingsChooserObj;self.selectedCategories[type]={mode:mode,value:value};},setSelectedCategories:function(categories){var self=EbayListingProductCategorySettingsChooserObj;self.selectedCategories=categories;},getSelectedCategory:function(type){var self=EbayListingProductCategorySettingsChooserObj;if(typeof type=='undefined'){return self.selectedCategories;}\nif(typeof self.selectedCategories[type]=='undefined'){return{mode:0,value:''};}\nreturn self.selectedCategories[type];},getInternalData:function(){var self=EbayListingProductCategorySettingsChooserObj;if(self.isSingleCategoryMode){return self.selectedCategories[self.singleCategoryType];}\nvar internalData={};self.setCategoryToInternalData(M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Helper\\\\Component\\\\Ebay\\\\Category::TYPE_EBAY_MAIN'),'category_main_',internalData);self.setCategoryToInternalData(M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Helper\\\\Component\\\\Ebay\\\\Category::TYPE_EBAY_SECONDARY'),'category_secondary_',internalData);self.setCategoryToInternalData(M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Helper\\\\Component\\\\Ebay\\\\Category::TYPE_STORE_MAIN'),'store_category_main_',internalData);self.setCategoryToInternalData(M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Helper\\\\Component\\\\Ebay\\\\Category::TYPE_STORE_SECONDARY'),'store_category_secondary_',internalData);return internalData;},getInternalDataByType:function(type){var prefixByType={};prefixByType[M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Helper\\\\Component\\\\Ebay\\\\Category::TYPE_EBAY_MAIN')]='category_main_';prefixByType[M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Helper\\\\Component\\\\Ebay\\\\Category::TYPE_EBAY_SECONDARY')]='category_secondary_';prefixByType[M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Helper\\\\Component\\\\Ebay\\\\Category::TYPE_STORE_MAIN')]='store_category_main_';prefixByType[M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Helper\\\\Component\\\\Ebay\\\\Category::TYPE_STORE_SECONDARY')]='store_category_secondary_';var data={};this.setCategoryToInternalData(type,prefixByType[type],data);return data;},getConvertedInternalData:function(){var self=EbayListingProductCategorySettingsChooserObj;return self.selectedCategories;},setCategoryToInternalData:function(type,prefix,data){var self=EbayListingProductCategorySettingsChooserObj;data[prefix+'mode']=0;data[prefix+'id']=null;data[prefix+'attribute']=null;if(typeof self.selectedCategories[type]!='undefined'&&typeof self.selectedCategories[type]['mode']!='undefined'){data[prefix+'mode']=self.selectedCategories[type].mode;if(data[prefix+'mode']==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Category::CATEGORY_MODE_EBAY')){data[prefix+'id']=self.selectedCategories[type].value;}else if(data[prefix+'mode']==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Category::CATEGORY_MODE_ATTRIBUTE')){data[prefix+'attribute']=self.selectedCategories[type].value;}}\nreturn data;},getCategoryTitle:function(type){var self=EbayListingProductCategorySettingsChooserObj;if(typeof self.categoryTitles[type]=='undefined'){return'';}\nreturn self.categoryTitles[type];},setCategoryTitles:function(titles){var self=EbayListingProductCategorySettingsChooserObj;self.categoryTitles=titles;},setIsWizardMode:function(mode){var self=EbayListingProductCategorySettingsChooserObj;self.isWizardMode=mode;},showEditPopUp:function(type){var self=EbayListingProductCategorySettingsChooserObj;var selected=self.getSelectedCategory(type);new Ajax.Request(M2ePro.url.get('ebay_category/getChooserEditHtml'),{method:'post',parameters:{marketplace_id:self.marketplaceId,account_id:self.accountId,category_type:type,selected_mode:selected.mode,selected_value:selected.value,selected_path:selected.path},onSuccess:function(transport){var title=M2ePro.translator.translate('Edit')+' '+self.getCategoryTitle(type);self.openPopUp(title,transport.responseText);self.renderRecent();self.renderAttributes();}});},openPopUp:function(title,html){var self=EbayListingProductCategorySettingsChooserObj;if($('chooser_container')){$('chooser_container').remove();}\n$('html-body').insert({bottom:html});var content=jQuery('#chooser_container');modal({title:title,type:'slide',closed:function(){var type=$('category_type').value;delete self.tempSelectedCategory[type];delete self.tempUnselectedCategory[type];},buttons:[{text:M2ePro.translator.translate('Cancel'),click:function(){EbayListingProductCategorySettingsChooserObj.cancelPopUp();}},{class:'action primary',text:M2ePro.translator.translate('Confirm'),click:function(){EbayListingProductCategorySettingsChooserObj.confirmCategory();}}]},content);content.modal('openModal');},cancelPopUp:function(){var self=EbayListingProductCategorySettingsChooserObj;jQuery('#chooser_container').modal('closeModal');if(typeof self.cancelCallback=='function'){self.cancelCallback();}},selectCategory:function(mode,value){var self=EbayListingProductCategorySettingsChooserObj;var type=$('category_type').value;self.tempSelectedCategory[type]={mode:mode,value:value};delete self.tempUnselectedCategory[type];new Ajax.Request(M2ePro.url.get('ebay_category/getPath'),{method:'post',parameters:{marketplace_id:self.marketplaceId,account_id:self.accountId,value:value,mode:mode,category_type:type},onSuccess:function(transport){$('selected_category_path').innerHTML=transport.responseText;$('category_reset_link').show();}});},unSelectCategory:function(){var self=EbayListingProductCategorySettingsChooserObj;var type=$('category_type').value;self.tempUnselectedCategory[type]=true;delete self.tempSelectedCategory[type];$('selected_category_path').innerHTML='';$('category_reset_link').hide();$('selected_category_path').innerHTML='<span style=\"color: grey; font-style: italic\">'+M2ePro.translator.translate('Not Selected')+'</span>';},isCategoryTemporarySelected:function(type){return typeof this.tempSelectedCategory[type]!='undefined'&&typeof this.tempSelectedCategory[type].mode!='undefined'&&this.tempSelectedCategory[type].mode!=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Category::CATEGORY_MODE_NONE');},isCategoryTemporaryUnselected:function(type){return typeof this.tempUnselectedCategory[type]!='undefined';},isCategorySelected:function(type){return typeof this.selectedCategories[type]!='undefined'&&typeof this.selectedCategories[type].mode!='undefined'&&this.selectedCategories[type].mode!=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Category::CATEGORY_MODE_NONE');},isCategoryValidationRequired:function(type){return typeof this.categoriesRequiringValidation[type]!='undefined'&&this.categoriesRequiringValidation[type];},confirmCategory:function(){var self=EbayListingProductCategorySettingsChooserObj;var type=$('category_type').value;$('category_validation').value=this.isCategoryTemporarySelected(type)?1:(this.isCategorySelected(type)&&!this.isCategoryTemporaryUnselected(type))?1:'';if(this.isCategoryValidationRequired(type)&&!Validation.validate($('category_validation'))){return;}\nif(typeof self.tempSelectedCategory[type]!='undefined'){self.selectedCategories[type]=self.tempSelectedCategory[type];if(type==0&&this.selectCallback!=null){(this.selectCallback)(self.selectedCategories[type].mode,self.selectedCategories[type].value);}}\nif(typeof self.tempUnselectedCategory[type]!='undefined'){delete self.selectedCategories[type];if(this.unselectCallback!=null){(this.unselectCallback)();}}\ndelete self.tempSelectedCategory[type];delete self.tempUnselectedCategory[type];jQuery('#chooser_container').modal('closeModal');self.reload();if(typeof self.doneCallback=='function'){self.doneCallback();}},reload:function(){var self=EbayListingProductCategorySettingsChooserObj;var selectedCategories={};var types=[M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Helper\\\\Component\\\\Ebay\\\\Category::TYPE_EBAY_MAIN'),M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Helper\\\\Component\\\\Ebay\\\\Category::TYPE_EBAY_SECONDARY'),M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Helper\\\\Component\\\\Ebay\\\\Category::TYPE_STORE_MAIN'),M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Helper\\\\Component\\\\Ebay\\\\Category::TYPE_STORE_SECONDARY')];types.each(function(type){if(typeof self.selectedCategories[type]=='undefined'){selectedCategories[type]=null;}else{selectedCategories[type]=self.selectedCategories[type];}});new Ajax.Request(M2ePro.url.get('ebay_category/getChooserHtml'),{method:'post',asynchronous:false,parameters:{marketplace_id:self.marketplaceId,account_id:self.accountId,div_id:self.divId,selected_categories:Object.toJSON(selectedCategories),is_single_category_mode:self.isSingleCategoryMode,single_category_type:self.singleCategoryType,is_show_edit_links:self.isShowEditLinks,select_callback:self.selectCallback,unselect_callback:self.unselectCallback},onSuccess:function(transport){if($(self.divId)){$(self.divId).innerHTML=transport.responseText;}}});},reloadPopUp:function(){var self=EbayListingProductCategorySettingsChooserObj;var type=$('category_type').value;self.showEditPopUp(type);},renderAttributes:function(){var self=EbayListingProductCategorySettingsChooserObj;if(!$('chooser_attributes_table')){return;}\nvar handlerObj=new AttributeCreator('category_chooser_'+this.marketplaceId+'_'+this.accountId+'_'+this.divId);handlerObj.setOnSuccessCallback(function(attributeParams,result){$$('#chooser_attributes_table tbody').first().update();self.attributes.push({code:attributeParams.code,label:attributeParams.store_label});self.renderAttributes();self.selectCategory(M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category::CATEGORY_MODE_ATTRIBUTE'),attributeParams.code);});handlerObj.setOnFailedCallback(function(attributeParams,result){self.alert(result['error']);});var totalHtml='',rowHtml='',newAttrHtml='<td style=\"color: brown\">'+M2ePro.translator.translate('Create a New One...')+'</td>'+'<td style=\"padding-left: 55px\"><a href=\"javascript:void(0)\" '+'onclick=\"'+handlerObj.id+'.showPopup({\\'allowed_attribute_types\\':\\'text,select\\'});\">'+\nM2ePro.translator.translate('Select')+'</a></td>';self.attributes.each(function(attribute,index){rowHtml+='<td>'+attribute.label+'</td>'+'<td style=\"padding-left: 55px\"><a href=\"javascript:void(0)\" '+'onclick=\"EbayListingProductCategorySettingsChooserObj.selectCategory('+M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Category::CATEGORY_MODE_ATTRIBUTE')+', \\''+attribute.code+'\\')\">'+\nM2ePro.translator.translate('Select')+'</a></td>';if((index+1)==self.attributes.length&&(index+1)%2!=0){rowHtml+=newAttrHtml;}\nif(((index+1)%2==0)||(index+1)==self.attributes.length){totalHtml+='<tr>'+rowHtml+'</tr>';rowHtml='';}\nif((index+1)==self.attributes.length&&(index+1)%2==0){totalHtml+='<tr>'+newAttrHtml+'</tr>';}});$$('#chooser_attributes_table tbody').first().insert(totalHtml);},renderRecent:function(){var self=EbayListingProductCategorySettingsChooserObj;if(!$('chooser_recent_table')){return;}\nvar type=$('category_type').value;var selected=null;if(typeof self.selectedCategories[type]!=\"undefined\"&&self.selectedCategories[type].mode==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Category::CATEGORY_MODE_EBAY')){selected=self.selectedCategories[type].value;}\nnew Ajax.Request(M2ePro.url.get('ebay_category/getRecent'),{method:'post',parameters:{marketplace:self.marketplaceId,account:self.accountId,selected_category:selected,category_type:type},onSuccess:function(transport){var categories=transport.responseText.evalJSON();var html='';if(transport.responseText.length>2){categories.each(function(category){html+='<tr><td>'+category.path+'</td>'+'<td><a href=\"javascript:void(0)\" '+'onclick=\"EbayListingProductCategorySettingsChooserObj.selectCategory('+M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Category::CATEGORY_MODE_EBAY')+', \\''+category.id+'\\')\">'+\nM2ePro.translator.translate('Select')+'</a></td></tr>';});}else{html+='<tr><td colspan=\"2\" style=\"padding-left: 200px\"><strong>'+M2ePro.translator.translate('No recently used Categories')+'</strong></td></tr>';}\n$('chooser_recent_table').innerHTML=html;}});},search:function(){var self=EbayListingProductCategorySettingsChooserObj;var query=$('query').value;if(query.length<3){return;}\nvar type=$('category_type').value;$('chooser_search_results').innerHTML='';new Ajax.Request(M2ePro.url.get('ebay_category/search'),{method:'post',parameters:{marketplace_id:self.marketplaceId,account_id:self.accountId,query:query,category_type:type},onSuccess:function(transport){var html='<table id=\"search_results_table\">';if(transport.responseText.length>2){var result=transport.responseText.evalJSON();result.each(function(category){html+='<tr><td style=\"padding: 2px;\">';html+=category.titles+' ('+category.id+')';html+='</td><td style=\"padding: 2px;\">';html+='<a href=\"javascript:void(0)\" '+'onclick=\"EbayListingProductCategorySettingsChooserObj.selectCategory('+M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Category::CATEGORY_MODE_EBAY')+', '+category.id+')\">'+\nM2ePro.translator.translate('Select')+'</a>';html+='</td>';});}else{html+='<tr><td colspan=\"2\" style=\"text-align: center;\"><strong>'+M2ePro.translator.translate('No results')+'</strong></td></tr>';var refreshMessage='';if(!self.isWizardMode){if($('category_type').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Helper\\\\Component\\\\Ebay\\\\Category::TYPE_EBAY_MAIN')||$('category_type').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Helper\\\\Component\\\\Ebay\\\\Category::TYPE_EBAY_SECONDARY')){refreshMessage=M2ePro.translator.translate('Try to <a href=\"javascript:void(0)\" onclick=\"EbayListingProductCategorySettingsChooserObj.refreshEbayCategories()\">update Marketplaces Data</a> and repeate the Search.');}else{refreshMessage=M2ePro.translator.translate('Try to <a href=\"javascript:void(0)\" onclick=\"EbayListingProductCategorySettingsChooserObj.refreshStoreCategories()\">refresh eBay Store Data</a> and repeate the Search.');}}\nhtml+='<tr><td colspan=\"2\" style=\"text-align: center;\">'+refreshMessage+'</td></tr>';}\nhtml+='</table>';$('chooser_search_results').innerHTML=html;}});},searchReset:function(){$('chooser_search_results').update();$('query').value='';$('query').focus();},refreshStoreCategories:function(){var self=EbayListingProductCategorySettingsChooserObj;if(self.accountId==null){return;}\nnew Ajax.Request(M2ePro.url.get('ebay_category/refreshStoreCategories'),{method:'post',parameters:{account_id:self.accountId},onSuccess:function(transport){EbayListingProductCategorySettingsChooserTabsBrowseObj.renderTopLevelCategories('chooser_browser');if($('query').value.length!=0){self.search();}}});},refreshEbayCategories:function(){var self=EbayListingProductCategorySettingsChooserObj;var win=window.open(M2ePro.url.get('ebay_marketplace/index'));var intervalId=setInterval(function(){if(!win.closed){return;}\nclearInterval(intervalId);EbayListingProductCategorySettingsChooserTabsBrowseObj.renderTopLevelCategories('chooser_browser');if($('query').value.length!=0){self.search();}},1000);},validate:function(){var self=EbayListingProductCategorySettingsChooserObj;var mainStore=false;if($$('#'+self.divId+' .main-empty-advice').length<=0){return true;}\nif($$('.main-store-empty-advice').length>0){mainStore=true;}\n$$('#'+self.divId+' .main-empty-advice')[0].hide();if(mainStore){$$('.main-store-empty-advice')[0].hide();}\nvar typeEbayMain=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Helper\\\\Component\\\\Ebay\\\\Category::TYPE_EBAY_MAIN');if(typeof self.selectedCategories[typeEbayMain]=='undefined'||typeof self.selectedCategories[typeEbayMain]['mode']=='undefined'||self.selectedCategories[typeEbayMain]['mode']==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Category::CATEGORY_MODE_NONE')){$$('#'+self.divId+' .main-empty-advice')[0].show();return false;}\nif(!mainStore){return true;}\nvar primary=$('magento_block_ebay_listing_category_chooser_store_primary_not_selected')==null;var secondary=$('magento_block_ebay_listing_category_chooser_store_secondary_not_selected')==null;if(primary==false&&secondary==true){$$('.main-store-empty-advice')[0].show();return false;}\nreturn true;},keyPressQuery:function(event){var self=EbayListingProductCategorySettingsChooserObj;if(event.keyCode==13){self.search();}},submitData:function(url){var self=EbayListingProductCategorySettingsChooserObj;if(!self.validate()){return;}\nvar categoryData=self.getInternalData();self.postForm(url,{category_data:Object.toJSON(categoryData)});}});});","Ess_M2ePro/js/Ebay/Listing/Product/Category/Settings/Mode.min.js":"define(['jquery','Magento_Ui/js/modal/modal'],function(jQuery,modal){window.EbayListingProductCategorySettingsMode=Class.create();EbayListingProductCategorySettingsMode.prototype={initialize:function(lastModeValue){$$('input[name=\"mode\"]').each(function(element){element.observe('change',function(){var modeSameRememberCheckbox=$('mode_same_remember_checkbox');modeSameRememberCheckbox.checked=false;modeSameRememberCheckbox.disabled=true;this.value=='same'&&(modeSameRememberCheckbox.disabled=false);})});var modeElement=$$('input[value=\"'+lastModeValue+'\"]').shift();modeElement.checked=true;modeElement.simulate('change');$('mode_same_remember_checkbox').observe('click',function(event){if(!this.checked){return;}\nevent.preventDefault();var content=jQuery('#mode_same_remember_pop_up_content');modal({title:M2ePro.translator.translate('Apply Settings'),type:'popup',buttons:[{text:M2ePro.translator.translate('Cancel'),class:'action-secondary action-dismiss',click:function(){content.modal('closeModal');}},{text:M2ePro.translator.translate('Continue'),class:'action-primary action-accept',click:function(){$('categories_mode_form').submit();}}]},content);content.modal('openModal');});},};});","Ess_M2ePro/js/Ebay/Listing/Product/Category/Settings/Grid.min.js":"define(['M2ePro/Grid'],function(){window.EbayListingProductCategorySettingsGrid=Class.create(Grid,{prepareActions:function(){this.actions={editCategoriesAction:function(id){id&&this.selectByRowId(id);this.editCategories();}.bind(this),editPrimaryCategoriesAction:function(id){id&&this.selectByRowId(id);this.editPrimaryCategories();}.bind(this),editStorePrimaryCategoriesAction:function(id){id&&this.selectByRowId(id);this.editStorePrimaryCategories();}.bind(this)};},editPrimaryCategories:function(){alert('abstract editPrimaryCategories');},editStorePrimaryCategories:function(){alert('abstract editPrimaryCategories');},editCategoriesByType:function(type,validationRequired){validationRequired=validationRequired||false;var self=this;new Ajax.Request(M2ePro.url.get('ebay_listing_product_category_settings/getChooserBlockHtml'),{method:'get',asynchronous:true,parameters:{products_ids:this.getSelectedProductsString()},onSuccess:function(transport){var temp=document.createElement('div');temp.innerHTML=transport.responseText;temp.innerHTML.evalScripts();setTimeout(function go(){if(typeof EbayListingProductCategorySettingsChooserObj=='undefined'){setTimeout(go,50);}else{EbayListingProductCategorySettingsChooserObj.showEditPopUp(type);validationRequired&&(EbayListingProductCategorySettingsChooserObj.categoriesRequiringValidation[type]=true);EbayListingProductCategorySettingsChooserObj.doneCallback=function(){self.saveCategoriesData(EbayListingProductCategorySettingsChooserObj.getInternalDataByType(type));EbayListingProductCategorySettingsChooserObj.doneCallback=null;EbayListingProductCategorySettingsChooserObj.cancelCallback=null;validationRequired&&(delete EbayListingProductCategorySettingsChooserObj.categoriesRequiringValidation[type]);};EbayListingProductCategorySettingsChooserObj.cancelCallback=function(){self.unselectAll();EbayListingProductCategorySettingsChooserObj.doneCallback=null;EbayListingProductCategorySettingsChooserObj.cancelCallback=null;validationRequired&&(delete EbayListingProductCategorySettingsChooserObj.categoriesRequiringValidation[type]);};}},50);}.bind(this)});},saveCategoriesData:function(templateData){new Ajax.Request(M2ePro.url.get('ebay_listing_product_category_settings/stepTwoSaveToSession'),{method:'post',parameters:{products_ids:this.getSelectedProductsString(),template_data:Object.toJSON(templateData)},onSuccess:function(transport){this.unselectAll();this.getGridObj().doFilter();jQuery('#m2epro-popup').modal('closeModal');}.bind(this)});},editCategories:function(){alert('abstract editCategories');},getComponent:function(){return'ebay';}});});","Ess_M2ePro/js/Ebay/Listing/Product/Category/Settings/Specific.min.js":"define(['M2ePro/Common'],function(){window.EbayListingProductCategorySettingsSpecific=Class.create();EbayListingProductCategorySettingsSpecific.prototype=Object.extend(new Common(),{initialize:function(marketplaceId,categoryMode,categoryValue,uniqId){this.marketplaceId=marketplaceId;this.categoryMode=categoryMode;this.categoryValue=categoryValue;this.maxSelectedSpecifics=25;this.valuesCounter=0;this.counter=0;this.uniqId=uniqId||'';this.attributes=[];this.attributeOptions='';this.dictionarySpecifics=[];this.ebaySelectedSpecifics=[];this.customSelectedSpecifics=[];this.specificsJson=[];},setAttributes:function(attributes){this.attributes=attributes;return this;},setDictionarySpecifics:function(specifics){this.dictionarySpecifics=specifics;return this;},setEbaySelectedSpecifics:function(specifics){this.ebaySelectedSpecifics=specifics;return this;},setCustomSelectedSpecifics:function(specifics){this.customSelectedSpecifics=specifics;return this;},getItemSpecifics:function(){var self=this;var parameters=$(self.uniqId+'category_specific_form').serialize(true);new Ajax.Request(M2ePro.url.get('ebay_category/getJsonSpecificsFromPost'),{method:'post',asynchronous:false,parameters:parameters,onSuccess:function(transport){if(transport.responseText.length!=0){self.specificsJson=transport.responseText.evalJSON();}}});return self.specificsJson;},getInternalData:function(){var self=this;var internalData=$(self.uniqId+'category_specific_form').serialize(true);internalData['specifics']=self.getItemSpecifics();return internalData;},prepareAttributes:function(){var cachedOptions='';this.attributes.each(function(v){cachedOptions+='<option value=\"'+v.code+'\">'+v.label+'</option>\\n';});this.attributeOptions=cachedOptions;},prepareBeforeRenderSpecifics:function(){if(this.categoryMode==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category::CATEGORY_MODE_EBAY')){$(this.uniqId+'item_specifics_tbody').innerHTML='';if($$('#'+this.uniqId+'item_specifics_tbody .not-custom').length>0){$$('#'+this.uniqId+'item_specifics_tbody .not-custom').invoke('show');}}else{$$('#'+this.uniqId+'item_specifics_tbody .not-custom').invoke('hide');}\n$(this.uniqId+'add_custom_container').show();this.prepareAttributes();this.clearSpecifics();if((this.dictionarySpecifics.length==0)&&(this.customSelectedSpecifics.length==0)){$(this.uniqId+'item_specifics_tbody').hide();return false;}\nreturn true;},renderSpecifics:function(){if(!this.prepareBeforeRenderSpecifics()){return;}\nthis.renderDictionarySpecific();this.renderCustomSelectedSpecifics();$(this.uniqId+'item_specifics_tbody').show();},renderDictionarySpecific:function(){var self=this;self.dictionarySpecifics.each(function(specific){var counter=self.counter;var recommendedOptionsHtml='';self.addDictionarySpecificRow(specific);if(typeof specific.min_values!='undefined'){for(var i=1;i<specific.min_values;i++){self.addSpecificCustomValueRow(counter);}}\nfor(var i=0;i<specific.values.length;i++){var recommended=specific.values[i];recommendedOptionsHtml+='<option value=\"%value%\">%label%</option>'.replace(/%value%/,base64_encode(recommended.value)).replace(/%label%/,recommended.value);}\n$(self.uniqId+'item_specifics_value_ebay_recommended_'+counter).insert(recommendedOptionsHtml);$(self.uniqId+'item_specifics_value_ebay_recommended_'+counter).selectedIndex=-1;$(self.uniqId+'item_specifics_value_custom_attribute_'+counter).insert(self.attributeOptions);var handlerObj=new AttributeCreator(self.uniqId+'item_specifics_value_custom_attribute_'+counter);handlerObj.setSelectObj($(self.uniqId+'item_specifics_value_custom_attribute_'+counter));handlerObj.injectAddOption();var specificValueMode=$(self.uniqId+'item_specifics_value_mode_'+counter);if(specific.required){if(specificValueMode.select('option[value=\"'+M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_NONE')+'\"]').length>0){specificValueMode.select('option[value=\"'+M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_NONE')+'\"]')[0].remove();}\nspecificValueMode.select('option')[0].selected=1;}\nif(specific.type==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::RENDER_TYPE_TEXT')){specificValueMode.select('option[value=\"'+M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_EBAY_RECOMMENDED')+'\"]')[0].remove();}\nif(specific.type==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::RENDER_TYPE_SELECT_ONE')||specific.type==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::RENDER_TYPE_SELECT_MULTIPLE')){specificValueMode.select('option[value=\"'+M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_CUSTOM_VALUE')+'\"]')[0].remove();}\nif(specific.type==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::RENDER_TYPE_SELECT_MULTIPLE')||specific.type==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::RENDER_TYPE_SELECT_MULTIPLE_OR_TEXT')){$(self.uniqId+'item_specifics_value_ebay_recommended_'+counter).writeAttribute('multiple','true');$(self.uniqId+'item_specifics_value_ebay_recommended_'+counter).addClassName('select multiselect admin__control-multiselect');$(self.uniqId+'item_specifics_value_ebay_recommended_'+counter).removeClassName('admin__control-select');var tempOldName=$(self.uniqId+'item_specifics_value_ebay_recommended_'+counter).readAttribute('name');$(self.uniqId+'item_specifics_value_ebay_recommended_'+counter).writeAttribute('name',tempOldName+'[]');}\nif(specific.values.length<1){if(specific.type==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::RENDER_TYPE_SELECT_ONE_OR_TEXT')||specific.type==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::RENDER_TYPE_SELECT_MULTIPLE_OR_TEXT')){specificValueMode.select('option[value=\"'+M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_EBAY_RECOMMENDED')+'\"]')[0].remove();}}\nself.chooseEbaySelectedSpecifics(specific,counter);self.dictionarySpecificModeChange($(self.uniqId+'item_specifics_value_mode_'+counter));var length=$$('#'+self.uniqId+'item_specifics_custom_value_tbody_'+counter+' tr').length;if(typeof specific.min_values!='undefined'&&typeof specific.max_values!='undefined'){if(specific.max_values>length){$(self.uniqId+'add_item_specifics_custom_value_button_'+counter).show();}else{$(self.uniqId+'add_item_specifics_custom_value_button_'+counter).hide();}\nif(length==1||specific.min_values>=length){$$('#'+self.uniqId+'item_specifics_custom_value_tbody_'+counter+' tr td.btn_value_remove').invoke('hide');}else{$$('#'+self.uniqId+'item_specifics_custom_value_tbody_'+counter+' tr td.btn_value_remove').invoke('show');}}else{if(specific.type==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::RENDER_TYPE_SELECT_MULTIPLE')||specific.type==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::RENDER_TYPE_SELECT_MULTIPLE_OR_TEXT')){$(self.uniqId+'add_item_specifics_custom_value_button_'+counter).show();}\nif(length==1){$$('#'+self.uniqId+'item_specifics_custom_value_tbody_'+counter+' tr td.btn_value_remove').invoke('hide');}else{$$('#'+self.uniqId+'item_specifics_custom_value_tbody_'+counter+' tr td.btn_value_remove').invoke('show');}}});},renderCustomSelectedSpecifics:function(){var self=this;this.customSelectedSpecifics.each(function(specific){var counter=self.counter;self.addCustomSpecificRow();$$('#'+self.uniqId+'custom_item_specifics_value_mode_'+counter+' option[value=\"'+specific.value_mode+'\"]')[0].selected=true;self.customSelectedSpecificChange($(self.uniqId+'custom_item_specifics_value_mode_'+counter));if(specific.value_mode==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_CUSTOM_VALUE')){$(self.uniqId+'custom_item_specifics_label_custom_value_'+counter).value=specific.attribute_title;if(typeof $$('#'+self.uniqId+'item_specifics_custom_value_tbody_'+counter+' input.item-specific')[0]=='undefined'){self.addSpecificCustomValueRow(counter);}\n$$('#'+self.uniqId+'item_specifics_custom_value_tbody_'+counter+' input.item-specific')[0].setValue(specific.value_custom_value[0]);}\nif(specific.value_mode==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_CUSTOM_ATTRIBUTE')){if($$('#'+self.uniqId+'item_specifics_value_custom_attribute_'+counter+' option[value=\"'+specific.value_custom_attribute+'\"]').length>0){$$('#'+self.uniqId+'item_specifics_value_custom_attribute_'+counter+' option[value=\"'+specific.value_custom_attribute+'\"]')[0].selected=true;}else{$(self.uniqId+'item_specifics_value_custom_attribute_'+counter).selectedIndex=-1;}}\nif(specific.value_mode==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_CUSTOM_LABEL_ATTRIBUTE')){$(self.uniqId+'custom_item_specifics_label_custom_label_attribute_'+counter).value=specific.attribute_title;if($$('#'+self.uniqId+'item_specifics_value_custom_attribute_'+counter+' option[value=\"'+specific.value_custom_attribute+'\"]').length>0){$$('#'+self.uniqId+'item_specifics_value_custom_attribute_'+counter+' option[value=\"'+specific.value_custom_attribute+'\"]')[0].selected=true;}else{$(self.uniqId+'item_specifics_value_custom_attribute_'+counter).selectedIndex=-1;}}\nself.customSelectedSpecificChange($(self.uniqId+'custom_item_specifics_value_mode_'+counter));});},renderAttributesWithEmptyOption:function(id,insertTo,value,notRequiried){var self=this;var className=notRequiried?'':' class=\"M2ePro-required-when-visible\"';var txt='<select name=\"'+id+'\" id=\"'+id+'\" '+className+'>\\n';txt+='<option class=\"empty\"></option>\\n';txt+=self.attributeOptions;if($(insertTo+'_note')!=null&&$$('#'+insertTo+'_note').length!=0){$(insertTo).innerHTML=txt+$(insertTo+'_note').innerHTML;}else{$(insertTo).innerHTML=txt;}\nself.checkAttributesSelect(id,value);},addDictionarySpecificRow:function(specific){var template=$(this.uniqId+'specific_template').innerHTML;template=template.replace(/%i%/g,this.counter);template=template.replace(/%attribute_title%/g,specific.title);template=template.replace(/%required%/g,specific.required?'&nbsp;<span class=\"required\">*</span>':'');template=template.replace(/%relation_mode%/,M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::MODE_ITEM_SPECIFICS'));if(typeof specific.min_values!='undefined'&&typeof specific.max_values!='undefined'){template=template.replace(/%min_values%/g,specific.min_values);template=template.replace(/%max_values%/g,specific.max_values);}else{template=template.replace(/%min_values%/g,specific.required?1:0);if(specific.type==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::RENDER_TYPE_SELECT_MULTIPLE')||specific.type==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::RENDER_TYPE_SELECT_MULTIPLE_OR_TEXT')){template=template.replace(/%max_values%/g,30);}else{template=template.replace(/%max_values%/g,1);}}\n$(this.uniqId+'item_specifics_tbody').insert(template);this.addSpecificCustomValueRow(this.counter);++this.counter;},addCustomSpecificRow:function(){var template=$(this.uniqId+'specific_template').innerHTML;template=template.replace(/%i%/g,this.counter);template=template.replace(/%attribute_title%%required%/g,'');template=template.replace(/%relation_mode%/g,M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::MODE_CUSTOM_ITEM_SPECIFICS'));template=template.replace(/%min_values%/g,1);template=template.replace(/%max_values%/g,1);$(this.uniqId+'item_specifics_tbody').show();$(this.uniqId+'item_specifics_tbody').insert(template);this.addSpecificCustomValueRow(this.counter);var selectId=this.uniqId+'item_specifics_value_custom_attribute_'+this.counter;$(selectId).insert(this.attributeOptions);var handlerObj=new AttributeCreator(selectId);handlerObj.setSelectObj($(selectId));handlerObj.injectAddOption();$(selectId).show();$(this.uniqId+'item_specifics_value_mode_'+this.counter).hide();$(this.uniqId+'attribute_title_'+this.counter).hide();$(this.uniqId+'custom_item_specifics_value_mode_'+this.counter).show();$(this.uniqId+'custom_item_specific_remove_button_'+this.counter).show();$(this.uniqId+'specific_'+this.counter+'_row').removeClassName('not-custom');this.checkSpecificsCounter($(this.uniqId+'custom_item_specifics_value_mode_'+this.counter));++this.counter;},addSpecificCustomValueRow:function(generalCounter){var template=$(this.uniqId+'specific_custom_value_template').innerHTML;template=template.replace(/%i%/g,generalCounter);template=template.replace(/%position%/g,this.valuesCounter);$(this.uniqId+'item_specifics_custom_value_tbody_'+generalCounter).insert(template);++this.valuesCounter;},addItemSpecificsCustomValueRow:function(button){var generalCounter=parseInt(button.getAttribute('data-counter'));var tbody=$(this.uniqId+'item_specifics_custom_value_tbody_'+generalCounter);this.addSpecificCustomValueRow(generalCounter);var valuesCounter=tbody.childElements().length;if(parseInt(tbody.getAttribute('data-max_values'))>valuesCounter){button.show();}else{button.hide();}\nif(parseInt(tbody.getAttribute('data-min_values'))>=valuesCounter){$$('#'+this.uniqId+'item_specifics_custom_value_tbody_'+generalCounter+' tr td.btn_value_remove').invoke('hide');}else{$$('#'+this.uniqId+'item_specifics_custom_value_tbody_'+generalCounter+' tr td.btn_value_remove').invoke('show');}},chooseEbaySelectedSpecifics:function(specific,counter){var self=this;self.ebaySelectedSpecifics.each(function(selectedSpecific){if(selectedSpecific.attribute_title!=specific.title||!selectedSpecific.value_data){return;}\nif(selectedSpecific.value_mode==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_NONE')){$$('#'+self.uniqId+'item_specifics_value_mode_'+counter+' option[value=\"'+M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_NONE')+'\"]')[0].selected=true;}\nif(selectedSpecific.value_mode==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_EBAY_RECOMMENDED')){$$('#'+self.uniqId+'item_specifics_value_mode_'+counter+' option[value=\"'+M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_EBAY_RECOMMENDED')+'\"]')[0].selected=true;$$('#'+self.uniqId+'item_specifics_value_ebay_recommended_'+counter+' option').each(function(tempOption){for(var i=0;i<selectedSpecific.value_data.length;i++){var tempSearchValue=base64_encode(selectedSpecific.value_data[i]);if(tempOption.value==tempSearchValue){tempOption.selected=true;}}});}\nif(selectedSpecific.value_mode==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_CUSTOM_VALUE')){$$('#'+self.uniqId+'item_specifics_value_mode_'+counter+' option[value=\"'+M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_CUSTOM_VALUE')+'\"]')[0].selected=true;var length=selectedSpecific.value_data.length;for(var i=0;i<length;i++){if(typeof $$('#'+self.uniqId+'item_specifics_custom_value_tbody_'+counter+' input.item-specific')[i]=='undefined'){self.addSpecificCustomValueRow(counter);}\n$$('#'+self.uniqId+'item_specifics_custom_value_tbody_'+counter+' input.item-specific')[i].setValue(selectedSpecific.value_data[i]);}}\nif(selectedSpecific.value_mode==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_CUSTOM_ATTRIBUTE')){if($$('#'+self.uniqId+'item_specifics_value_custom_attribute_'+counter+' option[value=\"'+selectedSpecific.value_data+'\"]').length!=0){$$('#'+self.uniqId+'item_specifics_value_mode_'+counter+' option[value=\"'+M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_CUSTOM_ATTRIBUTE')+'\"]')[0].selected=true;$$('#'+self.uniqId+'item_specifics_value_custom_attribute_'+counter+' option[value=\"'+selectedSpecific.value_data+'\"]')[0].selected=true;}else if($$('#'+self.uniqId+'item_specifics_value_mode_'+counter+' option[value=\"'+M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_NONE')+'\"]').length>0){$$('#'+self.uniqId+'item_specifics_value_mode_'+counter+' option[value=\"'+M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_NONE')+'\"]')[0].selected=true;}else if($$('#'+self.uniqId+'item_specifics_value_mode_'+counter+' option[value=\"'+M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_EBAY_RECOMMENDED')+'\"]').length>0){$$('#'+self.uniqId+'item_specifics_value_mode_'+counter+' option[value=\"'+M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_EBAY_RECOMMENDED')+'\"]')[0].selected=true;}}});},dictionarySpecificModeChange:function(select){var self=this;var number=select.id.replace(self.uniqId+'item_specifics_value_mode_','');$(self.uniqId+'item_specifics_value_ebay_recommended_'+number,self.uniqId+'item_specifics_custom_value_'+number,self.uniqId+'item_specifics_value_custom_attribute_'+number,self.uniqId+'custom_item_specifics_label_custom_attribute_'+number).invoke('hide');$(self.uniqId+'attribute_title_'+number).show();if(select.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_EBAY_RECOMMENDED')){$(self.uniqId+'item_specifics_value_ebay_recommended_'+number).show();}\nif(select.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_CUSTOM_VALUE')){$(self.uniqId+'item_specifics_custom_value_'+number).show();}\nif(select.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_CUSTOM_ATTRIBUTE')){$(self.uniqId+'attribute_title_'+number).show();$(self.uniqId+'custom_item_specifics_label_custom_attribute_'+number).hide();$(self.uniqId+'item_specifics_value_custom_attribute_'+number).show();}\nthis.checkSpecificsCounter(select);select.up('td').next('td').select('.validation-advice').each(Element.hide);},customSelectedSpecificChange:function(select){var self=this;var number=select.id.replace(self.uniqId+'custom_item_specifics_value_mode_','');$(self.uniqId+'item_specifics_custom_value_'+number,self.uniqId+'item_specifics_value_custom_attribute_'+number,self.uniqId+'item_specifics_value_ebay_recommended_'+number).invoke('hide');$(self.uniqId+'custom_item_specifics_label_custom_value_'+number,self.uniqId+'custom_item_specifics_label_custom_label_attribute_'+number,self.uniqId+'custom_item_specifics_label_custom_attribute_'+number).invoke('hide');if(select.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_CUSTOM_VALUE')){$(self.uniqId+'item_specifics_custom_value_'+number).show();$(self.uniqId+'custom_item_specifics_label_custom_value_'+number).show();}\nif(select.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_CUSTOM_ATTRIBUTE')){$(self.uniqId+'custom_item_specifics_label_custom_attribute_'+number).show();$(self.uniqId+'item_specifics_value_custom_attribute_'+number).show();}\nif(select.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_CUSTOM_LABEL_ATTRIBUTE')){$(self.uniqId+'custom_item_specifics_label_custom_label_attribute_'+number).show();$(self.uniqId+'item_specifics_value_custom_attribute_'+number).show();}\nthis.checkSpecificsCounter(select);select.up('td').next('td').select('.validation-advice').each(Element.hide);},validate:function(){if($$('.'+this.uniqId+'not-none').length>this.maxSelectedSpecifics){$(this.uniqId+'maximum_specifics_error').show();return false;}\nvar form=jQuery('#'+this.uniqId+'category_specific_form');this.initFormValidation(form);return form.valid();},checkAttributesSelect:function(id,value){if($(id)){if(typeof M2ePro.formData[id]!='undefined'){$(id).value=M2ePro.formData[id];}\nif(value){$(id).value=value;}}},checkSpecificsCounter:function(select){$(this.uniqId+'maximum_specifics_error').hide();if(select!=null){if(select.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Category_Specific::VALUE_MODE_NONE')){select.removeClassName(this.uniqId+'not-none');}else{select.addClassName(this.uniqId+'not-none');}}\nif($$('.'+this.uniqId+'not-none').length>=this.maxSelectedSpecifics){$(this.uniqId+'add_custom_container').hide();}else{$(this.uniqId+'add_custom_container').show();}},reload:function(){var self=this;new Ajax.Request(M2ePro.url.get('ebay_category/getSpecificHtml'),{method:'post',parameters:{marketplace_id:self.marketplaceId,category_mode:self.categoryMode,category_value:self.categoryValue,unique_id:self.uniqId,attributes:self.attributes.join(','),internal_data:$(self.uniqId+'category_specific_form').serialize(true)},onSuccess:function(transport){$('category_specific_box'+self.uniqId).innerHTML=transport.responseText;}});},submitData:function(url){var self=this;if(!self.validate()){return;}\nvar specificData=self.getInternalData();self.postForm(url,{specific_data:Object.toJSON(specificData)});},clearSpecifics:function(){$$('#'+self.uniqId+'item_specifics_tbody tr').each(Element.remove);},removeSpecific:function(button){$(button).up('tr').remove();this.checkSpecificsCounter(null);},removeItemSpecificsCustomValue:function(button){var tbody=$(button).up('tbody'),addBtn=$(button).up('table').next('a');$(button).up('tr').remove();var length=tbody.childElements().length;if(parseInt(tbody.getAttribute('data-max_values'))>length){addBtn.show();}else{addBtn.hide();}\nif(length==1||parseInt(tbody.getAttribute('data-min_values'))>=length){var btnRemove=tbody.getElementsByClassName('btn_value_remove');for(var i=0;i<btnRemove.length;i++){btnRemove[i].hide();}}}});});","Ess_M2ePro/js/Ebay/Listing/Product/Category/Settings/Specific/Wrapper.min.js":"define(['jquery','Magento_Ui/js/modal/modal','M2ePro/Common'],function(jQuery,modal){window.EbayListingProductCategorySettingsSpecificWrapper=Class.create(Common,{initialize:function(currentCategory,wrapperObj){this.wrapperObj=wrapperObj;this.setCurrentCategory(currentCategory);},refreshButtons:function(){$$('button.specifics_buttons').invoke('hide');if(this.getNextCategory()){$$('button.next_category_button').invoke('show');}else{$$('button.continue').invoke('show');}},setCurrentCategory:function(category){$('categories_list').select('li').each(function(li){li.removeClassName('selected');});this.currentCategory=category;$(category).addClassName('selected');this.refreshButtons();},getCurrentCategory:function(){return this.currentCategory;},getNextCategory:function(){var nextLi=$(this.currentCategory).next('li');if(!nextLi){return false;}\nreturn nextLi.id;},getPrevCategory:function(){var prevLi=$(this.currentCategory).previous('li');if(!prevLi){return false;}\nreturn prevLi.id;},renderPrevCategory:function(){if(!this.getPrevCategory()){var url=M2ePro.url.get('ebay_listing_product_category_settings');setLocation(url);return;}\nthis.getSpecificsData(this.getPrevCategory(),function(transport){var response=transport.responseText.evalJSON();try{$('specifics_main_container').innerHTML=response.html;$('specifics_main_container').innerHTML.evalScripts();}catch(e){}});},renderNextCategory:function(){if(!EbayListingProductCategorySettingsSpecificObj.validate()){return;}\nif(!!$('skip_optional_specifics').checked){this.lock();}\nif(!this.getNextCategory()){this.unlock();return this.showPopup();}\nthis.saveCategory(function(){this.getSpecificsData(this.getNextCategory(),function(transport){var response=transport.responseText.evalJSON();try{$('specifics_main_container').innerHTML=response.html;$('specifics_main_container').innerHTML.evalScripts();}catch(e){}\nif(!response.hasRequiredSpecifics&&!!$('skip_optional_specifics').checked){this.renderNextCategory();}else{this.unlock();}})}.bind(this));},getSpecificsData:function(category,callback){var url=M2ePro.url.get('ebay_listing_product_category_settings/stepThreeGetCategorySpecifics');new Ajax.Request(url,{method:'get',parameters:{category:category},onSuccess:function(transport){this.setCurrentCategory(category);callback&&callback.call(this,transport);}.bind(this)});},saveCategory:function(callback){if(!EbayListingProductCategorySettingsSpecificObj.validate()){return;}\nvar url=M2ePro.url.get('ebay_listing_product_category_settings/stepThreeSaveCategorySpecificsToSession');new Ajax.Request(url,{method:'post',parameters:{category:this.getCurrentCategory(),data:Object.toJSON(EbayListingProductCategorySettingsSpecificObj.getInternalData())},onSuccess:function(transport){callback.call(this);}.bind(this)});},save:function(){if(this.getNextCategory()){return;}\nthis.saveCategory(function(){var url=M2ePro.url.get('ebay_listing_product_category_settings/save');new Ajax.Request(url,{method:'post',onSuccess:function(transport){setLocation(M2ePro.url.get('ebay_listing/review'))}});});},showPopup:function(){var self=this;this.popup=jQuery('#popup_content').modal({title:M2ePro.translator.translate('Set Item Specifics'),type:'popup',buttons:[{text:M2ePro.translator.translate('Cancel'),class:'action-secondary action-dismiss',click:function(event){this.closeModal(event,true);}},{text:M2ePro.translator.translate('Confirm'),class:'action-primary action-accept forward',click:function(){self.save();}}]});this.popup.modal('openModal');},lock:function(){$(this.wrapperObj.wrapperId).visible()||this.wrapperObj.lock();$$('.loading-mask').invoke('setStyle',{visibility:'hidden'});$(this.wrapperObj.wrapperId).update('<div style=\"height: 46%\"></div>'+'<div>'+M2ePro.translator.translate('Loading. Please wait')+' ...</div>');},unlock:function(){this.wrapperObj.unlock();$$('.loading-mask').invoke('setStyle',{visibility:'visible'});}});});","Ess_M2ePro/js/Ebay/Listing/Product/Category/Settings/Mode/Category/Grid.min.js":"define(['Magento_Ui/js/modal/modal','M2ePro/Plugin/Messages','M2ePro/Ebay/Listing/Product/Category/Settings/Grid'],function(modal,MagentoMessageObj){window.EbayListingProductCategorySettingsModeCategoryGrid=Class.create(EbayListingProductCategorySettingsGrid,{editCategories:function(){var url=M2ePro.url.get('ebay_listing_product_category_settings/getChooserBlockHtml');new Ajax.Request(url,{method:'get',parameters:{ids:this.getSelectedProductsString()},onSuccess:function(transport){this.openPopUp(M2ePro.translator.translate('Set eBay Categories'),transport.responseText);}.bind(this)});},editPrimaryCategories:function(){this.editCategoriesByType(M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Helper\\\\Component\\\\Ebay\\\\Category::TYPE_EBAY_MAIN'),true)},editStorePrimaryCategories:function(){this.editCategoriesByType(M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Helper\\\\Component\\\\Ebay\\\\Category::TYPE_STORE_MAIN'),false)},openPopUp:function(title,content){var self=this;if(!$('m2epro-popup')){$('html-body').insert({bottom:'<div id=\"m2epro-popup\"></div>'});}\n$('m2epro-popup').update();$('m2epro-popup').insert(content);var popup=jQuery('#m2epro-popup');modal({title:title,type:'slide',closed:function(){$('m2epro-popup').update();},buttons:[{text:M2ePro.translator.translate('Cancel'),click:function(){popup.modal('closeModal');self.unselectAll();}},{text:M2ePro.translator.translate('Confirm'),class:'action primary',click:function(){if(!EbayListingProductCategorySettingsChooserObj.validate()){return;}\nself.saveCategoriesData(EbayListingProductCategorySettingsChooserObj.getInternalData());popup.modal('closeModal');}}]},popup);popup.modal('openModal');},validate:function(){MagentoMessageObj.clear();new Ajax.Request(M2ePro.url.get('ebay_listing_product_category_settings/stepTwoModeCategoryValidate'),{method:'post',onSuccess:function(transport){var response=transport.responseText.evalJSON();if(response.validation==true){setLocation(M2ePro.url.get('ebay_listing_product_category_settings'));}else{MagentoMessageObj.addErrorMessage(response.message);}}.bind(this)});},confirm:function(config){if(config.actions&&config.actions.confirm){config.actions.confirm();}}});});","Ess_M2ePro/js/Ebay/Listing/Product/Category/Settings/Mode/Product/SuggestedSearch.min.js":"define(['M2ePro/Common'],function(){window.EbayListingProductCategorySettingsModeProductSuggestedSearch=Class.create(Common,{searchResult:{failed:0,succeeded:0},initialize:function(){},resetSearchResult:function(){this.searchResult={failed:0,succeeded:0};},search:function(products,onComplete){var parts=this.makeProductsParts(products);ProgressBarObj.reset();ProgressBarObj.setTitle('Getting Suggested Categories');ProgressBarObj.setStatus('Getting Suggested Categories in process. Please wait...');ProgressBarObj.show();this.scrollPageToTop();WrapperObj.lock();this.resetSearchResult();this.sendPartsProducts(parts,parts.length,onComplete);},makeProductsParts:function(products){var productsInPart=5;var productsArray=explode(',',products);var parts=[];if(productsArray.length<productsInPart){return parts[0]=productsArray;}\nvar result=[];for(var i=0;i<productsArray.length;i++){if(result.length==0||result[result.length-1].length==productsInPart){result[result.length]=[];}\nresult[result.length-1][result[result.length-1].length]=productsArray[i];}\nreturn result;},sendPartsProducts:function(parts,partsCount,onComplete){if(parts.length==0){if(typeof onComplete=='function'){onComplete(this.searchResult);}\n$$('.loading-mask').invoke('setStyle',{visibility:'visible'});this.resetSearchResult();return;}\nvar part=parts.splice(0,1)[0];var partString=implode(',',part);new Ajax.Request(M2ePro.url.get('ebay_listing_product_category_settings/stepTwoGetSuggestedCategory'),{method:'get',parameters:{products_ids:partString},onSuccess:function(transport){var percents=(100 / partsCount)*(partsCount-parts.length);var response=transport.responseText.evalJSON();this.searchResult.failed+=response['failed'];this.searchResult.succeeded+=response['succeeded'];if(percents<=0){ProgressBarObj.setPercents(0,0);}else if(percents>=100){ProgressBarObj.setPercents(100,0);ProgressBarObj.setStatus('Suggested Categories has been received.');ProgressBarObj.hide();ProgressBarObj.reset();WrapperObj.unlock();}else{ProgressBarObj.setPercents(percents,1);}\nsetTimeout(function(){this.sendPartsProducts(parts,partsCount,onComplete);}.bind(this),500);}.bind(this)});$$('.loading-mask').invoke('setStyle',{visibility:'hidden'});}});});","Ess_M2ePro/js/Ebay/Listing/Product/Category/Settings/Mode/Product/Grid.min.js":"define(['jquery','Magento_Ui/js/modal/modal','M2ePro/Plugin/Messages','M2ePro/Ebay/Listing/Product/Category/Settings/Grid'],function(jQuery,modal,MagentoMessageObj){window.EbayListingProductCategorySettingsModeProductGrid=Class.create(EbayListingProductCategorySettingsGrid,{productIdCellIndex:1,productTitleCellIndex:2,prepareActions:function($super){$super();this.actions=Object.extend(this.actions,{getSuggestedCategoriesAction:function(id){this.getSuggestedCategories(id);}.bind(this),resetCategoriesAction:function(id){this.resetCategories(id);}.bind(this),removeItemAction:function(id){this.removeItems(id);}.bind(this)});},getSuggestedCategories:function(id){var self=this,confirmAction;self.selectedProductsIds=id?[id]:self.getSelectedProductsArray();self.unselectAll();confirmAction=function(){EbayListingProductCategorySettingsModeProductSuggestedSearchObj.search(self.selectedProductsIds.join(','),function(searchResult){self.getGridObj().doFilter();self.selectedProductsIds=[];MagentoMessageObj.clear();if(searchResult.failed>0){MagentoMessageObj.addErrorMessage(M2ePro.translator.translate('eBay could not assign Categories for %product_title% Products.').replace('%product_title%',searchResult.failed));}else if(searchResult.succeeded>0){MagentoMessageObj.addSuccessMessage(M2ePro.translator.translate('Suggested Categories were successfully Received for %product_title% Product(s).').replace('%product_title%',searchResult.succeeded));}});};if(id){self.confirm({actions:{confirm:function(){confirmAction();},cancel:function(){return false;}}});}else{confirmAction();}},getSuggestedCategoriesForAll:function(){var self=this,confirmAction,gridIds=self.getGridMassActionObj().getGridIds().split(',');confirmAction=function(){self.getGridMassActionObj().selectAll();self.getSuggestedCategories();};if(gridIds.length>100){self.confirm({actions:{confirm:function(){confirmAction();},cancel:function(){return false;}}});}else{confirmAction();}},editPrimaryCategories:function(){this.editCategoriesByType(M2ePro.php.constant('Ess_M2ePro_Helper_Component_Ebay_Category::TYPE_EBAY_MAIN'))},editStorePrimaryCategories:function(){this.editCategoriesByType(M2ePro.php.constant('Ess_M2ePro_Helper_Component_Ebay_Category::TYPE_STORE_MAIN'))},editCategories:function(id){this.selectedProductsIds=id?[id]:this.getSelectedProductsArray();new Ajax.Request(M2ePro.url.get('ebay_listing_product_category_settings/getChooserBlockHtml'),{method:'post',asynchronous:true,parameters:{ids:this.selectedProductsIds.join(',')},onSuccess:function(transport){var title=M2ePro.translator.translate('Set eBay Category for Product(s)');if(this.selectedProductsIds.length==1){var productName=this.getProductNameByRowId(this.selectedProductsIds[0]);title+='&nbsp;\"'+productName+'\"';}\nthis.showChooserPopup(title,transport.responseText);}.bind(this)});},resetCategories:function(id){var self=this,confirmAction;confirmAction=function(){self.selectedProductsIds=id?[id]:self.getSelectedProductsArray();new Ajax.Request(M2ePro.url.get('ebay_listing_product_category_settings/stepTwoSuggestedReset'),{method:'post',asynchronous:true,parameters:{products_ids:self.selectedProductsIds.join(',')},onSuccess:function(transport){MagentoMessageObj.clear();self.getGridObj().doFilter();self.unselectAll();}});};if(id){self.confirm({actions:{confirm:function(){confirmAction();},cancel:function(){return false;}}});}else{confirmAction();}},showChooserPopup:function(title,content){var self=this;if(!$('m2epro-popup')){$('html-body').insert({bottom:'<div id=\"m2epro-popup\"></div>'});}\n$('m2epro-popup').update();$('m2epro-popup').insert(content);var popup=jQuery('#m2epro-popup');modal({title:title,type:'slide',closed:function(){self.selectedProductsIds=[];return true;},buttons:[{text:M2ePro.translator.translate('Cancel'),click:function(){popup.modal('closeModal');self.unselectAll();}},{text:M2ePro.translator.translate('Confirm'),class:'action primary',click:function(){if(!self.validate()){return;}\nself.saveCategoriesData(EbayListingProductCategorySettingsChooserObj.getInternalData());}}]},popup);popup.modal('openModal');},nextStep:function(){var self=this;MagentoMessageObj.clear();new Ajax.Request(M2ePro.url.get('ebay_listing_product_category_settings/stepTwoModeProductValidate'),{method:'get',asynchronous:true,parameters:{},onSuccess:function(transport){var response=transport.responseText.evalJSON();if(response['validation']){return setLocation(M2ePro.url.get('ebay_listing_product_category_settings'));}\nif(response['message']){return MagentoMessageObj.addErrorMessage(response['message']);}\nvar popup=jQuery('#next_step_warning_popup_content');modal({title:M2ePro.translator.translate('Set eBay Category'),type:'popup',buttons:[{text:M2ePro.translator.translate('Cancel'),class:'action-secondary action-dismiss',click:function(){this.closeModal();}},{text:M2ePro.translator.translate('Continue'),class:'action-primary action-accept forward',id:'save_popup_button',click:function(){this.closeModal();setLocation(M2ePro.url.get('ebay_listing_product_category_settings'));}}]},popup);popup.modal('openModal');}.bind(this)});},removeItems:function(id){var self=this,confirmAction;confirmAction=function(){self.selectedProductsIds=id?[id]:self.getSelectedProductsArray();var url=M2ePro.url.get('ebay_listing_product_category_settings/stepTwoDeleteProductsModeProduct');new Ajax.Request(url,{method:'post',parameters:{products_ids:self.selectedProductsIds.join(',')},onSuccess:function(){self.unselectAllAndReload();}});};if(id){self.confirm({actions:{confirm:function(){confirmAction();},cancel:function(){return false;}}});}else{confirmAction();}},confirm:function($super,config){var action='';$$('select#'+this.gridId+'_massaction-select option').each(function(o){if(o.selected&&o.value!=''){action=o.value;}});$super(config);},validate:function(){if($$('.main-store-empty-advice').length<=0){return true;}\n$$('.main-store-empty-advice')[0].hide();var primary=$('magento_block_ebay_listing_category_chooser_store_primary_not_selected')==null;var secondary=$('magento_block_ebay_listing_category_chooser_store_secondary_not_selected')==null;if(primary==false&&secondary==true){$$('.main-store-empty-advice')[0].show();return false;}\nreturn true;}});});","Ess_M2ePro/js/Ebay/Listing/Product/Category/Settings/Chooser/Tabs/Browse.min.js":"define(['M2ePro/Common'],function(){window.EbayListingProductCategorySettingsChooserTabsBrowse=Class.create();EbayListingProductCategorySettingsChooserTabsBrowse.prototype=Object.extend(new Common(),{initialize:function(){this.marketplaceId=null;this.observers={\"leaf_selected\":[],\"not_leaf_selected\":[],\"any_selected\":[]};},setMarketplaceId:function(marketplaceId){var self=EbayListingProductCategorySettingsChooserTabsBrowseObj;self.marketplaceId=marketplaceId;},getMarketplaceId:function(){var self=EbayListingProductCategorySettingsChooserTabsBrowseObj;if(self.marketplaceId===null){self.alert('You must set Site');}\nreturn self.marketplaceId;},getCategoriesSelectElementId:function(categoryId){if(categoryId===null)categoryId=0;return'category_chooser_select_'+categoryId;},getCategoryChildrenElementId:function(categoryId){if(categoryId===null)categoryId=0;return'category_chooser_children_'+categoryId;},getSelectedCategories:function(){var self=EbayListingProductCategorySettingsChooserTabsBrowseObj;var categoryId=0;var selectedCategories=[];var isLastCategory=false;while(!isLastCategory){var categorySelect=$(self.getCategoriesSelectElementId(categoryId));if(!categorySelect||categorySelect.selectedIndex==-1){break;}\ncategoryId=selectedCategories[selectedCategories.length]=categorySelect.options[categorySelect.selectedIndex].value;if(categorySelect.options[categorySelect.selectedIndex].getAttribute('is_leaf')==1){isLastCategory=true;}}\nreturn selectedCategories;},renderTopLevelCategories:function(containerId){this.prepareDomStructure(null,$(containerId));this.renderChildCategories(null);},renderChildCategories:function(parentCategoryId){var self=EbayListingProductCategorySettingsChooserTabsBrowseObj;new Ajax.Request(M2ePro.url.get('ebay_category/getChildCategories'),{method:'post',asynchronous:true,parameters:{\"parent_category_id\":parentCategoryId,\"marketplace_id\":self.getMarketplaceId(),\"account_id\":EbayListingProductCategorySettingsChooserObj.getAccountId(),\"category_type\":$('category_type').value},onSuccess:function(transport){if(transport.responseText.length<=2){self.simulate('leaf_selected',self.getSelectedCategories());return;}\nvar categories=JSON.parse(transport.responseText);var optionsHtml='';var arrowString='';categories.each(function(category){if(parseInt(category.is_leaf)==0){arrowString=' > ';}else{arrowString='';}\noptionsHtml+='<option is_leaf=\"'+category.is_leaf+'\" value=\"'+category.category_id+'\">'+\ncategory.title+arrowString+'</option>';});$(self.getCategoriesSelectElementId(parentCategoryId)).innerHTML=optionsHtml;$(self.getCategoriesSelectElementId(parentCategoryId)).style.display='inline-block';$('chooser_browser').scrollLeft=$('chooser_browser').scrollWidth;}});},onSelectCategory:function(select){var self=EbayListingProductCategorySettingsChooserTabsBrowseObj;var parentCategoryId=select.id.replace(self.getCategoriesSelectElementId(\"\"),\"\");var categoryId=select.options[select.selectedIndex].value;var is_leaf=select.options[select.selectedIndex].getAttribute('is_leaf');var selectedCategories=self.getSelectedCategories();var parentDiv=$(self.getCategoryChildrenElementId(parentCategoryId));parentDiv.innerHTML='';self.simulate('any_selected',selectedCategories);if(is_leaf==1){self.simulate('leaf_selected',selectedCategories);return;}\nself.simulate('not_leaf_selected',selectedCategories);self.prepareDomStructure(categoryId,parentDiv);self.renderChildCategories(categoryId);},prepareDomStructure:function(categoryId,parentDiv){var self=EbayListingProductCategorySettingsChooserTabsBrowseObj;var childrenSelect=document.createElement('select');childrenSelect.id=self.getCategoriesSelectElementId(categoryId);childrenSelect.style.minWidth='200px';childrenSelect.style.maxHeight='none';childrenSelect.size=10;childrenSelect.className='multiselect admin__control-multiselect';childrenSelect.onchange=function(){EbayListingProductCategorySettingsChooserTabsBrowseObj.onSelectCategory(this);};childrenSelect.style.display='none';parentDiv.appendChild(childrenSelect);var childrenDiv=document.createElement('div');childrenDiv.id=self.getCategoryChildrenElementId(categoryId);childrenDiv.className='category-children-block';parentDiv.appendChild(childrenDiv);},observe:function(event,observer){var self=EbayListingProductCategorySettingsChooserTabsBrowseObj;if(typeof observer!='function'){self.alert('Observer must be a function!');return;}\nif(typeof self.observers[event]=='undefined'){self.alert('Event does not supported!');return;}\nself.observers[event][self.observers[event].length]=observer;},simulate:function(event,parameters){var self=EbayListingProductCategorySettingsChooserTabsBrowseObj;parameters=parameters||null;if(typeof self.observers[event]=='undefined'){self.alert('Event does not supported!');return;}\nif(self.observers[event].length==0){return;}\nself.observers[event].each(function(observer){if(parameters==null){(observer)();}else{(observer)(parameters);}});}});});","Ess_M2ePro/js/Ebay/Listing/Product/Add/Category/Summary/Grid.min.js":"define(['M2ePro/Grid'],function(){window.EbayListingProductAddCategorySummaryGrid=Class.create(Grid,{prepareActions:function(){this.actions={removeAction:this.remove.bind(this)};},remove:function(){var self=this;Grid.prototype.confirm({actions:{confirm:function(){var url=M2ePro.url.get('ebay_listing_product_add/removeSessionProductsByCategory');new Ajax.Request(url,{parameters:{ids:self.getSelectedProductsString()},onSuccess:self.unselectAllAndReload.bind(self)});},cancel:function(){return false;}}});},confirm:function(config){if(config.actions&&config.actions.confirm){config.actions.confirm();}}});});","Ess_M2ePro/js/Ebay/Account/PickupStore.min.js":"define(['jquery','mage/apply/main','M2ePro/Common'],function(jQuery,mage){window.EbayPickupStore=Class.create(Common,{autogenerate:false,geocodeObject:{},defaultBusinessHours:{},initialize:function()\n{this.setValidationCheckRepetitionValue('M2ePro-pickup-store-location-id',M2ePro.translator.translate('The specified Title is already used for another In-Store Pickup. In-Store Pickup Title must be unique.'),'Ebay\\\\Account\\\\PickupStore','location_id','id',M2ePro.formData.id);jQuery.validator.addMethod('M2ePro-pickup-store-location-id-length',function(value){return value.length<=32;},M2ePro.translator.translate('Max length 32 character.'));jQuery.validator.addMethod('M2ePro-validate-must-arrive-date',function(value,el){if(el.up('#special_hours_grid')&&!el.up('#special_hours_grid').visible()){return true;}\nreturn value.match('^[0-9]{4}-[0-9]{2}-[0-9]{1,2}$');},M2ePro.translator.translate('Please enter a valid date.'));jQuery.validator.addMethod('M2ePro-pickup-store-dropdown',function(value){return value!='';},M2ePro.translator.translate('Select value.'));jQuery.validator.addMethod('M2ePro-validate-schedule-week-days',function(value,el){var countOfCheckedDays=0;$$('.week_day_mode').each(function(el){el.checked&&countOfCheckedDays++;});return countOfCheckedDays>0;},M2ePro.translator.translate('You need to choose at set at least one time.'));jQuery.validator.addMethod('M2ePro-validate-selected-schedule-time',function(value,el){var countUnselectedControls=0;if(el.up('#special_hours_grid')){if(!el.up('#special_hours_grid').visible()){return true;}}else{if(!el.up('tr').select('.week_day_mode').shift().checked){return true;}}\nel.up('td').select('select').each(function(el){el.value==''&&countUnselectedControls++;});return countUnselectedControls==0;},M2ePro.translator.translate('You should specify time.'));jQuery.validator.addMethod('M2ePro-validate-schedule-wrong-interval-time',function(value,el){if(el.up('#special_hours_grid')){if(!el.up('#special_hours_grid').visible()){return true;}}else{if(!el.up('tr').select('.week_day_mode').shift().checked){return true;}}\nvar now=new Date(),fromTime=new Date(now.toDateString()+' '+$(el.id.replace('validator_to','from')).value),toTime=new Date(now.toDateString()+' '+$(el.id.replace('validator_to','to')).value);return(toTime-fromTime)>0;},M2ePro.translator.translate('Must be greater than \"Open Time\".'));jQuery.validator.addMethod('M2ePro-validate-max-length-128',function(value){return value.length<=128;},M2ePro.translator.translate('Max length 128 character.'));this.validateLocation();},init:function()\n{this.observeFields();},observeFields:function()\n{var self=this;if($('google_map').href.indexOf('#empty')!=-1){$('google_map').hide();}\nif($('auto_generate_field').visible()){var autoGenerate=$('auto_generate');autoGenerate.observe('click',function(){self.generateLocationId();});autoGenerate.observe('change',self.switchAutoGeneration).simulate('change');}\n$('country').observe('change',self.countryChange).simulate('change');$$('.get_geocord').shift().observe('click',self.calculateLatitudeLongitude);$('utc_offset').observe('change',function(event){if(event.target.value!=''&&this.down('option').value==''){this.down('option').remove();}});$$('.week_day_mode').each(function(el){el.observe('change',self.scheduleDayModeChange).simulate('change');});$$('.week_time_select').each(function(el){el.observe('change',self.scheduleTimeSelectChange).simulate('change');});$$('.date_time_select').each(function(el){el.observe('change',self.scheduleTimeSelectChange).simulate('change');});$$('.add_date').shift().observe('click',self.addDateColumn);$$('.remove_date').each(function(el){el.observe('click',self.removeDateColumn);});self.hideSpecialHoursGrid();$('default_mode').observe('change',self.changeDefaultMode).simulate('change');$('qty_mode').observe('change',self.qtyModeChange).simulate('change');$('qty_modification_mode').observe('change',self.qtyPostedModeChange).simulate('change');setTimeout(function(){self.initGeocodeAPI();},0);},switchAutoGeneration:function(event)\n{var self=EbayPickupStoreObj,nameField=$('name');self.autogenerate=!self.autogenerate;if(!self.autogenerate){nameField.stopObserving('keyup',self.generateLocationId);}else{nameField.observe('keyup',self.generateLocationId);}},generateLocationId:function()\n{var nameField=$('name'),locationIdFiled=$('location_id');if(nameField.value){locationIdFiled.value=nameField.value.toLowerCase().replace(/[^a-z0-9 _]+/g,'').replace(/\\s/g,'_').slice(0,32);}else{locationIdFiled.value='';}},countryChange:function(event){var self=EbayPickupStoreObj,countryCode='';if(event.target.value!=''&&this.down('option').value==''){this.down('option').remove();}\nif(event.target.selectedOptions.length){countryCode=event.target.value;}\nself.updateHiddenValue(this,$('marketplace_id'));new Ajax.Request(M2ePro.url.get('getRegions'),{method:'post',parameters:{country_code:countryCode},onSuccess:function(transport){var regions=transport.responseText.evalJSON(),insertData,defaultValue=$('region_hidden').value;$('region')&&$('region').remove();if(!regions.length){insertData={top:new Element('input',{type:'text',id:'region',name:'region',class:'input-text M2ePro-required-when-visible',value:defaultValue})};}else{insertData={top:self.renderRegions(regions,defaultValue)};}\n$('region_container').up().insert(insertData)}});},renderRegions:function(regionsData,defaultValue)\n{var select=new Element('select',{id:'region',name:'region',class:'M2ePro-pickup-store-dropdown'});select.observe('change',function(event){if(event.target.value!=''&&this.down('option').value==''){this.down('option').remove();}});var emptyOption=new Element('option',{value:''});select.appendChild(emptyOption);regionsData.each(function(region){var option=new Element('option',{value:region.name});if(defaultValue==region.name){option.selected=true;}\noption.innerHTML=region.name;select.appendChild(option);});return select;},initGeocodeAPI:function()\n{var src='//maps.googleapis.com/maps/api/js?'+'key=AIzaSyC2t7txYJJe10PryITwaIL8FmjdjxR9xeQ&signed_in=true&'+'callback=EbayPickupStoreObj.getGeocodeObject';require([src]);},getGeocodeObject:function()\n{EbayPickupStoreObj.geocodeObject=new google.maps.Geocoder();},calculateLatitudeLongitude:function(event)\n{event.preventDefault();var self=EbayPickupStoreObj,address='';if($('country').selectedOptions.length){address+=$('country').selectedOptions[0].innerHTML;}\nvar region=$('region').value;region&&(address+=', '+region);var city=$('city').value;city&&(address+=', '+city);var address1=$('address_1').value;address1&&(address+=', '+address1);self.geocodeObject.geocode({'address':address},function(results,status){if(status===google.maps.GeocoderStatus.OK){if(results.length){var geometry=results[0].geometry;window.test_geo=geometry;var lat=+geometry.location.lat().toFixed(3),lng=+geometry.location.lng().toFixed(3);$('latitude').value=lat;$('longitude').value=lng;$('google_map').href='https://www.google.com/maps/place/'+lat+','+lng;$('google_map').show();}}else{self.alert('Location not found.');}});},scheduleDayModeChange:function(event)\n{var self=EbayPickupStoreObj,topElement=event.target.up('tr'),containerFrom=topElement.down('#'+this.id.replace('mode','')+'container_from'),containerTo=topElement.down('#'+this.id.replace('mode','')+'container_to');containerFrom.hide();containerTo.hide();if(this.checked){if(self.defaultBusinessHours.from&&self.defaultBusinessHours.to){var timeFrom=self.defaultBusinessHours.from||[],timeTo=self.defaultBusinessHours.to||[];topElement.down('#'+this.id.replace('mode','')+'from_hours').value=timeFrom[0]||'';topElement.down('#'+this.id.replace('mode','')+'from_minutes').value=timeFrom[1]||'';topElement.down('#'+this.id.replace('mode','')+'from').value=(timeFrom[0]||'00')+':'+(timeFrom[1]||'00')+':00';topElement.down('#'+this.id.replace('mode','')+'to_hours').value=timeTo[0]||'';topElement.down('#'+this.id.replace('mode','')+'to_minutes').value=timeTo[1]||'';topElement.down('#'+this.id.replace('mode','')+'to').value=(timeTo[0]||'00')+':'+(timeTo[1]||'00')+':00';}\ncontainerFrom.show();containerTo.show();}},scheduleTimeSelectChange:function(event)\n{var topElement=event.target.up('td'),inputId=this.id.match('(.)*(?=_)')[0];var hours=topElement.down('#'+inputId+'_hours').value,minutes=topElement.down('#'+inputId+'_minutes').value;if(hours==''||minutes==''){return;}\nif((event.target.id.indexOf('week_day')!=-1)&&(event.target.id.indexOf('from')!=-1)){EbayPickupStoreObj.defaultBusinessHours.from=[hours,minutes];}else if((event.target.id.indexOf('week_day')!=-1)&&(event.target.id.indexOf('to')!=-1)){EbayPickupStoreObj.defaultBusinessHours.to=[hours,minutes];}\ntopElement.up('tr').down('#'+inputId).value=hours+':'+minutes+':00';},addDateColumn:function(event)\n{event.preventDefault();var self=EbayPickupStoreObj,template=$('special_hours_template'),specialHoursFieldsCount=++($$('.date-field').length);if(!$('special_hours_grid').visible()){self.showSpecialHoursGrid();}\nvar newColumn=jQuery('<div>').html(template.innerHTML)[0];newColumn=newColumn.down('tr');newColumn.down('input[name^=\"date_validator_to_\"]').name='date_validator_to_'\n+specialHoursFieldsCount;newColumn.down('input[name^=\"date_validator_from_\"]').name='date_validator_from_'\n+specialHoursFieldsCount;$('special_hours_grid_rows').down('tbody').appendChild(newColumn);newColumn.down('.remove_date').observe('click',self.removeDateColumn);newColumn.getElementsBySelector('.date_time_select').each(function(el){el.observe('change',self.scheduleTimeSelectChange).simulate('change');});var parent=newColumn.down('#date').up();parent.innerHTML='';var newElementKey='date-'+specialHoursFieldsCount;parent.insert({top:new Element('input',{type:'text',id:newElementKey,value:'',name:newElementKey,class:'input-text date-field M2ePro-required-when-visible M2ePro-validate-must-arrive-date','data-mage-init':'{\"calendar\": '+'{\"showTime\": false, \"dateFormat\": \"yy-mm-dd\", \"showButtonPanel\": false}'+'}',onchange:'EbayPickupStoreObj.dateOnChange(this)'})});mage.apply();},dateOnChange:function(el){var dateContainer=el,dateStr=dateContainer.value,dateFrom=dateContainer.up('tr').down('#date_from'),dateTo=dateContainer.up('tr').down('#date_to');dateFrom.name='special_hours[date_settings]['+dateStr+'][open]';dateTo.name='special_hours[date_settings]['+dateStr+'][close]';},removeDateColumn:function(event)\n{var self=EbayPickupStoreObj;event.preventDefault();event.target.up('tr').remove();self.hideSpecialHoursGrid();},changeDefaultMode:function()\n{var self=EbayPickupStoreObj;if(+this.value){$('magento_block_ebay_account_pickup_store_form_data_quantity_custom_settings').show();var mode=M2ePro.formData.qty_mode;if(mode==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Account_PickupStore::QTY_MODE_SELLING_FORMAT_TEMPLATE')){M2ePro.formData.qty_mode=M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Account_PickupStore::QTY_MODE_PRODUCT');}}else{$('magento_block_ebay_account_pickup_store_form_data_quantity_custom_settings').hide();}},qtyModeChange:function()\n{var self=EbayPickupStoreObj,customValueTr=$('qty_mode_cv_tr'),attributeElement=$('qty_custom_attribute'),maxPostedValueTr=$('qty_modification_mode_tr'),maxPostedValueMode=$('qty_modification_mode');customValueTr.hide();attributeElement.value='';if(isNaN(+this.value)||$('default_mode').value=='0'){return;}\nif(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Account_PickupStore::QTY_MODE_NUMBER')){customValueTr.show();}else if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Account_PickupStore::QTY_MODE_ATTRIBUTE')){self.updateHiddenValue(this,attributeElement);}\nmaxPostedValueTr.hide();maxPostedValueMode.value=0;if(self.isMaxPostedQtyAvailable(this.value)){maxPostedValueTr.show();maxPostedValueMode.value=1;if(self.isMaxPostedQtyAvailable(M2ePro.formData.qty_mode)){maxPostedValueMode.value=M2ePro.formData.qty_modification_mode;}}\nmaxPostedValueMode.simulate('change');self.updateQtyPercentage();},isMaxPostedQtyAvailable:function(qtyMode)\n{return qtyMode==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Account_PickupStore::QTY_MODE_PRODUCT')||qtyMode==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Account_PickupStore::QTY_MODE_ATTRIBUTE')||qtyMode==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Account_PickupStore::QTY_MODE_PRODUCT_FIXED');},qtyPostedModeChange:function()\n{var minPosterValueTr=$('qty_min_posted_value_tr'),maxPosterValueTr=$('qty_max_posted_value_tr');minPosterValueTr.hide();maxPosterValueTr.hide();if(this.value==1){minPosterValueTr.show();maxPosterValueTr.show();}},updateQtyPercentage:function()\n{var qtyPercentageTr=$('qty_percentage_tr');qtyPercentageTr.hide();var qtyMode=$('qty_mode').value;if(qtyMode==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Account_PickupStore::QTY_MODE_SINGLE')||qtyMode==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Account_PickupStore::QTY_MODE_NUMBER')){return;}\nqtyPercentageTr.show();},hideSpecialHoursGrid:function()\n{if($$('.date-field').length>0){return;}\n$('special_hours_grid').hide();var addDateBtn=$$('.add_date').shift();addDateBtn.removeClassName('right');addDateBtn.style.width='';addDateBtn.up('div').removeClassName('add_btn_wrapper').addClassName('add_btn_wrapper_center');},showSpecialHoursGrid:function()\n{$('special_hours_grid').show();var addDateBtn=$$('.add_date').shift();addDateBtn.addClassName('right');addDateBtn.style.width='12.5%';addDateBtn.up('div').removeClassName('add_btn_wrapper_center').addClassName('add_btn_wrapper');},duplicateClick:function($headId,chapter_when_duplicate_text)\n{$$('.loading-mask').invoke('show');this.setValidationCheckRepetitionValue('M2ePro-pickup-store-location-id',M2ePro.translator.translate('The specified Title is already used for another In-Store Pickup. In-Store Pickup Title must be unique.'),'Ebay\\\\Account\\\\PickupStore','location_id','id',0);M2ePro.formData.id=0;$('name').value=$('location_id').value=$('pickup_store_id').value='';$('location_id').disabled=false;if(!$('auto_generate_field').visible()){$('auto_generate_field').show();$('auto_generate').observe('change',EbayPickupStoreObj.switchAutoGeneration).simulate('change');}\n$$('.page-title').each(function(o){o.innerHTML=chapter_when_duplicate_text;});$$('.M2ePro_duplicate_button').each(function(o){o.hide();});$$('.M2ePro_delete_button').each(function(o){o.hide();});window.setTimeout(function(){$$('.loading-mask').invoke('hide')},1200);},isValidForm:function()\n{var result=jQuery('#edit_form').valid();if(result){$('location_id').disabled=false;}\nreturn result;},validateLocation:function()\n{jQuery.validator.addMethod('M2ePro-check-location',function(value){var preValidation=true;['country','region','city','address_1','postal_code','latitude','longitude'].each(function(el){if(!$(el)||$(el).value==''){preValidation=false;}});if(!preValidation){return true;}\nvar checkResult=false;new Ajax.Request(M2ePro.url.get('validateLocation'),{method:'post',asynchronous:false,parameters:{id:M2ePro.formData.id,country:$('country').value,region:$('region').value,city:$('city').value,address_1:$('address_1').value,address_2:$('address_2').value,postal_code:$('postal_code').value,latitude:$('latitude').value,longitude:$('longitude').value,utc_offset:$('utc_offset').value},onSuccess:function(transport){checkResult=transport.responseText.evalJSON()['result'];}});return checkResult;},M2ePro.translator.translate('Same Location is already exists.'));}});});","Ess_M2ePro/js/Ebay/Account/Grid.min.js":"define(['Magento_Ui/js/modal/modal','M2ePro/Plugin/Messages','M2ePro/Grid'],function(modal,MessageObj){window.EbayAccountGrid=Class.create(Grid,{initialize:function($super,gridId){this.messageObj=Object.create(MessageObj);this.messageObj.setContainer('#account_feedback_action_messages_container');$super(gridId);},prepareActions:function()\n{jQuery.validator.addMethod('M2ePro-validate-feedback-response-max-length',function(value,el){if(jQuery.validator.methods['M2ePro-required-when-visible'](null,el)){return true;}\nreturn value.length>=2&&value.length<=80;},M2ePro.translator.translate('Should be between 2 and 80 characters long.'));},openAccountFeedbackPopup:function(id)\n{var self=this;new Ajax.Request(M2ePro.url.get('ebay_account_feedback/getPopup'),{method:'GET',parameters:{id:id},onSuccess:function(transport){var response=transport.responseText.evalJSON();var container=$('edit_feedback_popup_container');if(container){container.remove();}\n$('html-body').insert({bottom:'<div id=\"edit_feedback_popup_container\">'+response.html+'</div>'});self.feedbackPopup=jQuery('#edit_feedback_popup_container');modal({title:response.title,type:'slide',buttons:[]},self.feedbackPopup);self.feedbackPopup.modal('openModal');}});},openSendResponsePopup:function(el,feedbackId,transactionId,itemId)\n{var self=this;self.messageObj.clear();new Ajax.Request(M2ePro.url.get('ebay_account_feedback/getSendResponseForm'),{method:'GET',parameters:{feedback_Id:feedbackId},onSuccess:function(transport){var response=transport.responseText.evalJSON();var container=$('send_response_popup_container');if(container){container.remove();}\n$('html-body').insert({bottom:'<div id=\"send_response_popup_container\"></div>'});$('send_response_popup_container').update(response.html);self.initFormValidation('#send_response_form');self.sendResponsePopup=jQuery('#send_response_popup_container');modal({title:response.title,type:'popup',buttons:[{text:M2ePro.translator.translate('Cancel'),class:'action-secondary action-dismiss',click:function(){self.sendResponsePopup.modal('closeModal');}},{text:M2ePro.translator.translate('Send'),class:'action-primary',click:function(){if(!jQuery('#send_response_form').valid()){return false;}\nvar data=$('send_response_form').serialize(true);new Ajax.Request(M2ePro.url.get('ebay_account_feedback/sendResponse'),{parameters:{feedback_id:data.feedback_id,feedback_text:(data.feedback_template_type=='custom')?data.feedback_text:data.feedback_template},onSuccess:function(transport){var response=transport.responseText.evalJSON();self.messageObj['add'+response.type[0].toUpperCase()+response.type.slice(1)+'Message'](response.text);self.sendResponsePopup.modal('closeModal');window['ebayFeedbackGridJsObject'].reload();}});}}]},self.sendResponsePopup);self.sendResponsePopup.modal('openModal');}});},});});","Ess_M2ePro/js/Ebay/Template/Shipping.min.js":"define(['jquery','Magento_Ui/js/modal/modal','M2ePro/Common'],function(jQuery,modal){window.EbayTemplateShipping=Class.create(Common,{shippingMethods:{},missingAttributes:{},discountProfiles:[],shippingServices:[],shippingLocations:[],counter:{local:0,international:0,total:0},originCountry:null,initialize:function()\n{jQuery.validator.addMethod('M2ePro-location-or-postal-required',function(){return $('address_mode').value!=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::ADDRESS_MODE_NONE')||$('postal_code_mode').value!=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::POSTAL_CODE_MODE_NONE');},M2ePro.translator.translate('Location or Zip/Postal Code should be specified.'));jQuery.validator.addMethod('M2ePro-validate-international-ship-to-location',function(value,el){return $$('input[name=\"'+el.name+'\"]').any(function(o){return o.checked;});},M2ePro.translator.translate('Select one or more international ship-to Locations.'));jQuery.validator.addMethod('M2ePro-required-if-calculated',function(value){if(EbayTemplateShippingObj.isLocalShippingModeCalculated()||EbayTemplateShippingObj.isInternationalShippingModeCalculated()){return value!=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::POSTAL_CODE_MODE_NONE');}\nreturn true;},M2ePro.translator.translate('This is a required field.'));jQuery.validator.addMethod('M2ePro-validate-shipping-methods',function(value,el){var locationType=/local/.test(el.id)?'local':'international',shippingModeValue=$(locationType+'_shipping_mode').value;shippingModeValue=parseInt(shippingModeValue);if(shippingModeValue!==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::SHIPPING_TYPE_FLAT')&&shippingModeValue!==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::SHIPPING_TYPE_CALCULATED')){return true;}\nreturn EbayTemplateShippingObj.counter[locationType]!=0;},M2ePro.translator.translate('You should specify at least one Shipping Method.'));jQuery.validator.addMethod('M2ePro-validate-shipping-service',function(value,el){var hidden=!$(el).visible();var current=el;while(!hidden){el=$(el).up();hidden=!el.visible();if(el==document||el.hasClassName('entry-edit')){break;}}\nif(hidden||current.up('table').id=='shipping_international_table'){return true;}\nreturn value!='';},M2ePro.translator.translate('This is a required field.'));},initObservers:function()\n{jQuery('#country_mode').on('change',EbayTemplateShippingObj.countryModeChange).trigger('change');jQuery('#postal_code_mode').on('change',EbayTemplateShippingObj.postalCodeModeChange).trigger('change');jQuery('#address_mode').on('change',EbayTemplateShippingObj.addressModeChange).trigger('change');jQuery('#local_shipping_mode').on('change',EbayTemplateShippingObj.localShippingModeChange).trigger('change');if($('local_shipping_rate_table_mode')){jQuery('#local_shipping_rate_table_mode').on('change',EbayTemplateShippingObj.rateTableModeChange);}\nif($('international_shipping_rate_table_mode')){jQuery('#international_shipping_rate_table_mode').on('change',EbayTemplateShippingObj.rateTableModeChange);}\nEbayTemplateShippingObj.prepareMeasurementObservers('local');jQuery('#dispatch_time').on('change',EbayTemplateShippingObj.dispatchTimeChange).trigger('change');if($('click_and_collect_mode')){jQuery('#click_and_collect_mode').on('change',EbayTemplateShippingObj.clickAndCollectModeChange).trigger('change');}\nif($('cross_border_trade')){jQuery('#cross_border_trade').on('change',EbayTemplateShippingObj.crossBorderTradeChange).trigger('change');}\njQuery('#international_shipping_mode').on('change',EbayTemplateShippingObj.internationalShippingModeChange).trigger('change');jQuery('.shipping_excluded_location_region_link').each(function(){jQuery(this).on('click',EbayTemplateShippingObj.checkExcludeLocationsRegionsSelection).on('mouseover',function(event){this.down('label').style.textDecoration='underline';}).on('mouseout',function(event){this.down('label').style.textDecoration='none';});});jQuery('.shipping_excluded_location').each(function(){jQuery(this).on('change',EbayTemplateShippingObj.selectExcludeLocation);});EbayTemplateShippingObj.renderShippingMethods(EbayTemplateShippingObj.shippingMethods);EbayTemplateShippingObj.checkMessages('local');EbayTemplateShippingObj.checkMessages('international');},countryModeChange:function()\n{var self=EbayTemplateShippingObj,elem=$('country_mode');if(elem.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::COUNTRY_MODE_CUSTOM_VALUE')){self.updateHiddenValue(elem,$('country_custom_value'));}\nif(elem.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::COUNTRY_MODE_CUSTOM_ATTRIBUTE')){self.updateHiddenValue(elem,$('country_custom_attribute'));}},postalCodeModeChange:function()\n{var self=EbayTemplateShippingObj,elem=$('postal_code_mode');if(elem.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::POSTAL_CODE_MODE_CUSTOM_VALUE')){$('postal_code_custom_value_tr').show();}else{$('postal_code_custom_value_tr').hide();}\nif(elem.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::POSTAL_CODE_MODE_CUSTOM_ATTRIBUTE')){self.updateHiddenValue(elem,$('postal_code_custom_attribute'));}},addressModeChange:function()\n{var self=EbayTemplateShippingObj,elem=$('address_mode');if(elem.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::ADDRESS_MODE_CUSTOM_VALUE')){$('address_custom_value_tr').show();}else{$('address_custom_value_tr').hide();}\nif(elem.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::ADDRESS_MODE_CUSTOM_ATTRIBUTE')){self.updateHiddenValue(elem,$('address_custom_attribute'));}},dispatchTimeChange:function()\n{if(!$('click_and_collect_mode')){return;}\nif(this.value>3||(!EbayTemplateShippingObj.isLocalShippingModeFlat()&&!EbayTemplateShippingObj.isLocalShippingModeCalculated())){$('click_and_collect_mode_tr').hide();$('click_and_collect_mode').selectedIndex=1;jQuery('#click_and_collect_mode').trigger('change');return;}\n$('click_and_collect_mode_tr').show();jQuery('#click_and_collect_mode').trigger('change');},localShippingModeChange:function()\n{$('magento_block_ebay_template_shipping_form_data_international-wrapper').hide();$('local_shipping_methods_tr').hide();$('magento_block_ebay_template_shipping_form_data_excluded_locations-wrapper').show();$$('#shipping_local_tbody .icon-btn').each(function(el){EbayTemplateShippingObj.removeRow.call(el,'local');});if(EbayTemplateShippingObj.isLocalShippingModeFlat()||EbayTemplateShippingObj.isLocalShippingModeCalculated()){$$('.local-shipping-tr').invoke('show');jQuery('#dispatch_time').trigger('change');$('domestic_shipping_fieldset-wrapper').setStyle({borderBottom:null});}else{$$('.local-shipping-tr').invoke('hide');$('domestic_shipping_fieldset-wrapper').setStyle({borderBottom:'0px'});if($('click_and_collect_mode')){$('click_and_collect_mode').selectedIndex=1;jQuery('#click_and_collect_mode').trigger('change');}}\nEbayTemplateShippingObj.updateMeasurementVisibility();EbayTemplateShippingObj.updateCashOnDeliveryCostVisibility();EbayTemplateShippingObj.updateCrossBorderTradeVisibility();EbayTemplateShippingObj.updateRateTableVisibility('local');EbayTemplateShippingObj.updateLocalHandlingCostVisibility();EbayTemplateShippingObj.renderDiscountProfiles('local');EbayTemplateShippingObj.clearMessages('local');if(EbayTemplateShippingObj.isLocalShippingModeFlat()){$('magento_block_ebay_template_shipping_form_data_international-wrapper').show();$('local_shipping_methods_tr').show();}\nif(EbayTemplateShippingObj.isLocalShippingModeCalculated()){$('magento_block_ebay_template_shipping_form_data_international-wrapper').show();$('local_shipping_methods_tr').show();}\nif(EbayTemplateShippingObj.isLocalShippingModeFreight()){$('international_shipping_mode').value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::SHIPPING_TYPE_NO_INTERNATIONAL');jQuery('#international_shipping_mode').trigger('change');$('magento_block_ebay_template_shipping_form_data_excluded_locations-wrapper').hide();EbayTemplateShippingObj.resetExcludeLocationsList();}\nif(EbayTemplateShippingObj.isLocalShippingModeLocal()){$('international_shipping_mode').value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::SHIPPING_TYPE_NO_INTERNATIONAL');jQuery('#international_shipping_mode').trigger('change');$('magento_block_ebay_template_shipping_form_data_excluded_locations-wrapper').hide();EbayTemplateShippingObj.resetExcludeLocationsList();}},isLocalShippingModeFlat:function()\n{return $('local_shipping_mode').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::SHIPPING_TYPE_FLAT');},isLocalShippingModeCalculated:function()\n{return $('local_shipping_mode').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::SHIPPING_TYPE_CALCULATED');},isLocalShippingModeFreight:function()\n{return $('local_shipping_mode').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::SHIPPING_TYPE_FREIGHT');},isLocalShippingModeLocal:function()\n{return $('local_shipping_mode').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::SHIPPING_TYPE_LOCAL');},hasSurcharge:function(locationType)\n{var marketplaceId=$$('[name=\"shipping[marketplace_id]\"]')[0];return locationType=='local'&&marketplaceId&&['1','9'].indexOf(marketplaceId.value)!=-1;},internationalShippingModeChange:function()\n{$$('#shipping_international_tbody .icon-btn').each(function(el){EbayTemplateShippingObj.removeRow.call(el,'international');});if(EbayTemplateShippingObj.isInternationalShippingModeFlat()||EbayTemplateShippingObj.isInternationalShippingModeCalculated()){$('add_international_shipping_method_button').show();$('shipping_international_table').hide();$('international_shipping_methods_tr').show();$$('.international-shipping-tr').invoke('show');}else{$('international_shipping_methods_tr').hide();$$('.international-shipping-tr').invoke('hide');EbayTemplateShippingObj.deleteExcludedLocation('international','type','excluded_locations_hidden');EbayTemplateShippingObj.updateExcludedLocationsTitles('excluded_locations_titles');if($('international_shipping_rate_table_mode')){$('international_shipping_rate_table_mode').selectedIndex=0;jQuery('#international_shipping_rate_table_mode').trigger('change');}}\nEbayTemplateShippingObj.updateMeasurementVisibility();EbayTemplateShippingObj.renderDiscountProfiles('international');EbayTemplateShippingObj.updateRateTableVisibility('international');EbayTemplateShippingObj.updateInternationalHandlingCostVisibility();EbayTemplateShippingObj.clearMessages('international');},isInternationalShippingModeFlat:function()\n{return $('international_shipping_mode').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::SHIPPING_TYPE_FLAT');},isInternationalShippingModeCalculated:function()\n{return $('international_shipping_mode').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::SHIPPING_TYPE_CALCULATED');},isInternationalShippingModeNoInternational:function()\n{return $('international_shipping_mode').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::SHIPPING_TYPE_NO_INTERNATIONAL');},getCalculatedLocationType:function()\n{if(EbayTemplateShippingObj.isLocalShippingModeCalculated()){return'local';}\nif(EbayTemplateShippingObj.isInternationalShippingModeCalculated()){return'international';}\nreturn null;},isShippingModeCalculated:function(locationType)\n{if(locationType=='local'){return EbayTemplateShippingObj.isLocalShippingModeCalculated();}\nif(locationType=='international'){return EbayTemplateShippingObj.isInternationalShippingModeCalculated();}\nreturn false;},isClickAndCollectEnabled:function()\n{if(!$('click_and_collect_mode')){return false;}\nreturn $('click_and_collect_mode').value==1;},crossBorderTradeChange:function()\n{if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::CROSS_BORDER_TRADE_NONE')){$('international_shipping_none').show();}else{$('international_shipping_none').hide();if(EbayTemplateShippingObj.isInternationalShippingModeNoInternational()){$('international_shipping_mode').value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::SHIPPING_TYPE_FLAT');jQuery('#international_shipping_mode').trigger('change');}}},updateCrossBorderTradeVisibility:function()\n{if(!$('magento_block_ebay_template_shipping_form_data_cross_border_trade-wrapper')){return;}\nif(EbayTemplateShippingObj.isLocalShippingModeFlat()||EbayTemplateShippingObj.isLocalShippingModeCalculated()){$('magento_block_ebay_template_shipping_form_data_cross_border_trade-wrapper').show();}else{$('magento_block_ebay_template_shipping_form_data_cross_border_trade-wrapper').hide();$('cross_border_trade').value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::CROSS_BORDER_TRADE_NONE');}},updateRateTableVisibility:function(locationType)\n{var shippingMode=$(locationType+'_shipping_mode').value;if(!$(locationType+'_shipping_rate_table_mode_tr')){return;}\nif(shippingMode!=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::SHIPPING_TYPE_FLAT')){$(locationType+'_shipping_rate_table_mode_tr').hide();$(locationType+'_shipping_rate_table_mode').value=0;}else{$(locationType+'_shipping_rate_table_mode_tr').show();}},isRateTableEnabled:function()\n{var local=$('local_shipping_rate_table_mode'),international=$('international_shipping_rate_table_mode');if(!local&&!international){return false;}\nreturn(local&&local.value!=0)||(international&&international.value!=0);},rateTableModeChange:function()\n{var absoluteHide=!!(!EbayTemplateShippingObj.isLocalShippingModeFlat()||EbayTemplateShippingObj.isRateTableEnabled());$$('[id^=\"shipping_variant_cost_surcharge_\"]').each(function(surchargeRow){var row=surchargeRow.previous('tr');if(!row){return;}\nvar inputCostSurchargeCV=surchargeRow.select('.shipping-cost-surcharge')[0];var inputCostSurchargeCA=surchargeRow.select('.shipping-cost-surcharge-ca')[0];inputCostSurchargeCV.hide();inputCostSurchargeCA.hide();if(absoluteHide||!(/(FedEx|UPS)/.test(row.select('.shipping-service')[0].value))||row.select('.cost-mode')[0].value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping\\\\Service::COST_MODE_FREE')){surchargeRow.hide();}else{surchargeRow.show();if(row.select('.cost-mode')[0].value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping\\\\Service::COST_MODE_CUSTOM_VALUE')){inputCostSurchargeCV.show();inputCostSurchargeCV.disabled=false;}else if(row.select('.cost-mode')[0].value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping\\\\Service::COST_MODE_CUSTOM_ATTRIBUTE')){inputCostSurchargeCA.show();}}});EbayTemplateShippingObj.updatePackageBlockState();},clickAndCollectModeChange:function()\n{EbayTemplateShippingObj.updatePackageBlockState();},updateLocalHandlingCostVisibility:function()\n{if(!$('local_handling_cost_cv_tr')){return;}\nif(EbayTemplateShippingObj.isLocalShippingModeFlat()){$('local_handling_cost_cv_tr').hide();$('local_handling_cost').value='';}\nif(EbayTemplateShippingObj.isLocalShippingModeCalculated()){$('local_handling_cost_cv_tr').show();}},updateInternationalHandlingCostVisibility:function()\n{if(!$('international_handling_cost_cv_tr')){return;}\nif(EbayTemplateShippingObj.isInternationalShippingModeCalculated()){$('international_handling_cost_cv_tr').show();}else{$('international_handling_cost_cv_tr').hide();$('international_handling_cost').value='';}},updateDiscountProfiles:function(accountId)\n{new Ajax.Request(M2ePro.url.get('ebay_template_shipping/updateDiscountProfiles'),{method:'get',parameters:{'account_id':accountId},onSuccess:function(transport){EbayTemplateShippingObj.discountProfiles[accountId]['profiles']=transport.responseText.evalJSON(true);EbayTemplateShippingObj.renderDiscountProfiles('local',accountId);EbayTemplateShippingObj.renderDiscountProfiles('international',accountId);}});},renderDiscountProfiles:function(locationType,renderAccountId)\n{if(typeof renderAccountId=='undefined'){$$('.'+locationType+'-discount-profile-account-tr').each(function(account){var accountId=account.readAttribute('account_id');if($(locationType+'_shipping_discount_profile_id_'+accountId)){var value=EbayTemplateShippingObj.discountProfiles[accountId]['selected'][locationType];var html=EbayTemplateShippingObj.getDiscountProfilesHtml(locationType,accountId);$(locationType+'_shipping_discount_profile_id_'+accountId).update(html);if(value&&EbayTemplateShippingObj.discountProfiles[accountId]['profiles'].length>0){var select=$(locationType+'_shipping_discount_profile_id_'+accountId);for(var i=0;i<select.length;i++){if(select[i].value==value){select.value=value;break;}}}}});}else{if($(locationType+'_shipping_discount_profile_id_'+renderAccountId)){var value=EbayTemplateShippingObj.discountProfiles[renderAccountId]['selected'][locationType];var html=EbayTemplateShippingObj.getDiscountProfilesHtml(locationType,renderAccountId);$(locationType+'_shipping_discount_profile_id_'+renderAccountId).update(html);if(value&&EbayTemplateShippingObj.discountProfiles[renderAccountId]['profiles'].length>0){$(locationType+'_shipping_discount_profile_id_'+renderAccountId).value=value;}}}},getDiscountProfilesHtml:function(locationType,accountId)\n{var shippingModeSelect=$(locationType+'_shipping_mode');var desiredProfileType=null;var html='<option value=\"\">'+M2ePro.translator.translate('None')+'</option>';switch(parseInt(shippingModeSelect.value)){case M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::SHIPPING_TYPE_FLAT'):desiredProfileType='flat_shipping';break;case M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping::SHIPPING_TYPE_CALCULATED'):desiredProfileType='calculated_shipping';break;}\nif(desiredProfileType===null){return html;}\nEbayTemplateShippingObj.discountProfiles[accountId]['profiles'].each(function(profile){if(profile.type!=desiredProfileType){return;}\nhtml+='<option value=\"'+profile.profile_id+'\">'+profile.profile_name+'</option>';});return html;},updateCashOnDeliveryCostVisibility:function()\n{if(!$('cash_on_delivery_cost_cv_tr')){return;}\nif(EbayTemplateShippingObj.isLocalShippingModeFlat()||EbayTemplateShippingObj.isLocalShippingModeCalculated()){$('cash_on_delivery_cost_cv_tr').show();}else{$('cash_on_delivery_cost_cv_tr').hide();$('cash_on_delivery_cost').value='';}},packageSizeChange:function()\n{var self=EbayTemplateShippingObj;var packageSizeMode=this.value;$('package_size_mode').value=packageSizeMode;$('package_size_attribute').value='';if(packageSizeMode==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping\\\\Calculated::PACKAGE_SIZE_CUSTOM_VALUE')){self.updateHiddenValue(this,$('package_size_value'));var showDimension=parseInt(this.options[this.selectedIndex].getAttribute('dimensions_supported'));self.updateDimensionVisibility(showDimension);}else if(packageSizeMode==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping\\\\Calculated::PACKAGE_SIZE_CUSTOM_ATTRIBUTE')){self.updateHiddenValue(this,$('package_size_attribute'));self.updateDimensionVisibility(true);}},updateDimensionVisibility:function(showDimension)\n{if(showDimension){$('dimensions_tr').show();jQuery('#dimension_mode').trigger('change');}else{$('dimensions_tr').hide();$('dimension_mode').value=0;jQuery('#dimension_mode').trigger('change');}},dimensionModeChange:function()\n{$$('.dimensions_ca_tr, .dimensions_cv_tr').invoke('hide');if(this.value!=0){$$(this.value==1?'.dimensions_cv_tr':'.dimensions_ca_tr').invoke('show');}},weightChange:function()\n{var measurementNoteElement=this.up().next('.note');$('weight_cv').hide();measurementNoteElement.hide();var weightMode=this.value;$('weight_mode').value=weightMode;$('weight_attribute').value='';if(weightMode==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping\\\\Calculated::WEIGHT_CUSTOM_VALUE')){$('weight_cv').show();}else if(weightMode==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping\\\\Calculated::WEIGHT_CUSTOM_ATTRIBUTE')){EbayTemplateShippingObj.updateHiddenValue(this,$('weight_attribute'));measurementNoteElement.show();}},isMeasurementSystemEnglish:function()\n{return $('measurement_system').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping\\\\Calculated::MEASUREMENT_SYSTEM_ENGLISH');},measurementSystemChange:function()\n{$$('.measurement-system-english, .measurement-system-metric').invoke('hide');if(EbayTemplateShippingObj.isMeasurementSystemEnglish()){$$('.measurement-system-english').invoke('show');}else{$$('.measurement-system-metric').invoke('show');}},updateMeasurementVisibility:function()\n{if(EbayTemplateShippingObj.isLocalShippingModeCalculated()){EbayTemplateShippingObj.showMeasurementOptions('local','calculated');EbayTemplateShippingObj.updatePackageBlockState();return;}\nif(EbayTemplateShippingObj.isInternationalShippingModeCalculated()){EbayTemplateShippingObj.showMeasurementOptions('international','calculated');EbayTemplateShippingObj.updatePackageBlockState();return;}\nif(EbayTemplateShippingObj.isLocalShippingModeFlat()&&EbayTemplateShippingObj.isRateTableEnabled()){EbayTemplateShippingObj.showMeasurementOptions('local','flat');}\nEbayTemplateShippingObj.updatePackageBlockState();},showMeasurementOptions:function(locationType,shippingMode)\n{$$('#block_shipping_template_calculated_options tr').each(function(element){if(element.hasClassName('visible-for-'+shippingMode+'-by-default')){element.show();}else{element.hide();}});EbayTemplateShippingObj.prepareMeasurementObservers(shippingMode);},prepareMeasurementObservers:function(shippingMode)\n{jQuery('#measurement_system').on('change',EbayTemplateShippingObj.measurementSystemChange).trigger('change');if(shippingMode=='calculated'){jQuery('#package_size').on('change',EbayTemplateShippingObj.packageSizeChange).trigger('change');}\nif($('dimension_mode')){jQuery('#dimension_mode').on('change',EbayTemplateShippingObj.dimensionModeChange).trigger('change');}\njQuery('#weight').on('change',EbayTemplateShippingObj.weightChange).trigger('change');},serviceChange:function()\n{var row=$(this).up('tr');if(this.up('table').id!='shipping_international_table'){this.down(0).hide();}\nif(this.value===''){row.select('.cost-mode')[0].hide();row.select('.shipping-cost-cv')[0].hide();row.select('.shipping-cost-ca')[0].hide();row.select('.shipping-cost-additional')[0].hide();row.select('.shipping-cost-additional-ca')[0].hide();}else{row.select('.cost-mode')[0].show();jQuery(row.select('.cost-mode')[0]).trigger('change');}},serviceCostModeChange:function()\n{var row=$(this).up('tr');var surchargeRow=$('shipping_variant_cost_surcharge_'+this.name.match(/\\d+/)+'_tr');if(EbayTemplateShippingObj.isLocalShippingModeFlat()&&surchargeRow){var inputCostSurchargeCV=surchargeRow.select('.shipping-cost-surcharge')[0];var inputCostSurchargeCA=surchargeRow.select('.shipping-cost-surcharge-ca')[0];if(!EbayTemplateShippingObj.isRateTableEnabled()&&/(FedEx|UPS)/.test(row.select('.shipping-service')[0].value)){surchargeRow.show();}else{surchargeRow.hide();}}\nvar inputCostCV=row.select('.shipping-cost-cv')[0];var inputCostCA=row.select('.shipping-cost-ca')[0];var inputCostAddCV=row.select('.shipping-cost-additional')[0];var inputCostAddCA=row.select('.shipping-cost-additional-ca')[0];var inputPriority=row.select('.shipping-priority')[0];[inputCostCV,inputCostCA,inputCostAddCV,inputCostAddCA].invoke('hide');if(surchargeRow){inputCostSurchargeCV.hide();inputCostSurchargeCA.hide();}\ninputPriority.show();if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping\\\\Service::COST_MODE_CUSTOM_VALUE')){inputCostCV.show();inputCostCV.disabled=false;inputCostAddCV.show();inputCostAddCV.disabled=false;if(surchargeRow&&!EbayTemplateShippingObj.isRateTableEnabled()){inputCostSurchargeCV.show();inputCostSurchargeCV.disabled=false;}}\nif(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping\\\\Service::COST_MODE_CUSTOM_ATTRIBUTE')){inputCostCA.show();inputCostAddCA.show();surchargeRow&&!EbayTemplateShippingObj.isRateTableEnabled()&&inputCostSurchargeCA.show();}\nif(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping\\\\Service::COST_MODE_FREE')){var isLocalMethod=/local/.test(row.id);if(isLocalMethod&&EbayTemplateShippingObj.isLocalShippingModeCalculated()){inputPriority.value=0;inputCostCV.value=0;inputCostAddCV.value=0;[inputPriority,inputCostCV,inputCostAddCV].invoke('hide');}else{inputCostCV.show();inputCostCV.value=0;inputCostCV.disabled=true;inputCostAddCV.show();inputCostAddCV.value=0;inputCostAddCV.disabled=true;}\nif(surchargeRow){inputCostSurchargeCV.hide();inputCostSurchargeCA.hide();surchargeRow.hide();}}},shippingLocationChange:function()\n{var i=this.name.match(/\\d+/);var current=this;if(this.value!='Worldwide'){return;}\n$$('input[name=\"shipping[shippingLocation]['+i+'][]\"]').each(function(item){if(current.checked&&item!=current){item.checked=false;item.disabled=true;}else{item.disabled=false;}});},addRow:function(type)\n{$('shipping_'+type+'_table').show();$('add_'+type+'_shipping_method_button').hide();var id='shipping_'+type+'_tbody';var i=EbayTemplateShippingObj.counter.total;var tpl=$$('#block_listing_template_shipping_table_row_template_table tbody')[0].innerHTML;tpl=tpl.replace(/%i%/g,i);tpl=tpl.replace(/%type%/g,type);$(id).insert(tpl);var row=$('shipping_variant_'+type+'_'+i+'_tr');AttributeObj.renderAttributesWithEmptyOption('shipping[shipping_cost_attribute]['+i+']',row.down('.shipping-cost-ca'));var handlerObj=new AttributeCreator('shipping[shipping_cost_attribute]['+i+']');handlerObj.setSelectObj($('shipping[shipping_cost_attribute]['+i+']'));handlerObj.injectAddOption();AttributeObj.renderAttributesWithEmptyOption('shipping[shipping_cost_additional_attribute]['+i+']',row.down('.shipping-cost-additional-ca'));var handlerObj=new AttributeCreator('shipping[shipping_cost_additional_attribute]['+i+']');handlerObj.setSelectObj($('shipping[shipping_cost_additional_attribute]['+i+']'));handlerObj.injectAddOption();EbayTemplateShippingObj.renderServices(row.select('.shipping-service')[0],type);EbayTemplateShippingObj.initRow(row);if(type=='international'){tpl=$$('#block_shipping_table_locations_row_template_table tbody')[0].innerHTML;tpl=tpl.replace(/%i%/g,i);$(id).insert(tpl);EbayTemplateShippingObj.renderShipToLocationCheckboxes(i);}\nif(EbayTemplateShippingObj.isLocalShippingModeFlat()&&EbayTemplateShippingObj.hasSurcharge(type)){tpl=$$('#block_shipping_table_cost_surcharge_row_template_table tbody')[0].innerHTML;tpl=tpl.replace(/%i%/g,i);$(id).insert(tpl);AttributeObj.renderAttributesWithEmptyOption('shipping[shipping_cost_surcharge_attribute]['+i+']',$('shipping_variant_cost_surcharge_'+i+'_tr').down('.shipping-cost-surcharge-ca'));$('shipping[shipping_cost_surcharge_attribute]['+i+']').insert({top:new Element('option',{selected:true}).update(M2ePro.translator.translate('None'))});var handlerObj=new AttributeCreator('shipping[shipping_cost_surcharge_attribute]['+i+']');handlerObj.setSelectObj($('shipping[shipping_cost_surcharge_attribute]['+i+']'));handlerObj.injectAddOption();}\nEbayTemplateShippingObj.counter[type]++;EbayTemplateShippingObj.counter.total++;if(type=='local'&&EbayTemplateShippingObj.counter[type]>=4){$(id).up('table').select('tfoot')[0].hide();}\nif(type=='international'&&EbayTemplateShippingObj.counter[type]>=5){$(id).up('table').select('tfoot')[0].hide();}\nvar isAttributeMode=function(element){return element.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Shipping::COUNTRY_MODE_CUSTOM_ATTRIBUTE');};row.down('[name^=\"shipping[shipping_cost_attribute]\"]').observe('change',function(event){var element=event.target.up('tr').down('[name^=\"shipping[cost_mode]\"]');if(!isAttributeMode(element)){return;}\nEbayTemplateShippingObj.checkMessages(type);});row.down('[name^=\"shipping[shipping_cost_additional_attribute]\"]').observe('change',function(event){var element=event.target.up('tr').down('[name^=\"shipping[cost_mode]\"]');if(!isAttributeMode(element)){return;}\nEbayTemplateShippingObj.checkMessages(type);});if(type=='local'){var next=row.next(\"[id^='shipping_variant_cost_surcharge']\");if(next){next.down('[name^=\"shipping[shipping_cost_surcharge_attribute]\"]').observe('change',function(event){var element=row.down('[name^=\"shipping[cost_mode]\"]');if(!isAttributeMode(element)){return;}\nEbayTemplateShippingObj.checkMessages(type);});}}\nreturn row;},initRow:function(row)\n{var locationType=/local/.test(row.id)?'local':'international';if(EbayTemplateShippingObj.isShippingModeCalculated(locationType)){row.select('.cost-mode')[0].value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping\\\\Service::COST_MODE_CALCULATED');row.select('.shipping-mode-option-notcalc').invoke('remove');if(locationType=='international'||$$('#shipping_local_tbody .cost-mode').length>1){row.select('.shipping-mode-option-free').invoke('remove');}}else{row.select('.cost-mode')[0].value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping\\\\Service::COST_MODE_FREE');row.select('.shipping-mode-option-calc')[0].remove();}\nEbayTemplateShippingObj.renderServices(row.select('.shipping-service')[0],locationType);jQuery(row.select('.cost-mode')[0]).trigger('change');jQuery(row.select('.shipping-service')[0]).trigger('change');},renderServices:function(el,locationType)\n{var html='';var isCalculated=EbayTemplateShippingObj.isShippingModeCalculated(locationType);var selectedPackage=$('package_size_value').value;var categoryMethods='';if(locationType=='international'){html+='<option value=\"\">--</option>';}else{html+='<option value=\"\">'+M2ePro.translator.translate('Select Shipping Service')+'</option>';}\nif(Object.isArray(EbayTemplateShippingObj.shippingServices)&&EbayTemplateShippingObj.shippingServices.length==0){$(el).update(html);return;}\n$H(EbayTemplateShippingObj.shippingServices).each(function(category){categoryMethods='';category.value.methods.each(function(service){var isServiceOfSelectedDestination=(locationType=='local'&&service.is_international==0)||(locationType=='international'&&service.is_international==1);var isServiceOfSelectedType=(isCalculated&&service.is_calculated==1)||(!isCalculated&&service.is_flat==1);if(!isServiceOfSelectedDestination||!isServiceOfSelectedType){return;}\nif(isCalculated){if(service.data.ShippingPackage.indexOf(selectedPackage)!=-1){categoryMethods+='<option value=\"'+service.ebay_id+'\">'+service.title+'</option>';}\nreturn;}\ncategoryMethods+='<option value=\"'+service.ebay_id+'\">'+service.title+'</option>';});if(categoryMethods!=''){noCategoryTitle=category[0]=='';if(noCategoryTitle){html+=categoryMethods;}else{if(locationType=='local'){html+='<optgroup ebay_id=\"'+category.key+'\" label=\"'+category.value.title+'\">'+categoryMethods+'</optgroup>';}else{html+='<optgroup label=\"'+category.value.title+'\">'+categoryMethods+'</optgroup>';}}}});$(el).update(html);},renderShipToLocationCheckboxes:function(i)\n{var html='';EbayTemplateShippingObj.shippingLocations.each(function(location){if(location.ebay_id=='Worldwide'){html+='<div style=\"margin-bottom: 10px;\">'+'<input'+' id=\"shipping_shippingLocation_'+location.ebay_id+'_'+i+'\"'+' type=\"checkbox\"'+' name=\"shipping[shippingLocation]['+i+'][]\" value=\"'+location.ebay_id+'\"'+' onclick=\"EbayTemplateShippingObj.shippingLocationChange.call(this);\"'+' class=\"shipping-location M2ePro-validate-international-ship-to-location admin__control-checkbox\"'+'/>'+'<label '+'for=\"shipping_shippingLocation_'+location.ebay_id+'_'+i+'\"'+'class=\"admin__field-label\"'+'>'+'<span><b>'+location.title+'</b></span>'+'</label>'+'</div>';}else{html+='<input'+' id=\"shipping_shippingLocation_'+location.ebay_id+'_'+i+'\"'+' type=\"checkbox\"'+' name=\"shipping[shippingLocation]['+i+'][]\" value=\"'+location.ebay_id+'\"'+' onclick=\"EbayTemplateShippingObj.shippingLocationChange.call(this);\"'+' class=\"admin__control-checkbox\"'+'/>'+'<label style=\"width: 142px; text-align: left; margin-bottom: 5px;\" '+'class=\"nobr admin__field-label\"'+'for=\"shipping_shippingLocation_'+location.ebay_id+'_'+i+'\"'+'>'+'<span>'+location.title+'</span>'+'</label>';}});$$('#shipping_variant_locations_'+i+'_tr td')[0].innerHTML='<div style=\"margin: 5px 10px\">'+html+'</div>';$$('#shipping_variant_locations_'+i+'_tr td')[0].innerHTML+='<div style=\"clear: both; margin-bottom: 10px;\" />';if(!EbayTemplateShippingObj.shippingMethods[i]){return;}\nvar locations=[];EbayTemplateShippingObj.shippingMethods[i].locations.each(function(item){locations.push(item);});$$('input[name=\"shipping[shippingLocation]['+i+'][]\"]').each(function(el){if(locations.indexOf(el.value)!=-1){el.checked=true;}\njQuery(el).trigger('change');});$$('input[value=\"Worldwide\"]').each(function(element){EbayTemplateShippingObj.shippingLocationChange.call(element);});},removeRow:function(locationType)\n{var table=$(this).up('table');if(locationType=='international'){$(this).up('tr').next().remove();}\nif(EbayTemplateShippingObj.hasSurcharge(locationType)){var i=$(this).up('tr').id.match(/\\d+/);var next=$(this).up('tr').next('[id=shipping_variant_cost_surcharge_'+i+'_tr]');next&&next.remove();}\n$(this).up('tr').remove();EbayTemplateShippingObj.counter[locationType]--;if(EbayTemplateShippingObj.counter[locationType]==0){$('shipping_'+locationType+'_table').hide();$('add_'+locationType+'_shipping_method_button').show();}\nif(locationType=='local'&&EbayTemplateShippingObj.counter[locationType]<4){table.select('tfoot')[0].show();}\nif(locationType=='international'&&EbayTemplateShippingObj.counter[locationType]<5){table.select('tfoot')[0].show();}\nEbayTemplateShippingObj.updateMeasurementVisibility();},hasMissingServiceAttribute:function(code,position)\n{if(typeof EbayTemplateShippingObj.missingAttributes['services'][position]=='undefined'){return false;}\nif(typeof EbayTemplateShippingObj.missingAttributes['services'][position][code]=='undefined'){return false;}\nreturn true;},addMissingServiceAttributeOption:function(select,code,position,value)\n{var option=document.createElement('option');option.value=value;option.innerHTML=EbayTemplateShippingObj.missingAttributes['services'][position][code];var first=select.down('.empty').next();first.insert({before:option});},renderShippingMethods:function(shippingMethods)\n{if(shippingMethods.length>0){$('shipping_local_table').show();$('add_local_shipping_method_button').hide();}else{$('shipping_local_table').hide();$('add_local_shipping_method_button').show();}\nshippingMethods.each(function(service,i){var type=service.shipping_type==1?'international':'local';var row=EbayTemplateShippingObj.addRow(type);var surchargeRow=$('shipping_variant_cost_surcharge_'+i+'_tr');row.down('.shipping-service').value=service.shipping_value;row.down('.cost-mode').value=service.cost_mode;if(service.cost_mode==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping\\\\Service::COST_MODE_CUSTOM_VALUE')){row.down('.shipping-cost-cv').value=service.cost_value;row.down('.shipping-cost-additional').value=service.cost_additional_value;if(surchargeRow){surchargeRow.down('.shipping-cost-surcharge').value=service.cost_surcharge_value;}}else if(service.cost_mode==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\Shipping\\\\Service::COST_MODE_CUSTOM_ATTRIBUTE')){if(EbayTemplateShippingObj.hasMissingServiceAttribute('cost_value',i)){EbayTemplateShippingObj.addMissingServiceAttributeOption(row.down('.shipping-cost-ca select'),'cost_value',i,service.cost_value);}\nif(EbayTemplateShippingObj.hasMissingServiceAttribute('cost_additional_value',i)){EbayTemplateShippingObj.addMissingServiceAttributeOption(row.down('.shipping-cost-additional-ca select'),'cost_additional_value',i,service.cost_additional_value);}\nrow.down('.shipping-cost-ca select').value=service.cost_value;row.down('.shipping-cost-additional-ca select').value=service.cost_additional_value;if(surchargeRow){surchargeRow.down('.shipping-cost-surcharge-ca select').value=service.cost_surcharge_value;}}\nrow.down('.shipping-priority').value=service.priority;jQuery(row.down('.cost-mode')).trigger('change');jQuery(row.down('.shipping-service')).trigger('change');});},replaceSelectWithInputHidden:function(select)\n{var td=select.up('td');var label=select.options[select.selectedIndex].innerHTML;var input='<input type=\"hidden\" '+'name=\"'+select.name+'\" '+'id=\"'+select.id+'\" '+'value=\"'+select.value+'\" '+'class=\"'+select.className+'\" />';$(select).replace('');$(td).insert('<span>'+label+input+'</span>');if(td.down('.cost-mode')){td.down('.cost-mode').observe('change',EbayTemplateShippingObj.serviceCostModeChange);}},initExcludeListPopup:function()\n{var element=jQuery('#magento_block_ebay_template_shipping_form_data_exclude_locations_popup');modal({title:M2ePro.translator.translate('Excluded Shipping Locations'),type:'slide',buttons:[{text:M2ePro.translator.translate('Cancel'),click:function(){element.modal('closeModal');}},{text:M2ePro.translator.translate('Save'),class:'action-primary',id:'save_popup_button',click:function(){EbayTemplateShippingObj.saveExcludeLocationsList();element.modal('closeModal');}}]},element);},showExcludeListPopup:function()\n{var self=EbayTemplateShippingObj;self.updatePopupData();self.checkExcludeLocationSelection();self.afterInitPopupActions();jQuery('#magento_block_ebay_template_shipping_form_data_exclude_locations_popup').modal('openModal');},updatePopupData:function()\n{$('excluded_locations_popup_hidden').value=$('excluded_locations_hidden').value;EbayTemplateShippingObj.updateExcludedLocationsTitles();},checkExcludeLocationSelection:function()\n{var self=EbayTemplateShippingObj,excludedLocations=$('excluded_locations_popup_hidden').value.evalJSON();$$('.shipping_excluded_location').each(function(el){el.checked=0;});$$('.shipping_excluded_location').each(function(el){for(var i=0;i<excludedLocations.length;i++){if(excludedLocations[i]['code']==el.value){el.checked=1;el.hasClassName('shipping_excluded_region')&&self.selectExcludedLocationAllRegion(el.value,1);}}});EbayTemplateShippingObj.updateExcludedLocationsSelectedRegions();},selectExcludedLocationAllRegion:function(regionCode,checkBoxState)\n{$$('div[id=\"shipping_excluded_location_international_region_'+regionCode+'\"] .shipping_excluded_location').each(function(el){el.checked=checkBoxState;});},afterInitPopupActions:function()\n{var firstNavigationLink=$$('.shipping_excluded_location_region_link').shift();firstNavigationLink&&jQuery(firstNavigationLink).trigger('click');EbayTemplateShippingObj.isInternationalShippingModeNoInternational()?$('exclude_locations_popup_international').hide():$('exclude_locations_popup_international').show();EbayTemplateShippingObj.updatePopupSizes();},updatePopupSizes:function()\n{var popupHeight='445px',popupGeneralContentMinHeight='380px';if(EbayTemplateShippingObj.isInternationalShippingModeNoInternational()){popupHeight='280px';popupGeneralContentMinHeight='200px';}\n$('excluded_locations_popup_content_general').setStyle({'min-height':popupGeneralContentMinHeight});if($('exclude_locations_international_regions')){var standartRegionHeight=$('exclude_locations_international_regions').getHeight();$('exclude_locations_international_locations').setStyle({'height':standartRegionHeight+'px'});}},saveExcludeLocationsList:function()\n{var title=$('excluded_locations_popup_titles').innerHTML,titleContainer=$('excluded_locations_titles');title==M2ePro.translator.translate('None')?titleContainer.innerHTML=M2ePro.translator.translate('No Locations are currently excluded.'):titleContainer.innerHTML=title;$('excluded_locations_hidden').value=$('excluded_locations_popup_hidden').value;},resetExcludeLocationsList:function(window)\n{window=window||'general';if(window=='general'){$('excluded_locations_hidden').value='[]';$('excluded_locations_titles').innerHTML=M2ePro.translator.translate('No Locations are currently excluded.');return;}\n$('excluded_locations_popup_hidden').value='[]';EbayTemplateShippingObj.updateExcludedLocationsTitles();EbayTemplateShippingObj.checkExcludeLocationSelection();},selectExcludeLocation:function()\n{EbayTemplateShippingObj.updateExcludedLocationsHiddenInput(this);EbayTemplateShippingObj.updateExcludedLocationsTitles();EbayTemplateShippingObj.updateExcludedLocationsSelectedRegions();},updateExcludedLocationsHiddenInput:function(element)\n{var self=EbayTemplateShippingObj,asia=$('shipping_excluded_location_international_Asia');if(element.hasClassName('shipping_excluded_region')){element.checked?self.processRegionWasSelected(element):self.processRegionWasDeselected(element);self.processRelatedRegions(element);}else{element.checked?self.processOneLocationWasSelected(element):self.processOneLocationWasDeselected(element);if(self.isChildAsiaRegion(element.getAttribute('region'))){self.processAsiaChildRegion(element);}}\nif(self.isAllLocationsOfAsiaAreSelected()&&!asia.checked){asia.checked=1;self.processRegionWasSelected($(asia));}},processRegionWasSelected:function(regionCheckBox)\n{var self=EbayTemplateShippingObj,code=regionCheckBox.value,title=regionCheckBox.next().innerHTML,region=regionCheckBox.getAttribute('region'),type=regionCheckBox.getAttribute('location_type');self.selectExcludedLocationAllRegion(code,1);self.deleteExcludedLocation(code,'region');self.addExcludedLocation(code,title,region,type);},processRegionWasDeselected:function(regionCheckBox)\n{var self=EbayTemplateShippingObj,code=regionCheckBox.value;self.selectExcludedLocationAllRegion(code,0);self.deleteExcludedLocation(code);},processRelatedRegions:function(regionCheckBox)\n{var self=EbayTemplateShippingObj;if(self.isAsiaRegion(regionCheckBox.value)){self.processAsiaRegion(regionCheckBox);}\nif(self.isChildAsiaRegion(regionCheckBox.value)){self.processAsiaChildRegion(regionCheckBox);}},processAsiaRegion:function(regionCheckBox)\n{var self=EbayTemplateShippingObj;var middleEast=$('shipping_excluded_location_international_Middle East'),southeastAsia=$('shipping_excluded_location_international_Southeast Asia');if(regionCheckBox.checked){if(!middleEast.checked){middleEast.checked=1;self.processRegionWasSelected(middleEast);}\nif(!southeastAsia.checked){southeastAsia.checked=1;self.processRegionWasSelected(southeastAsia);}\nreturn;}\nmiddleEast.checked=0;southeastAsia.checked=0;self.processRegionWasDeselected(middleEast);self.processRegionWasDeselected(southeastAsia);},processAsiaChildRegion:function(regionCheckBox)\n{var self=EbayTemplateShippingObj,asia=$('shipping_excluded_location_international_Asia');if(!regionCheckBox.checked&&asia.checked){var code=asia.value;asia.checked=0;self.deleteExcludedLocation(code,'code');$$('div[id=\"shipping_excluded_location_international_region_'+code+'\"] .shipping_excluded_location').each(function(el){el.checked=1;self.addExcludedLocation(el.value,el.next().innerHTML,el.getAttribute('region'),el.getAttribute('type'));});}},processOneLocationWasSelected:function(locationCheckBox)\n{var self=EbayTemplateShippingObj,code=locationCheckBox.value,title=locationCheckBox.next().innerHTML,region=locationCheckBox.getAttribute('region'),type=locationCheckBox.getAttribute('location_type');self.addExcludedLocation(code,title,region,type);if(!self.isAllLocationsOfRegionAreSelected(region)){return;}\nif(self.isAsiaRegion(region)&&!self.isAllLocationsOfAsiaAreSelected()){return;}\nvar regionTitle=$('shipping_excluded_location_international_'+region).next('label').innerHTML;$('shipping_excluded_location_international_'+region).checked=1;self.deleteExcludedLocation(region,'region');self.addExcludedLocation(region,regionTitle,null,type);},processOneLocationWasDeselected:function(locationCheckBox)\n{var self=EbayTemplateShippingObj,code=locationCheckBox.value,region=locationCheckBox.getAttribute('region'),type=locationCheckBox.getAttribute('location_type');self.deleteExcludedLocation(code);if(region==null){return;}\nself.deleteExcludedLocation(region);self.deleteExcludedLocation(region,'region');$('shipping_excluded_location_international_'+region).checked=0;var result=self.getLocationsByRegion(region);result['locations'].each(function(el){self.addExcludedLocation(el.value,el.next().innerHTML,region,type);});},updateExcludedLocationsTitles:function(sourse)\n{sourse=sourse||'excluded_locations_popup_titles';var excludedLocations=$(sourse.replace('titles','hidden')).value.evalJSON(),title=sourse=='excluded_locations_popup_titles'?M2ePro.translator.translate('None'):M2ePro.translator.translate('No Locations are currently excluded.');if(excludedLocations.length){title=[];excludedLocations.each(function(location){var currentTitle=EbayTemplateShippingObj.isRootLocation(location)?'<b>'+location['title']+'</b>':location['title'];title.push(currentTitle);});title=title.join(', ');}\n$('excluded_locations_reset_link').show();if(sourse=='excluded_locations_popup_titles'&&title==M2ePro.translator.translate('None')){$('excluded_locations_reset_link').hide()}\n$(sourse).innerHTML=title;},updateExcludedLocationsSelectedRegions:function()\n{$$('.shipping_excluded_location_region_link').each(function(el){var locations=EbayTemplateShippingObj.getLocationsByRegion(el.getAttribute('region'));el.removeClassName('have_selected_locations');if(locations['selected']>0&&!el.children[0].checked){el.addClassName('have_selected_locations');el.down('span',1).innerHTML='('+locations['selected']+' '+M2ePro.translator.translate('selected')+')';}});},getLocationsByRegion:function(regionCode)\n{if(regionCode==null){return false;}\nvar totalCount=0,selectedLocations=[];$$('div[id=\"shipping_excluded_location_international_region_'+regionCode+'\"] .shipping_excluded_location').each(function(el){totalCount++;el.checked&&selectedLocations.push(el);});return{total:totalCount,selected:selectedLocations.length,locations:selectedLocations};},isAllLocationsOfRegionAreSelected:function(regionCode)\n{var locations=EbayTemplateShippingObj.getLocationsByRegion(regionCode);if(!locations){return false;}\nreturn locations['total']==locations['selected'];},isAllLocationsOfAsiaAreSelected:function()\n{var asiaLocations=EbayTemplateShippingObj.getLocationsByRegion('Asia'),eastLocations=EbayTemplateShippingObj.getLocationsByRegion('Middle East'),southLocations=EbayTemplateShippingObj.getLocationsByRegion('Southeast Asia');if(!asiaLocations||!eastLocations||!southLocations){return false;}\nreturn asiaLocations['total']==asiaLocations['selected']&&eastLocations['total']==eastLocations['selected']&&southLocations['total']==southLocations['selected'];},isRootLocation:function(location)\n{return!!(location['region']==null);},isAsiaRegion:function(location)\n{return location=='Asia';},isChildAsiaRegion:function(location)\n{return location=='Middle East'||location=='Southeast Asia';},addExcludedLocation:function(code,title,region,type,sourse)\n{sourse=sourse||'excluded_locations_popup_hidden';var excludedLocations=$(sourse).value.evalJSON();var item={code:code,title:title,region:region,type:type};excludedLocations.push(item);$(sourse).value=Object.toJSON(excludedLocations);},deleteExcludedLocation:function(code,key,sourse)\n{key=key||'code';sourse=sourse||'excluded_locations_popup_hidden';var excludedLocations=$(sourse).value.evalJSON(),resultAfterDelete=[];for(var i=0;i<excludedLocations.length;i++){if(excludedLocations[i][key]!=code){resultAfterDelete.push(excludedLocations[i]);}}\n$(sourse).value=Object.toJSON(resultAfterDelete);},checkExcludeLocationsRegionsSelection:function()\n{$$('.shipping_excluded_location_region').invoke('hide');$$('.shipping_excluded_location_region_link').invoke('removeClassName','selected_region');$('shipping_excluded_location_international_region_'+this.getAttribute('region')).show();this.addClassName('selected_region');},updatePackageBlockState:function()\n{if(this.isLocalShippingModeCalculated()||this.isInternationalShippingModeCalculated()){this.setCalculatedPackageBlockState();return;}\nif(this.isClickAndCollectEnabled()&&(this.isLocalShippingModeFlat()||this.isLocalShippingModeCalculated())&&$('dispatch_time').value<=3){this.setClickAndCollectPackageBlockState();return;}\nif(this.isRateTableEnabled()){this.setRateTablePackageBlockState();return;}\nthis.setNonePackageBlockState();},setCalculatedPackageBlockState:function()\n{$('magento_block_ebay_template_shipping_form_data_calculated-wrapper').show();var dimensionsTr=$('dimensions_tr');var dimensionSelect=$('dimension_mode');if(dimensionsTr){dimensionsTr.show();jQuery(dimensionSelect).trigger('change');}\nvar packageSizeTr=$('package_size_tr');var packageSizeSelect=$('package_size');if(packageSizeTr){packageSizeTr.show();jQuery(packageSizeSelect).trigger('change');}\nvar weightTr=$('weight_tr');var weightSelect=$('weight');if(weightTr){if($('weight').selectedIndex==0){$('weight').selectedIndex=1;}\nweightTr.show();$('weight_mode_none').hide();jQuery(weightSelect).trigger('change');}},setRateTablePackageBlockState:function()\n{$('magento_block_ebay_template_shipping_form_data_calculated-wrapper').show();var dimensionsTr=$('dimensions_tr');var dimensionSelect=$('dimension_mode');if(dimensionsTr){dimensionsTr.hide();dimensionSelect.selectedIndex=0;jQuery(dimensionSelect).trigger('change');}\nvar packageSizeTr=$('package_size_tr');var packageSizeSelect=$('package_size');if(packageSizeTr){packageSizeTr.hide();packageSizeSelect.selectedIndex=0;jQuery(packageSizeSelect).trigger('change');}\nvar weightTr=$('weight_tr');var weightSelect=$('weight');if(weightTr){weightTr.show();$('weight_mode_none').show();jQuery(weightSelect).trigger('change');}},setClickAndCollectPackageBlockState:function()\n{$('magento_block_ebay_template_shipping_form_data_calculated-wrapper').show();var dimensionsTr=$('dimensions_tr');var dimensionSelect=$('dimension_mode');if(dimensionsTr){dimensionsTr.show();jQuery(dimensionSelect).trigger('change');}\nvar packageSizeTr=$('package_size_tr');var packageSizeSelect=$('package_size');if(packageSizeTr){packageSizeTr.hide();packageSizeSelect.selectedIndex=0;jQuery(packageSizeSelect).trigger('change');}\nvar weightTr=$('weight_tr');var weightSelect=$('weight');if(weightTr){weightTr.show();$('weight_mode_none').show();jQuery(weightSelect).trigger('change');}},setNonePackageBlockState:function()\n{$('magento_block_ebay_template_shipping_form_data_calculated-wrapper').hide();var dimensionsTr=$('dimensions_tr');var dimensionSelect=$('dimension_mode');if(dimensionsTr){dimensionSelect.selectedIndex=0;jQuery(dimensionSelect).trigger('change');}\nvar weightTr=$('weight_tr');var weightSelect=$('weight');if(weightTr){weightSelect.selectedIndex=0;jQuery(weightSelect).trigger('change');}},checkMessages:function(type)\n{if(typeof EbayListingTemplateSwitcherObj=='undefined'){return;}\nvar container,excludeTable,data,formElements=Form.getElements('template_shipping_data_container');if(type=='local'){container='shipping_local_table_messages';excludeTable=$('shipping_international_table');formElements=formElements.map(function(element){if(element.up('table')==excludeTable){return false;}\nreturn element;}).filter(function(el){return el;});data=Form.serializeElements(formElements);}else if(type=='international'){container='shipping_international_table_messages';excludeTable=$('shipping_local_table');formElements=formElements.map(function(element){if(element.up('table')==excludeTable){return false;}\nreturn element;}).filter(function(el){return el;});data=Form.serializeElements(formElements);}else{return;}\nvar id='',nick=M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Manager::TEMPLATE_SHIPPING'),storeId=EbayListingTemplateSwitcherObj.storeId,marketplaceId=EbayListingTemplateSwitcherObj.marketplaceId,checkAttributesAvailability=false,callback=function(){var refresh=$(container).down('a.refresh-messages');if(refresh){refresh.observe('click',function(){this.checkMessages();}.bind(this))}}.bind(this);TemplateHandlerObj.checkMessages(id,nick,data,storeId,marketplaceId,checkAttributesAvailability,container,callback);},clearMessages:function(type)\n{if(typeof EbayListingTemplateSwitcherObj=='undefined'){return;}\nvar container=type=='local'?'shipping_local_table_messages':'shipping_international_table_messages';$(container).innerHTML='';}});});","Ess_M2ePro/js/Ebay/Template/Synchronization.min.js":"define(['M2ePro/Common','Magento_Ui/js/modal/confirm'],function(){window.EbayTemplateSynchronization=Class.create(Common,{initialize:function()\n{var self=this;jQuery.validator.addMethod('M2ePro-validate-qty',function(value,el){if(self.isElementHiddenFromPage(el)){return true;}\nif(value.match(/[^\\d]+/g)||value<=0){return false;}\nreturn true;},M2ePro.translator.translate('Wrong value. Only integer numbers.'));jQuery.validator.addMethod('M2ePro-validate-conditions-between',function(value,el){var minValue=$(el.id.replace('_max','')).value;if(!el.up('.admin__field').visible()){return true;}\nreturn parseInt(value)>parseInt(minValue);},M2ePro.translator.translate('Must be greater than \"Min\".'));jQuery.validator.addMethod('M2ePro-validate-stop-relist-conditions-product-status',function(value,el){if(EbayTemplateSynchronizationObj.isRelistModeDisabled()){return true;}\nif($('stop_status_disabled').value==1&&$('relist_status_enabled').value==0){return false;}\nreturn true;},M2ePro.translator.translate('Inconsistent Settings in Relist and Stop Rules.'));jQuery.validator.addMethod('M2ePro-validate-stop-relist-conditions-stock-availability',function(value,el){if(EbayTemplateSynchronizationObj.isRelistModeDisabled()){return true;}\nif($('stop_out_off_stock').value==1&&$('relist_is_in_stock').value==0){return false;}\nreturn true;},M2ePro.translator.translate('Inconsistent Settings in Relist and Stop Rules.'));jQuery.validator.addMethod('M2ePro-validate-stop-relist-conditions-item-qty',function(value,el){if(EbayTemplateSynchronizationObj.isRelistModeDisabled()){return true;}\nvar stopMaxQty=0,relistMinQty=0;var qtyType=el.getAttribute('qty_type');switch(parseInt($('stop_qty_'+qtyType).value)){case M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Synchronization::STOP_QTY_NONE'):return true;break;case M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Synchronization::STOP_QTY_LESS'):stopMaxQty=parseInt($('stop_qty_'+qtyType+'_value').value);break;case M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Synchronization::STOP_QTY_BETWEEN'):stopMaxQty=parseInt($('stop_qty_'+qtyType+'_value_max').value);break;}\nswitch(parseInt($('relist_qty_'+qtyType).value)){case M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Synchronization::RELIST_QTY_NONE'):return false;break;case M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Synchronization::RELIST_QTY_MORE'):case M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Synchronization::RELIST_QTY_BETWEEN'):relistMinQty=parseInt($('relist_qty_'+qtyType+'_value').value);break;}\nif(relistMinQty<=stopMaxQty){return false;}\nreturn true;},M2ePro.translator.translate('Inconsistent Settings in Relist and Stop Rules.'));jQuery.validator.addMethod('M2ePro-validate-schedule-interval-date',function(value,el){if(!el.up('tr').visible()){return true;}\nreturn el.value.match('^[0-9]{4}-[0-9]{2}-[0-9]{1,2}$');},M2ePro.translator.translate('Wrong value.'));jQuery.validator.addMethod('M2ePro-validate-schedule-week-days',function(value,el){var countOfCheckedDays=0;if(!EbayTemplateSynchronizationObj.isScheduleModeEnabled()){return true;}\n$$('.schedule_week_day_mode').each(function(el){el.checked&&countOfCheckedDays++;});return countOfCheckedDays>0;},M2ePro.translator.translate('You need to choose at set at least one time for the schedule to run.'));jQuery.validator.addMethod('M2ePro-validate-selected-schedule-time',function(value,el){var countUnselectedControls=0;if(!EbayTemplateSynchronizationObj.isScheduleModeEnabled()){return true;}\nif(!el.up('tr').select('.schedule_week_day_mode').shift().checked){return true;}\nel.up('td').select('select').each(function(el){el.value==''&&countUnselectedControls++;});return countUnselectedControls==0;},M2ePro.translator.translate('You should specify time.'));jQuery.validator.addMethod('M2ePro-validate-schedule-wrong-interval-date',function(value,el){if(!el.up('tr').visible()){return true;}\nvar fromDate=new Date($('schedule_interval_date_from').value),toDate=new Date(value);return(toDate-fromDate)>=0;},M2ePro.translator.translate('Must be greater than \"Active From\" Date.'));jQuery.validator.addMethod('M2ePro-validate-schedule-wrong-interval-time',function(value,el){if(!EbayTemplateSynchronizationObj.isScheduleModeEnabled()){return true;}\nif(!el.up('tr').select('.schedule_week_day_mode').shift().checked){return true;}\nvar now=new Date(),fromTime=new Date(now.toDateString()+' '+$(el.id.replace('validator_to','from')).value),toTime=new Date(now.toDateString()+' '+$(el.id.replace('validator_to','to')).value);return(toTime-fromTime)>0;},M2ePro.translator.translate('Must be greater than \"From Time\".'));},initObservers:function()\n{$('list_mode').observe('change',EbayTemplateSynchronizationObj.listMode_change).simulate('change');$('list_qty_magento').observe('change',EbayTemplateSynchronizationObj.listQty_change).simulate('change');$('list_qty_calculated').observe('change',EbayTemplateSynchronizationObj.listQty_change).simulate('change');$('list_advanced_rules_mode').observe('change',EbayTemplateSynchronizationObj.listAdvancedRules_change).simulate('change');$('relist_mode').observe('change',EbayTemplateSynchronizationObj.relistMode_change).simulate('change');$('relist_qty_magento').observe('change',EbayTemplateSynchronizationObj.relistQty_change).simulate('change');$('relist_qty_calculated').observe('change',EbayTemplateSynchronizationObj.relistQty_change).simulate('change');$('relist_advanced_rules_mode').observe('change',EbayTemplateSynchronizationObj.relistAdvancedRules_change).simulate('change');$('revise_update_qty').observe('change',EbayTemplateSynchronizationObj.reviseQty_change).simulate('change');$('revise_update_qty_max_applied_value_mode').observe('change',EbayTemplateSynchronizationObj.reviseQtyMaxAppliedValueMode_change).simulate('change');$('revise_update_price').observe('change',EbayTemplateSynchronizationObj.revisePrice_change).simulate('change');$('revise_update_price_max_allowed_deviation_mode').observe('change',EbayTemplateSynchronizationObj.revisePriceMaxAllowedDeviationMode_change).simulate('change');$('stop_qty_magento').observe('change',EbayTemplateSynchronizationObj.stopQty_change).simulate('change');$('stop_qty_calculated').observe('change',EbayTemplateSynchronizationObj.stopQty_change).simulate('change');$('stop_advanced_rules_mode').observe('change',EbayTemplateSynchronizationObj.stopAdvancedRules_change).simulate('change');},isRelistModeDisabled:function()\n{return $('relist_mode').value==0;},isScheduleModeEnabled:function()\n{return $('schedule_mode').value==1;},listMode_change:function()\n{var rulesContainer=$('magento_block_ebay_template_synchronization_form_data_list_rules'),advancedRulesContainer=$('magento_block_ebay_template_synchronization_list_advanced_filters');rulesContainer.hide();advancedRulesContainer.hide();if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Synchronization::LIST_MODE_YES')){rulesContainer.show();advancedRulesContainer.show();}},listQty_change:function()\n{var qtyType=this.getAttribute('qty_type');var valueContainer=$('list_qty_'+qtyType+'_value_container'),valueMaxContainer=$('list_qty_'+qtyType+'_value_max_container'),item=valueContainer.select('label span')[0];valueContainer.hide();valueMaxContainer.hide();if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Synchronization::LIST_QTY_LESS')||this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Synchronization::LIST_QTY_MORE')){item.innerHTML=M2ePro.translator.translate('Quantity');valueContainer.show();}\nif(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Synchronization::LIST_QTY_BETWEEN')){item.innerHTML=M2ePro.translator.translate('Min Quantity');valueContainer.show();valueMaxContainer.show();}},listAdvancedRules_change:function()\n{var rulesContainer=$('list_advanced_rules_filters_container'),warningContainer=$('list_advanced_rules_filters_warning');rulesContainer.hide();warningContainer.hide();if(this.value==1){rulesContainer.show();warningContainer.show();}},reviseQty_change:function()\n{if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Synchronization::REVISE_UPDATE_QTY_YES')){$('revise_update_qty_max_applied_value_mode_tr').show();$('revise_update_qty_max_applied_value_line_tr').show();$('revise_update_qty_max_applied_value_mode').simulate('change');}else{$('revise_update_qty_max_applied_value_mode_tr').hide();$('revise_update_qty_max_applied_value_line_tr').hide();$('revise_update_qty_max_applied_value_tr').hide();$('revise_update_qty_max_applied_value_mode').value=M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Synchronization::REVISE_MAX_AFFECTED_QTY_MODE_OFF');}},reviseQtyMaxAppliedValueMode_change:function(event)\n{var self=EbayTemplateSynchronizationObj;$('revise_update_qty_max_applied_value_tr').hide();if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Synchronization::REVISE_MAX_AFFECTED_QTY_MODE_ON')){$('revise_update_qty_max_applied_value_tr').show();}else if(!event.cancelable){self.openReviseMaxAppliedQtyDisableConfirmationPopUp();}},openReviseMaxAppliedQtyDisableConfirmationPopUp:function()\n{var self=this;var element=jQuery('#revise_qty_max_applied_value_confirmation_popup_template').clone();element.confirm({title:M2ePro.translator.translate('Are you sure?'),actions:{confirm:self.reviseQtyMaxAppliedValueDisableConfirm,cancel:self.reviseQtyMaxAppliedValueDisableCancel},buttons:[{text:M2ePro.translator.translate('Cancel'),class:'action-secondary action-dismiss',click:function(event){this.closeModal(event);}},{text:M2ePro.translator.translate('Confirm'),class:'action-primary action-accept',click:function(event){this.closeModal(event,true);}}]});},reviseQtyMaxAppliedValueDisableCancel:function()\n{$('revise_update_qty_max_applied_value_mode').selectedIndex=1;$('revise_update_qty_max_applied_value_mode').simulate('change');},reviseQtyMaxAppliedValueDisableConfirm:function()\n{$('revise_update_qty_max_applied_value_mode').selectedIndex=0;$('revise_update_qty_max_applied_value_mode').simulate('change');},revisePrice_change:function()\n{if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Synchronization::REVISE_UPDATE_PRICE_YES')){$('revise_update_price_max_allowed_deviation_mode_tr').show();$('revise_update_price_max_allowed_deviation_tr').show();$('revise_update_price_line').show();$('revise_update_price_max_allowed_deviation_mode').simulate('change');}else{$('revise_update_price_max_allowed_deviation_mode_tr').hide();$('revise_update_price_max_allowed_deviation_tr').hide();$('revise_update_price_line').hide();$('revise_update_price_max_allowed_deviation_mode').value=M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Synchronization::REVISE_MAX_ALLOWED_PRICE_DEVIATION_MODE_OFF');}},revisePriceMaxAllowedDeviationMode_change:function(event)\n{var self=EbayTemplateSynchronizationObj;$('revise_update_price_max_allowed_deviation_tr').hide();if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Synchronization::REVISE_MAX_ALLOWED_PRICE_DEVIATION_MODE_ON')){$('revise_update_price_max_allowed_deviation_tr').show();}else if(!event.cancelable){self.openReviseMaxAllowedDeviationPriceDisableConfirmationPopUp();}},openReviseMaxAllowedDeviationPriceDisableConfirmationPopUp:function()\n{var self=this;var element=jQuery('#revise_price_max_max_allowed_deviation_confirmation_popup_template').clone();element.confirm({title:M2ePro.translator.translate('Are you sure?'),actions:{confirm:self.revisePriceMaxAllowedDeviationDisableConfirm,cancel:self.revisePriceMaxAllowedDeviationDisableCancel},buttons:[{text:M2ePro.translator.translate('Cancel'),class:'action-secondary action-dismiss',click:function(event){this.closeModal(event);}},{text:M2ePro.translator.translate('Confirm'),class:'action-primary action-accept',click:function(event){this.closeModal(event,true);}}]});},revisePriceMaxAllowedDeviationDisableCancel:function()\n{$('revise_update_price_max_allowed_deviation_mode').selectedIndex=1;$('revise_update_price_max_allowed_deviation_mode').simulate('change');},revisePriceMaxAllowedDeviationDisableConfirm:function()\n{$('revise_update_price_max_allowed_deviation_mode').selectedIndex=0;$('revise_update_price_max_allowed_deviation_mode').simulate('change');},relistMode_change:function()\n{var rulesContainer=$('magento_block_ebay_template_synchronization_form_data_relist_rules'),advancedRulesContainer=$('magento_block_ebay_template_synchronization_relist_advanced_filters'),userLockContainer=$('relist_filter_user_lock_tr_container'),sendDataContainer=$('relist_send_data_tr_container');userLockContainer.hide();sendDataContainer.hide();rulesContainer.hide();advancedRulesContainer.hide();if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Synchronization::RELIST_MODE_YES')){userLockContainer.show();sendDataContainer.show();rulesContainer.show();advancedRulesContainer.show();}},relistQty_change:function()\n{var qtyType=this.getAttribute('qty_type');var valueContainer=$('relist_qty_'+qtyType+'_value_container'),valueMaxContainer=$('relist_qty_'+qtyType+'_value_max_container'),item=valueContainer.select('label span')[0];valueContainer.hide();valueMaxContainer.hide();if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Synchronization::RELIST_QTY_LESS')||this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Synchronization::RELIST_QTY_MORE')){item.innerHTML=M2ePro.translator.translate('Quantity');valueContainer.show();}\nif(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Synchronization::RELIST_QTY_BETWEEN')){item.innerHTML=M2ePro.translator.translate('Min Quantity');valueContainer.show();valueMaxContainer.show();}},relistAdvancedRules_change:function()\n{var rulesContainer=$('relist_advanced_rules_filters_container'),warningContainer=$('relist_advanced_rules_filters_warning');rulesContainer.hide();warningContainer.hide();if(this.value==1){rulesContainer.show();warningContainer.show();}},stopQty_change:function()\n{var qtyType=this.getAttribute('qty_type');var valueContainer=$('stop_qty_'+qtyType+'_value_container'),valueMaxContainer=$('stop_qty_'+qtyType+'_value_max_container'),item=valueContainer.select('label span')[0];valueContainer.hide();valueMaxContainer.hide();if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Synchronization::STOP_QTY_LESS')||this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Synchronization::STOP_QTY_MORE')){item.innerHTML=M2ePro.translator.translate('Quantity');valueContainer.show();}\nif(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Synchronization::STOP_QTY_BETWEEN')){item.innerHTML=M2ePro.translator.translate('Min Quantity');valueContainer.show();valueMaxContainer.show();}},stopAdvancedRules_change:function()\n{var rulesContainer=$('stop_advanced_rules_filters_container'),warningContainer=$('stop_advanced_rules_filters_warning');rulesContainer.hide();warningContainer.hide();if(this.value==1){rulesContainer.show();warningContainer.show();}},scheduleModeChange:function()\n{$('schedule_interval_mode_tr','schedule_interval_value_tr','magento_block_ebay_template_synchronization_form_data_schedule_week').invoke('hide');if(this.value==1){$('schedule_interval_mode_tr','magento_block_ebay_template_synchronization_form_data_schedule_week').invoke('show');$('schedule_interval_mode').simulate('change');}},scheduleIntervalModeChange:function()\n{var valueTr=$('schedule_interval_value_tr');valueTr.hide();if(EbayTemplateSynchronizationObj.isScheduleModeEnabled()&&this.value==1){valueTr.show();}},scheduleDayModeChange:function()\n{var containerFrom=$(this.id.replace('mode','')+'container_from'),containerTo=$(this.id.replace('mode','')+'container_to');containerFrom.hide();containerTo.hide();if(this.checked){containerFrom.show();containerTo.show();}},scheduleTimeSelectChange:function()\n{var inputId=this.id.match('(.)*(?=_)')[0];var hours=$(inputId+'_hours').value,minutes=$(inputId+'_minutes').value,ampm=$(inputId+'_ampm').value;$(inputId).value=hours+':'+minutes+' '+ampm;}});});","Ess_M2ePro/js/Ebay/Template/ReturnPolicy.min.js":"define(['knockout','jquery','M2ePro/Common'],function(ko,jquery){window.EbayTemplateReturnPolicy=Class.create(Common,{initialize:function(){},initObservers:function(){jquery('#return_accepted').off('change');jquery('#return_accepted').on('change',this.acceptedChange).change();},acceptedChange:function()\n{var columns=['return_option','return_within','return_shipping_cost','return_restocking_fee'];if(this.value=='ReturnsAccepted'){columns.forEach(function(value){var el=$$('.field-'+value).first();el&&el[$(value).options.length?'show':'hide']();});$$('.field-return_description').invoke('show');if($$('.field-return_holiday_mode').length){$$('.field-return_holiday_mode').invoke('show');}}else{columns.forEach(function(value){var el=$$('.field-'+value).first();el&&el.hide();});$$('.field-return_description').invoke('hide');$$('.field-return_holiday').invoke('hide');$$('.field-return_holiday_mode').invoke('hide');}}});});","Ess_M2ePro/js/Ebay/Template/SellingFormat.min.js":"define(['Magento_Ui/js/modal/modal','M2ePro/Common'],function(modal){window.EbayTemplateSellingFormat=Class.create(Common,{charityIndex:0,charityTpl:'',initialize:function()\n{var self=this;jQuery.validator.addMethod('M2ePro-validate-price-coefficient',function(value,el){var tempEl=el;if(self.isElementHiddenFromPage(el)){return true;}\nvar coefficient=el.up().next().down('input');coefficient.removeClassName('price_unvalidated');if(!coefficient.up('div').visible()){return true;}\nif(coefficient.value==''){return false;}\nvar floatValidator=Validation.get('M2ePro-validation-float');if(floatValidator.test($F(coefficient),coefficient)&&parseFloat(coefficient.value)<=0){coefficient.addClassName('price_unvalidated');return false;}\nreturn true;},M2ePro.translator.translate('Price Change is not valid.'));jQuery.validator.addMethod('M2ePro-validate-qty',function(value,el){if(self.isElementHiddenFromPage(el)){return true;}\nif(value.match(/[^\\d]+/g)||value<=0){return false;}\nreturn true;},M2ePro.translator.translate('Wrong value. Only integer numbers.'));jQuery.validator.addMethod('M2ePro-validate-vat',function(value){if(!value){return true;}\nif(value.length>6){return false;}\nif(value<0){return false;}\nvalue=Math.ceil(value);return value>=0&&value<=30;},M2ePro.translator.translate('wrong_value_more_than_30'));jQuery.validator.addMethod('M2ePro-validation-charity-percentage',function(value,element){if(value==0){return false;}\nreturn true;},M2ePro.translator.translate('Please select a percentage of donation'));if($('charity_row_template')){this.charityTpl=$('charity_row_template').down('tbody').innerHTML;$('charity_row_template').remove();}},initObservers:function()\n{$('listing_type').observe('change',EbayTemplateSellingFormatObj.listing_type_change).simulate('change');$('duration_mode').observe('change',EbayTemplateSellingFormatObj.duration_mode_change).simulate('change');$('duration_attribute').observe('change',EbayTemplateSellingFormatObj.duration_attribute_change).simulate('change');$('qty_mode').observe('change',EbayTemplateSellingFormatObj.qty_mode_change).simulate('change');$('qty_modification_mode').observe('change',EbayTemplateSellingFormatObj.qtyPostedMode_change).simulate('change');if($('tax_category_mode')){$('tax_category_mode').observe('change',EbayTemplateSellingFormatObj.taxCategoryChange).simulate('change');}\n$('fixed_price_mode').observe('change',EbayTemplateSellingFormatObj.fixed_price_mode_change).simulate('change');$('start_price_mode').observe('change',EbayTemplateSellingFormatObj.start_price_mode_change).simulate('change');$('reserve_price_mode').observe('change',EbayTemplateSellingFormatObj.reserve_price_mode_change).simulate('change');$('buyitnow_price_mode').observe('change',EbayTemplateSellingFormatObj.buyitnow_price_mode_change).simulate('change');$('price_discount_stp_mode').observe('change',EbayTemplateSellingFormatObj.price_discount_stp_mode_change).simulate('change');$('price_discount_map_mode').observe('change',EbayTemplateSellingFormatObj.price_discount_map_mode_change).simulate('change');$$('.price_coefficient_mode').each(function(element){element.observe('change',EbayTemplateSellingFormatObj.price_coefficient_mode_change).simulate('change');});$('best_offer_mode').observe('change',EbayTemplateSellingFormatObj.best_offer_mode_change).simulate('change');$('best_offer_accept_mode').observe('change',EbayTemplateSellingFormatObj.best_offer_accept_mode_change).simulate('change');$('best_offer_reject_mode').observe('change',EbayTemplateSellingFormatObj.best_offer_reject_mode_change).simulate('change');EbayTemplateSellingFormatObj.checkPriceMessages();$('fixed_price_mode','start_price_mode','reserve_price_mode','buyitnow_price_mode','price_discount_stp_mode','price_discount_map_mode').invoke('observe','change',function(){EbayTemplateSellingFormatObj.checkPriceMessages();});EbayTemplateSellingFormatObj.checkBestOfferMessages();$('best_offer_accept_mode','best_offer_reject_mode').invoke('observe','change',function(){EbayTemplateSellingFormatObj.checkBestOfferMessages();});},isStpAvailable:function(){return M2ePro.formData.isStpEnabled;},isMapAvailable:function(){return M2ePro.formData.isMapEnabled;},isStpAdvancedAvailable:function(){return M2ePro.formData.isStpAdvancedEnabled;},listing_type_change:function(event){var self=EbayTemplateSellingFormatObj,bestOfferBlock=$('magento_block_ebay_template_selling_format_edit_form_best_offer-wrapper'),bestOfferMode=$('best_offer_mode'),attributeElement=$('listing_type_attribute');$('fixed_price_tr','start_price_tr','reserve_price_tr','buyitnow_price_tr').invoke('show');if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::LISTING_TYPE_FIXED')){$('start_price_tr','reserve_price_tr','buyitnow_price_tr').invoke('hide');$$('#variation_price_tr .value').invoke('show');}\nattributeElement.innerHTML='';if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::LISTING_TYPE_ATTRIBUTE')){self.selectMagentoAttribute(this,attributeElement);}\nbestOfferBlock.show();if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::LISTING_TYPE_AUCTION')){$('fixed_price_tr').hide();bestOfferBlock.hide();bestOfferMode.value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::BEST_OFFER_MODE_NO');bestOfferMode.simulate('change');}\nself.updateQtyMode();self.updateQtyPercentage();self.updateIgnoreVariations();self.updateListingDuration();self.updateFixedPrice();self.updatePriceDiscountStpVisibility();self.updatePriceDiscountMapVisibility();self.updateVariationPriceTrVisibility();},duration_mode_change:function(){var outOfStockControlTr=$('out_of_stock_control_tr'),outOfStockControlMode=$('out_of_stock_control_mode');outOfStockControlTr.hide();if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Helper\\\\Component\\\\Ebay::LISTING_DURATION_GTC')){outOfStockControlTr.show();outOfStockControlMode.value=M2ePro.formData.outOfStockControl;}else{outOfStockControlMode.value=0;}},duration_attribute_change:function(){EbayTemplateSellingFormatObj.updateHiddenValue(this,$('listing_duration_attribute_value'));},updateQtyMode:function(){var qtyMode=$('qty_mode'),qtyModeTr=$('qty_mode_tr');qtyModeTr.show();if($('listing_type').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::LISTING_TYPE_AUCTION')){qtyMode.value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Template\\\\SellingFormat::QTY_MODE_SINGLE');qtyMode.simulate('change');qtyModeTr.hide();}},updateQtyPercentage:function(){var qtyPercentageTr=$('qty_percentage_tr');qtyPercentageTr.hide();if($('listing_type').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::LISTING_TYPE_AUCTION')){return;}\nvar qtyMode=$('qty_mode').value;if(qtyMode==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Template\\\\SellingFormat::QTY_MODE_SINGLE')||qtyMode==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Template\\\\SellingFormat::QTY_MODE_NUMBER')){return;}\nqtyPercentageTr.show();},updateIgnoreVariations:function(){var ignoreVariationsValueTr=$('ignore_variations_value_tr'),ignoreVariationsValue=$('ignore_variations_value');ignoreVariationsValueTr.hide();if($('listing_type').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::LISTING_TYPE_AUCTION')){ignoreVariationsValue.value=0;}else{ignoreVariationsValueTr.show();}},updateListingDuration:function(){var durationMode=$('duration_mode_container'),durationModeValue=$('duration_mode'),durationAttribute=$('duration_attribute_container'),durationAttributeNote=$('duration_attribute_note');var outOfStockControlTr=$('out_of_stock_control_tr'),outOfStockControlMode=$('out_of_stock_control_mode');$('durationId1','durationId30','durationId100').invoke('show');durationMode.show();durationAttribute.hide();durationAttributeNote.hide();if($('listing_type').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::LISTING_TYPE_FIXED')){durationModeValue.value=3;$('durationId1').hide();if(M2ePro.formData.duration_mode&&M2ePro.formData.duration_mode!=1){durationModeValue.value=M2ePro.formData.duration_mode;}\ndurationModeValue.simulate('change');}\nif($('listing_type').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::LISTING_TYPE_AUCTION')){durationModeValue.value=3;$('durationId30','durationId100').invoke('hide');if(M2ePro.formData.duration_mode&&M2ePro.formData.duration_mode!=30&&M2ePro.formData.duration_mode!=100){durationModeValue.value=M2ePro.formData.duration_mode;}\noutOfStockControlTr.hide();outOfStockControlMode.value=0;}\nif($('listing_type').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::LISTING_TYPE_ATTRIBUTE')){durationMode.hide();durationAttribute.show();durationAttributeNote.show();outOfStockControlTr.hide();outOfStockControlMode.value=0;}},updateVariationPriceTrVisibility:function(){var removeBottomBorderTds=$$('#fixed_price_tr td.remove_bottom_border'),addRowspanTds=$$('#fixed_price_tr td.add_rowspan'),priceModeSelect=$('fixed_price_mode'),variationPriceTr=$('variation_price_tr');variationPriceTr.hide();removeBottomBorderTds.invoke('removeClassName','bottom_border_disabled');addRowspanTds.invoke('removeAttribute','rowspan');if($('listing_type').value!=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::LISTING_TYPE_AUCTION')){variationPriceTr.show();addRowspanTds.invoke('setAttribute','rowspan','2');if(priceModeSelect.value!=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Template\\\\SellingFormat::PRICE_MODE_NONE')){removeBottomBorderTds.invoke('addClassName','bottom_border_disabled');}}},updateFixedPrice:function(){var priceLabel=$('fixed_price_label'),bestOfferAcceptPercentageOption=$('best_offer_accept_percentage_option'),bestOfferRejectPercentageOption=$('best_offer_reject_percentage_option');priceLabel.innerHTML=M2ePro.translator.translate('Fixed Price')+': ';bestOfferAcceptPercentageOption.innerHTML=M2ePro.translator.translate('% of Fixed Price');bestOfferRejectPercentageOption.innerHTML=M2ePro.translator.translate('% of Fixed Price');if($('listing_type').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::LISTING_TYPE_FIXED')){priceLabel.innerHTML=M2ePro.translator.translate('Price')+': ';bestOfferAcceptPercentageOption.innerHTML=M2ePro.translator.translate('% of Price');bestOfferRejectPercentageOption.innerHTML=M2ePro.translator.translate('% of Price');}},updatePriceDiscountStpVisibility:function(){var priceDiscTrStp=$('price_discount_stp_tr'),priceDiscStpMode=$('price_discount_stp_mode');priceDiscTrStp.hide();if(EbayTemplateSellingFormatObj.isStpAvailable()){priceDiscTrStp.show();}\nif($('listing_type').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::LISTING_TYPE_AUCTION')){priceDiscTrStp.hide();priceDiscStpMode.value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Template\\\\SellingFormat::PRICE_MODE_NONE');priceDiscStpMode.simulate('change');}},updatePriceDiscountMapVisibility:function(){var priceDiscTrMap=$('price_discount_map_tr'),priceDiscMapMode=$('price_discount_map_mode');priceDiscTrMap.hide();if(EbayTemplateSellingFormatObj.isMapAvailable()){priceDiscTrMap.show();}\nif($('listing_type').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::LISTING_TYPE_AUCTION')){priceDiscTrMap.hide();priceDiscMapMode.value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Template\\\\SellingFormat::PRICE_MODE_NONE');priceDiscMapMode.simulate('change');}},qty_mode_change:function(){var self=EbayTemplateSellingFormatObj,customValueTr=$('qty_mode_cv_tr'),attributeElement=$('qty_custom_attribute'),maxPostedValueTr=$('qty_modification_mode_tr'),maxPostedValueMode=$('qty_modification_mode');customValueTr.hide();attributeElement.value='';if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Template\\\\SellingFormat::QTY_MODE_NUMBER')){customValueTr.show();}else if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Template\\\\SellingFormat::QTY_MODE_ATTRIBUTE')){self.selectMagentoAttribute(this,attributeElement);}\nmaxPostedValueTr.hide();maxPostedValueMode.value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::QTY_MODIFICATION_MODE_OFF');if(self.isMaxPostedQtyAvailable(this.value)){maxPostedValueTr.show();maxPostedValueMode.value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::QTY_MODIFICATION_MODE_ON');if(self.isMaxPostedQtyAvailable(M2ePro.formData.qty_mode)){maxPostedValueMode.value=M2ePro.formData.qty_modification_mode;}}\nmaxPostedValueMode.simulate('change');self.updateQtyPercentage();},isMaxPostedQtyAvailable:function(qtyMode){return qtyMode==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Template\\\\SellingFormat::QTY_MODE_PRODUCT')||qtyMode==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Template\\\\SellingFormat::QTY_MODE_ATTRIBUTE')||qtyMode==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Template\\\\SellingFormat::QTY_MODE_PRODUCT_FIXED');},qtyPostedMode_change:function(){var minPosterValueTr=$('qty_min_posted_value_tr'),maxPosterValueTr=$('qty_max_posted_value_tr');minPosterValueTr.hide();maxPosterValueTr.hide();if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::QTY_MODIFICATION_MODE_ON')){minPosterValueTr.show();maxPosterValueTr.show();}},taxCategoryChange:function(){var self=EbayTemplateSellingFormatObj,valueEl=$('tax_category_value'),attributeEl=$('tax_category_attribute');valueEl.value='';attributeEl.value='';if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::TAX_CATEGORY_MODE_VALUE')){self.updateHiddenValue(this,valueEl);}\nif(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::TAX_CATEGORY_MODE_ATTRIBUTE')){self.updateHiddenValue(this,attributeEl);}},fixed_price_mode_change:function(){var self=EbayTemplateSellingFormatObj,listingType=$('listing_type'),currencyTd=$('fixed_price_currency_td'),attributeElement=$('fixed_price_custom_attribute'),priceChangeTd=$('fixed_price_change_td'),priceChangeTds=$$('#fixed_price_tr td.remove_bottom_border'),variationPriceSelect=$$('#variation_price_tr .value');variationPriceSelect.invoke('hide');priceChangeTds.invoke('removeClassName','bottom_border_disabled');priceChangeTd.hide();currencyTd&&currencyTd.hide();if(this.value!=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Template\\\\SellingFormat::PRICE_MODE_NONE')){priceChangeTd.show();currencyTd&&currencyTd.show();variationPriceSelect.invoke('show');if(listingType.value!=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::LISTING_TYPE_AUCTION')){priceChangeTds.invoke('addClassName','bottom_border_disabled');}}\nattributeElement.value='';if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Template\\\\SellingFormat::PRICE_MODE_ATTRIBUTE')){self.selectMagentoAttribute(this,attributeElement);}},start_price_mode_change:function(){var self=EbayTemplateSellingFormatObj,attributeElement=$('start_price_custom_attribute');attributeElement.value='';if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Template\\\\SellingFormat::PRICE_MODE_ATTRIBUTE')){self.selectMagentoAttribute(this,attributeElement);}},reserve_price_mode_change:function(){var self=EbayTemplateSellingFormatObj,attributeElement=$('reserve_price_custom_attribute'),priceChangeTd=$('reserve_price_change_td'),currencyTd=$('reserve_price_currency_td');priceChangeTd.hide();currencyTd&&currencyTd.hide();if(this.value!=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Template\\\\SellingFormat::PRICE_MODE_NONE')){priceChangeTd.show();currencyTd&&currencyTd.show();}\nattributeElement.value='';if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Template\\\\SellingFormat::PRICE_MODE_ATTRIBUTE')){self.selectMagentoAttribute(this,attributeElement);}},buyitnow_price_mode_change:function(){var self=EbayTemplateSellingFormatObj,attributeElement=$('buyitnow_price_custom_attribute'),priceChangeTd=$('buyitnow_price_change_td'),currencyTd=$('buyitnow_price_currency_td');priceChangeTd.hide();currencyTd&&currencyTd.hide();if(this.value!=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Template\\\\SellingFormat::PRICE_MODE_NONE')){priceChangeTd.show();currencyTd&&currencyTd.show();}\nattributeElement.value='';if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Template\\\\SellingFormat::PRICE_MODE_ATTRIBUTE')){self.selectMagentoAttribute(this,attributeElement);}},price_coefficient_mode_change:function(){var coefficientInputDiv=$(this.id.replace('mode','')+'input_div'),signSpan=$(this.id.replace('mode','')+'sign_span'),percentSpan=$(this.id.replace('mode','')+'percent_span'),examplesContainer=$(this.id.replace('coefficient_mode','')+'example_container');coefficientInputDiv.show();examplesContainer.show();if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::PRICE_COEFFICIENT_NONE')){coefficientInputDiv.hide();examplesContainer.hide();}\nsignSpan.innerHTML='';percentSpan.innerHTML='';$$('.'+this.id.replace('coefficient_mode','')+'example').invoke('hide');if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::PRICE_COEFFICIENT_ABSOLUTE_INCREASE')){signSpan.innerHTML='+';if(typeof M2ePro.formData.currency!='undefined'){percentSpan.innerHTML=M2ePro.formData.currency;}\n$(this.id.replace('coefficient_mode','')+'example_absolute_increase').show();}\nif(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::PRICE_COEFFICIENT_ABSOLUTE_DECREASE')){signSpan.innerHTML='-';if(typeof M2ePro.formData.currency!='undefined'){percentSpan.innerHTML=M2ePro.formData.currency;}\n$(this.id.replace('coefficient_mode','')+'example_absolute_decrease').show();}\nif(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::PRICE_COEFFICIENT_PERCENTAGE_INCREASE')){signSpan.innerHTML='+';percentSpan.innerHTML='%';$(this.id.replace('coefficient_mode','')+'example_percentage_increase').show();}\nif(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::PRICE_COEFFICIENT_PERCENTAGE_DECREASE')){signSpan.innerHTML='-';percentSpan.innerHTML='%';$(this.id.replace('coefficient_mode','')+'example_percentage_decrease').show();}},price_discount_stp_mode_change:function(){var attributeElement=$('price_discount_stp_attribute'),priceDiscountStpTds=$$('#price_discount_stp_tr td.remove_bottom_border'),priceDiscountStpReasonTr=$('price_discount_stp_reason_tr'),currencyTd=$('price_discount_stp_currency_td');priceDiscountStpReasonTr.hide();currencyTd&&currencyTd.hide();priceDiscountStpTds.invoke('removeClassName','bottom_border_disabled');if(this.value!=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Template\\\\SellingFormat::PRICE_MODE_NONE')){currencyTd&&currencyTd.show();if(EbayTemplateSellingFormatObj.isStpAdvancedAvailable()){priceDiscountStpReasonTr.show();priceDiscountStpTds.invoke('addClassName','bottom_border_disabled');}}\nattributeElement.value='';if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Template\\\\SellingFormat::PRICE_MODE_ATTRIBUTE')){EbayTemplateSellingFormatObj.selectMagentoAttribute(this,attributeElement);}},price_discount_map_mode_change:function(){var attributeElement=$('price_discount_map_attribute'),priceDiscountMapExposureTr=$('price_discount_map_exposure_tr'),currencyTd=$('price_discount_map_currency_td');priceDiscountMapExposureTr.hide();currencyTd&&currencyTd.hide();if(this.value!=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Template\\\\SellingFormat::PRICE_MODE_NONE')){currencyTd&&currencyTd.show();if(EbayTemplateSellingFormatObj.isMapAvailable()){priceDiscountMapExposureTr.show();}}\nattributeElement.value='';if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Template\\\\SellingFormat::PRICE_MODE_ATTRIBUTE')){EbayTemplateSellingFormatObj.selectMagentoAttribute(this,attributeElement);}},best_offer_mode_change:function(){var bestOfferRespondTable=$$('.best_offer_respond_table_container');bestOfferRespondTable.invoke('hide');if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::BEST_OFFER_MODE_YES')){bestOfferRespondTable.invoke('show');$('best_offer_reject_mode','best_offer_accept_mode').invoke('simulate','change');}else{$('template_selling_format_messages_best_offer').innerHTML='';}},best_offer_accept_mode_change:function(){var self=EbayTemplateSellingFormatObj,bestOfferAcceptValueTr=$('best_offer_accept_value_tr'),attributeElement=$('best_offer_accept_custom_attribute');bestOfferAcceptValueTr.hide();if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::BEST_OFFER_ACCEPT_MODE_PERCENTAGE')){bestOfferAcceptValueTr.show();}\nattributeElement.value='';if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::BEST_OFFER_ACCEPT_MODE_ATTRIBUTE')){self.selectMagentoAttribute(this,attributeElement);}},best_offer_reject_mode_change:function(){var self=EbayTemplateSellingFormatObj,bestOfferRejectValueTr=$('best_offer_reject_value_tr'),attributeElement=$('best_offer_reject_custom_attribute');bestOfferRejectValueTr.hide();if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::BEST_OFFER_REJECT_MODE_PERCENTAGE')){bestOfferRejectValueTr.show();}\nattributeElement.value='';if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Ebay\\\\Template\\\\SellingFormat::BEST_OFFER_REJECT_MODE_ATTRIBUTE')){self.selectMagentoAttribute(this,attributeElement);}},selectMagentoAttribute:function(elementSelect,elementAttribute){var attributeCode=elementSelect.options[elementSelect.selectedIndex].getAttribute('attribute_code');elementAttribute.value=attributeCode;},checkBestOfferMessages:function()\n{var formElements=$(\"best_offer_mode\",\"best_offer_accept_mode\",\"best_offer_accept_custom_attribute\",\"best_offer_reject_mode\",\"best_offer_reject_custom_attribute\");var isVisible=$$('.best_offer_respond_table_container').first().visible();if(!isVisible){return false;}\nthis.checkMessages(Form.serializeElements(formElements),'template_selling_format_messages_best_offer')},checkPriceMessages:function()\n{var formElements=Form.getElements('template_selling_format_data_container'),excludedElements=$(\"best_offer_mode\",\"best_offer_accept_mode\",\"best_offer_accept_custom_attribute\",\"best_offer_reject_mode\",\"best_offer_reject_custom_attribute\");formElements=formElements.filter(function(element){return excludedElements.indexOf(element)<0;});if(formElements.length===0){return false;}\nthis.checkMessages(Form.serializeElements(formElements),'template_selling_format_messages');},checkMessages:function(data,container)\n{if(typeof EbayListingTemplateSwitcherObj=='undefined'){return;}\nvar id='',nick=M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Manager::TEMPLATE_SELLING_FORMAT'),storeId=EbayListingTemplateSwitcherObj.storeId,marketplaceId=EbayListingTemplateSwitcherObj.marketplaceId,checkAttributesAvailability=EbayListingTemplateSwitcherObj.checkAttributesAvailability,callback=function(){var refresh=$(container).down('a.refresh-messages');if(refresh){refresh.observe('click',function(){this.checkMessages(data,container);}.bind(this))}}.bind(this);TemplateHandlerObj.checkMessages(id,nick,data,storeId,marketplaceId,checkAttributesAvailability,container,callback);},renderCharities:function(data){var self=this;$H(data).each(function(charity){self.addCharityRow(charity.value);});},addCharityRow:function(charityData){var self=this;$('charity_not_set_table').hide();$('charity_table').show();charityData=charityData||{};this.charityIndex++;var tpl=this.charityTpl;tpl=tpl.replace(/%i%/g,this.charityIndex);$('charity_table_tbody').insert(tpl);var row=$('charity_row_'+this.charityIndex+'_tr');row.show();var marketplaceEl=row.down('.charity-marketplace_id');if($('charity_table_tbody').select('tr').length===(marketplaceEl.select('option').length-1)){$$('.add_charity_button').each(function(el){el.hide();});}\nif(charityData.marketplace_id){marketplaceEl.value=charityData.marketplace_id;self.charityMarketplaceChange.call(self,marketplaceEl,charityData);}else{self.hideSelectedMarketplaceOptions();}},removeCharityRow:function(el){el.up('.charity-row').remove();if($('charity_table_tbody').select('tr').length==0){$('charity_not_set_table').show();$('charity_table').hide();}\n$$('.add_charity_button').each(function(el){el.show();});},charityMarketplaceChange:function(marketplaceEl,charityData){var self=this,organizationEl=marketplaceEl.up('.charity-row').down('.charity-organization'),percentageEl=organizationEl.up('.charity-row').down('.charity-percentage');charityData=charityData||{};self.hideSelectedMarketplaceOptions();percentageEl.value='';if(marketplaceEl.value==''){organizationEl.value='';organizationEl.simulate('change');organizationEl.disable().hide();return;}\norganizationEl.update().enable().show();var option=new Element('option',{class:'empty',value:''});organizationEl.insert({bottom:option});option=new Element('option',{class:'searchNewCharity',value:''});option.innerHTML=M2ePro.translator.translate('Search for Charity Organization');organizationEl.insert({bottom:option});if(charityData.organization_id&&charityData.organization_custom==0){charityData.organization_custom=1;self.charityDictionary[marketplaceEl.value].charities.each(function(charity){if(charityData.organization_id==charity.id){charityData.organization_custom=0;}});}\nif(charityData.organization_custom){var customOptgroup=new Element('optgroup',{label:'Custom',class:'customCharity'}).insert({bottom:new Element('option',{value:charityData.organization_id,class:'newCharity'}).update(charityData.organization_name)});organizationEl.insert(customOptgroup);organizationEl.up('.charity-row').select('input.organization_custom')[0].value=charityData.organization_custom;}\nif(self.charityDictionary[marketplaceEl.value].charities.length>0){var optgroup=new Element('optgroup',{label:'Featured',class:'featuredCharity'});self.charityDictionary[marketplaceEl.value].charities.each(function(charity){var option=new Element('option',{value:charity.id});option.innerHTML=charity.name;optgroup.insert(option);});organizationEl.insert(optgroup);}\nif(charityData.organization_id){organizationEl.value=charityData.organization_id;self.charityOrganizationChange.call(self,organizationEl,charityData);}},charityOrganizationChange:function(organizationEl,charityData){var self=this,percentageEl=organizationEl.up('.charity-row').down('.charity-percentage'),marketplaceEl=organizationEl.up('.charity-row').down('.charity-marketplace_id');if(organizationEl[organizationEl.selectedIndex].hasClassName('searchNewCharity')){self.openPopUpCharity(organizationEl,marketplaceEl.value);if(typeof self.charitySelectedHistory!='undefined'){organizationEl.selectedIndex=self.charitySelectedHistory;}\nreturn;}\nvar optgroup=organizationEl[organizationEl.selectedIndex].up('optgroup')\nif(optgroup&&optgroup.hasClassName('customCharity')){organizationEl.up('.charity-row').select('input.organization_custom')[0].value=1;}else{organizationEl.up('.charity-row').select('input.organization_custom')[0].value=0;}\nself.charitySelectedHistory=organizationEl.selectedIndex;organizationEl.up('.charity-row').select('input.organization_name')[0].value=organizationEl[organizationEl.selectedIndex].innerHTML;charityData=charityData||{};if(organizationEl.value==''){percentageEl.value='';percentageEl.simulate('change');percentageEl.disable().hide();return;}\npercentageEl.update().enable().show();var option=new Element('option',{class:'empty',value:''});percentageEl.insert({bottom:option});if(marketplaceEl.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Helper\\\\Component\\\\Ebay::MARKETPLACE_MOTORS')){option=new Element('option',{value:1});option.innerHTML='1%';percentageEl.insert({bottom:option});option=new Element('option',{value:5});option.innerHTML='5%';percentageEl.insert({bottom:option});}\nfor(var i=2;i<21;i++){option=new Element('option',{value:i*5});option.innerHTML=i*5+'%';percentageEl.insert({bottom:option});}\nif(charityData.percentage){percentageEl.value=charityData.percentage;}},charityOrganizationCustomModeChange:function(organizationEl,charityData){var self=this,percentageEl=organizationEl.up('.charity-row').down('.charity-percentage'),marketplaceEl=organizationEl.up('.charity-row').down('.charity-marketplace_id');if(organizationEl[organizationEl.selectedIndex].hasClassName('searchNewCharity')){self.openPopUpCharity(organizationEl,marketplaceEl.value);if(typeof self.charitySelectedHistory!='undefined'){organizationEl.selectedIndex=self.charitySelectedHistory;}\nreturn;}\nvar optgroup=organizationEl[organizationEl.selectedIndex].up('optgroup')\nif(optgroup&&optgroup.hasClassName('customCharity')){organizationEl.up('.charity-row').select('input.organization_custom')[0].value=1;}else{organizationEl.up('.charity-row').select('input.organization_custom')[0].value=0;}\nself.charitySelectedHistory=organizationEl.selectedIndex;organizationEl.up('.charity-row').select('input.organization_name')[0].value=organizationEl[organizationEl.selectedIndex].innerHTML;if(organizationEl.value==''){$('charity_percentage').hide();}else{$('charity_percentage').show();}\npercentageEl.value='';},hideSelectedMarketplaceOptions:function()\n{var charityTBody=$('charity_table_tbody');charityTBody.select('select.charity-marketplace_id option').each(function(option){option.show();});charityTBody.select('select.charity-marketplace_id').each(function(select){charityTBody.select('select.charity-marketplace_id option[value=\"'+select.value+'\"]').each(function(option){option.hide();});select[select.selectedIndex].show();});},openPopUpCharity:function(organizationEl,marketplaceId){var self=this;new Ajax.Request(M2ePro.url.get('ebay_template_sellingFormat/getSearchCharityPopUpHtml'),{method:'post',parameters:{marketplace_id:marketplaceId},onSuccess:function(transport){var container=$('charitySearch_pop_up_content');if(container){container.remove();}\n$('html-body').insert({bottom:transport.responseText});self.charitySearchPopup=jQuery('#charitySearch_pop_up_content');modal({title:M2ePro.translator.translate('Search For Charities'),type:'slide',buttons:[]},self.charitySearchPopup);self.charitySearchPopup.modal('openModal');self.charitySearchPopup.organizationEl=organizationEl;$('query').observe('keypress',function(event){event.keyCode==Event.KEY_RETURN&&self.searchCharity();});$('searchCharity_reset').observe('click',function(event){$('query').value='';$('selectCharitySearch').selectedIndex='';$('searchCharity_grid').hide();$('searchCharity_warning_block').hide();})}});},searchCharity:function(){var query=$('query').value;var destination=$('selectCharitySearch').value;var marketplaceId=$('charitySearch_marketplace_id').value;if(query==''){$('query').focus();this.alert(M2ePro.translator.translate('Please, enter the organization name or ID.'));return;}\n$('searchCharity_grid').hide();$('searchCharity_error_block').hide();$('searchCharity_warning_block').hide();new Ajax.Request(M2ePro.url.get('ebay_template_sellingFormat/searchCharity'),{method:'post',parameters:{query:query,destination:destination,marketplace_id:marketplaceId},onSuccess:function(transport){transport=transport.responseText.evalJSON();if(transport.result=='success'){$('searchCharity_grid').update(transport.html).show();if(transport.count){$('searchCharity_warning_block').show();}}else{$('searchCharity_error_block').update(transport.html);$('searchCharity_error_block').show();}}})},selectNewCharity:function(id,name){var self=this;self.confirm({actions:{confirm:function(){var customCharities=self.charitySearchPopup.organizationEl.select('option.newCharity');if(customCharities.length>0){customCharities[0].update(name);customCharities[0].value=id;}else{var optgroups=self.charitySearchPopup.organizationEl.select('optgroup.customCharity');if(optgroups.length>0){optgroups[0].insert({bottom:new Element('option',{value:id,class:'newCharity'}).update(name)});}else{var optgroup=new Element('optgroup',{label:'Custom',class:'customCharity'}).insert({bottom:new Element('option',{value:id,class:'newCharity'}).update(name)});var featuresGroups=self.charitySearchPopup.organizationEl.select('optgroup.featuredCharity');if(featuresGroups.length>0){featuresGroups[0].insert({before:optgroup});}else{self.charitySearchPopup.organizationEl.insert(optgroup);}}}\nself.charitySearchPopup.organizationEl.value=id;self.charitySearchPopup.organizationEl.up('.charity-row').select('input.organization_custom')[0].value=1;self.charitySearchPopup.organizationEl.simulate('change');self.charitySearchPopup.modal('closeModal');},cancel:function(){return false;}}});}});});","Ess_M2ePro/js/Ebay/Template/Payment.min.js":"define(['jquery','M2ePro/Common'],function(jQuery){window.EbayTemplatePayment=Class.create(Common,{initialize:function()\n{jQuery.validator.addMethod('M2ePro-validate-payment-methods',function(value){if($('pay_pal_mode').checked){return true;}\nreturn $$('input[name=\"payment[services][]\"]').any(function(o){return o.checked;});},M2ePro.translator.translate('Payment method should be specified.'));jQuery.validator.addMethod('M2ePro-validate-ebay-payment-email',function(value,el){var advice=Validation.getAdvice('M2ePro-validate-ebay-payment-email',el);advice&&advice.remove();if(!Validation.get('M2ePro-required-when-visible').test(value,el)){this.error=Validation.get('M2ePro-required-when-visible').error;return false;}\nthis.error=Validation.get('validate-email').error;return Validation.get('validate-email').test(value,el);},M2ePro.translator.translate('Email is not valid.'));},initObservers:function()\n{jQuery('#pay_pal_mode').on('change',EbayTemplatePaymentObj.payPalModeChange).trigger('change');jQuery('#pay_pal_immediate_payment').on('change',EbayTemplatePaymentObj.immediatePaymentChange).trigger('change');},payPalModeChange:function()\n{if(this.checked){$('pay_pal_email_address_container').show();$('pay_pal_immediate_payment_container').show();}else{$('pay_pal_email_address').setValue('');$('pay_pal_email_address_container').hide();$('pay_pal_immediate_payment_container').hide();$('pay_pal_immediate_payment').checked=false;jQuery('#pay_pal_immediate_payment').trigger('change');}},immediatePaymentChange:function()\n{var wrapper=$('magento_block_ebay_template_payment_form_data_additional_service');if(this.checked){wrapper.hide();$$('input.additional-payment-service').each(function(payment){payment.checked=false;});}else{wrapper&&wrapper.show();}}});});","Ess_M2ePro/js/Ebay/Template/Description.min.js":"define(['Magento_Ui/js/modal/modal','M2ePro/Common','mage/adminhtml/wysiwyg/tiny_mce/setup'],function(){window.EbayTemplateDescription=Class.create(Common,{initialize:function()\n{jQuery.validator.addMethod('M2ePro-validate-description-template',function(value,el){if($('description_mode').value!=M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::DESCRIPTION_MODE_CUSTOM')){return true;}\nreturn Validation.get('required-entry').test(value,el);},M2ePro.translator.translate('This is a required field.'));jQuery.validator.addMethod('M2ePro-validate-condition-note-length',function(value){if($('condition_note_mode').value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::CONDITION_NOTE_MODE_NONE')){return true;}\nreturn value.length<=1000;},M2ePro.translator.translate('Seller Notes must be less then 1000 symbols.'));jQuery.validator.addMethod('M2ePro-validate-magento-product-id',function(value){var isValidMagentoProductId=false;new Ajax.Request(M2ePro.url.get('ebay_template_description/checkMagentoProductId'),{method:'post',asynchronous:false,parameters:{product_id:value},onSuccess:function(transport){var response=transport.responseText.evalJSON();isValidMagentoProductId=response.result;}});return isValidMagentoProductId;},M2ePro.translator.translate('Please enter a valid Magento product ID.'));},initObservers:function()\n{$('title_mode').observe('change',EbayTemplateDescriptionObj.title_mode_change).simulate('change');$('subtitle_mode').observe('change',EbayTemplateDescriptionObj.subtitle_mode_change).simulate('change');$('item_condition').observe('change',EbayTemplateDescriptionObj.item_condition_change).simulate('change');$('condition_note_mode').observe('change',EbayTemplateDescriptionObj.condition_note_mode_change).simulate('change');$('watermark_scale').observe('change',EbayTemplateDescriptionObj.watermark_scale_mode_change).simulate('change');$('watermark_mode').observe('change',EbayTemplateDescriptionObj.watermark_mode_change).simulate('change');$('description_mode').observe('change',EbayTemplateDescriptionObj.description_mode_change).simulate('change');$('description_template_show_hide_wysiwyg').observe('click',wysiwygdescription_template.toggle.bind(wysiwygdescription_template)).observe('click',EbayTemplateDescriptionObj.showHideWYSIWYG);$('image_main').observe('change',EbayTemplateDescriptionObj.image_main_change).simulate('change');$('gallery_images').observe('change',EbayTemplateDescriptionObj.gallery_images_change).simulate('change');$('variation_images').observe('change',EbayTemplateDescriptionObj.variation_images_change).simulate('change');$('product_details_ean','product_details_upc','product_details_epid','product_details_isbn').each(function(element){element.observe('change',EbayTemplateDescriptionObj.product_details_specification_visibility_change).simulate('change');});$('product_details_brand').observe('change',EbayTemplateDescriptionObj.product_details_brand_change).simulate('change');$('product_details_mpn').observe('change',EbayTemplateDescriptionObj.product_details_mpn_change);$('custom_inserts_open_popup').observe('click',EbayTemplateDescriptionObj.customInsertsOpenPopup);this.initCustomInsertsPopup();this.initPreviewPopup();},initWYSIWYG:function()\n{tinymce.dom.Event._pageInit();},duplicateClick:function(headId,chapter_when_duplicate_text,templateNick)\n{var watermarkImageContainer=$('watermark_uploaded_image_container');if(watermarkImageContainer){watermarkImageContainer.remove();$('watermark_image').addClassName('M2ePro-required-when-visible');$('watermark_image_container').addClassName('_required');}\nEbayTemplateEditObj.duplicateClick(headId,chapter_when_duplicate_text,templateNick);},title_mode_change:function()\n{var self=EbayTemplateDescriptionObj;self.setTextVisibilityMode(this,'custom_title_tr');},subtitle_mode_change:function()\n{var self=EbayTemplateDescriptionObj;self.setTextVisibilityMode(this,'custom_subtitle_tr');},description_mode_change:function()\n{var self=EbayTemplateDescriptionObj;var viewEditCustomDescription=$('view_edit_custom_description');if(viewEditCustomDescription){viewEditCustomDescription.hide();}\n$$('.c-custom_description_tr').invoke('hide');if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::DESCRIPTION_MODE_CUSTOM')){if(viewEditCustomDescription){viewEditCustomDescription.show();$$('.c-custom_description_tr').invoke('hide');return;}\nif(typeof wysiwygdescription_template!=='undefined'&&$('description_editor_type').value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::EDITOR_TYPE_SIMPLE')){wysiwygdescription_template.turnOff();}\n$$('.c-custom_description_tr').invoke('show');}else{if(viewEditCustomDescription){viewEditCustomDescription.remove();}}},view_edit_custom_change:function()\n{if(typeof wysiwygdescription_template!=='undefined'&&$('description_editor_type').value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::EDITOR_TYPE_SIMPLE')){wysiwygdescription_template.turnOff();}\n$$('.c-custom_description_tr').invoke('show');$('view_edit_custom_description').hide();},item_condition_change:function()\n{$('condition_note_tr').show();$('condition_note_mode').simulate('change');var self=EbayTemplateDescriptionObj,isConditionNoteNeeded=true,conditionValue=$('condition_value'),conditionAttribute=$('condition_attribute');if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::CONDITION_MODE_NONE')){isConditionNoteNeeded=false;}else if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::CONDITION_MODE_EBAY')){self.updateHiddenValue(this,conditionValue);conditionAttribute.value='';isConditionNoteNeeded=conditionValue.value!=M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::CONDITION_EBAY_NEW');}else{self.updateHiddenValue(this,conditionAttribute);conditionValue.value='';}\nif(!isConditionNoteNeeded){$('condition_note_mode').value=M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::CONDITION_NOTE_MODE_NONE');$('condition_note_mode').simulate('change');$('condition_note_tr').hide();$('custom_condition_note_tr').hide();}},condition_note_mode_change:function()\n{var self=EbayTemplateDescriptionObj;if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::CONDITION_NOTE_MODE_NONE')){$('condition_note_template').update('');}\nself.setTextVisibilityMode(this,'custom_condition_note_tr');self.setTextVisibilityMode(this,'custom_condition_note_attributes_tr');},watermark_mode_change:function()\n{var self=EbayTemplateDescriptionObj;self.setTextVisibilityMode(this,'watermark_image_container');if($('watermark_uploaded_image_container')){self.setTextVisibilityMode(this,'watermark_uploaded_image_container');}\nif($('watermark_scale').value!=M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::WATERMARK_SCALE_MODE_STRETCH')){self.setTextVisibilityMode(this,'watermark_position_container');}\nself.setTextVisibilityMode(this,'watermark_scale_container');self.setTextVisibilityMode(this,'watermark_transparent_container');},watermark_scale_mode_change:function()\n{var self=EbayTemplateDescriptionObj;$('watermark_position_container').show();if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::WATERMARK_SCALE_MODE_STRETCH')){$('watermark_position_container').hide();}},setTextVisibilityMode:function(obj,elementName)\n{var elementObj=$(elementName);if(!elementObj){return;}\nelementObj.hide();if(obj.value==1){elementObj.show();}},image_main_change:function()\n{var self=EbayTemplateDescriptionObj;$('gallery_images_mode_tr','variation_images_mode_tr','use_supersize_images_tr','default_image_url_tr','watermark_block').invoke('show');if($$('#variation_configurable_images option').length>1){$('variation_configurable_images_container').show();}\nif(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::IMAGE_MAIN_MODE_ATTRIBUTE')){self.updateHiddenValue(this,$('image_main_attribute'));}else{$('image_main_attribute').value='';}\nif(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::IMAGE_MAIN_MODE_NONE')){$('gallery_images_mode_tr','variation_images_mode_tr','variation_configurable_images_container','use_supersize_images_tr','default_image_url_tr').invoke('hide');$('use_supersize_images').value=0;$('gallery_images').value=0;$('gallery_images').simulate('change');$('variation_configurable_images').value='';$('variation_images').value=1;$('variation_images_limit').value=1;$('variation_images').simulate('change');$('default_image_url').value='';$('watermark_block').hide();var watermarkMode=$('watermark_mode');if(watermarkMode.selectedIndex!=0){watermarkMode.selectedIndex=0;watermarkMode.simulate('change');}}},gallery_images_change:function()\n{var self=EbayTemplateDescriptionObj;$('gallery_images_limit').value='';$('gallery_images_attribute').value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::GALLERY_IMAGES_MODE_PRODUCT')){self.updateHiddenValue(this,$('gallery_images_limit'));}else if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::GALLERY_IMAGES_MODE_ATTRIBUTE')){self.updateHiddenValue(this,$('gallery_images_attribute'));}},variation_images_change:function()\n{var self=EbayTemplateDescriptionObj;$('variation_images_limit').value='';$('variation_images_attribute').value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::VARIATION_IMAGES_MODE_PRODUCT')){self.updateHiddenValue(this,$('variation_images_limit'));}else if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::VARIATION_IMAGES_MODE_ATTRIBUTE')){self.updateHiddenValue(this,$('variation_images_attribute'));}},image_width_mode_change:function()\n{$('image_width_span')[this.value==1?'show':'hide']();},image_height_mode_change:function()\n{$('image_height_span')[this.value==1?'show':'hide']();},image_margin_mode_change:function()\n{$('image_margin_span')[this.value==1?'show':'hide']();},select_attributes_image_change:function()\n{$$('.all-products-images').invoke(this.value=='media_gallery'?'show':'hide');$$('.all-products-image').invoke(this.value=='image'?'show':'hide');if(this.value=='image'){$('display_products_images').value='custom_settings';}\n$('display_products_images').simulate('change');},display_products_images_change:function()\n{$$('.products-images-custom-settings').invoke('hide');$$('.products-images-gallery-view').invoke('hide');if(this.value=='gallery_view'){$$('.products-images-gallery-view').invoke('show');}else{$$('.products-images-custom-settings').invoke('show');}\njQuery('.products-images-mode-change-label').each(function(index,elem){jQuery(elem).find('.label span').text(jQuery(elem).find('.'+this.value).text());}.bind(this));},product_details_specification_visibility_change:function()\n{var self=EbayTemplateDescriptionObj,modeNone=M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::PRODUCT_DETAILS_MODE_NONE'),modeDoesNotApply=M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::PRODUCT_DETAILS_MODE_DOES_NOT_APPLY');var isNotAttributeMode=function(element){return element.value==modeNone||element.value==modeDoesNotApply;};if($('product_details_ean','product_details_upc','product_details_isbn','product_details_brand').every(isNotAttributeMode)&&$('product_details_epid').value==modeNone){$('product_details_specification_separator').hide();$$('.product-details-specification').each(function(element){element.hide();element.down('.select').down().selectedIndex=1;});}else{$('product_details_specification_separator').show();var hiddenElement=$(this.id+'_attribute');if(!hiddenElement){return;}\n$$('.product-details-specification').invoke('show');self.updateHiddenValue(this,hiddenElement);}},product_details_brand_change:function()\n{var self=EbayTemplateDescriptionObj;if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::PRODUCT_DETAILS_MODE_NONE')||this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::PRODUCT_DETAILS_MODE_DOES_NOT_APPLY')){$('product_details_mpn_tr').hide();$('product_details_mpn').selectedIndex=0;}else{$('product_details_mpn_tr').show();$$('.product-details-specification').invoke('show');self.updateHiddenValue(this,$(this.id+'_attribute'));}\nself.product_details_specification_visibility_change();},product_details_mpn_change:function()\n{var self=EbayTemplateDescriptionObj;if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::PRODUCT_DETAILS_MODE_ATTRIBUTE')){self.updateHiddenValue(this,$(this.id+'_attribute'));}},showHideWYSIWYG:function()\n{var label;if($('description_template').visible()){label=M2ePro.translator.translate('Show Editor');$('description_editor_type').value=M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::EDITOR_TYPE_SIMPLE');}else{label=M2ePro.translator.translate('Hide Editor');$('description_editor_type').value=M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::EDITOR_TYPE_TINYMCE');}\nthis.select('span').first().update(label);},initCustomInsertsPopup:function()\n{var popup=jQuery('#custom_inserts_popup');if(!popup.find('form').length){popup.wrapInner('<form id=\"description_custom_inserts_form\"></form>');CommonObj.initFormValidation('#description_custom_inserts_form');}\npopup.modal({title:M2ePro.translator.translate('Custom Insertions'),type:'slide',buttons:[],closed:function(){EbayTemplateDescriptionObj.customInsertsOnClosePopup();}});},customInsertsOpenPopup:function()\n{jQuery('#custom_inserts_popup').modal('openModal');EbayTemplateDescriptionObj.observeImageAttributes();},customInsertsOnClosePopup:function()\n{jQuery('#description_custom_inserts_form').trigger('reset').validate().resetForm();EbayTemplateDescriptionObj.stopObservingImageAttributes();},customInsertsClosePopup:function(callback)\n{jQuery('#custom_inserts_popup').modal({closed:function(){callback&&callback();callback=undefined;EbayTemplateDescriptionObj.customInsertsOnClosePopup();}}).modal('closeModal');},insertProductAttribute:function()\n{this.customInsertsClosePopup(function(){AttributeObj.appendToTextarea('#'+$('custom_inserts_product_attribute').value+'#');});},insertM2eProAttribute:function()\n{this.customInsertsClosePopup(function(){AttributeObj.appendToTextarea('#value['+$('custom_inserts_m2epro_attribute').value+']#');});},insertGallery:function()\n{if(!jQuery('#description_custom_inserts_form').valid()){return;}\nvar template='#'+$('select_attributes_image').value;if($('image_width_mode').value=='1'){template+='['+$('image_width').value+',';}else{template+='[,';}\nif($('image_height_mode').value=='1'){template+=''+$('image_height').value+',';}else{template+=',';}\nif($('image_margin_mode').value=='1'){template+=''+$('image_margin').value+',';}else{template+=',';}\nif($('select_attributes_image').value=='media_gallery'&&$('display_products_images').value=='gallery_view'){template+='2';}else if($('image_linked_mode').value=='1'){template+='1';}else{template+=\"0\";}\nif($('select_attributes_image').value=='media_gallery'){template+=','+$('select_attributes_image_layout').value+','+$('select_attributes_image_count').value;}\nif($('select_attributes_image').value=='media_gallery'&&$('display_products_images').value=='gallery_view'){template+=',\"'+$('gallery_hint_text').value+'\"';}else if($('select_attributes_image').value=='media_gallery'){template+=',\"\"';}\nif($('image_insertion_watermark_mode').value=='1'){template+=',1';}else{template+=',';}\nif($('select_attributes_image').value=='image'){template+=','+$('select_attributes_image_order_position').value;}\ntemplate+=']#';this.customInsertsClosePopup(function(){AttributeObj.appendToTextarea(template);});},observeImageAttributes:function()\n{$('image_width_mode').observe('change',EbayTemplateDescriptionObj.image_width_mode_change).simulate('change');$('image_height_mode').observe('change',EbayTemplateDescriptionObj.image_height_mode_change).simulate('change');$('image_margin_mode').observe('change',EbayTemplateDescriptionObj.image_margin_mode_change).simulate('change');$('select_attributes_image').observe('change',EbayTemplateDescriptionObj.select_attributes_image_change).simulate('change');$('display_products_images').observe('change',EbayTemplateDescriptionObj.display_products_images_change).simulate('change');if($('watermark_mode').value==1){this.setTextVisibilityMode($('watermark_mode'),'products_images_watermark_mode');$('image_insertion_watermark_mode').selectedIndex=1;}else{this.setTextVisibilityMode($('watermark_mode'),'products_images_watermark_mode');$('image_insertion_watermark_mode').selectedIndex=0;}},stopObservingImageAttributes:function()\n{$('image_width_mode').stopObserving();$('image_height_mode').stopObserving();$('image_margin_mode').stopObserving();$('select_attributes_image').stopObserving();},saveWatermarkImage:function(callback,params)\n{var form=$('edit_form');form.action=M2ePro.url.get('ebay_template_description/saveWatermarkImage');form.target='watermark_image_frame';if($('watermark_image_frame')===null){document.body.appendChild(new Element('iframe',{id:'watermark_image_frame',name:'watermark_image_frame',style:'display: none'}));}\n$('watermark_image_frame').observe('load',function(){if(typeof callback=='function'){callback(params);}});form.submit();},initPreviewPopup:function()\n{var popup=jQuery('#description_preview_popup');if(!popup.find('form').length){popup.wrapInner(new Element('form',{id:'description_preview_form',method:'post',target:'_blank',action:M2ePro.url.get('ebay_template_description/preview')}));this.initFormValidation('#description_preview_form');}\npopup.modal({title:M2ePro.translator.translate('Description Preview'),type:'popup',buttons:[{text:M2ePro.translator.translate('Cancel'),class:'action-secondary action-dismiss',click:function(event){this.closeModal(event);}},{text:M2ePro.translator.translate('Confirm'),class:'action-primary action-accept',click:function(event){if(!jQuery('#description_preview_form').valid()){return;}\n$('description_preview_description_mode').value=$('description_mode').value;$('description_preview_description_template').value=$('description_template').value;$('description_preview_watermark_mode').value=$('watermark_mode').value;$('description_preview_form').submit();this.closeModal(event);}}],closed:function(){jQuery('#description_preview_form').trigger('reset').validate().resetForm();}});},openPreviewPopup:function()\n{if($('description_mode').value==M2ePro.php.constant('Ess_M2ePro_Model_Ebay_Template_Description::DESCRIPTION_MODE_CUSTOM')&&!$('description_template').value.length){this.alert(M2ePro.translator.translate('Please enter Description Value.'));return;}\njQuery('#description_preview_popup').modal('openModal');},selectProductIdRandomly:function()\n{var self=this;new Ajax.Request(M2ePro.url.get('ebay_template_description/getRandomMagentoProductId'),{method:'post',parameters:{store_id:$('description_preview_store_id').value},onSuccess:function(transport){var response=transport.responseText.evalJSON();if(response.success){$('description_preview_magento_product_id').value=response.product_id;}else{self.alert(response.message);}}});}});});","Ess_M2ePro/js/Ebay/Template/Edit/Form.min.js":"define(['jquery','M2ePro/Template/Edit'],function(jQuery){window.EbayTemplateEdit=Class.create(TemplateEdit,{templateNick:null,initialize:function()\n{jQuery.validator.addMethod('validate-title-uniqueness',function(value){var unique=false;var templateId=0;if($(EbayTemplateEditObj.templateNick+'_id')){templateId=$(EbayTemplateEditObj.templateNick+'_id').value;}\nnew Ajax.Request(M2ePro.url.get('ebay_template/isTitleUnique'),{method:'post',asynchronous:false,parameters:{id_value:templateId,title:value},onSuccess:function(transport)\n{unique=transport.responseText.evalJSON()['unique'];}});return unique;},M2ePro.translator.translate('Policy Title is not unique.'));},initObservers:function()\n{var $marketplace=jQuery('#marketplace_id');if($marketplace.length){$marketplace.on('change',this.loadTemplateData).trigger('change');}else{this.loadTemplateData(null);}},getComponent:function()\n{return'ebay';},loadTemplateData:function(marketplaceId,callback)\n{if(typeof this.value!='undefined'&&this.value===''){return;}\nvar self=EbayTemplateEditObj;marketplaceId=this.value||marketplaceId;new Ajax.Request(M2ePro.url.get('ebay_template/getTemplateHtml'),{method:'get',asynchronous:true,parameters:{marketplace_id:marketplaceId},onSuccess:function(transport){var editFormData=$('edit_form_data');if(!editFormData){editFormData=document.createElement('div');editFormData.id='edit_form_data';$('edit_form').appendChild(editFormData);}\neditFormData.innerHTML=transport.responseText;editFormData.innerHTML.extractScripts().map(function(script){try{eval(script);}catch(e){}});var titleInput=$$('input[name=\"'+self.templateNick+'[title]\"]')[0];var marketplaceIdInput=$$('input[name=\"'+self.templateNick+'[marketplace_id]\"]')[0];if($('title').value.trim()==''){$('title').value=titleInput.value;}\nif(marketplaceIdInput){marketplaceIdInput.value=marketplaceId;}\ncallback&&callback();}});},isValidForm:function()\n{var validationResult=true;validationResult&=jQuery('#edit_form').valid();validationResult&=Validation.validate($('title'));if($('marketplace_id')){validationResult&=Validation.validate($('marketplace_id'));}\nif($('ebay_template_synchronization_edit_form_container')){}\nvar titleInput=$$('input[name=\"'+EbayTemplateEditObj.templateNick+'[title]\"]')[0];if(titleInput){titleInput.value=$('title').value;}\nreturn validationResult;},duplicateClick:function($super,headId,chapter_when_duplicate_text,templateNick)\n{$$('input[name=\"'+templateNick+'[id]\"]')[0].value='';M2ePro.url.add({'formSubmitNew':' '});$super(headId,chapter_when_duplicate_text);},saveAndCloseClick:function(url,confirmText)\n{if(!this.isValidForm()){return;}\nvar self=this;if(confirmText&&this.showConfirmMsg){this.confirm(this.templateNick,confirmText,function(){self.saveFormUsingAjax(url,self.templateNick);});return;}\nself.saveFormUsingAjax(url,self.templateNick);},saveFormUsingAjax:function(url,templateNick)\n{new Ajax.Request(url,{method:'post',parameters:Form.serialize($('edit_form')),onSuccess:function(transport){var templates=transport.responseText.evalJSON();if(templates.length&&templates[0].nick==templateNick){window.close();}else{console.error('Policy Saving Error');}}});}});});","Ess_M2ePro/js/Amazon/Account.min.js":"define(['M2ePro/Common'],function(){window.AmazonAccount=Class.create(Common,{initialize:function()\n{this.setValidationCheckRepetitionValue('M2ePro-account-title',M2ePro.translator.translate('The specified Title is already used for other Account. Account Title must be unique.'),'Account','title','id',M2ePro.formData.id,M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Helper\\\\Component\\\\Amazon::NICK'));jQuery.validator.addMethod('M2ePro-marketplace-merchant',function(value,el){if(jQuery.validator.methods['M2ePro-required-when-visible'](null,el)){return true;}\nthis.error=M2ePro.translator.translate('M2E Pro was not able to get access to the Amazon Account. Please, make sure, that you choose correct Option on MWS Authorization Page and enter correct Merchant ID.');var merchant_id=$('merchant_id').value;var token=$('token').value;var marketplace_id=$('marketplace_id').value;var pattern=/^[A-Z0-9]*$/;if(!pattern.test(merchant_id)){return false;}\nvar checkResult=false;var checkReason=null;new Ajax.Request(M2ePro.url.get('amazon_account/checkAuth'),{method:'post',asynchronous:false,parameters:{merchant_id:merchant_id,token:token,marketplace_id:marketplace_id},onSuccess:function(transport){var response=transport.responseText.evalJSON();checkResult=response['result'];checkReason=response['reason'];}});if(checkReason!=null){this.error=M2ePro.translator.translate('M2E Pro was not able to get access to the Amazon Account. Reason: %error_message%').replace('%error_message%',checkReason);}\nreturn checkResult;},M2ePro.translator.translate('M2E Pro was not able to get access to the Amazon Account. Please, make sure, that you choose correct Option on MWS Authorization Page and enter correct Merchant ID.'));jQuery.validator.addMethod('M2ePro-account-customer-id',function(value){var checkResult=false;if($('magento_orders_customer_id_container').getStyle('display')=='none'){return true;}\nnew Ajax.Request(M2ePro.url.get('general/checkCustomerId'),{method:'post',asynchronous:false,parameters:{customer_id:value,id:M2ePro.formData.id},onSuccess:function(transport){checkResult=transport.responseText.evalJSON()['ok'];}});return checkResult;},M2ePro.translator.translate('No Customer entry is found for specified ID.'));jQuery.validator.addMethod('M2ePro-account-order-number-prefix',function(value){if($('magento_orders_number_prefix_mode').value==0){return true;}\nreturn value.length<=5;},M2ePro.translator.translate('Prefix length should not be greater than 5 characters.'));jQuery.validator.addMethod('M2ePro-require-select-attribute',function(value,el){if($('other_listings_mapping_mode').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::OTHER_LISTINGS_MAPPING_MODE_NO')){return true;}\nvar isAttributeSelected=false;$$('.attribute-mode-select').forEach(function(obj){if(obj.value!=0){isAttributeSelected=true;}});return isAttributeSelected;},M2ePro.translator.translate('If Yes is chosen, you must select at least one Attribute for Product Mapping.'));jQuery.validator.addMethod('M2ePro-account-repricing-price-value',function(value,el){if(!el.up('div.admin__field.field').visible()){return true;}\nif(!value.match(/^\\d+[.]?\\d*?$/g)){return false;}\nif(value<=0){return false;}\nreturn true;},M2ePro.translator.translate('Invalid input data. Decimal value required. Example 12.05'));jQuery.validator.addMethod('M2ePro-account-repricing-price-percent',function(value,el){if(!el.up('div.admin__field.field').visible()){return true;}\nif(!value.match(/^\\d+$/g)){return false;}\nif(value<=0||value>100){return false;}\nreturn true;},M2ePro.translator.translate('Please enter correct value.'));},initObservers:function()\n{$('other_listings_synchronization').observe('change',AmazonAccountObj.other_listings_synchronization_change).simulate('change');$('other_listings_mapping_mode').observe('change',AmazonAccountObj.other_listings_mapping_mode_change).simulate('change');$('mapping_general_id_mode').observe('change',AmazonAccountObj.mapping_general_id_mode_change).simulate('change');$('mapping_sku_mode').observe('change',AmazonAccountObj.mapping_sku_mode_change).simulate('change');$('mapping_title_mode').observe('change',AmazonAccountObj.mapping_title_mode_change).simulate('change');$('other_listings_move_mode').observe('change',AmazonAccountObj.move_mode_change).simulate('change');if($('is_vat_calculation_service_enabled')){$('is_vat_calculation_service_enabled').observe('change',AmazonAccountObj.vatCalculationModeChange).simulate('change');}\n$('magento_orders_listings_mode').observe('change',AmazonAccountObj.magentoOrdersListingsModeChange).simulate('change');$('magento_orders_listings_store_mode').observe('change',AmazonAccountObj.magentoOrdersListingsStoreModeChange).simulate('change');$('magento_orders_listings_other_mode').observe('change',AmazonAccountObj.magentoOrdersListingsOtherModeChange).simulate('change');$('magento_orders_listings_other_product_mode').observe('change',AmazonAccountObj.magentoOrdersListingsOtherProductModeChange);$('magento_orders_number_source').observe('change',AmazonAccountObj.magentoOrdersNumberSourceChange).simulate('change');$('magento_orders_number_prefix_mode').observe('change',AmazonAccountObj.magentoOrdersNumberPrefixModeChange).simulate('change');$('magento_orders_number_prefix_prefix').observe('keyup',AmazonAccountObj.magentoOrdersNumberPrefixPrefixChange).simulate('change');AmazonAccountObj.renderOrderNumberExample();$('magento_orders_fba_mode').observe('change',AmazonAccountObj.magentoOrdersFbaModeChange).simulate('change');$('magento_orders_customer_mode').observe('change',AmazonAccountObj.magentoOrdersCustomerModeChange).simulate('change');$('magento_orders_status_mapping_mode').observe('change',AmazonAccountObj.magentoOrdersStatusMappingModeChange);$('order_number_example-note').previous().remove();},deleteClick:function()\n{this.confirm({content:M2ePro.translator.translate('Be attentive! By Deleting Account you delete all information on it from M2E Pro Server. This will cause inappropriate work of all Accounts\\' copies.'),actions:{confirm:function(){setLocation(M2ePro.url.get('deleteAction'));},cancel:function(){return false;}}});},getToken:function(marketplaceId){var title=$('title');title.removeClassName('required-entry M2ePro-account-title');$('merchant_id').removeClassName('M2ePro-marketplace-merchant');$('token').removeClassName('M2ePro-marketplace-merchant');$('other_listings_mapping_mode').removeClassName('M2ePro-require-select-attribute');this.submitForm(M2ePro.url.get('amazon_account/beforeGetToken',{'id':M2ePro.formData.id,'title':title.value,'marketplace_id':marketplaceId}));return false;},changeMarketplace:function(id)\n{var self=AmazonAccountObj;$$('[id^=\"marketplaces_developer_key_container_\"],[id^=\"marketplaces_register_url_container_\"]').invoke('hide');$('marketplaces_related_store_id_container').show();$('marketplaces_merchant_id_container').show();$('marketplaces_token_container').show();self.showGetAccessData(id);},showGetAccessData:function(id)\n{$('marketplaces_application_name_container').show();$('marketplaces_developer_key_container_'+id).show();$('marketplaces_register_url_container_'+id).show();},other_listings_synchronization_change:function()\n{if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::OTHER_LISTINGS_SYNCHRONIZATION_YES')){$('other_listings_mapping_mode_tr').show();$('marketplaces_related_store_id_container').show();}else{$('other_listings_mapping_mode').value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::OTHER_LISTINGS_MAPPING_MODE_NO');$('other_listings_mapping_mode').simulate('change');$('other_listings_mapping_mode_tr').hide();$('marketplaces_related_store_id_container').hide();}},other_listings_mapping_mode_change:function()\n{if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::OTHER_LISTINGS_MAPPING_MODE_YES')){$('magento_block_amazon_accounts_other_listings_product_mapping').show();$('magento_block_amazon_accounts_other_listings_move_mode').show();}else{$('magento_block_amazon_accounts_other_listings_product_mapping').hide();$('magento_block_amazon_accounts_other_listings_move_mode').hide();$('other_listings_move_mode').value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::OTHER_LISTINGS_MOVE_TO_LISTINGS_DISABLED');$('mapping_general_id_mode').value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::OTHER_LISTINGS_MAPPING_GENERAL_ID_MODE_NONE');$('mapping_sku_mode').value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::OTHER_LISTINGS_MAPPING_SKU_MODE_NONE');$('mapping_title_mode').value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::OTHER_LISTINGS_MAPPING_TITLE_MODE_NONE');}\n$('mapping_general_id_mode').simulate('change');$('mapping_sku_mode').simulate('change');$('mapping_title_mode').simulate('change');$('other_listings_move_mode').simulate('change');},mapping_general_id_mode_change:function()\n{var self=AmazonAccountObj;if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::OTHER_LISTINGS_MAPPING_GENERAL_ID_MODE_NONE')){$('mapping_general_id_priority_td').hide();}else{$('mapping_general_id_priority_td').show();}\n$('mapping_general_id_attribute').value='';if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::OTHER_LISTINGS_MAPPING_GENERAL_ID_MODE_CUSTOM_ATTRIBUTE')){self.updateHiddenValue(this,$('mapping_general_id_attribute'));}},mapping_sku_mode_change:function()\n{var self=AmazonAccountObj;if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::OTHER_LISTINGS_MAPPING_SKU_MODE_NONE')){$('mapping_sku_priority_td').hide();}else{$('mapping_sku_priority_td').show();}\n$('mapping_sku_attribute').value='';if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::OTHER_LISTINGS_MAPPING_SKU_MODE_CUSTOM_ATTRIBUTE')){self.updateHiddenValue(this,$('mapping_sku_attribute'));}},mapping_title_mode_change:function()\n{var self=AmazonAccountObj;if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::OTHER_LISTINGS_MAPPING_TITLE_MODE_NONE')){$('mapping_title_priority_td').hide();}else{$('mapping_title_priority_td').show();}\n$('mapping_title_attribute').value='';if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::OTHER_LISTINGS_MAPPING_TITLE_MODE_CUSTOM_ATTRIBUTE')){self.updateHiddenValue(this,$('mapping_title_attribute'));}},move_mode_change:function()\n{if($('other_listings_move_mode').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::OTHER_LISTINGS_MOVE_TO_LISTINGS_ENABLED')){$('other_listings_move_synch_tr').show();}else{$('other_listings_move_synch_tr').hide();}},magentoOrdersListingsModeChange:function()\n{var self=AmazonAccountObj;if($('magento_orders_listings_mode').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_LISTINGS_MODE_YES')){$('magento_orders_listings_store_mode_container').show();}else{$('magento_orders_listings_store_mode_container').hide();$('magento_orders_listings_store_mode').value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_LISTINGS_STORE_MODE_DEFAULT');}\nself.magentoOrdersListingsStoreModeChange();self.changeVisibilityForOrdersModesRelatedBlocks();},magentoOrdersListingsStoreModeChange:function()\n{if($('magento_orders_listings_store_mode').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_LISTINGS_STORE_MODE_CUSTOM')){$('magento_orders_listings_store_id_container').show();}else{$('magento_orders_listings_store_id_container').hide();$('magento_orders_listings_store_id').value='';}},magentoOrdersListingsOtherModeChange:function()\n{var self=AmazonAccountObj;if($('magento_orders_listings_other_mode').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_LISTINGS_OTHER_MODE_YES')){$('magento_orders_listings_other_product_mode_container').show();$('magento_orders_listings_other_store_id_container').show();}else{$('magento_orders_listings_other_product_mode_container').hide();$('magento_orders_listings_other_store_id_container').hide();$('magento_orders_listings_other_product_mode').value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_LISTINGS_OTHER_PRODUCT_MODE_IGNORE');$('magento_orders_listings_other_store_id').value='';}\nself.magentoOrdersListingsOtherProductModeChange();self.changeVisibilityForOrdersModesRelatedBlocks();},magentoOrdersListingsOtherProductModeChange:function()\n{if($('magento_orders_listings_other_product_mode').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_LISTINGS_OTHER_PRODUCT_MODE_IGNORE')){$('magento_orders_listings_other_product_mode_note').hide();$('magento_orders_listings_other_product_tax_class_id_container').hide();}else{$('magento_orders_listings_other_product_mode_note').show();$('magento_orders_listings_other_product_tax_class_id_container').show();}},magentoOrdersNumberSourceChange:function()\n{var self=AmazonAccountObj;self.renderOrderNumberExample();},magentoOrdersNumberPrefixModeChange:function()\n{var self=AmazonAccountObj;if($('magento_orders_number_prefix_mode').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_NUMBER_PREFIX_MODE_YES')){$('magento_orders_number_prefix_container').show();}else{$('magento_orders_number_prefix_container').hide();$('magento_orders_number_prefix_prefix').value='';}\nself.renderOrderNumberExample();},magentoOrdersNumberPrefixPrefixChange:function()\n{var self=AmazonAccountObj;self.renderOrderNumberExample();},renderOrderNumberExample:function()\n{var orderNumber=$('sample_magento_order_id').value;if($('magento_orders_number_source').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_NUMBER_SOURCE_CHANNEL')){orderNumber=$('sample_amazon_order_id').value;}\nif($('magento_orders_number_prefix_mode').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_NUMBER_PREFIX_MODE_YES')){orderNumber=$('magento_orders_number_prefix_prefix').value+orderNumber;}\n$('order_number_example_container').update(orderNumber);},magentoOrdersFbaModeChange:function()\n{if($('magento_orders_fba_mode').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_FBA_MODE_NO')){$('magento_orders_fba_stock_mode_container').hide();$('magento_orders_fba_stock_mode').value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_FBA_STOCK_MODE_NO');}else{$('magento_orders_fba_stock_mode_container').show();}},magentoOrdersCustomerModeChange:function()\n{var customerMode=$('magento_orders_customer_mode').value;if(customerMode==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_CUSTOMER_MODE_PREDEFINED')){$('magento_orders_customer_id_container').show();$('magento_orders_customer_id').addClassName('M2ePro-account-product-id');}else{$('magento_orders_customer_id_container').hide();$('magento_orders_customer_id').value='';$('magento_orders_customer_id').removeClassName('M2ePro-account-product-id');}\nvar action=(customerMode==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_CUSTOMER_MODE_NEW'))?'show':'hide';$('magento_orders_customer_new_website_id_container')[action]();$('magento_orders_customer_new_group_id_container')[action]();$('magento_orders_customer_new_notifications_container')[action]();if(action=='hide'){$('magento_orders_customer_new_website_id').value='';$('magento_orders_customer_new_group_id').value='';$('magento_orders_customer_new_notifications').value='';}},magentoOrdersStatusMappingModeChange:function()\n{$('magento_orders_status_mapping_processing').value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_STATUS_MAPPING_PROCESSING');$('magento_orders_status_mapping_shipped').value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_STATUS_MAPPING_SHIPPED');$('magento_orders_invoice_mode').checked=true;$('magento_orders_shipment_mode').checked=true;var disabled=$('magento_orders_status_mapping_mode').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_STATUS_MAPPING_MODE_DEFAULT');$('magento_orders_status_mapping_processing').disabled=disabled;$('magento_orders_status_mapping_shipped').disabled=disabled;$('magento_orders_invoice_mode').disabled=disabled;$('magento_orders_shipment_mode').disabled=disabled;},changeVisibilityForOrdersModesRelatedBlocks:function()\n{var self=AmazonAccountObj;if($('magento_orders_listings_mode').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_LISTINGS_MODE_NO')&&$('magento_orders_listings_other_mode').value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_LISTINGS_OTHER_MODE_NO')){$('magento_block_amazon_accounts_magento_orders_number-wrapper').hide();$('magento_orders_number_source').value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_NUMBER_SOURCE_MAGENTO');$('magento_orders_number_prefix_mode').value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_NUMBER_PREFIX_MODE_NO');self.magentoOrdersNumberPrefixModeChange();$('magento_block_amazon_accounts_magento_orders_fba-wrapper').hide();$('magento_orders_fba_mode').value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_FBA_MODE_YES');$('magento_orders_fba_stock_mode').value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_FBA_STOCK_MODE_YES');$('magento_block_amazon_accounts_magento_orders_refund_and_cancellation-wrapper').hide();$('magento_orders_refund').value=1;$('magento_block_amazon_accounts_magento_orders_customer-wrapper').hide();$('magento_orders_customer_mode').value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_CUSTOMER_MODE_GUEST');self.magentoOrdersCustomerModeChange();$('magento_block_amazon_accounts_magento_orders_status_mapping-wrapper').hide();$('magento_orders_status_mapping_mode').value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_STATUS_MAPPING_MODE_DEFAULT');self.magentoOrdersStatusMappingModeChange();$('magento_block_amazon_accounts_magento_orders_rules-wrapper').hide();$('magento_orders_qty_reservation_days').value=1;$('magento_block_amazon_accounts_magento_orders_tax-wrapper').hide();$('magento_orders_tax_mode').value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_TAX_MODE_MIXED');$('magento_orders_customer_billing_address_mode').value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Account::MAGENTO_ORDERS_BILLING_ADDRESS_MODE_SHIPPING_IF_SAME_CUSTOMER_AND_RECIPIENT');}else{$('magento_block_amazon_accounts_magento_orders_number-wrapper').show();$('magento_block_amazon_accounts_magento_orders_fba-wrapper').show();$('magento_block_amazon_accounts_magento_orders_refund_and_cancellation-wrapper').show();$('magento_block_amazon_accounts_magento_orders_customer-wrapper').show();$('magento_block_amazon_accounts_magento_orders_status_mapping-wrapper').show();$('magento_block_amazon_accounts_magento_orders_tax-wrapper').show();$('magento_block_amazon_accounts_magento_orders_rules-wrapper').show();}},vatCalculationModeChange:function()\n{$('is_magento_invoice_creation_disabled_tr').hide();if($('is_vat_calculation_service_enabled').value==1){$('is_magento_invoice_creation_disabled_tr').show();}},linkOrRegisterRepricing:function()\n{return setLocation(M2ePro.url.get('amazon_account_repricing/linkOrRegister'));},unlinkRepricing:function()\n{this.confirm({actions:{confirm:function(){AmazonAccountObj.openUnlinkPage();},cancel:function(){return false;}}});},openUnlinkPage:function()\n{return setLocation(M2ePro.url.get('amazon_account_repricing/openUnlinkPage'));},openManagement:function()\n{window.open(M2ePro.url.get('amazon_account_repricing/openManagement'));},regular_price_mode_change:function()\n{var self=AmazonAccountObj,regularPriceAttr=$('regular_price_attribute'),regularPriceCoeficient=$('regular_price_coefficient_td'),variationRegularPrice=$('regular_price_variation_mode_tr');regularPriceAttr.value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Account_Repricing::PRICE_MODE_ATTRIBUTE')){self.updateHiddenValue(this,regularPriceAttr);}\nregularPriceCoeficient.hide();variationRegularPrice.hide();if(this.value!=M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Account_Repricing::PRICE_MODE_MANUAL')&&this.value!=M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Account_Repricing::REGULAR_PRICE_MODE_PRODUCT_POLICY')){regularPriceCoeficient.show();variationRegularPrice.show();}\nif(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Account_Repricing::PRICE_MODE_MANUAL')){$$('.repricing-min-price-mode-regular-depended').each(function(element){if(element.selected){element.up().selectedIndex=M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Account_Repricing::PRICE_MODE_MANUAL');element.simulate('change');}\nelement.hide();});$$('.repricing-max-price-mode-regular-depended').each(function(element){if(element.selected){element.up().selectedIndex=M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Account_Repricing::PRICE_MODE_MANUAL');element.simulate('change');}\nelement.hide();});}else{$$('.repricing-min-price-mode-regular-depended').each(function(element){element.show();});$$('.repricing-max-price-mode-regular-depended').each(function(element){element.show();});}},min_price_mode_change:function()\n{var self=AmazonAccountObj,minPriceValueTr=$('min_price_value_tr'),minPricePercentTr=$('min_price_percent_tr'),minPriceWarning=$('min_price_warning_tr'),minPriceAttr=$('min_price_attribute'),minPriceCoeficient=$('min_price_coefficient_td'),variationMinPrice=$('min_price_variation_mode_tr');minPriceWarning.hide();if(this.value!=M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Account_Repricing::PRICE_MODE_MANUAL')){minPriceWarning.show();}\nminPriceCoeficient.hide();variationMinPrice.hide();minPriceAttr.value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Account_Repricing::PRICE_MODE_ATTRIBUTE')){self.updateHiddenValue(this,minPriceAttr);minPriceCoeficient.show();variationMinPrice.show();}\nminPriceValueTr.hide();if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Account_Repricing::MIN_PRICE_MODE_REGULAR_VALUE')){minPriceValueTr.show();}\nminPricePercentTr.hide();if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Account_Repricing::MIN_PRICE_MODE_REGULAR_PERCENT')){minPricePercentTr.show();}},max_price_mode_change:function()\n{var self=AmazonAccountObj,maxPriceValueTr=$('max_price_value_tr'),maxPricePercentTr=$('max_price_percent_tr'),maxPriceWarning=$('max_price_warning_tr'),maxPriceAttr=$('max_price_attribute'),maxPriceCoeficient=$('max_price_coefficient_td'),variationMaxPrice=$('max_price_variation_mode_tr');maxPriceWarning.hide();if(this.value!=M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Account_Repricing::PRICE_MODE_MANUAL')){maxPriceWarning.show();}\nmaxPriceCoeficient.hide();variationMaxPrice.hide();maxPriceAttr.value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Account_Repricing::PRICE_MODE_ATTRIBUTE')){self.updateHiddenValue(this,maxPriceAttr);maxPriceCoeficient.show();variationMaxPrice.show();}\nmaxPriceValueTr.hide();if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Account_Repricing::MAX_PRICE_MODE_REGULAR_VALUE')){maxPriceValueTr.show();}\nmaxPricePercentTr.hide();if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Account_Repricing::MAX_PRICE_MODE_REGULAR_PERCENT')){maxPricePercentTr.show();}},disable_mode_change:function()\n{var self=AmazonAccountObj,disableModeAttr=$('disable_mode_attribute');disableModeAttr.value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Account_Repricing::DISABLE_MODE_ATTRIBUTE')){self.updateHiddenValue(this,disableModeAttr);}},saveAndClose:function()\n{var self=this,url=typeof M2ePro.url.urls.formSubmit=='undefined'?M2ePro.url.formSubmit+'back/'+base64_encode('list')+'/':M2ePro.url.get('formSubmit',{'back':base64_encode('list')});if(!self.isValidForm()){return;}\nnew Ajax.Request(url,{method:'post',parameters:Form.serialize($('edit_form')),onSuccess:function(transport){transport=transport.responseText.evalJSON();if(transport.success){window.close();}else{self.alert(transport.message);return;}}});},});});","Ess_M2ePro/js/Amazon/Listing/Settings.min.js":"define(['M2ePro/Common'],function(){window.AmazonListingSettings=Class.create(Common,{storeId:null,marketplaceId:null,initialize:function(){},saveClick:function(url,skipValidation){if(typeof skipValidation=='undefined'&&!this.isValidForm()){return;}\nif(typeof categories_selected_items!='undefined'){array_unique(categories_selected_items);var selectedCategories=implode(',',categories_selected_items);$('selected_categories').value=selectedCategories;}\nif(typeof url=='undefined'||url==''){url=M2ePro.url.formSubmit+'back/'+base64_encode('list')+'/';}\nCommon.prototype.saveClick.call(this,url);},saveAndEditClick:function(url,lastActiveTab,skipValidation){if(typeof skipValidation=='undefined'&&!this.isValidForm()){return;}\nif(typeof categories_selected_items!='undefined'&&!this.isValidForm()){array_unique(categories_selected_items);var selectedCategories=implode(',',categories_selected_items);$('selected_categories').value=selectedCategories;}\nif(lastActiveTab&&url){var tabsUrl='|tab='+jQuery('#amazonListingEditTabs').data().tabs.active.find('a')[0].id.split('_').pop();url=url+'back/'+base64_encode('edit'+tabsUrl)+'/';}\nthis.submitForm(url);},reloadSellingFormatTemplates:function(){AmazonListingSettingsObj.reload(M2ePro.url.get('getSellingFormatTemplates'),'template_selling_format_id');},reloadSynchronizationTemplates:function(){AmazonListingSettingsObj.reload(M2ePro.url.get('getSynchronizationTemplates'),'template_synchronization_id');},selling_format_template_id_simulate_change:function(){var intervalRestartLimit=20;var intervalRestartCount=0;var intervalId=setInterval(function simulateSellingFormatTemplateChange(){intervalRestartCount++;if(intervalRestartCount>=intervalRestartLimit||Ajax.activeRequestCount==0){$('template_selling_format_id').value&&$('template_selling_format_id').simulate('change');clearInterval(intervalId);}},250);},selling_format_template_id_change:function(){AmazonListingSettingsObj.checkMessages();AmazonListingSettingsObj.hideEmptyOption(this);},checkMessages:function(){if(AmazonListingSettingsObj.storeId===null||AmazonListingSettingsObj.marketplaceId===null){return;}\nvar id=$('template_selling_format_id').value,nick='selling_format',storeId=AmazonListingSettingsObj.storeId,marketplaceId=AmazonListingSettingsObj.marketplaceId,checkAttributesAvailability=false,container='template_selling_format_messages',callback=function(){var refresh=$(container).down('a.refresh-messages');if(refresh){refresh.observe('click',function(){this.checkMessages();}.bind(this))}}.bind(this);TemplateHandlerObj.checkMessages(id,nick,'',storeId,marketplaceId,checkAttributesAvailability,container,callback);},synchronization_template_id_change:function(){AmazonListingSettingsObj.hideEmptyOption(this);},reload:function(url,id){new Ajax.Request(url,{asynchronous:false,onSuccess:function(transport){var data=transport.responseText.evalJSON(true);var options='';var firstItemValue='';var currentValue=$(id).value;data.each(function(paris){var key=(typeof paris.key!='undefined')?paris.key:paris.id;var val=(typeof paris.value!='undefined')?paris.value:paris.title;options+='<option value=\"'+key+'\">'+val+'</option>\\n';if(firstItemValue==''){firstItemValue=key;}});$(id).update();$(id).insert(options);if(currentValue!=''){$(id).value=currentValue;}else{if(M2ePro.formData[id]>0){$(id).value=M2ePro.formData[id];}else{$(id).value=firstItemValue;}}\n$(id).simulate('change');}});},addNewTemplate:function(url,callback){var win=window.open(url);var intervalId=setInterval(function(){if(!win.closed){return;}\nclearInterval(intervalId);callback&&callback();},1000);},newSellingFormatTemplateCallback:function(){var noteEl=$('template_selling_format_note');AmazonListingSettingsObj.reloadSellingFormatTemplates();if($('template_selling_format_id').children.length>0){$('template_selling_format_id').show();noteEl&&$('template_selling_format_note').show();$('template_selling_format_label').hide();}else{$('template_selling_format_id').hide();noteEl&&$('template_selling_format_note').hide();$('template_selling_format_label').show();}},newSynchronizationTemplateCallback:function(){var noteEl=$('template_synchronization_note');AmazonListingSettingsObj.reloadSynchronizationTemplates();if($('template_synchronization_id').children.length>0){$('template_synchronization_id').show();noteEl&&$('template_synchronization_note').show();$('template_synchronization_label').hide();}else{$('template_synchronization_id').hide();noteEl&&$('template_synchronization_note').hide();$('template_synchronization_label').show();}}});});","Ess_M2ePro/js/Amazon/Listing/AfnQty.min.js":"define(['Magento_Ui/js/modal/alert'],function(alert){window.AmazonListingAfnQty=Class.create();AmazonListingAfnQty.prototype={initialize:function(containerId){},showAfnQty:function(el,selectedSku,selectedProductId,accountId){var self=this,skus=[];var i=50,hasSelected=false;el.up('table').select('.m2ePro-online-sku-value').each(function(skuEl){if(i===0){throw $break;}\nif(skuEl.innerHTML==''){return;}\nif(selectedSku==skuEl.innerHTML){hasSelected=true;}\nskus.push({sku:skuEl.innerHTML,productId:skuEl.getAttribute('productId')});i--;});if(!hasSelected){skus.pop();skus.push({sku:selectedSku,productId:selectedProductId});}\nvar skusStr='';skus.each(function(item){skusStr+=item.sku+','});skusStr=rtrim(skusStr,',');new Ajax.Request(M2ePro.url.get('amazon_listing/getAFNQtyBySku'),{method:'post',parameters:{skus:skusStr,account_id:accountId},onSuccess:function(transport){if(!transport.responseText.isJSON()){alert({content:transport.responseText});return;}\nvar response=transport.responseText.evalJSON();var data={};skus.each(function(item){if(response.items[item.sku]){data[item.productId]=response.items[item.sku].qty;}else{data[item.productId]='empty';}});self.renderAfnQty(data);}});},renderAfnQty:function(data)\n{var self=this;$H(data).each(function(item){var container=$('m2ePro_afn_qty_value_'+item.key);container.down('a').hide();container.down('.m2ePro-online-sku-value').remove();if(item.value!='empty'){container.down('.m2epro-afn-qty-data').show();container.down('.total span').update(item.value.total);container.down('.in-stock span').update(item.value.in_stock);}else{container.down('.m2epro-empty-afn-qty-data').show();}});}};});","Ess_M2ePro/js/Amazon/Listing/AutoAction.min.js":"define(['jquery','M2ePro/Listing/AutoAction','prototype'],function(jQuery){window.AmazonListingAutoAction=Class.create(ListingAutoAction,{controller:'amazon_listing_autoAction',addingModeChange:function(el)\n{if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Listing::ADDING_MODE_ADD')&&ListingAutoActionObj.showCreateNewAsin){$('auto_action_amazon_add_and_create_asin').show();}else{$('auto_action_amazon_add_and_create_asin').hide();$('auto_action_amazon_add_and_assign_description_template').hide();$('auto_action_create_asin').value=M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::ADDING_MODE_ADD_AND_CREATE_NEW_ASIN_NO');$('adding_description_template_id').value='';}\nif(el.target.value!=M2ePro.php.constant('Ess_M2ePro_Model_Listing::ADDING_MODE_NONE')){$$('[id$=\"adding_add_not_visible_field\"]')[0].show();}else{$$('[id$=\"adding_add_not_visible\"]')[0].value=M2ePro.php.constant('Ess_M2ePro_Model_Listing::AUTO_ADDING_ADD_NOT_VISIBLE_YES');$$('[id$=\"adding_add_not_visible_field\"]')[0].hide();}},createAsinChange:function(el)\n{if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::ADDING_MODE_ADD_AND_CREATE_NEW_ASIN_YES')){$('auto_action_amazon_add_and_assign_description_template').show();}else{$('auto_action_amazon_add_and_assign_description_template').hide();$('adding_description_template_id').value='';}},categoryStepOne:function(groupId)\n{this.loadAutoCategoryForm(groupId,function(){$('category_close_button').hide();});},collectData:function()\n{if($('auto_mode')){switch(parseInt($('auto_mode').value)){case M2ePro.php.constant('Ess_M2ePro_Model_Listing::AUTO_MODE_GLOBAL'):ListingAutoActionObj.internalData={auto_mode:$('auto_mode').value,auto_global_adding_mode:$('auto_global_adding_mode').value,auto_global_adding_add_not_visible:$('auto_global_adding_add_not_visible').value,adding_description_template_id:$('adding_description_template_id').value};break;case M2ePro.php.constant('Ess_M2ePro_Model_Listing::AUTO_MODE_WEBSITE'):ListingAutoActionObj.internalData={auto_mode:$('auto_mode').value,auto_website_adding_mode:$('auto_website_adding_mode').value,auto_website_adding_add_not_visible:$('auto_website_adding_add_not_visible').value,auto_website_deleting_mode:$('auto_website_deleting_mode').value,adding_description_template_id:$('adding_description_template_id').value};break;case M2ePro.php.constant('Ess_M2ePro_Model_Listing::AUTO_MODE_CATEGORY'):ListingAutoActionObj.internalData={id:$('group_id').value,title:$('group_title').value,auto_mode:$('auto_mode').value,adding_mode:$('adding_mode').value,adding_add_not_visible:$('adding_add_not_visible').value,deleting_mode:$('deleting_mode').value,categories:categories_selected_items,adding_description_template_id:$('adding_description_template_id').value};break;}}},reloadDescriptionTemplates:function()\n{var select=$('adding_description_template_id');new Ajax.Request(M2ePro.url.get(ListingAutoActionObj.controller+'/getDescriptionTemplatesList'),{onSuccess:function(transport){var data=transport.responseText.evalJSON(true);var options='<option></option>';var firstItem=null;var currentValue=select.value;data.each(function(item){var key=item.id;var val=item.title;var disabled=item.is_new_asin_accepted==0?' disabled=\"disabled\"':'';options+='<option value=\"'+key+'\"'+disabled+'>'+val+'</option>\\n';if(!firstItem){firstItem=item;}});select.update();select.insert(options);if(currentValue!=''){$('adding_description_template_id').value=currentValue;}else if(typeof id!=='undefined'&&M2ePro.formData[id]>0){select.value=M2ePro.formData[id];}else if(firstItem.is_new_asin_accepted!=0){select.value=firstItem.id;}\nselect.simulate('change');}});},addNewTemplate:function(url,callback)\n{var win=window.open(url);var intervalId=setInterval(function(){if(!win.closed){return;}\nclearInterval(intervalId);callback&&callback();},1000);}});});","Ess_M2ePro/js/Amazon/Listing/Create/General.min.js":"define(['underscore','Magento_Ui/js/modal/alert','M2ePro/Amazon/Listing/Create/General/MarketplaceSynchProgress','M2ePro/Plugin/ProgressBar','M2ePro/Plugin/AreaWrapper'],function(_,alert){window.AmazonListingCreateGeneral=Class.create();AmazonListingCreateGeneral.prototype={marketplaceSynchProgressObj:null,accounts:null,selectedAccountId:null,initialize:function(){var self=this;self.marketplaceSynchProgressObj=new AmazonListingCreateGeneralMarketplaceSynchProgress(new ProgressBar('progress_bar'),new AreaWrapper('content_container'));CommonObj.setValidationCheckRepetitionValue('M2ePro-listing-title',M2ePro.translator.translate('The specified Title is already used for other Listing. Listing Title must be unique.'),'Listing','title','id',null,M2ePro.php.constant('Ess_M2ePro_Helper_Component_Amazon::NICK'));self.initAccount();self.initMarketplace();},initAccount:function(){var self=this;$('account_id').observe('change',function(){self.selectedAccountId=this.value;if(this.value==''){$('marketplace_info').hide();return;}\nvar account=_.findWhere(self.accounts,{id:this.value});if(!_.isUndefined(account)){$('marketplace_info').show();$('marketplace_id').value=account.marketplace_id;$('marketplace_title').innerHTML=account.marketplace_title;$('marketplace_url').innerHTML=account.marketplace_url;}});self.renderAccounts();$('add_account_button').observe('click',function(){var win=window.open(M2ePro.url.get('amazon_account/newAction'));var intervalId=setInterval(function(){if(!win.closed){return;}\nclearInterval(intervalId);self.renderAccounts();},1000);});},initMarketplace:function(){var self=this;$('save_and_next').observe('click',function(){if(self.marketplaceSynchProgressObj.runningNow){alert({content:M2ePro.translator.translate('Please wait while Synchronization is finished.')});return;}\njQuery('#edit_form').valid()&&self.synchronizeMarketplace($('marketplace_id').value);});},renderAccounts:function(callback){var self=this;var account_add_btn=$('add_account_button');var account_label_el=$('account_label');var account_select_el=$('account_id');var marketplace_info=$('marketplace_info');if(account_select_el.disabled){account_select_el.enable();self.accountDisabled=true;}\nnew Ajax.Request(M2ePro.url.get('general/getAccounts'),{method:'get',onSuccess:function(transport){var accounts=transport.responseText.evalJSON();if(_.isNull(self.accounts)){self.accounts=accounts;}\nif(_.isNull(self.selectedAccountId)){self.selectedAccountId=account_select_el.value;}\nvar isAccountsChanged=!self.isAccountsEqual(accounts);if(isAccountsChanged){self.accounts=accounts;}\nif(accounts.length==0){account_add_btn.down('span').update(M2ePro.translator.translate('Add'));account_label_el.update(M2ePro.translator.translate('Account not found, please create it.'));account_label_el.show();account_select_el.hide();marketplace_info.hide();return;}\nmarketplace_info.show();account_select_el.update();account_select_el.appendChild(new Element('option',{style:'display: none'}));accounts.each(function(account){account_select_el.appendChild(new Element('option',{value:account.id})).insert(account.title);});account_add_btn.down('span').update(M2ePro.translator.translate('Add Another'));if(accounts.length===1){var account=_.first(accounts);self.selectedAccountId=account.id;var accountElement;if(M2ePro.formData.wizard){accountElement=new Element('span').update(account.title);}else{var accountLink=M2ePro.url.get('amazon_account/edit',{'id':account.id,close_on_save:1});accountElement=new Element('a',{'href':accountLink,'target':'_blank'}).update(account.title);}\naccount_label_el.update(accountElement);account_label_el.show();account_select_el.hide();}else if(isAccountsChanged){self.selectedAccountId=_.last(accounts).id;account_label_el.hide();account_select_el.show();}\naccount_select_el.setValue(self.selectedAccountId);account_select_el.simulate('change');if(self.accountDisabled){account_select_el.disable();}\ncallback&&callback();}});},synchronizeMarketplace:function(marketplaceId){var self=this;new Ajax.Request(M2ePro.url.get('general/isMarketplaceEnabled'),{method:'get',parameters:{marketplace_id:marketplaceId},onSuccess:function(transport){var result=transport.responseText.evalJSON();if(result.status){return self.marketplaceSynchProgressObj.end();}\nvar title='Amazon '+$('marketplace_title').innerHTML;$('save_and_next').disable();self.marketplaceSynchProgressObj.runTask(title,M2ePro.url.get('amazon_marketplace/runSynchNow',{marketplace_id:marketplaceId}));}});},isAccountsEqual:function(newAccounts){if(!newAccounts.length&&!this.accounts.length){return true;}\nif(newAccounts.length!==this.accounts.length){return false;}\nreturn _.every(this.accounts,function(account){return _.where(newAccounts,account).length>0;});}};});","Ess_M2ePro/js/Amazon/Listing/Create/Selling.min.js":"define(['M2ePro/Common'],function(){window.AmazonListingCreateSelling=Class.create(Common,{initialize:function(){jQuery.validator.addMethod('M2ePro-validate-condition-note-length',function(value){if($('condition_note_mode').value!=M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::CONDITION_NOTE_MODE_CUSTOM_VALUE')){return true;}\nreturn value.length<=2000;},M2ePro.translator.translate('condition_note_length_error'));jQuery.validator.addMethod('M2ePro-validate-sku-modification-custom-value',function(value){if($('sku_modification_mode').value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::SKU_MODIFICATION_MODE_NONE')){return true;}\nif($('sku_modification_mode').value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::SKU_MODIFICATION_MODE_TEMPLATE')){return value.match(/%value%/g);}\nreturn true;},M2ePro.translator.translate('sku_modification_custom_value_error'));jQuery.validator.addMethod('M2ePro-validate-sku-modification-custom-value-max-length',function(value){if($('sku_modification_mode').value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::SKU_MODIFICATION_MODE_NONE')){return true;}\nif($('sku_modification_mode').value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::SKU_MODIFICATION_MODE_TEMPLATE')){value=value.replace('%value%','');}\nreturn value.length<M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing_Product_Action_Type_ListAction_Validator_Sku_General::SKU_MAX_LENGTH');},M2ePro.translator.translate('sku_modification_custom_value_max_length_error'));},getAvailableConstantsForImages:function(){return[M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::CONDITION_USED_LIKE_NEW'),M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::CONDITION_USED_VERY_GOOD'),M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::CONDITION_USED_GOOD'),M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::CONDITION_USED_ACCEPTABLE'),M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::CONDITION_COLLECTIBLE_LIKE_NEW'),M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::CONDITION_COLLECTIBLE_VERY_GOOD'),M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::CONDITION_COLLECTIBLE_GOOD'),M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::CONDITION_COLLECTIBLE_ACCEPTABLE'),];},sku_mode_change:function(){var self=AmazonListingCreateSellingObj;$('sku_custom_attribute').value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::SKU_MODE_CUSTOM_ATTRIBUTE')){self.updateHiddenValue(this,$('sku_custom_attribute'));}},sku_modification_mode_change:function(){if($('sku_modification_mode').value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::SKU_MODIFICATION_MODE_TEMPLATE')){$('sku_modification_custom_value').value='%value%';}else{$('sku_modification_custom_value').value='';}\nif($('sku_modification_mode').value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::SKU_MODIFICATION_MODE_NONE')){$('sku_modification_custom_value_tr').hide();}else{$('sku_modification_custom_value_tr').show();}},condition_mode_change:function(){var self=AmazonListingCreateSellingObj,attributeCode=this.options[this.selectedIndex].getAttribute('attribute_code'),condition_note_mode=$('condition_note_mode'),conditionValue=$('condition_value'),conditionCustomAttribute=$('condition_custom_attribute');$('magento_block_amazon_listing_add_images-wrapper').hide();$('condition_note_mode_tr').show();$('condition_note_value_tr').show();conditionValue.value='';conditionCustomAttribute.value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::CONDITION_MODE_DEFAULT')){self.updateHiddenValue(this,conditionValue);if(attributeCode==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::CONDITION_NEW')){$('condition_note_mode_tr').hide();$('condition_note_value_tr').hide();}else{self.condition_note_mode_change();}\nif(self.getAvailableConstantsForImages().indexOf(attributeCode)==-1){$('image_main_attribute').value='';$('image_main_mode').selectedIndex=M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::IMAGE_MAIN_MODE_NONE');$('image_main_mode').simulate('change');}else{$('magento_block_amazon_listing_add_images-wrapper').show();}}else{self.updateHiddenValue(this,conditionCustomAttribute);$('condition_note_mode_tr').show();self.condition_note_mode_change();$('magento_block_amazon_listing_add_images-wrapper').show();}},image_main_mode_change:function(){var self=AmazonListingCreateSellingObj;$('gallery_images_mode_tr').show();$('image_main_attribute').value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::IMAGE_MAIN_MODE_NONE')){$('gallery_images_mode_tr').hide();$('gallery_images_limit').value='';$('gallery_images_attribute').value='';$('gallery_images_mode').selectedIndex=M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::GALLERY_IMAGES_MODE_NONE');}\nif(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::IMAGE_MAIN_MODE_ATTRIBUTE')){self.updateHiddenValue(this,$('image_main_attribute'));}},gallery_images_mode_change:function(){var self=AmazonListingCreateSellingObj;$('gallery_images_limit').value='';$('gallery_images_attribute').value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::GALLERY_IMAGES_MODE_PRODUCT')){self.updateHiddenValue(this,$('gallery_images_limit'));}\nif(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::GALLERY_IMAGES_MODE_ATTRIBUTE')){self.updateHiddenValue(this,$('gallery_images_attribute'));}},gift_wrap_mode_change:function(){var self=AmazonListingCreateSellingObj;$('gift_wrap_attribute').value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::GIFT_WRAP_MODE_ATTRIBUTE')){self.updateHiddenValue(this,$('gift_wrap_attribute'));}},gift_message_mode_change:function(){var self=AmazonListingCreateSellingObj;$('gift_message_attribute').value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::GIFT_MESSAGE_MODE_ATTRIBUTE')){self.updateHiddenValue(this,$('gift_message_attribute'));}},condition_note_mode_change:function(){var self=AmazonListingCreateSellingObj;if($('condition_note_mode').value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::CONDITION_NOTE_MODE_CUSTOM_VALUE')){$('condition_note_value_tr').show();}else{$('condition_note_value_tr').hide();}},handling_time_mode_change:function(){var self=AmazonListingCreateSellingObj;$('handling_time_custom_attribute').value='';$('handling_time_value').value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::HANDLING_TIME_MODE_RECOMMENDED')){self.updateHiddenValue(this,$('handling_time_value'));}\nif(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::HANDLING_TIME_MODE_CUSTOM_ATTRIBUTE')){self.updateHiddenValue(this,$('handling_time_custom_attribute'));}},restock_date_mode_change:function(){var self=AmazonListingCreateSellingObj;$('restock_date_value_tr').hide();$('restock_date_custom_attribute').value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::RESTOCK_DATE_MODE_CUSTOM_VALUE')){$('restock_date_value_tr').show();}\nif(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::RESTOCK_DATE_MODE_CUSTOM_ATTRIBUTE')){self.updateHiddenValue(this,$('restock_date_custom_attribute'));}},appendToText:function(ddId,targetId){if($(ddId).value==''){return;}\nvar attributePlaceholder='#'+$(ddId).value+'#',element=$(targetId);if(document.selection){element.focus();document.selection.createRange().text=attributePlaceholder;element.focus();}else if(element.selectionStart||element.selectionStart=='0'){var startPos=element.selectionStart,endPos=element.selectionEnd,scrollTop=element.scrollTop,tempValue;tempValue=element.value.substring(0,startPos);tempValue+=attributePlaceholder;tempValue+=element.value.substring(endPos,element.value.length);element.value=tempValue;element.focus();element.selectionStart=startPos+attributePlaceholder.length;element.selectionEnd=startPos+attributePlaceholder.length;element.scrollTop=scrollTop;}else{element.value+=attributePlaceholder;element.focus();}}});});","Ess_M2ePro/js/Amazon/Listing/Create/Search.min.js":"define(['M2ePro/Common'],function(){window.AmazonListingCreateSearch=Class.create(Common,{initialize:function(){},general_id_mode_change:function(){var self=AmazonListingCreateSearchObj;$('general_id_custom_attribute').value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::GENERAL_ID_MODE_CUSTOM_ATTRIBUTE')){self.updateHiddenValue(this,$('general_id_custom_attribute'));}},worldwide_id_mode_change:function(){var self=AmazonListingCreateSearchObj;$('worldwide_id_custom_attribute').value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Listing::WORLDWIDE_ID_MODE_CUSTOM_ATTRIBUTE')){self.updateHiddenValue(this,$('worldwide_id_custom_attribute'));}},});});","Ess_M2ePro/js/Amazon/Listing/Create/General/MarketplaceSynchProgress.min.js":"define(['M2ePro/SynchProgress'],function(){AmazonListingCreateGeneralMarketplaceSynchProgress=Class.create(SynchProgress,{runningNow:false,start:function($super,title,status){$super(title,status);this.runningNow=true;},end:function($super){$super();this.runningNow=false;this.saveClick(M2ePro.url.get('amazon_listing_create/index'),true)},runTask:function(title,url,callBackWhenEnd){title=title||'';url=url||'';callBackWhenEnd=callBackWhenEnd||'';if(url==''){return;}\nvar self=this;new Ajax.Request(M2ePro.url.get('general/synchCheckState'),{method:'get',asynchronous:true,onSuccess:function(transport){if(transport.responseText==self.stateExecuting){self.start(M2ePro.translator.translate('Another Synchronization Is Already Running.'),M2ePro.translator.translate('Getting information. Please wait ...'));setTimeout(function(){self.startGetExecutingInfo('self.runTask(\\''+title+'\\',\\''+url+'\\',\"'+callBackWhenEnd+'\");');},2000);}else{self.start(title,M2ePro.translator.translate('Preparing to start. Please wait ...'));new Ajax.Request(url,{method:'get',asynchronous:true});setTimeout(function(){self.startGetExecutingInfo(callBackWhenEnd);},2000);}}});},startGetExecutingInfo:function(callBackWhenEnd){callBackWhenEnd=callBackWhenEnd||'';var self=this;new Ajax.Request(M2ePro.url.get('general/synchGetExecutingInfo'),{method:'get',asynchronous:true,onSuccess:function(transport){var data=transport.responseText.evalJSON(true);if(data.mode==self.stateExecuting){self.progressBarObj.setTitle(data.title);if(data.percents<=0){self.progressBarObj.setPercents(0,0);}else if(data.percents>=100){self.progressBarObj.setPercents(100,0);}else{self.progressBarObj.setPercents(data.percents,1);}\nself.progressBarObj.setStatus(data.status);self.wrapperObj.lock();$$('.loading-mask').invoke('setStyle',{visibility:'hidden'});setTimeout(function(){self.startGetExecutingInfo(callBackWhenEnd);},3000);}else{self.progressBarObj.setPercents(100,0);setTimeout(function(){if(callBackWhenEnd!=''){eval(callBackWhenEnd);}else{self.end();}},1500);}}});}});});","Ess_M2ePro/js/Amazon/Listing/Other/Grid.min.js":"define(['M2ePro/Listing/Other/Grid'],function(){window.AmazonListingOtherGrid=Class.create(ListingOtherGrid,{getLogViewUrl:function(rowId)\n{var idField=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Block\\\\Adminhtml\\\\Log\\\\Listing\\\\Other\\\\AbstractGrid::LISTING_ID_FIELD');var params={};params[idField]=rowId;return M2ePro.url.get('amazon_log_listing_other/index',params);}});});","Ess_M2ePro/js/Amazon/Listing/View/Fulfillment.min.js":"define(['M2ePro/Plugin/Messages','M2ePro/Action'],function(MessageObj){window.AmazonListingViewFulfillment=Class.create(Action,{initialize:function($super,gridHandler){var self=this;$super(gridHandler);},options:{},setOptions:function(options){this.options=Object.extend(this.options,options);return this;},switchToAFN:function(productsIds){var self=this;self.gridHandler.unselectAll();new Ajax.Request(M2ePro.url.get('amazon_listing_product_fulfillment/switchToAFN'),{method:'post',parameters:{products_ids:productsIds},onSuccess:function(transport){if(!transport.responseText.isJSON()){self.alert(transport.responseText);return;}\nvar response=transport.responseText.evalJSON();self.gridHandler.unselectAllAndReload();MessageObj.clear();response.messages.each(function(msg){MessageObj['add'+msg.type[0].toUpperCase()+msg.type.slice(1)+'Message'](msg.text);});}});},switchToMFN:function(productsIds){var self=this;self.gridHandler.unselectAll();new Ajax.Request(M2ePro.url.get('amazon_listing_product_fulfillment/switchToMFN'),{method:'post',parameters:{products_ids:productsIds},onSuccess:function(transport){if(!transport.responseText.isJSON()){alert(transport.responseText);return;}\nvar response=transport.responseText.evalJSON();self.gridHandler.unselectAllAndReload();MessageObj.clear();response.messages.each(function(msg){MessageObj['add'+msg.type[0].toUpperCase()+msg.type.slice(1)+'Message'](msg.text);});}});}});});","Ess_M2ePro/js/Amazon/Listing/View/Action.min.js":"define(['M2ePro/Listing/View/Action'],function(){window.AmazonListingViewAction=Class.create(ListingViewAction,{deleteAndRemoveAction:function(){var selectedProductsParts=this.gridHandler.getSelectedItemsParts();if(selectedProductsParts.length==0){return;}\nthis.startActions(M2ePro.translator.translate('deleting_and_removing_selected_items_message'),M2ePro.url.get('runDeleteAndRemoveProducts'),selectedProductsParts);}});});","Ess_M2ePro/js/Amazon/Listing/View/Grid.min.js":"define(['M2ePro/Plugin/Messages','M2ePro/Listing/View/Grid','M2ePro/Listing/Moving','M2ePro/Amazon/Listing/View/Action','M2ePro/Amazon/Listing/View/Fulfillment','M2ePro/Amazon/Listing/Product/Repricing','M2ePro/Amazon/Listing/Product/Search','M2ePro/Amazon/Listing/Product/Template/Description','M2ePro/Amazon/Listing/Product/Template/Shipping','M2ePro/Amazon/Listing/Product/Template/ProductTaxCode','M2ePro/Amazon/Listing/Product/Variation/Manage'],function(MessageObj){window.AmazonListingViewGrid=Class.create(ListingViewGrid,{getLogViewUrl:function(rowId){var idField=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Block\\\\Adminhtml\\\\Log\\\\Listing\\\\Product\\\\AbstractGrid::LISTING_PRODUCT_ID_FIELD');var params={};params[idField]=rowId;return M2ePro.url.get('amazon_log_listing_product/index',params);},getMaxProductsInPart:function()\n{return 10;},prepareActions:function($super)\n{this.actionHandler=new AmazonListingViewAction(this);this.actions={listAction:this.actionHandler.listAction.bind(this.actionHandler),relistAction:this.actionHandler.relistAction.bind(this.actionHandler),reviseAction:this.actionHandler.reviseAction.bind(this.actionHandler),stopAction:this.actionHandler.stopAction.bind(this.actionHandler),stopAndRemoveAction:this.actionHandler.stopAndRemoveAction.bind(this.actionHandler),previewItemsAction:this.actionHandler.previewItemsAction.bind(this.actionHandler),startTranslateAction:this.actionHandler.startTranslateAction.bind(this.actionHandler),stopTranslateAction:this.actionHandler.stopTranslateAction.bind(this.actionHandler)};this.movingHandler=new ListingMoving(this);this.productSearchHandler=new AmazonListingProductSearch(this);this.templateDescriptionHandler=new AmazonListingProductTemplateDescription(this);this.templateShippingHandler=new AmazonListingProductTemplateShipping(this);this.templateProductTaxCodeHandler=new AmazonListingProductTemplateProductTaxCode(this);this.variationProductManageHandler=new AmazonListingProductVariationManage(this);this.fulfillmentHandler=new AmazonListingViewFulfillment(this);this.repricingHandler=new AmazonListingProductRepricing(this);this.actions=Object.extend(this.actions,{duplicateAction:this.duplicateProducts.bind(this),movingAction:this.movingHandler.run.bind(this.movingHandler),deleteAndRemoveAction:this.actionHandler.deleteAndRemoveAction.bind(this.actionHandler),assignTemplateDescriptionIdAction:(function(id){id=id||this.getSelectedProductsString();this.templateDescriptionHandler.validateProductsForTemplateDescriptionAssign(id)}).bind(this),unassignTemplateDescriptionIdAction:(function(id){id=id||this.getSelectedProductsString();this.templateDescriptionHandler.unassignFromTemplateDescription(id)}).bind(this),assignTemplateShippingTemplateIdAction:(function(id){id=id||this.getSelectedProductsString();this.templateShippingHandler.openPopUp(id,M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Account::SHIPPING_MODE_TEMPLATE'))}).bind(this),unassignTemplateShippingTemplateIdAction:(function(id){id=id||this.getSelectedProductsString();this.templateShippingHandler.unassign(id,M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Account::SHIPPING_MODE_TEMPLATE'))}).bind(this),assignTemplateShippingOverrideIdAction:(function(id){id=id||this.getSelectedProductsString();this.templateShippingHandler.openPopUp(id,M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Account::SHIPPING_MODE_OVERRIDE'))}).bind(this),unassignTemplateShippingOverrideIdAction:(function(id){id=id||this.getSelectedProductsString();this.templateShippingHandler.unassign(id,M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Account::SHIPPING_MODE_OVERRIDE'))}).bind(this),assignTemplateProductTaxCodeIdAction:(function(id){id=id||this.getSelectedProductsString();this.templateProductTaxCodeHandler.openPopUp(id)}).bind(this),unassignTemplateProductTaxCodeIdAction:(function(id){id=id||this.getSelectedProductsString();this.templateProductTaxCodeHandler.unassign(id)}).bind(this),switchToAfnAction:(function(id){id=id||this.getSelectedProductsString();this.fulfillmentHandler.switchToAFN(id);}).bind(this),switchToMfnAction:(function(id){id=id||this.getSelectedProductsString();this.fulfillmentHandler.switchToMFN(id);}).bind(this),addToRepricingAction:(function(id){id=id||this.getSelectedProductsString();this.repricingHandler.addToRepricing(id);}).bind(this),showDetailsAction:(function(id){id=id||this.getSelectedProductsString();this.repricingHandler.showDetails(id);}).bind(this),editRepricingAction:(function(id){id=id||this.getSelectedProductsString();this.repricingHandler.editRepricing(id);}).bind(this),removeFromRepricingAction:(function(id){id=id||this.getSelectedProductsString();this.repricingHandler.removeFromRepricing(id);}).bind(this),assignGeneralIdAction:(function(){this.productSearchHandler.searchGeneralIdAuto(this.getSelectedProductsString())}).bind(this),newGeneralIdAction:(function(){this.productSearchHandler.addNewGeneralId(this.getSelectedProductsString())}).bind(this),unassignGeneralIdAction:(function(){this.productSearchHandler.unmapFromGeneralId(this.getSelectedProductsString())}).bind(this)});},duplicateProducts:function(){this.scrollPageToTop();MessageObj.clear();new Ajax.Request(M2ePro.url.get('amazon_listing/duplicateProducts'),{method:'post',parameters:{ids:this.getSelectedProductsString()},onSuccess:(function(transport){try{var response=transport.responseText.evalJSON();MessageObj['add'+response.type[0].toUpperCase()+response.type.slice(1)+'Message'](response.message);if(response.type!='error'){this.unselectAllAndReload();}}catch(e){MessageObj.addErrorMessage('Internal Error.');}}).bind(this)});},unassignTemplateDescriptionIdActionConfrim:function(id)\n{var self=this;self.confirm({actions:{confirm:function(){self.templateDescriptionHandler.unassignFromTemplateDescription(id);},cancel:function(){return false;}}});},unassignTemplateShippingTemplateIdActionConfrim:function(id)\n{var self=this;self.confirm({actions:{confirm:function(){self.templateShippingHandler.unassign(id,M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Account::SHIPPING_MODE_TEMPLATE'));},cancel:function(){return false;}}});},unassignTemplateShippingOverrideIdActionConfrim:function(id)\n{var self=this;self.confirm({actions:{confirm:function(){self.templateShippingHandler.unassign(id,M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Account::SHIPPING_MODE_OVERRIDE'));},cancel:function(){return false;}}});},unassignTemplateProductTaxCodeIdActionConfrim:function(id)\n{var self=this;self.confirm({actions:{confirm:function(){self.templateProductTaxCodeHandler.unassign(id);},cancel:function(){return false;}}});}});});","Ess_M2ePro/js/Amazon/Listing/Product/Variation.min.js":"define(['Magento_Ui/js/modal/modal','M2ePro/Plugin/Messages','M2ePro/Common'],function(modal,MessageObj){window.AmazonListingProductVariation=Class.create();AmazonListingProductVariation.prototype=Object.extend(new Common(),{initialize:function(gridHandler){this.gridHandler=gridHandler;},setListingProductId:function(listingProductId){this.listingProductId=listingProductId;return this;},setNeededVariationData:function(variationAttributes,variationsTree){this.variationAttributes=variationAttributes;this.variationsTree=variationsTree;return this;},showSwitchToIndividualModePopUp:function(title){var self=this;if(self.switchToIndividualModePopUp){self.switchToIndividualModePopUp.modal('openModal');return;}\nnew Ajax.Request(M2ePro.url.get('amazon_listing_product_variation/getSwitchToIndividualModePopUp'),{method:'post',onSuccess:function(transport){$('html-body').insert({bottom:transport.responseText});self.switchToIndividualModePopUp=jQuery('#switch_to_individual_popup');modal({title:M2ePro.translator.translate('switch_to_individual_mode_popup_title'),type:'popup',modalClass:'width-50',buttons:[{text:M2ePro.translator.translate('No'),class:'action-secondary action-dismiss',click:function(){self.switchToIndividualModePopUp.modal('closeModal');}},{text:M2ePro.translator.translate('Yes'),class:'action-primary action-accept',click:function(){if($('switch_to_individual_remember_checkbox').checked){new Ajax.Request(M2ePro.url.get('saveListingAdditionalData'),{method:'post',parameters:{param_name:'hide_switch_to_individual_confirm',param_value:1},onSuccess:function(transport){self.gridHandler.unselectAllAndReload();}});}\nself.switchToIndividualModePopUp.modal('closeModal');self.showManagePopup(title);}}]},self.switchToIndividualModePopUp);self.switchToIndividualModePopUp.modal('openModal');}});},showSwitchToParentModePopUp:function(){var self=this;if(self.switchToParentModePopUp){self.switchToParentModePopUp.modal('openModal');return;}\nnew Ajax.Request(M2ePro.url.get('amazon_listing_product_variation/getSwitchToParentModePopUp'),{method:'post',onSuccess:function(transport){$('html-body').insert({bottom:transport.responseText});self.switchToParentModePopUp=jQuery('#switch_to_parent_popup');modal({title:M2ePro.translator.translate('switch_to_parent_mode_popup_title'),type:'popup',buttons:[{text:M2ePro.translator.translate('No'),class:'action-secondary action-dismiss',click:function(){self.switchToParentModePopUp.modal('closeModal');}},{text:M2ePro.translator.translate('Yes'),class:'action-primary action-accept',click:function(){if($('switch_to_parent_remember_checkbox').checked){new Ajax.Request(M2ePro.url.get('saveListingAdditionalData'),{method:'post',parameters:{param_name:'hide_switch_to_parent_confirm',param_value:1}});}\nself.switchToParentModePopUp.modal('closeModal');self.resetListingProductVariation();}}]},self.switchToParentModePopUp);self.switchToParentModePopUp.modal('openModal');}});},showEditPopup:function(popupTitle){var self=this;MessageObj.clear();new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_individual/getEditPopup'),{method:'get',parameters:{listing_product_id:this.listingProductId},onSuccess:(function(transport){try{var response=transport.responseText.evalJSON();if(response.type=='error'){MessageObj['add'+response.type[0].toUpperCase()+response.type.slice(1)+'Message'](response.message);return;}\nvar popupContent=$('variation_individual_edit_popup');if(popupContent){popupContent.remove();}\n$('html-body').insert({bottom:response.html});var variationForm=jQuery('#variation_edit_form').form();self.editPopup=jQuery('#variation_individual_edit_popup');modal({title:popupTitle,type:'slide',buttons:[{text:M2ePro.translator.translate('Cancel'),click:function(){self.editPopup.modal('closeModal');}},{text:M2ePro.translator.translate('Confirm'),class:'action primary',click:function(){if(!variationForm.valid()){return;}\nvar variationData={};Form.getElements('variation_edit_form').each(function(selectElement){var attribute=selectElement.readAttribute('name');selectElement.value&&(variationData[attribute]=selectElement.value);});self.editAction(variationData);self.editPopup.modal('closeModal');}}]},self.editPopup);self.editPopup.modal('openModal');}catch(e){this.editPopup.modal('closeModal');MessageObj.addErrorMessage('Internal Error.');}}).bind(this)});},editPopupInit:function(currentVariation){var container=$('variation_edit_container');var filters={};this.variationAttributes.each((function(attribute,i){var tr=container.appendChild(new Element('tr'));tr.appendChild(new Element('td',{class:'label',style:'width: 25%; vertical-align: inherit;'})).insert(attribute+': <span class=\"required\">*</span>');var select=tr.appendChild(new Element('td',{class:'value'})).appendChild(new Element('select',{name:'variation_data['+attribute+']',class:'required-entry admin__control-select',index:i}));select.appendChild(new Element('option',{value:currentVariation[attribute]})).insert(currentVariation[attribute]);this.eachAttributeHandler(select,i,function(){return container.select('select[index]').filter(function(select){return select.readAttribute('index')>i;});},filters);}).bind(this));container.select('select[index]').each(function(select){select.simulate('change');});},resetListingProductVariation:function(){MessageObj.clear();new Ajax.Request(M2ePro.url.get('amazon_listing_product/variationReset'),{method:'get',parameters:{listing_product_id:this.listingProductId},onSuccess:(function(transport){try{var response=transport.responseText.evalJSON();MessageObj['add'+response.type[0].toUpperCase()+response.type.slice(1)+'Message'](response.message);this.gridHandler.unselectAllAndReload();}catch(e){this.editPopup.modal('closeModal');MessageObj.addErrorMessage('Internal Error.');}}).bind(this)});},showManagePopup:function(popupTitle){var self=this;MessageObj.clear();new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_individual/getManagePopup'),{method:'get',parameters:{listing_product_id:this.listingProductId},onSuccess:(function(transport){try{var response=transport.responseText.evalJSON();if(response.type=='error'){MessageObj['add'+response.type[0].toUpperCase()+response.type.slice(1)+'Message'](response.message);return;}\nvar popupContent=$('variation_individual_manage_popup');if(popupContent){popupContent.remove();}\n$('html-body').insert({bottom:response.html});var variationForm=jQuery('#variation_manage_form');self.initFormValidation(variationForm);self.managePopup=jQuery('#variation_individual_manage_popup');modal({title:popupTitle,type:'slide',buttons:[{text:M2ePro.translator.translate('Cancel'),click:function(){self.managePopup.modal('closeModal');}},{text:M2ePro.translator.translate('Confirm'),class:'action primary',click:function(){if(!variationForm.valid()){return;}\nvar variationData={};Form.getElements('variation_manage_form').each(function(selectElement){var attribute=selectElement.readAttribute('name');selectElement.value&&(variationData[attribute]=selectElement.value);});self.manageAction(variationData);self.managePopup.modal('closeModal');}}]},self.managePopup);self.managePopup.modal('openModal');$('add_more_variation_button').observe('click',(function(){if(!variationForm.valid()){return;}\nself.manageAddRow();}));}catch(e){self.managePopup.modal('closeModal');MessageObj.addErrorMessage('Internal Error.');}})});},managePopupInit:function()\n{$('add_more_variation_button').simulate('click');},manageAddRow:function(){var container=$('variation_manage_tbody');var lastTr=container.select('tr').last();var index=lastTr?parseInt(lastTr.readAttribute('index'))+1:1;var tr=container.appendChild(new Element('tr',{index:index}));var filters={};this.variationAttributes.each((function(attribute,i){var select=tr.appendChild(new Element('td',{style:'vertical-align: top; padding: 5px 4px'})).appendChild(new Element('select',{name:'variation_data['+index+']['+attribute+']',class:'required-entry admin__control-select',style:'width: 100%',index:i,disabled:true}));this.eachAttributeHandler(select,i,function(){return tr.select('select[index]').filter(function(select){return select.readAttribute('index')>i;});},filters);}).bind(this));tr.appendChild(new Element('td',{style:'vertical-align: top; padding: 10px 4px'})).appendChild(new Element('a',{class:'remove-variation',href:'javascript:void(0)'})).insert('<span></span>').observe('click',function(){if(container.select('tr').length>1){tr.remove();}\nif(container.select('tr').length==1){container.select('a.remove-variation').each(function(btn){btn.hide();});}});container.select('a.remove-variation').each(function(btn){btn.hide();});if(container.select('tr').length>1){container.select('a.remove-variation').each(function(btn){btn.show();});}},eachAttributeHandler:function(select,i,getNextSelects,filters){var attribute=this.variationAttributes[i];if(!i){select.disabled=false;this.renderAttributeValues(select,attribute);}\nselect.observe('change',(function(){filters[attribute]=select.value;var nextSelects=getNextSelects.call(this);if(nextSelects.length<1){return;}\nnextSelects.each(function(select){select.disabled=true;});var nextSelect=nextSelects[0];nextSelect.disabled=false;this.renderAttributeValues(nextSelect,this.variationAttributes[i+1],filters);}).bind(this));},renderAttributeValues:function(container,attribute,filters){filters=filters||{};var values=this.getAttributeValues(attribute,this.variationsTree,filters);var oldValue=container.value;container.update();container.appendChild(new Element('option',{style:'display: none'}));if(typeof values!='undefined'){values.each(function(value){container.appendChild(new Element('option',{value:value})).insert(value);if(value==oldValue){container.value=oldValue;container.simulate('change');}});}},getAttributeValues:function(attribute,attributesTree,filters){for(var treeAttribute in attributesTree){if(attribute==treeAttribute){var values=[];for(var value in attributesTree[treeAttribute]){value&&values.push(value);}\nreturn values;}\nfor(var filterAttribute in filters){if(filterAttribute==treeAttribute){return this.getAttributeValues(attribute,attributesTree[treeAttribute][filters[filterAttribute]],filters)}}}},editAction:function(variationData){MessageObj.clear();var parameters=Object.extend({listing_product_id:this.listingProductId},variationData);new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_individual/edit'),{method:'post',parameters:parameters,onSuccess:(function(transport){try{this.editPopup.modal('closeModal');var response=transport.responseText.evalJSON();MessageObj['add'+response.type[0].toUpperCase()+response.type.slice(1)+'Message'](response.message);if(response.type=='error'){this.scrollPageToTop();}else{this.gridHandler.unselectAllAndReload();}}catch(e){console.log(e.stack);this.scrollPageToTop();this.editPopup.modal('closeModal');MessageObj.addErrorMessage('Internal Error.');}}).bind(this)});},manageAction:function(variationData){MessageObj.clear();var parameters=Object.extend({listing_product_id:this.listingProductId},variationData);new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_individual/manage'),{method:'post',parameters:parameters,onSuccess:(function(transport){try{this.managePopup.modal('closeModal');var response=transport.responseText.evalJSON();MessageObj['add'+response.type[0].toUpperCase()+response.type.slice(1)+'Message'](response.message);if(response.type=='error'){this.scrollPageToTop();}else{this.gridHandler.unselectAllAndReload();}}catch(e){this.scrollPageToTop();this.managePopup.modal('closeModal');MessageObj.addErrorMessage('Internal Error.');}}).bind(this)});},manageGenerateAction:function(unique){var self=this,attributesIndexes={};$('variation_manage').select('th.data-grid-th').each(function(el,i){attributesIndexes[el.readAttribute('attribute').toLowerCase()]=i;});new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_individual/generate'),{method:'post',parameters:{listing_product_id:self.listingProductId,unique:+(unique)},onSuccess:function(transport){try{var response=transport.responseText.evalJSON();if(response.type=='error'){MessageObj.addErrorMessage(response.message);self.managePopup.modal('closeModal');return self.scrollPageToTop();}\nif(response.text.length<1&&Boolean(unique)){self.alert(M2ePro.translator.translate('no_variations_left'));return;}\n$('variation_manage_tbody').select('tr').invoke('remove');response.text.each(function(attributes){self.manageAddRow();var tr=$('variation_manage_tbody').select('tr').last();var temp=[];attributes.each(function(attribute){var index=attributesIndexes[attribute.attribute.toLowerCase()];var select=tr.down('select[index='+index+']');temp[index]={select:select,value:attribute.option};});temp.each(function(obj){obj.select.value=obj.value;obj.select.simulate('change');});});}catch(e){self.scrollPageToTop();self.managePopup.modal('closeModal');MessageObj.addErrorMessage('Internal Error.');}}});}});});","Ess_M2ePro/js/Amazon/Listing/Product/Repricing.min.js":"define(['M2ePro/Plugin/Messages','Magento_Ui/js/modal/alert','Magento_Ui/js/modal/modal','M2ePro/Action'],function(MessageObj,alert){window.AmazonListingProductRepricing=Class.create(Action,{initialize:function($super,gridHandler){$super(gridHandler);},options:{},setOptions:function(options){this.options=Object.extend(this.options,options);return this;},openManagement:function(){window.open(M2ePro.url.get('amazon_listing_product_repricing/openManagement'));},addToRepricing:function(productsIds){var self=this;MessageObj.clear();new Ajax.Request(M2ePro.url.get('amazon_listing_product_repricing/validateProductsBeforeAdd'),{method:'post',parameters:{products_ids:productsIds},onSuccess:function(transport){if(!transport.responseText.isJSON()){alert({content:transport.responseText});return;}\nvar response=transport.responseText.evalJSON();if(response.products_ids.length===0){MessageObj['add'+response.type[0].toUpperCase()+response.type.slice(1)+'Message'](response.message);return;}\nif(response.products_ids.length===productsIds.split(',').length){self.addToRepricingConfirm(productsIds);return;}\nvar popupEl=$('regular_price_popup');if(popupEl){popupEl.remove();}\n$('html-body').insert({bottom:response});self.regularPricePopup=jQuery('#regular_price_popup');modal({title:title,type:'slide',buttons:[{text:M2ePro.translator.translate('Cancel'),click:function(){self.regularPricePopup.modal('closeModal');}},{text:M2ePro.translator.translate('Confirm'),class:'action primary',click:function(){self.addToRepricingConfirm(productsIds);}}]},self.regularPricePopup);self.regularPricePopup.modal('openModal');}});},addToRepricingConfirm:function(productsIds){return this.postForm(M2ePro.url.get('amazon_listing_product_repricing/openAddProducts'),{'products_ids':productsIds});},showDetails:function(productsIds){return this.postForm(M2ePro.url.get('amazon_listing_product_repricing/openShowDetails'),{'products_ids':productsIds});},editRepricing:function(productsIds){return this.postForm(M2ePro.url.get('amazon_listing_product_repricing/openEditProducts'),{'products_ids':productsIds});},removeFromRepricing:function(productsIds){return this.postForm(M2ePro.url.get('amazon_listing_product_repricing/openRemoveProducts'),{'products_ids':productsIds});}});});","Ess_M2ePro/js/Amazon/Listing/Product/Add.min.js":"define(['M2ePro/Common'],function(){window.AmazonListingProductAdd=Class.create();AmazonListingProductAdd.prototype=Object.extend(new Common(),{initialize:function(ProgressBarObj,WrapperObj){this.categories='';this.products='';this.listing_id=null;this.is_list=null;this.back='';this.emptyListing=0;this.categoriesAddAction=null;this.categoriesDeleteAction=null;this.progressBarObj=ProgressBarObj;this.wrapperObj=WrapperObj;},add:function(items,back,isList){var self=this;self.is_list=isList;self.back=back;self.getListingId(items);if(self.emptyListing==1){return;}\nself.products=items;var parts=self.makeProductsParts();self.progressBarObj.reset();self.progressBarObj.setTitle('Adding Products to Listing');self.progressBarObj.setStatus('Adding in process. Please wait...');self.progressBarObj.show();self.scrollPageToTop();self.wrapperObj.lock();self.sendPartsProducts(parts,parts.length);},setCategoriesActions:function(addAction,deleteAction){this.categoriesAddAction=addAction;this.categoriesDeleteAction=deleteAction;},getListingId:function(items){var self=this;if(self.listing_id){return;}\nvar hrefParts=explode('/',window.location.href);for(var i=0;i<hrefParts.length;i++){if(hrefParts[i]=='id'){self.listing_id=hrefParts[i+1];break;}}},makeProductsParts:function(){var self=this;var productsInPart=50;var productsArray=explode(',',self.products);var parts=new Array();if(productsArray.length<productsInPart){return parts[0]=productsArray;}\nvar result=new Array();for(var i=0;i<productsArray.length;i++){if(result.length==0||result[result.length-1].length==productsInPart){result[result.length]=new Array();}\nresult[result.length-1][result[result.length-1].length]=productsArray[i];}\nreturn result;},sendPartsProducts:function(parts,partsCount){var self=this;if(parts.length==0){return;}\nvar part=parts.splice(0,1);part=part[0];var partString=implode(',',part);var isLastPart='';if(parts.length<=0){isLastPart='yes';}\nnew Ajax.Request(M2ePro.url.get('add_products'),{method:'post',parameters:{listing_id:self.listing_id,is_last_part:isLastPart,do_list:self.is_list,back:self.back,products:partString},onSuccess:function(transport){var percents=(100 / partsCount)*(partsCount-parts.length);if(percents<=0){self.progressBarObj.setPercents(0,0);}else if(percents>=100){self.progressBarObj.setPercents(100,0);self.progressBarObj.setStatus('Adding has been completed.');return setLocation(transport.responseText.evalJSON()['redirect']);}else{self.progressBarObj.setPercents(percents,1);}\nsetTimeout(function(){self.sendPartsProducts(parts,partsCount);},500);}});$$('.loading-mask').invoke('setStyle',{visibility:'hidden'});},setHideProductsPresentedInOtherListings:function(hideProductsOthersListings){this.hideProductsOthersListings=hideProductsOthersListings;}});});","Ess_M2ePro/js/Amazon/Listing/Product/Search.min.js":"define(['Magento_Ui/js/modal/modal','M2ePro/Plugin/Messages','M2ePro/Action'],function(modal,MessageObj){window.AmazonListingProductSearch=Class.create(Action,{MATCHING_TYPE_EQUAL:1,MATCHING_TYPE_VIRTUAL_AMAZON:2,MATCHING_TYPE_VIRTUAL_MAGENTO:3,searchData:{},initialize:function($super,gridHandler){var self=this;$super(gridHandler);self.searchBlock=$('productSearch_pop_up_content').outerHTML;$('productSearch_pop_up_content').remove();},initSearchEvents:function(){var self=this;$('productSearch_submit_button').observe('click',function(event){self.searchGeneralIdManual(self.params.productId);});$('productSearch_reset_button').observe('click',function(event){$('query').value='';$('productSearch_grid').innerHTML='';});$('query').observe('keypress',function(event){event.keyCode==Event.KEY_RETURN&&self.searchGeneralIdManual(self.params.productId);});},options:{},setOptions:function(options){this.options=Object.extend(this.options,options);this.initValidators();return this;},initValidators:function(){var self=this;jQuery.validator.addMethod('M2ePro-amazon-attribute-unique-value',function(value,el){var existedValues=[],isValid=true,form=el.parent('form');form.select('select').each(function(index,el){if(el.value!=''){if(existedValues.indexOf(el.value)===-1){existedValues.push(el.value);}else{isValid=false;}}});return isValid;},M2ePro.translator.translate('variation_manage_matched_attributes_error_duplicate'));},params:{autoMapErrorFlag:false},openPopUp:function(mode,title,productId){MessageObj.clear();var self=this;this.gridHandler.unselectAll();this.params={mode:mode,title:title,productId:productId,autoMapErrorFlag:false};if(mode==0){new Ajax.Request(M2ePro.url.get('amazon_listing_product_search/getSearchAsinMenu'),{method:'post',parameters:{product_id:productId},onSuccess:function(transport){var containerEl=$('productSearchMenu_pop_up_content');if(containerEl){containerEl.remove();}\n$('html-body').insert({bottom:transport.responseText});self.searchMenuPopup=jQuery('#productSearchMenu_pop_up_content');modal({title:title,modalClass:'width-50',type:'popup',buttons:[{text:M2ePro.translator.translate('Close'),class:'action primary ',click:function(){self.searchMenuPopup.modal('closeModal')}}]},self.searchMenuPopup);self.searchMenuPopup.modal('openModal');}});}else{if($('productSearch_pop_up_content')){$('productSearch_pop_up_content').remove();}\n$('html-body').insert({bottom:self.searchBlock});self.popup=jQuery('#productSearch_pop_up_content');modal({title:title,type:'slide',buttons:[{text:M2ePro.translator.translate('Cancel'),class:'action default',click:function(){self.popup.modal('closeModal');}},{text:M2ePro.translator.translate('Clear Search Results'),class:'action primary',click:function(){ListingGridHandlerObj.productSearchHandler.clearSearchResultsAndOpenSearchMenu();}}]},this.popup);self.popup.modal('openModal');$('productSearch_pop_up_content').show();$('productSearch_form').hide();$('suggested_asin_grid_help_block').show();new Ajax.Request(M2ePro.url.get('amazon_listing_product_search/suggestedAsinGrid'),{method:'post',parameters:{product_id:productId},onSuccess:function(transport){$('productSearch_grid').update(transport.responseText);}});}},clearSearchResultsAndOpenSearchMenu:function(){var self=this;self.confirm({actions:{confirm:function(){self.popup.modal('closeModal');self.unmapFromGeneralId(self.params.productId,function(){self.openPopUp(0,self.params.title,self.params.productId);});},cancel:function(){return false;}}});},clearSearchResultsAndManualSearch:function(){var self=this;self.popup.modal('closeModal');self.unmapFromGeneralId(self.params.productId,function(){self.showSearchManualPrompt(self.params.title,self.params.productId);});},showSearchManualPrompt:function(title,listingProductId){var self=this,title=title||self.params.title;if(self.searchMenuPopup){self.searchMenuPopup.modal('closeModal');}\nif($('productSearch_pop_up_content')){$('productSearch_pop_up_content').remove();}\n$('html-body').insert({bottom:self.searchBlock});self.popup=jQuery('#productSearch_pop_up_content');var buttons=[];if(!listingProductId){buttons.push({text:M2ePro.translator.translate('Back'),class:'back',click:function(){self.popup.modal('closeModal');self.openPopUp(0,self.params.title,self.params.productId);}});}\nmodal({title:title,type:'slide',buttons:buttons},self.popup);self.popup.modal('openModal');if(listingProductId){self.params={mode:0,title:title,productId:listingProductId,autoMapErrorFlag:false};}\nself.initSearchEvents();$('productSearch_form').show();$('productSearch_error_block').hide();$('suggested_asin_grid_help_block').hide();$('query').value='';setTimeout(function(){$('query').focus();},500);},showSearchGeneralIdAutoPrompt:function(){var self=this;self.confirm({actions:{confirm:function(){if(self.searchMenuPopup){self.searchMenuPopup.modal('closeModal');}\nself.searchGeneralIdAuto(self.params.productId);},cancel:function(){return false;}}});},showUnmapFromGeneralIdPrompt:function(productId){MessageObj.clear();var self=this;self.confirm({actions:{confirm:function(){self.unmapFromGeneralId(productId);},cancel:function(){return false;}}});},addNewGeneralId:function(listingProductIds){var self=this;if(!M2ePro.customData.isNewAsinAvailable){self.alert(M2ePro.translator.translate('new_asin_not_available').replace('%code%',M2ePro.customData.marketplace.code));return;}\nlistingProductIds=listingProductIds||self.params.productId;new Ajax.Request(M2ePro.url.get('amazon_listing_product/mapToNewAsin'),{method:'post',parameters:{products_ids:listingProductIds},onSuccess:function(transport){if(!transport.responseText.isJSON()){self.alert(transport.responseText);return;}\nvar response=transport.responseText.evalJSON();if(typeof self.searchMenuPopup!='undefined'){self.searchMenuPopup.modal('closeModal')}\nself.gridHandler.unselectAllAndReload();self.flagSuccess=true;if(response.products_ids.length>0){ListingGridHandlerObj.templateDescriptionHandler.openPopUp(0,M2ePro.translator.translate('templateDescriptionPopupTitle'),response.products_ids,response.html,1);}else{if(response.messages.length>0){MessageObj.clear();response.messages.each(function(msg){MessageObj['add'+msg.type[0].toUpperCase()+msg.type.slice(1)+'Message'](msg.text);});}}}});},searchGeneralIdManual:function(productId){var self=this;var query=$('query').value;MessageObj.clear();if(query==''){$('query').focus();self.alert(M2ePro.translator.translate('enter_productSearch_query'));return;}\n$('productSearch_error_block').hide();new Ajax.Request(M2ePro.url.get('amazon_listing_product_search/searchAsinManual'),{method:'post',parameters:{query:query,product_id:productId},onSuccess:function(transport){transport=transport.responseText.evalJSON();if(transport.result=='success'){$('productSearch_grid').update(transport.html);}else{$('productSearch_error_message').update(transport.text);$('productSearch_error_block').show();}}});},searchGeneralIdAuto:function(productIds){MessageObj.clear();var self=this;var selectedProductsString=productIds.toString();var selectedProductsArray=selectedProductsString.split(\",\");if(selectedProductsString==''||selectedProductsArray.length==0){return;}\nvar maxProductsInPart=10;var result=new Array();for(var i=0;i<selectedProductsArray.length;i++){if(result.length==0||result[result.length-1].length==maxProductsInPart){result[result.length]=new Array();}\nresult[result.length-1][result[result.length-1].length]=selectedProductsArray[i];}\nvar selectedProductsParts=result;ListingGridHandlerObj.actionHandler.progressBarObj.reset();ListingGridHandlerObj.actionHandler.progressBarObj.show(M2ePro.translator.translate('automap_asin_progress_title'));ListingGridHandlerObj.actionHandler.gridWrapperObj.lock();$$('.loading-mask').invoke('setStyle',{visibility:'hidden'});self.params.autoMapErrorFlag=false;self.sendPartsOfProducts(selectedProductsParts,selectedProductsParts.length,selectedProductsString);},sendPartsOfProducts:function(parts,totalPartsCount,selectedProductsString){var self=this;if(parts.length==0){ListingGridHandlerObj.actionHandler.progressBarObj.setStatus(M2ePro.translator.translate('task_completed_message'));ListingGridHandlerObj.actionHandler.gridWrapperObj.unlock();$$('.loading-mask').invoke('setStyle',{visibility:'visible'});self.gridHandler.unselectAllAndReload();if(self.params.autoMapErrorFlag==true){MessageObj.addErrorMessage(M2ePro.translator.translate('automap_error_message'));}\nsetTimeout(function(){ListingGridHandlerObj.actionHandler.progressBarObj.hide();ListingGridHandlerObj.actionHandler.progressBarObj.reset();},2000);new Ajax.Request(M2ePro.url.get('amazon_listing_product_search/getProductsSearchStatus'),{method:'post',parameters:{products_ids:selectedProductsString},onSuccess:function(transport){if(!transport.responseText.isJSON()){self.alert(transport.responseText);return;}\nvar response=transport.responseText.evalJSON();if(response.messages){MessageObj.clear();response.messages.each(function(msg){MessageObj['add'+msg.type[0].toUpperCase()+msg.type.slice(1)+'Message'](msg.text);});}}});return;}\nvar part=parts.splice(0,1);part=part[0];var partString=implode(',',part);var partExecuteString=part.length;partExecuteString+='';ListingGridHandlerObj.actionHandler.progressBarObj.setStatus(str_replace('%product_title%',partExecuteString,M2ePro.translator.translate('automap_asin_search_products')));new Ajax.Request(M2ePro.url.get('amazon_listing_product_search/searchAsinAuto'),{method:'post',parameters:{products_ids:partString},onSuccess:function(transport){if(transport.responseText==1){self.params.autoMapErrorFlag=true;}\nvar percents=(100 / totalPartsCount)*(totalPartsCount-parts.length);if(percents<=0){ListingGridHandlerObj.actionHandler.progressBarObj.setPercents(0,0);}else if(percents>=100){ListingGridHandlerObj.actionHandler.progressBarObj.setPercents(100,0);}else{ListingGridHandlerObj.actionHandler.progressBarObj.setPercents(percents,1);}\nsetTimeout(function(){self.sendPartsOfProducts(parts,totalPartsCount,selectedProductsString);},500);}});},mapToGeneralId:function(productId,generalId,optionsData){var self=this;self.confirm({actions:{confirm:function(){if(optionsData===undefined){optionsData='';}\nnew Ajax.Request(M2ePro.url.get('amazon_listing/mapToAsin'),{method:'post',parameters:{product_id:productId,general_id:generalId,options_data:decodeURIComponent(optionsData),search_type:$('amazon_asin_search_type').value,search_value:$('amazon_asin_search_value').value},onSuccess:function(transport){if(transport.responseText.isJSON()){var response=transport.responseText.evalJSON();if(response['vocabulary_attributes']){self.openVocabularyAttributesPopUp(response['vocabulary_attributes']);}\nif(response['vocabulary_attribute_options']){self.openVocabularyOptionsPopUp(response['vocabulary_attribute_options']);}\nself.gridHandler.unselectAllAndReload();return;}\nif(transport.responseText==0){self.gridHandler.unselectAllAndReload();}else{self.alert(transport.responseText);}}});self.popup.modal('closeModal');},cancel:function(){return false;}}});},openVocabularyAttributesPopUp:function(attributes){var self=this;new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_vocabulary/getAttributesPopup'),{onSuccess:function(transport){var containerEl=$('vocabulary_attributes_pupup');if(containerEl){containerEl.remove();}\n$('html-body').insert({bottom:transport.responseText});self.vocabularyAttributesPupup=jQuery('#vocabulary_attributes_pupup');modal({title:'Remember Attributes Accordance',type:'popup',buttons:[{text:M2ePro.translator.translate('No'),class:'action-secondary action-dismiss',click:function(){self.addAttributesToVocabulary(false);}},{text:M2ePro.translator.translate('Yes'),class:'action-primary action-accept',click:function(){self.addAttributesToVocabulary(true);}}]},self.vocabularyAttributesPupup);self.vocabularyAttributesPupup.modal('openModal');$('vocabulary_attributes_data').value=Object.toJSON(attributes);var attributesHtml='';$H(attributes).each(function(element){attributesHtml+='<li>'+element.key+' > '+element.value+'</li>';});attributesHtml='<ul style=\"list-style-position: inside;\">'+attributesHtml+'</ul>';var bodyHtml=str_replace('%attributes%',attributesHtml,$('vocabulary_attributes_pupup').innerHTML);$('vocabulary_attributes_pupup').update(bodyHtml);}});},addAttributesToVocabulary:function(needAdd){var self=this;var isRemember=$('vocabulary_attributes_remember_checkbox').checked;if(!needAdd&&!isRemember){self.vocabularyAttributesPupup.modal('closeModal');return;}\nnew Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_vocabulary/addAttributes'),{method:'post',parameters:{attributes:$('vocabulary_attributes_data').value,need_add:needAdd?1:0,is_remember:isRemember?1:0},onSuccess:function(transport){self.vocabularyAttributesPupup.modal('closeModal');}});},openVocabularyOptionsPopUp:function(options){var self=this;new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_vocabulary/getOptionsPopup'),{onSuccess:function(transport){var containerEl=$('vocabulary_options_pupup');if(containerEl){containerEl.remove();}\n$('html-body').insert({bottom:transport.responseText});self.vocabularyOptionsPopup=jQuery('#vocabulary_options_pupup');modal({title:'Vocabulary',type:'popup',closed:function(){self.reloadVariationsGrid();},buttons:[{text:M2ePro.translator.translate('No'),class:'action-secondary action-dismiss',click:function(){self.addOptionsToVocabulary(false);}},{text:M2ePro.translator.translate('Yes'),class:'action-primary action-accept',click:function(){self.addOptionsToVocabulary(true);}}]},self.vocabularyOptionsPopup);self.vocabularyOptionsPopup.modal('openModal');$('vocabulary_options_data').value=Object.toJSON(options);var optionsHtml='';$H(options).each(function(element){var valuesHtml='';$H(element.value).each(function(value){valuesHtml+=value.key+' > '+value.value;});optionsHtml+='<li>'+element.key+': '+valuesHtml+'</li>';});optionsHtml='<ul style=\"list-style-position: inside\">'+optionsHtml+'</ul>';var bodyHtml=str_replace('%options%',optionsHtml,$('vocabulary_options_pupup').innerHTML);$('vocabulary_options_pupup').update(bodyHtml);}});},addOptionsToVocabulary:function(needAdd){var self=this;var isRemember=$('vocabulary_options_remember_checkbox').checked;if(!needAdd&&!isRemember){self.vocabularyOptionsPopup.modal('closeModal');return;}\nnew Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_vocabulary/addOptions'),{method:'post',parameters:{options_data:$('vocabulary_options_data').value,need_add:needAdd?1:0,is_remember:isRemember?1:0},onSuccess:function(transport){self.vocabularyOptionsPopup.modal('closeModal');}});},unmapFromGeneralId:function(productIds,afterDoneFunction){var self=this;this.gridHandler.unselectAll();self.flagSuccess=false;new Ajax.Request(M2ePro.url.get('amazon_listing_product/unmapFromAsin'),{method:'post',parameters:{products_ids:productIds},onSuccess:function(transport){if(!transport.responseText.isJSON()){self.alert(transport.responseText);return;}\nself.gridHandler.unselectAllAndReload();self.flagSuccess=true;var response=transport.responseText.evalJSON();MessageObj.clear();MessageObj['add'+response.type[0].toUpperCase()+response.type.slice(1)+'Message'](response.message);},onComplete:function(){if(self.flagSuccess==true&&afterDoneFunction!=undefined){afterDoneFunction();}}});},specificsChange:function(select){var self=this;var idParts=explode('_',select.id);var id=idParts[2];var specifics=[];var selectedAsin='';$(select.id)&&self.hideEmptyOption($(select.id));self.validateSpecifics(id);var asins=JSON.parse(decodeHtmlentities($('asins_'+id).innerHTML));$('parent_asin_text_'+id).hide();$('map_link_error_icon_'+id).hide();$$('.specifics_'+id).each(function(el){var specificName=explode('_',el.id);specificName=specificName[1];specifics[specificName]=el.value;});for(var spec in asins){var productSpecifics=asins[spec].specifics;var found=true;for(var sName in productSpecifics){if(productSpecifics[sName]!=specifics[sName]){found=false;break;}}\nif(found){selectedAsin=spec;break;}}\nvar asinLink=$('asin_link_'+id);if(selectedAsin===''){$('map_link_error_icon_'+id).show();asinLink.innerHTML=$('parent_asin_'+id).innerHTML;asinLink.href=asinLink.href.slice(0,asinLink.href.lastIndexOf(\"/\"))+'/'+$('parent_asin_'+id).innerHTML;$('parent_asin_text_'+id).show();return $('map_link_'+id).innerHTML='<span style=\"color: #808080\">'+M2ePro.translator.translate('assign')+'</span>';}\nasinLink.innerHTML=selectedAsin;asinLink.href=asinLink.href.slice(0,asinLink.href.lastIndexOf(\"/\"))+'/'+selectedAsin;var mapLinkTemplate=$('template_map_link_'+id).innerHTML;mapLinkTemplate=mapLinkTemplate.replace('%general_id%',selectedAsin);asins=addslashes(encodeURIComponent(JSON.stringify(asins)));mapLinkTemplate=mapLinkTemplate.replace('%options_data%',asins);$('map_link_'+id).innerHTML=mapLinkTemplate;},validateSpecifics:function(id,variations,i){var variation=$H(variations||decodeHtmlentities($('channel_variations_tree_'+id).innerHTML).evalJSON()),attributes=$$('.specifics_name_'+id),options=$$('.specifics_'+id),index=i||0;if(index===0){options.each(function(el){el.disable();});}\nif(!attributes[index]||!options[index]){return;}\nvar attr=variation.keys()[0];var oldValue=decodeHtmlentities(options[index].value);options[index].update();options[index].enable();options[index].appendChild(new Element('option',{style:'display: none'}));$H(variation.get(attr)).each(function(option){options[index].appendChild(new Element('option',{value:option[0]})).insert(option[0]);if(option[0]==oldValue){options[index].value=oldValue;}});if(oldValue){index++;this.validateSpecifics(id,variation.get(attr)[oldValue],index);}},attributesChange:function(select){var self=this;var idParts=explode('_',select.id);var id=idParts[4];var optionsData={matched_attributes:{},variations:null};$(select.id)&&self.hideEmptyOption($(select.id));$('map_link_error_icon_'+id).hide();var existedValues=[];$$('.amazon_product_attribute_'+id).each(function(el){var attributeNumber=explode('_',el.id);attributeNumber=attributeNumber[3];if(el.value!=''&&existedValues.indexOf(el.value)===-1){var magentoAttribute=$('magento_product_attribute_'+attributeNumber+'_'+id);optionsData.matched_attributes[magentoAttribute.value]=el.value;existedValues.push(el.value);}else{optionsData='';throw $break;}});if(optionsData===''){$('map_link_error_icon_'+id).show();return $('map_link_'+id).innerHTML='<span style=\"color: #808080\">'+M2ePro.translator.translate('assign')+'</span>';}\noptionsData.variations=JSON.parse(decodeHtmlentities($('variations_'+id).innerHTML));optionsData=addslashes(encodeURIComponent(JSON.stringify(optionsData)));var mapLinkTemplate=$('template_map_link_'+id).innerHTML;mapLinkTemplate=mapLinkTemplate.replace('%options_data%',optionsData);$('map_link_'+id).innerHTML=mapLinkTemplate;},showAsinCategories:function(link,rowId,asin,productId){var self=this;new Ajax.Request(M2ePro.url.get('amazon_listing_product_search/getCategoriesByAsin'),{method:'post',parameters:{asin:asin,product_id:productId},onSuccess:function(transport){link.hide();if(!transport.responseText.isJSON()){self.alert(transport.responseText);return;}\nvar response=transport.responseText.evalJSON();var categoriesRow=$('asin_categories_'+rowId);if(response.data==''){$('asin_categories_not_found_'+rowId).show();}else{var i=3;response.data.each(function(item){var str=item.title;if(item.path){str=item.path+' > '+str;}\nstr=str+' ('+item.id+')';var row=new Element('p');row.setStyle({'color':'grey'});categoriesRow.appendChild(row).insert(str);i--;if(i<=0){throw $break;}});}}});},renderMatchedAttributesVirtualView:function(id){if(this.searchData[id].matchingType===this.MATCHING_TYPE_VIRTUAL_AMAZON){this.renderMatchedAttributesVirtualAmazonView(id);}\nif(this.searchData[id].matchingType===this.MATCHING_TYPE_VIRTUAL_MAGENTO){this.renderMatchedAttributesVirtualMagentoView(id);}},renderMatchedAttributesVirtualAmazonView:function(id){var self=this,form=$('matching_attributes_form_'+id),tHeader=form.down('.matching-attributes-table-header'),searchData=self.searchData[id];form.select('.matching-attributes-table-attribute-row').each(function(el){el.remove();});searchData.selectedDestinationAttributes=[];var prematchedAttributes=[];var i=0;$H(searchData.matchedAttributes).each(function(attribute){var tr=new Element('div',{style:'display: table-row',class:'matching-attributes-table-attribute-row'}),tdLabel=new Element('div',{class:'label',style:'display: table-cell; padding-bottom: 5px;'}),spanMagentoAttr=new Element('span',{class:'magento-attribute-name'}),inputVirtualAttribute=new Element('input',{style:'display: none',value:attribute.key,type:'hidden',disabled:'disabled',class:'virtual-amazon-attribute-name-value',name:'virtual_amazon_attributes_'+i}),selectVirtualAttributeOption=new Element('select',{style:'margin-top: 5px; display: none; width: 200px; font-size: 10px; background-position: calc(100% - 12px) -38px, 100%, calc(100% - 3.2rem) 0;',disabled:'disabled',class:'admin__control-select required-entry virtual-amazon-option',name:'virtual_amazon_option_'+i}),selectVirtualAttributeOptionGroup=new Element('optgroup',{label:attribute.key}),spanVirtualAttributeAndOption=new Element('span',{style:'display: none; line-height: 29px;',class:'virtual-amazon-attribute-and-option'}),spanLeftHelpIcon=new Element('span',{style:'display: none',class:'left-help-icon'}),tdValue=new Element('div',{class:'value',style:'display: table-cell; padding-bottom: 5px; padding-left: 10px;'}),inputMagentoAttr=new Element('input',{value:attribute.key,type:'hidden',class:'magento-attribute-name-value',name:'magento_attributes_'+i}),selectAmazonAttr=new Element('select',{class:'admin__control-select required-entry M2ePro-amazon-attribute-unique-value amazon-attribute-name',name:'amazon_attributes_'+i,style:'width: 250px; font-size: 11px; background-position: calc(100% - 12px) -38px, 100%, calc(100% - 3.2rem) 0;'}),spanVirtualAttribute=new Element('span',{style:'display: none; line-height: 33px;',class:'virtual-amazon-attribute-name'}),spanRightHelpIcon=new Element('span',{style:'display: none',class:'right-help-icon'});var helpIconTpl=$('product_search_help_icon_tpl');spanLeftHelpIcon.update(helpIconTpl.innerHTML);spanLeftHelpIcon.down('.tool-tip-message-text').update(M2ePro.translator.translate('help_icon_magento_greater_left'));spanRightHelpIcon.update(helpIconTpl.innerHTML);spanRightHelpIcon.down('.tool-tip-message-text').update(M2ePro.translator.translate('help_icon_magento_greater_right'));var attributeStr=attribute.key;if(attributeStr.length>16){attributeStr=attribute.key.substr(0,15)+'...';spanVirtualAttributeAndOption.title=attribute.key;spanVirtualAttribute.title=attribute.key;}\nif(attribute.key.length<31){spanMagentoAttr.update(attribute.key);}else{spanMagentoAttr.update(attribute.key.substr(0,28)+'...');spanMagentoAttr.title=attribute.key;}\nspanVirtualAttribute.update(attributeStr+' (<span>&ndash;</span>)');spanVirtualAttributeAndOption.update(attributeStr+' (<a href=\"javascript:void(0);\"></a>)');spanVirtualAttributeAndOption.down('a').title='';spanVirtualAttributeAndOption.down('a').observe('click',function(event){spanVirtualAttributeAndOption.hide();selectVirtualAttributeOption.show();selectVirtualAttributeOption.value='';spanVirtualAttribute.down('span').update('&ndash;');spanVirtualAttribute.down('span').title='';$('map_link_error_icon_'+id).show();$('map_link_'+id).innerHTML='<span style=\"color: #808080\">'+M2ePro.translator.translate('assign')+'</span>';});var option=new Element('option',{value:''});selectAmazonAttr.insert({bottom:option});searchData.destinationAttributes.each(function(destinationAttribute){var option=new Element('option',{value:destinationAttribute});option.update(destinationAttribute);selectAmazonAttr.insert({bottom:option});if(attribute.value==destinationAttribute){selectAmazonAttr.value=destinationAttribute;prematchedAttributes.push(selectAmazonAttr);}});selectAmazonAttr.prevValue='';selectAmazonAttr.observe('change',function(event){$('map_link_error_icon_'+id).show();$('map_link_'+id).innerHTML='<span style=\"color: #808080\">'+M2ePro.translator.translate('assign')+'</span>';var result=true;if(selectAmazonAttr.value!=''&&inputMagentoAttr.value!=selectAmazonAttr.value&&searchData.productAttributes.indexOf(selectAmazonAttr.value)!==-1){result=false;if(attribute.value==null){self.alert(M2ePro.text.duplicate_amazon_attribute_error);}\nselectAmazonAttr.value='';}\nattribute.value=null;var prevValueIndex=searchData.selectedDestinationAttributes.indexOf(selectAmazonAttr.prevValue);if(prevValueIndex>-1){searchData.selectedDestinationAttributes.splice(prevValueIndex,1);}\nif(selectAmazonAttr.value!=''){searchData.selectedDestinationAttributes.push(selectAmazonAttr.value);}\nselectAmazonAttr.prevValue=selectAmazonAttr.value;form.select('select').each(function(el){result=Validation.get('M2ePro-amazon-attribute-unique-value').test($F(el),el)?result:false;});if(result&&searchData.selectedDestinationAttributes.length==searchData.destinationAttributes.length){self.showVirtualAmazonAttributes(id);}else{self.hideVirtualAmazonAttributes(id);}});selectVirtualAttributeOption.observe('change',function(event){var value=selectVirtualAttributeOption.value;spanVirtualAttributeAndOption.show();selectVirtualAttributeOption.hide();if(attributeStr.length+value.length<28){spanVirtualAttribute.down('span').update(value);spanVirtualAttribute.down('span').title='';spanVirtualAttributeAndOption.down('a').update(value);}else{spanVirtualAttribute.down('span').update(value.substr(0,22-attributeStr.length)+'...');spanVirtualAttribute.down('span').title=value;spanVirtualAttributeAndOption.down('a').update(value.substr(0,22-attributeStr.length)+'...');}\nspanVirtualAttributeAndOption.down('a').title=M2ePro.text.change_option+' \"'+value+'\"';var result=true;form.select('select').each(function(el){if(Validation.isVisible(el)){el.classNames().each(function(className){var v=Validation.get(className),validationResult=v.test($F(el),el);result=validationResult?result:false;if(!validationResult){throw $break;}});}});if(result){$('map_link_error_icon_'+id).hide();var data={};data.virtual_matched_attributes=form.serialize(true);data.variations=searchData.amazonVariation;data=addslashes(encodeURIComponent(JSON.stringify(data)));var mapLinkTemplate=$('template_map_link_'+id).innerHTML;mapLinkTemplate=mapLinkTemplate.replace('%options_data%',data);$('map_link_'+id).innerHTML=mapLinkTemplate;}else{$('map_link_error_icon_'+id).show();$('map_link_'+id).innerHTML='<span style=\"color: #808080\">'+M2ePro.translator.translate('assign')+'</span>';}});var option=new Element('option',{value:''});selectVirtualAttributeOption.insert({bottom:option});searchData.magentoVariationSet[attribute.key].each(function(optionValue){var option=new Element('option',{value:optionValue});option.update(optionValue);selectVirtualAttributeOptionGroup.insert({bottom:option});});selectVirtualAttributeOption.insert({bottom:selectVirtualAttributeOptionGroup});tdLabel.insert({bottom:spanMagentoAttr});tdLabel.insert({bottom:inputVirtualAttribute});tdLabel.insert({bottom:selectVirtualAttributeOption});tdLabel.insert({bottom:spanVirtualAttributeAndOption});tdLabel.insert({bottom:spanLeftHelpIcon});tdValue.insert({bottom:inputMagentoAttr});tdValue.insert({bottom:selectAmazonAttr});tdValue.insert({bottom:spanVirtualAttribute});tdValue.insert({bottom:spanRightHelpIcon});tr.insert({bottom:tdLabel});tr.insert({bottom:tdValue});tHeader.insert({after:tr});i++;});prematchedAttributes.each(function(el){el.simulate('change');});},showVirtualAmazonAttributes:function(id){var self=this,form=$('matching_attributes_form_'+id);var virtualAmazonAttr=form.select('select.amazon-attribute-name[value=\"\"]');virtualAmazonAttr.each(function(el){el.disable().hide();var tr=el.up('.matching-attributes-table-attribute-row');tr.down('.magento-attribute-name-value').disable();tr.down('.virtual-amazon-attribute-name').show();tr.down('.magento-attribute-name').hide();tr.down('.virtual-amazon-attribute-name-value').enable();tr.down('.virtual-amazon-option').enable().show();tr.down('.right-help-icon').show();tr.down('.left-help-icon').show();});},hideVirtualAmazonAttributes:function(id){var self=this,form=$('matching_attributes_form_'+id);var virtualAmazonAttr=form.select('select.amazon-attribute-name[value=\"\"]');virtualAmazonAttr.each(function(el){el.enable().show();var tr=el.up('.matching-attributes-table-attribute-row');tr.down('.magento-attribute-name-value').enable();tr.down('.virtual-amazon-attribute-name').hide();tr.down('.magento-attribute-name').show();tr.down('.virtual-amazon-attribute-name-value').disable();tr.down('.virtual-amazon-option').disable().hide();tr.down('.virtual-amazon-attribute-and-option').hide();tr.down('.right-help-icon').hide();tr.down('.left-help-icon').hide();});},renderMatchedAttributesVirtualMagentoView:function(id){var self=this,form=$('matching_attributes_form_'+id),tHeader=form.down('.matching-attributes-table-header'),searchData=self.searchData[id];form.select('.matching-attributes-table-attribute-row').each(function(el){el.remove();});var prematchedAttributes=[];var i=0;$H(searchData.matchedAttributes).each(function(attribute){var tr=new Element('div',{style:'display: table-row',class:'matching-attributes-table-attribute-row'}),tdLabel=new Element('div',{class:'label',style:'display: table-cell; padding-bottom: 5px;'}),spanMagentoAttr=new Element('span'),tdValue=new Element('div',{class:'value',style:'display: table-cell; padding-bottom: 5px; padding-left: 10px;'}),inputMagentoAttr=new Element('input',{value:attribute.key,type:'hidden',name:'magento_attributes_'+i}),selectAmazonAttr=new Element('select',{class:'admin__control-select required-entry M2ePro-amazon-attribute-unique-value amazon-attribute-name',name:'amazon_attributes_'+i,style:'width: 250px; font-size: 11px; background-position: calc(100% - 12px) -38px, 100%, calc(100% - 3.2rem) 0;'});if(attribute.key.length<31){spanMagentoAttr.update(attribute.key);}else{spanMagentoAttr.update(attribute.key.substr(0,28)+'...');spanMagentoAttr.title=attribute.key;}\nvar option=new Element('option',{value:''});selectAmazonAttr.insert({bottom:option});searchData.destinationAttributes.each(function(destinationAttribute){var option=new Element('option',{value:destinationAttribute});option.update(destinationAttribute);selectAmazonAttr.insert({bottom:option});if(attribute.value==destinationAttribute){selectAmazonAttr.value=destinationAttribute;prematchedAttributes.push(selectAmazonAttr);}});selectAmazonAttr.prevValue='';selectAmazonAttr.observe('change',function(event){$('map_link_error_icon_'+id).show();$('map_link_'+id).innerHTML='<span style=\"color: #808080\">'+M2ePro.translator.translate('assign')+'</span>';var result=true;if(selectAmazonAttr.value!=''&&inputMagentoAttr.value!=selectAmazonAttr.value&&searchData.destinationAttributes.indexOf(inputMagentoAttr.value)!==-1){result=false;if(attribute.value==null){self.alert(M2ePro.text.duplicate_magento_attribute_error);}\nselectAmazonAttr.value='';}\nattribute.value=null;form.select('select.amazon-attribute-name').each(function(el){el.classNames().each(function(className){var v=Validation.get(className),validationResult=v.test($F(el),el);result=validationResult?result:false;if(!validationResult){throw $break;}});});if(result){self.showVirtualMagentoAttributes(id,i);}else{self.hideVirtualMagentoAttributes(id);}});tdLabel.insert({bottom:spanMagentoAttr});tdValue.insert({bottom:inputMagentoAttr});tdValue.insert({bottom:selectAmazonAttr});tr.insert({bottom:tdLabel});tr.insert({bottom:tdValue});tHeader.insert({after:tr});i++;});prematchedAttributes.each(function(el){el.simulate('change');});},showVirtualMagentoAttributes:function(id,lastAttributeIndex){var self=this,form=$('matching_attributes_form_'+id),tBody=form.down('.matching-attributes-table'),searchData=self.searchData[id];form.select('div.virtual-attribute').each(function(el){el.remove();});var selectedValues=[];form.select('select.amazon-attribute-name').each(function(el){selectedValues.push(el.value);});var i=lastAttributeIndex;searchData.destinationAttributes.each(function(attribute){if(selectedValues.indexOf(attribute)!==-1){return true;}\nvar tr=new Element('div',{style:'display: table-row',class:'matching-attributes-table-attribute-row virtual-attribute'}),tdLabel=new Element('div',{class:'label',style:'display: table-cell; padding-bottom: 5px;'}),spanMagentoAttr=new Element('div',{style:'float: left; padding-top: 9px;'}),spanLeftHelpIcon=new Element('span',{class:'left-help-icon'}),tdValue=new Element('div',{class:'value',style:'display: table-cell; padding-bottom: 5px; padding-left: 10px;'}),inputMagentoAttr=new Element('input',{value:attribute,type:'hidden',name:'virtual_magento_attributes_'+i}),spanVirtualAttribute=new Element('div',{style:'display: none; float: left; padding-top: 9px'}),selectVirtualAttrOption=new Element('select',{style:'width: 200px; font-size: 11px; background-position: calc(100% - 12px) -38px, 100%, calc(100% - 3.2rem) 0; float: left; margin-top: 3px',class:'admin__control-select required-entry virtual-magento-option',name:'virtual_magento_option_'+i}),virtualAttrOptionGroup=new Element('optgroup',{label:attribute}),spanRightHelpIcon=new Element('span',{class:'right-help-icon'});var helpIconTpl=$('product_search_help_icon_tpl');spanLeftHelpIcon.update(helpIconTpl.innerHTML);spanLeftHelpIcon.down('.tool-tip-message-text').update(M2ePro.translator.translate('help_icon_amazon_greater_left'));spanRightHelpIcon.update(helpIconTpl.innerHTML);spanRightHelpIcon.down('.tool-tip-message-text').update(M2ePro.translator.translate('help_icon_amazon_greater_right'));var attributeStr=attribute;if(attributeStr.length>13){attributeStr=attribute.substr(0,12)+'...';spanMagentoAttr.title=attribute;spanVirtualAttribute.title=attribute;}\nspanMagentoAttr.update(attributeStr+' (<span>&ndash;</span>)');spanVirtualAttribute.update(attributeStr+' (<a href=\"javascript:void(0);\"></a>)');spanVirtualAttribute.down('a').title='';spanVirtualAttribute.down('a').observe('click',function(event){spanVirtualAttribute.hide();selectVirtualAttrOption.show();selectVirtualAttrOption.value='';spanMagentoAttr.down('span').update('&ndash;');spanMagentoAttr.down('span').title='';$('map_link_error_icon_'+id).show();$('map_link_'+id).innerHTML='<span style=\"color: #808080\">'+M2ePro.translator.translate('assign')+'</span>';});var option=new Element('option',{value:''});selectVirtualAttrOption.insert({bottom:option});searchData.amazonVariation.set[attribute].each(function(optionValue){var option=new Element('option',{value:optionValue});option.update(optionValue);virtualAttrOptionGroup.insert({bottom:option});});selectVirtualAttrOption.insert({bottom:virtualAttrOptionGroup});selectVirtualAttrOption.observe('change',function(event){var value=selectVirtualAttrOption.value;spanVirtualAttribute.show();selectVirtualAttrOption.hide();if(attributeStr.length+value.length<28){spanMagentoAttr.down('span').update(value);spanMagentoAttr.down('span').title='';spanVirtualAttribute.down('a').update(value);}else{spanMagentoAttr.down('span').update(value.substr(0,27-attributeStr.length)+'...');spanMagentoAttr.down('span').title=value;spanVirtualAttribute.down('a').update(value.substr(0,27-attributeStr.length)+'...');}\nspanVirtualAttribute.down('a').title=M2ePro.text.change_option+' \"'+value+'\"';var result=true;form.select('select').each(function(el){el.classNames().each(function(className){var v=Validation.get(className),validationResult=v.test($F(el),el);result=validationResult?result:false;if(!validationResult){throw $break;}});});if(result){$('map_link_error_icon_'+id).hide();var data={};data.virtual_matched_attributes=form.serialize(true);data.variations=searchData.amazonVariation;data=addslashes(encodeURIComponent(JSON.stringify(data)));var mapLinkTemplate=$('template_map_link_'+id).innerHTML;mapLinkTemplate=mapLinkTemplate.replace('%options_data%',data);$('map_link_'+id).innerHTML=mapLinkTemplate;}else{$('map_link_error_icon_'+id).show();$('map_link_'+id).innerHTML='<span style=\"color: #808080\">'+M2ePro.translator.translate('assign')+'</span>';}});tdLabel.insert({bottom:spanMagentoAttr});tdLabel.insert({bottom:spanLeftHelpIcon});tdValue.insert({bottom:inputMagentoAttr});tdValue.insert({bottom:spanVirtualAttribute});tdValue.insert({bottom:selectVirtualAttrOption});tdValue.insert({bottom:spanRightHelpIcon});tr.insert({bottom:tdLabel});tr.insert({bottom:tdValue});tBody.insert({bottom:tr});i++;});},hideVirtualMagentoAttributes:function(id){var self=this,form=$('matching_attributes_form_'+id);form.select('div.virtual-attribute').each(function(el){el.remove();});}});});","Ess_M2ePro/js/Amazon/Listing/Product/Template/Shipping.min.js":"define(['Magento_Ui/js/modal/modal','M2ePro/Plugin/Messages','M2ePro/Action'],function(modal,MessageObj){window.AmazonListingProductTemplateShipping=Class.create(Action,{initialize:function($super,gridHandler){var self=this;$super(gridHandler);},options:{},setOptions:function(options){this.options=Object.extend(this.options,options);return this;},openPopUp:function(productsIds,shippingMode){var self=this;self.gridHandler.unselectAll();new Ajax.Request(M2ePro.url.get('amazon_listing_product_template_shipping/viewPopup'),{method:'post',parameters:{products_ids:productsIds,shipping_mode:shippingMode},onSuccess:function(transport){if(!transport.responseText.isJSON()){self.alert(transport.responseText);return;}\nvar response=transport.responseText.evalJSON();if(!response.html){if(response.messages.length>0){MessageObj.clear();response.messages.each(function(msg){MessageObj['add'+msg.type[0].toUpperCase()+msg.type.slice(1)+'Message'](msg.text);});}\nreturn;}\nvar popupElId=(shippingMode==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Account::SHIPPING_MODE_OVERRIDE'))?'#template_shippingOverride_pop_up_content':'#template_shippingTemplate_pop_up_content';var popupEl=jQuery(popupElId);if(popupEl.length){popupEl.remove();}\n$('html-body').insert({bottom:response.html});self.templateShippingPopup=jQuery(popupElId);var title=M2ePro.translator.translate('templateShippingTemplatePopupTitle');var addNewPolicyTitle=M2ePro.translator.translate('Add New Shipping Template Policy');if(shippingMode==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Account::SHIPPING_MODE_OVERRIDE')){title=M2ePro.translator.translate('templateShippingOverridePopupTitle');addNewPolicyTitle=M2ePro.translator.translate('Add New Shipping Override Policy');}\nmodal({title:title,type:'slide',buttons:[{text:M2ePro.translator.translate('Cancel'),click:function(){self.templateShippingPopup.modal('closeModal');}},{text:addNewPolicyTitle,class:'action primary ',click:function(){self.createInNewTab(self.newTemplateUrl,shippingMode);}}]},self.templateShippingPopup);self.templateShippingPopup.productsIds=response.products_ids;self.templateShippingPopup.modal('openModal');$('template_shipping_grid').observe('click',function(event){if(!event.target.hasClassName('assign-shipping-template')){return;}\nself.assign(event.target.getAttribute('templateShippingId'),shippingMode);});$('template_shipping_grid').on('click','.new-shipping-template',function(){self.createInNewTab(self.newTemplateUrl,shippingMode);});self.loadGrid(shippingMode);}});},loadGrid:function(shippingMode){var self=this;new Ajax.Request(M2ePro.url.get('amazon_listing_product_template_shipping/viewGrid'),{method:'post',parameters:{products_ids:self.templateShippingPopup.productsIds,shipping_mode:shippingMode},onSuccess:function(transport){$('template_shipping_grid').update(transport.responseText);$('template_shipping_grid').show();}});},assign:function(templateId,shippingMode){var self=this;self.confirm({actions:{confirm:function(){new Ajax.Request(M2ePro.url.get('amazon_listing_product_template_shipping/assign'),{method:'post',parameters:{products_ids:self.templateShippingPopup.productsIds,shipping_mode:shippingMode,template_id:templateId},onSuccess:function(transport){if(!transport.responseText.isJSON()){self.alert(transport.responseText);return;}\nself.gridHandler.unselectAllAndReload();var response=transport.responseText.evalJSON();MessageObj.clear();response.messages.each(function(msg){MessageObj['add'+msg.type[0].toUpperCase()+msg.type.slice(1)+'Message'](msg.text);});}});self.templateShippingPopup.modal('closeModal');},cancel:function(){return false;}}});},unassign:function(productsIds,shippingMode){var self=this;new Ajax.Request(M2ePro.url.get('amazon_listing_product_template_shipping/unassign'),{method:'post',parameters:{products_ids:productsIds,shipping_mode:shippingMode},onSuccess:function(transport){if(!transport.responseText.isJSON()){self.alert(transport.responseText);return;}\nself.gridHandler.unselectAllAndReload();var response=transport.responseText.evalJSON();MessageObj.clear();response.messages.each(function(msg){MessageObj['add'+msg.type[0].toUpperCase()+msg.type.slice(1)+'Message'](msg.text);});}});},createInNewTab:function(url,shippingMode){var self=this;var win=window.open(url);var intervalId=setInterval(function(){if(!win.closed){return;}\nclearInterval(intervalId);self.loadGrid(shippingMode);},1000);}});});","Ess_M2ePro/js/Amazon/Listing/Product/Template/ProductTaxCode.min.js":"define(['Magento_Ui/js/modal/modal','M2ePro/Plugin/Messages','M2ePro/Action'],function(modal,MessageObj){window.AmazonListingProductTemplateProductTaxCode=Class.create(Action,{initialize:function($super,gridHandler)\n{var self=this;$super(gridHandler);},options:{},setOptions:function(options)\n{this.options=Object.extend(this.options,options);return this;},openPopUp:function(productsIds)\n{var self=this;self.gridHandler.unselectAll();new Ajax.Request(M2ePro.url.get('amazon_listing_product_template_productTaxCode/viewPopup'),{method:'post',parameters:{products_ids:productsIds},onSuccess:function(transport){if(!transport.responseText.isJSON()){self.alert(transport.responseText);return}\nvar response=transport.responseText.evalJSON();if(!response.html){if(response.messages.length>0){MessageObj.clear();response.messages.each(function(msg){MessageObj['add'+msg.type[0].toUpperCase()+msg.type.slice(1)+'Message'](msg.text);});}\nreturn;}\nvar popupElId='#template_productTaxCode_pop_up_content';var popupEl=jQuery(popupElId);if(popupEl.length){popupEl.remove();}\n$('html-body').insert({bottom:response.html});self.templateProductTaxCodePopup=jQuery(popupElId);modal({title:M2ePro.translator.translate('templateProductTaxCodePopupTitle'),type:'slide',buttons:[{text:M2ePro.translator.translate('Cancel'),click:function(){self.templateProductTaxCodePopup.modal('closeModal');}},{text:M2ePro.translator.translate('Add New Product Tax Code Policy'),class:'action primary ',click:function(){self.createInNewTab(self.newTemplateUrl);}}]},self.templateProductTaxCodePopup);self.templateProductTaxCodePopup.productsIds=response.products_ids;self.templateProductTaxCodePopup.modal('openModal');var grid=$('template_productTaxCode_grid');grid.observe('click',function(event){if(!event.target.hasClassName('assign-productTaxCode-template')){return;}\nself.assign(event.target.getAttribute('templateProductTaxCodeId'));});grid.on('click','.new-productTaxCode-template',function(){self.createInNewTab(self.newTemplateUrl);});self.loadGrid();}});},assign:function(templateId)\n{var self=this;self.confirm({actions:{confirm:function(){new Ajax.Request(M2ePro.url.get('amazon_listing_product_template_productTaxCode/assign'),{method:'post',parameters:{products_ids:self.templateProductTaxCodePopup.productsIds,template_id:templateId},onSuccess:function(transport){if(!transport.responseText.isJSON()){self.alert(transport.responseText);return;}\nself.gridHandler.unselectAllAndReload();var response=transport.responseText.evalJSON();MessageObj.clear();response.messages.each(function(msg){MessageObj['add'+msg.type[0].toUpperCase()+msg.type.slice(1)+'Message'](msg.text);});}});self.templateProductTaxCodePopup.modal('closeModal');},cancel:function(){return false;}}});},unassign:function(productsIds)\n{var self=this;new Ajax.Request(M2ePro.url.get('amazon_listing_product_template_productTaxCode/unassign'),{method:'post',parameters:{products_ids:productsIds},onSuccess:function(transport){if(!transport.responseText.isJSON()){alert(transport.responseText);return;}\nself.gridHandler.unselectAllAndReload();var response=transport.responseText.evalJSON();MessageObj.clear();response.messages.each(function(msg){MessageObj['add'+msg.type[0].toUpperCase()+msg.type.slice(1)+'Message'](msg.text);});}});},loadGrid:function()\n{var self=this;new Ajax.Request(M2ePro.url.get('amazon_listing_product_template_productTaxCode/viewGrid'),{method:'post',parameters:{products_ids:self.templateProductTaxCodePopup.productsIds},onSuccess:function(transport){var grid=$('template_productTaxCode_grid');grid.update(transport.responseText);grid.show();}});},createInNewTab:function(stepWindowUrl)\n{var self=this;var win=window.open(stepWindowUrl);var intervalId=setInterval(function(){if(!win.closed){return;}\nclearInterval(intervalId);self.loadGrid();},1000);}});});","Ess_M2ePro/js/Amazon/Listing/Product/Template/Description.min.js":"define(['Magento_Ui/js/modal/modal','M2ePro/Plugin/Messages','M2ePro/Action'],function(modal,MessageObj){window.AmazonListingProductTemplateDescription=Class.create(Action,{initialize:function($super,gridHandler){var self=this;$super(gridHandler);},options:{},setOptions:function(options){this.options=Object.extend(this.options,options);return this;},mapToTemplateDescription:function(el,templateId,mapToGeneralId){var self=this;self.confirm({actions:{confirm:function(){new Ajax.Request(M2ePro.url.get('amazon_listing_product_template_description/assign'),{method:'post',parameters:{products_ids:self.templateDescriptionPopup.productsIds,template_id:templateId},onSuccess:function(transport){if(!transport.responseText.isJSON()){self.alert(transport.responseText);return;}\nvar response=transport.responseText.evalJSON();if(mapToGeneralId){ListingGridHandlerObj.productSearchHandler.addNewGeneralId(response.products_ids);}else{self.gridHandler.unselectAllAndReload();if(response.messages.length>0){MessageObj.clear();response.messages.each(function(msg){MessageObj['add'+response.type[0].toUpperCase()+response.type.slice(1)+'Message'](msg);});}}}});self.templateDescriptionPopup.modal('closeModal');},cancel:function(){return false;}}});},unassignFromTemplateDescription:function(productsIds){var self=this;new Ajax.Request(M2ePro.url.get('amazon_listing_product_template_description/unassign'),{method:'post',parameters:{products_ids:productsIds},onSuccess:function(transport){if(!transport.responseText.isJSON()){self.alert(transport.responseText);return;}\nself.gridHandler.unselectAllAndReload();var response=transport.responseText.evalJSON();MessageObj.clear();response.messages.each(function(msg){MessageObj['add'+msg.type[0].toUpperCase()+msg.type.slice(1)+'Message'](msg.text);});}});},validateProductsForTemplateDescriptionAssign:function(productsIds){var self=this;self.flagSuccess=false;productsIds=productsIds||ListingGridHandlerObj.productSearchHandler.params.productId;new Ajax.Request(M2ePro.url.get('amazon_listing_product_template_description/validateProductsForAssign'),{method:'post',parameters:{products_ids:productsIds},onSuccess:function(transport){if(!transport.responseText.isJSON()){self.alert(transport.responseText);return;}\nvar response=transport.responseText.evalJSON();if(response.messages.length>0){MessageObj.clear();response.messages.each(function(msg){MessageObj['add'+msg.type[0].toUpperCase()+msg.type.slice(1)+'Message'](msg.text);});}\nif(!response.html){return;}\nif(typeof popUp!='undefined'){self.templateDescriptionPopup.modal('closeModal');}\nself.openPopUp(0,M2ePro.translator.translate('templateDescriptionPopupTitle'),response.products_ids,response.html);}});},openPopUp:function(mode,title,productsIds,contentData,checkIsNewAsinAccepted){var self=this;self.gridHandler.unselectAll();MessageObj.clear();var popupEl=$('template_description_pop_up_content');if(popupEl){popupEl.remove();}\n$('html-body').insert({bottom:contentData});self.templateDescriptionPopup=jQuery('#template_description_pop_up_content');modal({title:title,type:'slide',buttons:[{text:M2ePro.translator.translate('Cancel'),click:function(){self.templateDescriptionPopup.modal('closeModal');}},{text:M2ePro.translator.translate('Add New Description Policy'),class:'action primary ',click:function(){self.createTemplateDescriptionInNewTab(M2ePro.url.get('newTemplateDescriptionUrl'));}}]},self.templateDescriptionPopup);self.templateDescriptionPopup.modal('openModal');self.templateDescriptionPopup.productsIds=productsIds;self.templateDescriptionPopup.checkIsNewAsinAccepted=checkIsNewAsinAccepted||0;self.loadTemplateDescriptionGrid();},loadTemplateDescriptionGrid:function(){var self=this;new Ajax.Request(M2ePro.url.get('amazon_listing_product_template_description/viewGrid'),{method:'post',parameters:{products_ids:self.templateDescriptionPopup.productsIds,check_is_new_asin_accepted:self.templateDescriptionPopup.checkIsNewAsinAccepted},onSuccess:function(transport){$('template_description_grid').update(transport.responseText);$('template_description_grid').show();}});},createTemplateDescriptionInNewTab:function(stepWindowUrl){var self=this;var win=window.open(stepWindowUrl);var intervalId=setInterval(function(){if(!win.closed){return;}\nclearInterval(intervalId);amazonTemplateDescriptionGridJsObject.reload();},1000);}});});","Ess_M2ePro/js/Amazon/Listing/Product/Add/SearchAsin/Grid.min.js":"define(['Magento_Ui/js/modal/modal','M2ePro/Plugin/Messages','M2ePro/Listing/View/Grid','M2ePro/Amazon/Listing/View/Action','M2ePro/Amazon/Listing/Product/Search'],function(modal,MessageObj){AmazonListingProductAddSearchAsinGrid=Class.create(ListingViewGrid,{getComponent:function(){return'amazon';},getMaxProductsInPart:function(){return 1000;},prepareActions:function($super){$super();this.actionHandler=new AmazonListingViewAction(this);this.productSearchHandler=new AmazonListingProductSearch(this);this.actions=Object.extend(this.actions,{assignGeneralIdAction:(function(){this.productSearchHandler.searchGeneralIdAuto(this.getSelectedProductsString())}).bind(this),unassignGeneralIdAction:(function(){this.productSearchHandler.unmapFromGeneralId(this.getSelectedProductsString())}).bind(this)});this.productSearchHandler.clearSearchResultsAndOpenSearchMenu=function(){var self=this;self.confirm({actions:{confirm:function(){self.popup.modal('closeModal');self.unmapFromGeneralId(self.params.productId);},cancel:function(){return false;}}});};},parseResponse:function(response){if(!response.responseText.isJSON()){return;}\nreturn response.responseText.evalJSON();},afterInitPage:function($super){$super();},editSearchSettings:function(title,listingId){var self=this;MessageObj.clear();new Ajax.Request(M2ePro.url.get('amazon_listing_product_add/viewSearchSettings'),{method:'post',parameters:{id:listingId},onSuccess:function(transport){if(!$('edit_search_settings_popup')){$('html-body').insert({bottom:'<div id=\"edit_search_settings_popup\"></div>'});}\n$('edit_search_settings_popup').update(transport.responseText);$('breadcrumb_container').remove();self.searchSettnigsPopup=jQuery('#edit_search_settings_popup');modal({title:title,type:'slide',buttons:[{text:M2ePro.translator.translate('Cancel'),click:function(){self.searchSettnigsPopup.modal('closeModal');}},{text:M2ePro.translator.translate('Confirm'),class:'action primary',click:function(){ListingGridHandlerObj.saveSearchSettings();self.searchSettnigsPopup.modal('closeModal');}}]},self.searchSettnigsPopup);self.searchSettnigsPopup.modal('openModal');self.searchSettnigsPopup.listingId=listingId;}});},saveSearchSettings:function(){var self=this,data;if(self.searchSettingsForm&&!self.searchSettingsForm.validate()){return;}\ndata=$('edit_form').serialize(true);data.id=self.searchSettnigsPopup.listingId;new Ajax.Request(M2ePro.url.get('amazon_listing_product_add/saveSearchSettings'),{method:'post',parameters:data,onSuccess:function(transport){self.actionHandler.gridHandler.unselectAllAndReload();self.searchSettnigsPopup.modal('closeModal');}});},checkSearchResults:function(listingId){var self=this;new Ajax.Request(M2ePro.url.get('amazon_listing_product_add/checkSearchResults'),{method:'post',parameters:{id:listingId},onSuccess:function(transport){var response=self.parseResponse(transport);if(response.redirect){return setLocation(response.redirect);}\nif(!$('search_asin_new_asin_popup')){$('html-body').insert({bottom:response.html});}\nself.newAsinPopup=jQuery('#search_asin_new_asin_popup');modal({title:M2ePro.translator.translate('new_asin_popup_title'),type:'popup',buttons:[{class:'action-secondary action-dismiss',text:M2ePro.translator.translate('No'),click:function(){self.showNewAsinPopup(0);}},{text:M2ePro.translator.translate('Yes'),class:'action-primary action-accept',click:function(){self.showNewAsinPopup(1);}}]},self.newAsinPopup);var modalHeader=jQuery('#search_asin_new_asin_popup').closest('.modal-inner-wrap').find('h1.modal-title'),tips=jQuery('#new_asin_title_help_tips');tips.insertAfter(modalHeader);tips.show();self.newAsinPopup.modal('openModal');self.newAsinPopup.listingId=listingId;}});},showNewAsinPopup:function(showNewAsinStep){var self=this,remember=$('asin_search_new_asin_remember_checkbox').checked;new Ajax.Request(M2ePro.url.get('amazon_listing_product_add/showNewAsinStep'),{method:'post',parameters:{show_new_asin_step:+showNewAsinStep,remember:+remember,id:self.newAsinPopup.listingId},onSuccess:function(transport){var response=self.parseResponse(transport);if(response.redirect){return setLocation(response.redirect);}}});self.newAsinPopup.modal('closeModal');},showNotCompletedPopup:function(){var self=this;if(!$('not_completed_popup')){$('html-body').insert({bottom:'<div id=\"not_completed_popup\">'+M2ePro.translator.translate('not_completed_popup_text')+'</div>'});}\nvar popup=jQuery('#not_completed_popup');modal({title:M2ePro.translator.translate('not_completed_popup_title'),type:'popup',buttons:[{text:M2ePro.translator.translate('Close'),class:'action-secondary action-dismiss',click:function(){popup.modal('closeModal');}}]},popup);popup.modal('openModal');}});});","Ess_M2ePro/js/Amazon/Listing/Product/Add/NewAsin/Template/Description/Grid.min.js":"define(['Magento_Ui/js/modal/modal','M2ePro/Plugin/Messages','M2ePro/Listing/View/Grid','M2ePro/Amazon/Listing/View/Action','M2ePro/Amazon/Listing/Product/Template/Description'],function(modal,MessageObj){window.AmazonListingProductAddNewAsinTemplateDescriptionGrid=Class.create(ListingViewGrid,{getComponent:function(){return'amazon';},getMaxProductsInPart:function(){return 1000;},prepareActions:function($super){$super();this.actionHandler=new AmazonListingViewAction(this);this.templateDescriptionHandler=new AmazonListingProductTemplateDescription(this);this.actions=Object.extend(this.actions,{setDescriptionTemplateAction:(function(){this.mapToNewAsin(this.getSelectedProductsString())}).bind(this),resetDescriptionTemplateAction:(function(){this.unmapFromNewAsin(this.getSelectedProductsString())}).bind(this),setDescriptionTemplateByCategoryAction:(function(){this.mapToNewAsin(this.getSelectedProductsStringFromCategory())}).bind(this),resetDescriptionTemplateByCategoryAction:(function(){this.unmapFromNewAsin(this.getSelectedProductsStringFromCategory())}).bind(this)});},parseResponse:function(response){if(!response.responseText.isJSON()){return;}\nreturn response.responseText.evalJSON();},afterInitPage:function($super){$super();},setDescriptionTemplateRowAction:function(id){this.mapToNewAsin(id);},resetDescriptionTemplateRowAction:function(id){this.unmapFromNewAsin(id);},setDescriptionTemplateByCategoryRowAction:function(id){this.mapToNewAsin(this.getSelectedProductsStringFromCategory(id));},resetDescriptionTemplateByCategoryRowAction:function(id){this.unmapFromNewAsin(this.getSelectedProductsStringFromCategory(id));},getSelectedProductsStringFromCategory:function(categoryIds){var productsIdsStr='';categoryIds=categoryIds||this.getGridMassActionObj().checkedString;categoryIds=explode(',',categoryIds);categoryIds.each(function(categoryId){if(productsIdsStr!=''){productsIdsStr+=',';}\nproductsIdsStr+=$('products_ids_'+categoryId).value;});return productsIdsStr;},mapToNewAsin:function(listingProductIds){var self=this;new Ajax.Request(M2ePro.url.get('amazon_listing_product/mapToNewAsin'),{method:'post',parameters:{products_ids:listingProductIds},onSuccess:function(transport){if(!transport.responseText.isJSON()){self.alert(transport.responseText);return;}\nvar response=transport.responseText.evalJSON();self.templateDescriptionHandler.gridHandler.unselectAllAndReload();if(response.products_ids.length>0){ListingGridHandlerObj.templateDescriptionHandler.openPopUp(0,M2ePro.translator.translate('templateDescriptionPopupTitle'),response.products_ids,response.html,1);}else{if(response.messages.length>0){MessageObj.clear();response.messages.each(function(msg){MessageObj['add'+msg.type[0].toUpperCase()+msg.type.slice(1)+'Message'](msg.text);});}}}});},unmapFromNewAsin:function(productsIds){var self=this;self.templateDescriptionHandler.gridHandler.unselectAll();new Ajax.Request(M2ePro.url.get('amazon_listing_product/unmapFromAsin'),{method:'post',parameters:{products_ids:productsIds},onSuccess:function(transport){if(!transport.responseText.isJSON()){self.alert(transport.responseText);return;}\nvar response=transport.responseText.evalJSON();if(response.type=='success'){self.templateDescriptionHandler.unassignFromTemplateDescription(productsIds);}}});},mapToTemplateDescription:function(el,templateId,mapToGeneralId){var self=this;new Ajax.Request(M2ePro.url.get('amazon_listing_product_template_description/assign'),{method:'post',parameters:{products_ids:ListingGridHandlerObj.templateDescriptionHandler.templateDescriptionPopup.productsIds,template_id:templateId},onSuccess:function(transport){if(!transport.responseText.isJSON()){self.alert(transport.responseText);return;}\nvar response=transport.responseText.evalJSON();self.mapToNewAsin(response.products_ids);}});ListingGridHandlerObj.templateDescriptionHandler.templateDescriptionPopup.modal('closeModal');},checkCategoryProducts:function(url){var self=this;new Ajax.Request(M2ePro.url.get('amazon_listing_product_add/checkNewAsinCategoryProducts'),{method:'post',onSuccess:function(transport){if(transport.responseText==1){setLocation(url);}else{if(!transport.responseText.isJSON()){self.alert(transport.responseText);return;}\nvar response=transport.responseText.evalJSON();MessageObj.clear();MessageObj['add'+response.type[0].toUpperCase()+response.type.slice(1)+'Message'](response.text);}}});},checkManualProducts:function(url){var self=this;new Ajax.Request(M2ePro.url.get('amazon_listing_product_add/checkNewAsinManualProducts'),{method:'post',onSuccess:function(transport){if(transport.responseText==1){setLocation(url);}else{if(!transport.responseText.isJSON()){self.alert(transport.responseText);return;}\nvar response=transport.responseText.evalJSON();if($('new_asin_skip_popup_content')){$('new_asin_skip_popup_content').remove();}\n$('html-body').insert({bottom:response.html});$('total_count').innerHTML=response.total_count;$('failed_count').update(response.failed_count);self.skipPopup=jQuery('#new_asin_skip_popup_content');modal({title:M2ePro.translator.translate('setDescriptionPolicy'),type:'popup',buttons:[{text:M2ePro.translator.translate('Cancel'),class:'action-secondary action-dismiss',click:function(){self.skipPopup.modal('closeModal');}},{text:M2ePro.translator.translate('Continue'),class:'action-primary action-accept',click:function(){setLocation(response.continueUrl);self.skipPopup.modal('closeModal');}}]},self.skipPopup);self.skipPopup.modal('openModal');}}});}});});","Ess_M2ePro/js/Amazon/Listing/Product/Add/SourceMode/Category/Summary/Grid.min.js":"define(['M2ePro/Grid'],function(){window.AmazonListingProductAddSourceModeCategorySummaryGrid=Class.create(Grid,{prepareActions:function(){this.actions={removeAction:this.remove.bind(this)};},remove:function(){var self=this;Grid.prototype.confirm({actions:{confirm:function(){var url=M2ePro.url.get('amazon_listing_product_add/removeSessionProductsByCategory');new Ajax.Request(url,{parameters:{ids:self.getSelectedProductsString()},onSuccess:self.unselectAllAndReload.bind(self)});},cancel:function(){return false;}}});},confirm:function(config){if(config.actions&&config.actions.confirm){config.actions.confirm();}}});});","Ess_M2ePro/js/Amazon/Listing/Product/Repricing/Price.min.js":"define([],function(){window.AmazonListingProductRepricingPrice=Class.create();AmazonListingProductRepricingPrice.prototype={initialize:function(containerId){},showRepricingPrice:function(){var groupedSkus={};$$('.m2epro-repricing-price-value').each(function(el){var accountId=el.getAttribute('account_id');if(typeof groupedSkus[accountId]=='undefined'){groupedSkus[accountId]=[]}\ngroupedSkus[accountId][groupedSkus[accountId].length]=el.getAttribute('sku');});groupedSkus=JSON.stringify(groupedSkus);new Ajax.Request(M2ePro.url.get('amazon_listing_product_repricing/getUpdatedPriceBySkus'),{method:'post',parameters:{grouped_skus:groupedSkus},onSuccess:function(transport){var resultData=transport.responseText.evalJSON();$H(resultData).each(function(item){$H(item.value).each(function(priceItem){$('m2epro_repricing_price_value_'+priceItem.key).update(priceItem.value)});});}});}};});","Ess_M2ePro/js/Amazon/Listing/Product/Variation/Manage.min.js":"define(['M2ePro/Plugin/Messages','Magento_Ui/js/modal/modal','M2ePro/Action'],function(MessageObj,modal){window.AmazonListingProductVariationManage=Class.create(Action,{MATCHING_TYPE_EQUAL:1,MATCHING_TYPE_VIRTUAL_AMAZON:2,MATCHING_TYPE_VIRTUAL_MAGENTO:3,initialize:function($super,gridHandler){var self=this;$super(gridHandler);},options:{},matchingType:1,matchedAttributes:[],productAttributes:[],destinationAttributes:[],selectedDestinationAttributes:[],magentoVariationSet:[],amazonVariationSet:false,setOptions:function(options){this.options=Object.extend(this.options,options);this.initValidators();return this;},initValidators:function(){var self=this;jQuery.validator.addMethod('M2ePro-amazon-attribute-unique-value',function(value,el){var existedValues=[],isValid=true,form=el.up('form');form.select('select').each(function(el){if(el.value!=''){if(existedValues.indexOf(el.value)===-1){existedValues.push(el.value);}else{isValid=false;}}});return isValid;},M2ePro.translator.translate('variation_manage_matched_attributes_error_duplicate'));},initSettingsTab:function(){var self=this,form=$('variation_manager_attributes_form');if(form&&self.matchingType==self.MATCHING_TYPE_EQUAL){form.observe('change',function(e){if(e.target.tagName!='SELECT'){return;}\n$(e.target).select('.empty')&&$(e.target).select('.empty').length&&$(e.target).select('.empty')[0].hide();});}},parseResponse:function(response){if(!response.responseText.isJSON()){return;}\nreturn response.responseText.evalJSON();},openPopUp:function(productId,title,filter){var self=this;MessageObj.clear();new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation/manage'),{method:'post',parameters:{product_id:productId,filter:filter},onSuccess:function(transport){var containerEl=$('variation_manage_tabs_container');if(containerEl){containerEl.remove();}\n$('html-body').insert({bottom:transport.responseText});self.variationProductManagePopup=jQuery('#variation_manage_tabs_container');modal({title:title.escapeHTML(),type:'slide',closed:function(){self.gridHandler.unselectAllAndReload();},buttons:[]},self.variationProductManagePopup);self.variationProductManagePopup.modal('openModal');self.variationProductManagePopup.productId=productId;self.initSettingsTab();}});},closeManageVariationsPopup:function(){this.variationProductManagePopup.modal('closeModal');},openVocabularyAttributesPopUp:function(attributes){var self=this;new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_vocabulary/getAttributesPopup'),{onSuccess:function(transport){var containerEl=$('vocabulary_attributes_pupup');if(containerEl){containerEl.remove();}\n$('html-body').insert({bottom:transport.responseText});self.vocabularyAttributesPupup=jQuery('#vocabulary_attributes_pupup');modal({title:'Vocabulary',type:'popup',closed:function(){self.reloadVariationsGrid();},buttons:[{text:M2ePro.translator.translate('No'),class:'action-secondary action-dismiss',click:function(){self.addAttributesToVocabulary(false);}},{text:M2ePro.translator.translate('Yes'),class:'action-primary action-accept',click:function(){self.addAttributesToVocabulary(true);}}]},self.vocabularyAttributesPupup);self.vocabularyAttributesPupup.modal('openModal');$('vocabulary_attributes_data').value=Object.toJSON(attributes);var attributesHtml='';$H(attributes).each(function(element){attributesHtml+='<li>'+element.key+' > '+element.value+'</li>';});attributesHtml='<ul style=\"list-style-position: inside;\">'+attributesHtml+'</ul>';var bodyHtml=str_replace('%attributes%',attributesHtml,$('vocabulary_attributes_pupup').innerHTML);$('vocabulary_attributes_pupup').update(bodyHtml);}});},addAttributesToVocabulary:function(needAdd){var self=this;var isRemember=$('vocabulary_attributes_remember_checkbox').checked;if(!needAdd&&!isRemember){self.vocabularyAttributesPupup.modal('closeModal');return;}\nnew Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_vocabulary/addAttributes'),{method:'post',parameters:{attributes:$('vocabulary_attributes_data').value,need_add:needAdd?1:0,is_remember:isRemember?1:0},onSuccess:function(transport){self.vocabularyAttributesPupup.modal('closeModal');}});},openVocabularyOptionsPopUp:function(options){var self=this;new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_vocabulary/getOptionsPopup'),{onSuccess:function(transport){var containerEl=$('vocabulary_options_pupup');if(containerEl){containerEl.remove();}\n$('html-body').insert({bottom:transport.responseText});self.vocabularyOptionsPopup=jQuery('#vocabulary_options_pupup');modal({title:'Vocabulary',type:'popup',closed:function(){self.reloadVariationsGrid();},buttons:[{text:M2ePro.translator.translate('No'),class:'action-secondary action-dismiss',click:function(){self.addOptionsToVocabulary(false);}},{text:M2ePro.translator.translate('Yes'),class:'action-primary action-accept',click:function(){self.addOptionsToVocabulary(true);}}]},self.vocabularyOptionsPopup);self.vocabularyOptionsPopup.modal('openModal');$('vocabulary_options_data').value=Object.toJSON(options);var optionsHtml='';$H(options).each(function(element){var valuesHtml='';$H(element.value).each(function(value){valuesHtml+=value.key+' > '+value.value;});optionsHtml+='<li>'+element.key+': '+valuesHtml+'</li>';});optionsHtml='<ul style=\"list-style-position: inside;\">'+optionsHtml+'</ul>';var bodyHtml=str_replace('%options%',optionsHtml,$('vocabulary_options_pupup').innerHTML);$('vocabulary_options_pupup').update(bodyHtml);}});},addOptionsToVocabulary:function(needAdd){var self=this;var isRemember=$('vocabulary_options_remember_checkbox').checked;if(!needAdd&&!isRemember){self.vocabularyOptionsPopup.modal('closeModal');return;}\nnew Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_vocabulary/addOptions'),{method:'post',parameters:{options_data:$('vocabulary_options_data').value,need_add:needAdd?1:0,is_remember:isRemember?1:0},onSuccess:function(transport){self.vocabularyOptionsPopup.modal('closeModal');}});},setGeneralIdOwner:function(value,hideConfirm){var self=this,confirmAction;confirmAction=function(){new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_manage/setGeneralIdOwner'),{method:'post',parameters:{product_id:self.variationProductManagePopup.productId,general_id_owner:value},onSuccess:function(transport){var response=self.parseResponse(transport);if(response.success){return self.reloadVariationsGrid();}\nif(response.empty_sku){return self.openSkuPopUp();}\nself.openDescriptionTemplatePopUp(response.html);}});};if(hideConfirm){confirmAction();}else{self.confirm({actions:{confirm:function(){confirmAction();},cancel:function(){return false;}}});}},openSkuPopUp:function(){var self=this;new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_manage/getSkuPopup'),{method:'post',parameters:{product_id:self.variationProductManagePopup.productId},onSuccess:function(transport){var containerEl=$('manage_variation_sku_popup');if(containerEl){containerEl.remove();}\n$('html-body').insert({bottom:transport.responseText});self.skuPopup=jQuery('#manage_variation_sku_popup');modal({title:M2ePro.translator.translate('variation_manage_matched_sku_popup_title'),type:'popup',modalClass:'width-50',buttons:[{text:M2ePro.translator.translate('Cancel'),class:'action-secondary action-dismiss',click:function(){self.skuPopup.modal('closeModal');}},{text:M2ePro.translator.translate('Confirm'),class:'action-primary action-accept',click:function(){self.setProductSku();}}]},self.skuPopup);self.skuPopup.modal('openModal');}});},setProductSku:function(){var self=this,data;this.initFormValidation('#variation_manager_sku_form');if(!jQuery('#variation_manager_sku_form').valid()){return;}\ndata=$('variation_manager_sku_form').serialize(true);data.product_id=self.variationProductManagePopup.productId;new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_manage/setListingProductSku'),{method:'post',parameters:data,onSuccess:function(transport){var response=self.parseResponse(transport);if(response.success){self.skuPopup.modal('closeModal');self.setGeneralIdOwner(1,true);}else{var skuError=$('sku-error');if(!skuError){skuError=new Element('label',{id:'sku-error',for:'sku',class:'error',generated:true});$('sku').insert({after:skuError})}\nskuError.update(response.msg);skuError.show();}}});},openDescriptionTemplatePopUp:function(contentData){var self=this;self.gridHandler.unselectAll();MessageObj.clear();if(!$('template_description_pop_up_content')){$('html-body').insert({bottom:contentData});}\nself.templateDescriptionPopup=jQuery('#template_description_pop_up_content');modal({title:M2ePro.translator.translate('templateDescriptionPopupTitle'),type:'slide',buttons:[{text:M2ePro.translator.translate('Add New Description Policy'),class:'action primary ',click:function(){ListingGridHandlerObj.templateDescriptionHandler.createTemplateDescriptionInNewTab(M2ePro.url.get('newTemplateDescriptionUrl'));}}]},self.templateDescriptionPopup);self.templateDescriptionPopup.modal('openModal');self.templateDescriptionPopup.productsIds=self.variationProductManagePopup.productId;self.templateDescriptionPopup.checkIsNewAsinAccepted=1;self.loadTemplateDescriptionGrid();},loadTemplateDescriptionGrid:function(){var self=this;new Ajax.Request(M2ePro.url.get('amazon_listing_product_template_description/viewGrid'),{method:'post',parameters:{products_ids:self.variationProductManagePopup.productId,check_is_new_asin_accepted:1,map_to_template_js_fn:'ListingGridHandlerObj.variationProductManageHandler.mapToTemplateDescription'},onSuccess:function(transport){$('template_description_grid').update(transport.responseText);$('template_description_grid').show();}});},mapToTemplateDescription:function(el,templateId,mapToGeneralId){var self=this;new Ajax.Request(M2ePro.url.get('amazon_listing_product_template_description/assign'),{method:'post',parameters:{products_ids:self.variationProductManagePopup.productId,template_id:templateId},onSuccess:function(transport){var response=self.parseResponse(transport);if(response.type=='success'){self.templateDescriptionPopup.modal('closeModal');self.setGeneralIdOwner(1,true);}}});self.templateDescriptionPopup.modal('closeModal');},changeVariationTheme:function(el){var attrs=$('variation_manager_theme_attributes');attrs.hide();attrs.next().show();el.hide();el.next().show();var channelVariationThemeNote=$('channel_variation_theme_note');channelVariationThemeNote&&channelVariationThemeNote.hide();},setVariationTheme:function(){var self=this,value=$('variation_manager_theme').value;if(value){new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_manage/setVariationTheme'),{method:'post',parameters:{product_id:self.variationProductManagePopup.productId,variation_theme:value},onSuccess:function(transport){var response=self.parseResponse(transport);if(response.success){self.reloadSettings();}}});}},cancelVariationTheme:function(el){var attrs=$('variation_manager_theme_attributes');attrs.show();attrs.next().hide();el.up().previous().show();el.up().hide();var channelVariationThemeNote=$('channel_variation_theme_note');channelVariationThemeNote&&channelVariationThemeNote.show();},changeMatchedAttributes:function(el){$$('.variation_manager_attributes_amazon_value').each(function(el){el.hide();});$$('.variation_manager_attributes_amazon_select').each(function(el){el.show();});el.hide();el.next().show();el.next().next().show();},isValidAttributes:function(){var self=this,existedValues=[],isValid=true,form=$('variation_manager_attributes_form');if(!form||(form&&form.serialize()=='')){return true;}\nvar data=form.serialize(true);form.select('.validation-advice').each(function(el){el.hide();});if(typeof data['variation_attributes[amazon_attributes][]']=='string'){if(data['variation_attributes[amazon_attributes][]']!=''){return true;}\nvar errorEl=form.select('.validation-advice')[0];errorEl.show();errorEl.update(M2ePro.translator.translate('variation_manage_matched_attributes_error'));return false;}\nvar i=0;data['variation_attributes[amazon_attributes][]'].each(function(attrVal){if(attrVal!=''&&existedValues.indexOf(attrVal)===-1){existedValues.push(attrVal);}else{isValid=false;var errorEl=$('variation_manager_attributes_error_'+i);errorEl.show();if(attrVal==''){errorEl.update(M2ePro.translator.translate('variation_manage_matched_attributes_error'));}else{errorEl.update(M2ePro.translator.translate('variation_manage_matched_attributes_error_duplicate'))}}\ni++;});return isValid;},setMatchedAttributes:function(){var self=this,data;if(!self.isValidAttributes()){return;}\n$('variation_manager_attributes_form').select('.validation-advice').each(function(el){el.hide();});data=$('variation_manager_attributes_form').serialize(true);data.product_id=self.variationProductManagePopup.productId;new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_manage/setMatchedAttributes'),{method:'post',parameters:data,onSuccess:function(transport){var response=self.parseResponse(transport);if(response.success){self.reloadVariationsGrid();if(response['vocabulary_attributes']){self.openVocabularyAttributesPopUp(response['vocabulary_attributes']);}}}});},cancelMatchedAttributes:function(el){$$('.variation_manager_attributes_amazon_value').each(function(el){el.show();});$$('.variation_manager_attributes_amazon_select').each(function(el){el.hide();});$('variation_manager_attributes_form').select('.validation-advice').each(function(el){el.hide();});el.hide();el.previous().show();el.next().hide();},renderMatchedAttributesNotSetView:function(type){var self=this,form=$('variation_manager_attributes_form'),tBody=form.down('tbody');tBody.update();$H(self.matchedAttributes).each(function(attribute){var tr=new Element('tr'),tdLabel=new Element('td',{class:'label',style:'border-right: 1px solid #D6D6D6 !important;'}),label=new Element('label'),tdValue=new Element('td',{class:'value'}),valueSpan=new Element('span',{style:'color: red;'});label.innerHTML=attribute.key;valueSpan.innerHTML=M2ePro.translator.translate('not_set');tdLabel.insert({bottom:label});tdValue.insert({bottom:valueSpan});tr.insert({bottom:tdLabel});tr.insert({bottom:tdValue});tBody.insert({bottom:tr});});var tr=new Element('tr'),tdBtns=new Element('td',{class:'label',colspan:'2',style:'text-align: right; border: none'}),setBtn=new Element('button',{class:'action primary'});setBtn.update(M2ePro.translator.translate('set_attributes'));setBtn.observe('click',function(event){if(self.matchingType===self.MATCHING_TYPE_VIRTUAL_AMAZON){self.renderMatchedAttributesVirtualAmazonView();}\nif(self.matchingType===self.MATCHING_TYPE_VIRTUAL_MAGENTO){self.renderMatchedAttributesVirtualMagentoView();}});tdBtns.insert({bottom:setBtn});tr.insert({bottom:tdBtns});tBody.insert({bottom:tr});},renderMatchedAttributesVirtualAmazonView:function(){var self=this,form=$('variation_manager_attributes_form'),tBody=form.down('tbody');tBody.update();self.selectedDestinationAttributes=[];var prematchedAttributes=[];var i=0;$H(self.matchedAttributes).each(function(attribute){var tr=new Element('tr'),tdLabel=new Element('td',{class:'label value',style:'border-right: 1px solid #D6D6D6 !important; vertical-align: inherit;'}),labelMagentoAttr=new Element('label',{class:'magento-attribute-name'}),inputVirtualAttribute=new Element('input',{style:'display: none',value:attribute.key,type:'hidden',disabled:'disabled',class:'virtual-amazon-attribute-name-value',name:'variation_attributes[virtual_amazon_attributes]['+i+']'}),selectVirtualAttributeOption=new Element('select',{style:'display: none; width: 200px; margin-top: -3px',disabled:'disabled',class:'admin__control-select required-entry virtual-amazon-option',name:'variation_attributes[virtual_amazon_option]['+i+']'}),selectVirtualAttributeOptionGroup=new Element('optgroup',{label:attribute.key}),labelVirtualAttributeAndOption=new Element('span',{style:'display: none; line-height: 20px; vertical-align: baseline;',class:'virtual-amazon-attribute-and-option'}),spanLeftHelpIcon=new Element('span',{style:'display: none',class:'left-help-icon'}),tdValue=new Element('td',{class:'value'}),inputMagentoAttr=new Element('input',{value:attribute.key,type:'hidden',class:'magento-attribute-name-value',name:'variation_attributes[magento_attributes]['+i+']'}),selectAmazonAttr=new Element('select',{class:'admin__control-select required-entry M2ePro-amazon-attribute-unique-value amazon-attribute-name',name:'variation_attributes[amazon_attributes]['+i+']'}),spanVirtualAttribute=new Element('span',{style:'display: none; line-height: 20px; vertical-align: baseline;',class:'virtual-amazon-attribute-name'}),spanRightHelpIcon=new Element('span',{style:'display: none',class:'right-help-icon'});var helpIconTpl=$('variation_settings_form_help_icon_tpl');spanLeftHelpIcon.update(helpIconTpl.innerHTML);spanLeftHelpIcon.down('.tool-tip-message-text').update(M2ePro.translator.translate('help_icon_magento_greater_left'));spanRightHelpIcon.update(helpIconTpl.innerHTML);spanRightHelpIcon.down('.tool-tip-message-text').update(M2ePro.translator.translate('help_icon_magento_greater_right'));var attributeStr=attribute.key;if(attribute.key.length>13){attributeStr=attribute.key.substr(0,12)+'...';labelVirtualAttributeAndOption.title=attribute.key;spanVirtualAttribute.title=attribute.key;}\nif(attribute.key.length<31){labelMagentoAttr.update(attribute.key);}else{labelMagentoAttr.update(attribute.key.substr(0,28)+'...');labelMagentoAttr.title=attribute.key;}\nspanVirtualAttribute.update(attributeStr+' (<span>&ndash;</span>)');labelVirtualAttributeAndOption.update(attributeStr+' (<a href=\"javascript:void(0);\"></a>)');labelVirtualAttributeAndOption.down('a').title='';labelVirtualAttributeAndOption.down('a').observe('click',function(event){labelVirtualAttributeAndOption.hide();selectVirtualAttributeOption.show();selectVirtualAttributeOption.value='';spanVirtualAttribute.down('span').update('&ndash;');spanVirtualAttribute.down('span').title='';});var option=new Element('option',{value:''});selectAmazonAttr.insert({bottom:option});self.destinationAttributes.each(function(destinationAttribute){var option=new Element('option',{value:destinationAttribute});option.update(destinationAttribute);selectAmazonAttr.insert({bottom:option});if(attribute.value==destinationAttribute){selectAmazonAttr.value=destinationAttribute;prematchedAttributes.push(selectAmazonAttr);}});selectAmazonAttr.prevValue='';selectAmazonAttr.observe('change',function(event){var result=true;if(selectAmazonAttr.value!=''&&inputMagentoAttr.value!=selectAmazonAttr.value&&self.productAttributes.indexOf(selectAmazonAttr.value)!==-1){result=false;if(attribute.value==null){self.alert(M2ePro.translator.translate('duplicate_amazon_attribute_error'));}\nselectAmazonAttr.value='';}\nattribute.value=null;var prevValueIndex=self.selectedDestinationAttributes.indexOf(selectAmazonAttr.prevValue);if(prevValueIndex>-1){self.selectedDestinationAttributes.splice(prevValueIndex,1);}\nif(selectAmazonAttr.value!=''){self.selectedDestinationAttributes.push(selectAmazonAttr.value);}\nselectAmazonAttr.prevValue=selectAmazonAttr.value;form.select('select').each(function(el){result=Validation.get('M2ePro-amazon-attribute-unique-value').test($F(el),el)?result:false;});if(result&&self.selectedDestinationAttributes.length==self.destinationAttributes.length){self.showVirtualAmazonAttributes();}else{self.hideVirtualAmazonAttributes();}});selectVirtualAttributeOption.observe('change',function(event){var value=selectVirtualAttributeOption.value;labelVirtualAttributeAndOption.show();selectVirtualAttributeOption.hide();if(attributeStr.length+value.length<28){spanVirtualAttribute.down('span').update(value);spanVirtualAttribute.down('span').title='';labelVirtualAttributeAndOption.down('a').update(value);}else{spanVirtualAttribute.down('span').update(value.substr(0,24-attributeStr.length)+'...');spanVirtualAttribute.down('span').title=value;labelVirtualAttributeAndOption.down('a').update(value.substr(0,24-attributeStr.length)+'...');}\nlabelVirtualAttributeAndOption.down('a').title=M2ePro.translator.translate('change_option')+' \"'+value+'\"';});var option=new Element('option',{value:''});selectVirtualAttributeOption.insert({bottom:option});self.magentoVariationSet[attribute.key].each(function(optionValue){var option=new Element('option',{value:optionValue});option.update(optionValue);selectVirtualAttributeOptionGroup.insert({bottom:option});});selectVirtualAttributeOption.insert({bottom:selectVirtualAttributeOptionGroup});tdLabel.insert({bottom:labelMagentoAttr});tdLabel.insert({bottom:inputVirtualAttribute});tdLabel.insert({bottom:labelVirtualAttributeAndOption});tdLabel.insert({bottom:selectVirtualAttributeOption});tdLabel.insert({bottom:spanLeftHelpIcon});tdValue.insert({bottom:inputMagentoAttr});tdValue.insert({bottom:selectAmazonAttr});tdValue.insert({bottom:spanVirtualAttribute});tdValue.insert({bottom:spanRightHelpIcon});tr.insert({bottom:tdLabel});tr.insert({bottom:tdValue});tBody.insert({bottom:tr});i++;});var tr=new Element('tr'),tdBtns=new Element('td',{class:'label',colspan:'2',style:'text-align: right; border: none'}),cancelBtn=new Element('a',{href:'javascript:void(0);',style:'margin-left: 9px;'}),confirmBtn=new Element('button',{style:'margin-left: 9px;',class:'action primary'});cancelBtn.update(M2ePro.translator.translate('Cancel'));confirmBtn.update(M2ePro.translator.translate('Confirm'));cancelBtn.observe('click',function(event){self.renderMatchedAttributesNotSetView();});confirmBtn.observe('click',function(event){form.select('.validation-advice').each(function(el){el.hide();});var result=true;form.select('select').each(function(el){el.classNames().each(function(className){var validationResult=Validation.test(className,el);result=validationResult?result:false;if(!validationResult){throw $break;}});});form.select('.validation-advice').each(function(el){jQuery(el).wrapInner('<label class=\"mage-error\">');});if(result){var data=form.serialize(true);data.product_id=self.variationProductManagePopup.productId;new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_manage/setMatchedAttributes'),{method:'post',parameters:data,onSuccess:function(transport){var response=self.parseResponse(transport);if(response.success){self.reloadVariationsGrid();if(response['vocabulary_attributes']){self.openVocabularyAttributesPopUp(response['vocabulary_attributes']);}}}});}});tdBtns.insert({bottom:cancelBtn});tdBtns.insert({bottom:confirmBtn});tr.insert({bottom:tdBtns});tBody.insert({bottom:tr});prematchedAttributes.each(function(el){el.simulate('change');});tBody.select('.tool-tip-image').each(function(element){element.observe('mouseover',MagentoFieldTipObj.showToolTip);element.observe('mouseout',MagentoFieldTipObj.onToolTipIconMouseLeave);});tBody.select('.tool-tip-message').each(function(element){element.observe('mouseout',MagentoFieldTipObj.onToolTipMouseLeave);element.observe('mouseover',MagentoFieldTipObj.onToolTipMouseEnter);});},showVirtualAmazonAttributes:function(){var self=this,form=$('variation_manager_attributes_form');var virtualAmazonAttr=form.select('select.amazon-attribute-name[value=\"\"]');virtualAmazonAttr.each(function(el){el.disable().hide();var tr=el.up('tr');tr.down('.magento-attribute-name-value').disable();tr.down('.virtual-amazon-attribute-name').show();tr.down('.magento-attribute-name').hide();tr.down('.virtual-amazon-attribute-name-value').enable();tr.down('.virtual-amazon-option').enable().show();tr.down('.right-help-icon').show();tr.down('.left-help-icon').show();});},hideVirtualAmazonAttributes:function(){var self=this,form=$('variation_manager_attributes_form');var virtualAmazonAttr=form.select('select.amazon-attribute-name[value=\"\"]');virtualAmazonAttr.each(function(el){el.enable().show();var tr=el.up('tr');tr.down('.magento-attribute-name-value').enable();tr.down('.virtual-amazon-attribute-name').hide();tr.down('.magento-attribute-name').show();tr.down('.virtual-amazon-attribute-name-value').disable();tr.down('.virtual-amazon-option').disable().hide();tr.down('.virtual-amazon-attribute-and-option').hide();tr.down('.right-help-icon').hide();tr.down('.left-help-icon').hide();});},renderMatchedAttributesVirtualMagentoView:function(){var self=this,form=$('variation_manager_attributes_form'),tBody=form.down('tbody');tBody.update();var prematchedAttributes=[];var i=0;$H(self.matchedAttributes).each(function(attribute){var tr=new Element('tr'),tdLabel=new Element('td',{class:'label',style:'border-right: 1px solid #D6D6D6 !important;'}),labelMagentoAttr=new Element('label'),tdValue=new Element('td',{class:'value'}),inputMagentoAttr=new Element('input',{value:attribute.key,type:'hidden',name:'variation_attributes[magento_attributes]['+i+']'}),selectAmazonAttr=new Element('select',{class:'admin__control-select required-entry M2ePro-amazon-attribute-unique-value amazon-attribute-name',name:'variation_attributes[amazon_attributes]['+i+']'});if(attribute.key.length<31){labelMagentoAttr.update(attribute.key);}else{labelMagentoAttr.update(attribute.key.substr(0,28)+'...');labelMagentoAttr.title=attribute.key;}\nvar option=new Element('option',{value:''});selectAmazonAttr.insert({bottom:option});self.destinationAttributes.each(function(destinationAttribute){var option=new Element('option',{value:destinationAttribute});option.update(destinationAttribute);selectAmazonAttr.insert({bottom:option});if(attribute.value==destinationAttribute){selectAmazonAttr.value=destinationAttribute;prematchedAttributes.push(selectAmazonAttr);}});selectAmazonAttr.prevValue='';selectAmazonAttr.observe('change',function(event){var result=true;if(selectAmazonAttr.value!=''&&inputMagentoAttr.value!=selectAmazonAttr.value&&self.destinationAttributes.indexOf(inputMagentoAttr.value)!==-1){result=false;if(attribute.value==null){self.alert(M2ePro.translator.translate('duplicate_magento_attribute_error'));}\nselectAmazonAttr.value='';}\nattribute.value=null;form.select('select.amazon-attribute-name').each(function(el){el.classNames().each(function(className){var v=Validation.get(className),validationResult=v.test($F(el),el);result=validationResult?result:false;if(!validationResult){throw $break;}});});if(result){self.showVirtualMagentoAttributes(i);}else{self.hideVirtualMagentoAttributes();}});tdLabel.insert({bottom:labelMagentoAttr});tdValue.insert({bottom:inputMagentoAttr});tdValue.insert({bottom:selectAmazonAttr});tr.insert({bottom:tdLabel});tr.insert({bottom:tdValue});tBody.insert({bottom:tr});i++;});var tr=new Element('tr',{class:'buttons-row'}),tdBtns=new Element('td',{class:'label',colspan:'2',style:'text-align: right; border: none'}),cancelBtn=new Element('a',{href:'javascript:void(0);',style:'margin-left: 9px;'}),confirmBtn=new Element('button',{style:'margin-left: 9px;',class:'action primary'});cancelBtn.update(M2ePro.translator.translate('Cancel'));confirmBtn.update(M2ePro.translator.translate('Confirm'));cancelBtn.observe('click',function(event){self.renderMatchedAttributesNotSetView();});confirmBtn.observe('click',function(event){form.select('.validation-advice').each(function(el){el.hide();});var result=true;form.select('select','input').each(function(el){el.classNames().each(function(className){var validationResult=Validation.test(className,el);result=validationResult?result:false;if(!validationResult){throw $break;}});});form.select('.validation-advice').each(function(el){jQuery(el).wrapInner('<label class=\"mage-error\">');});if(result){var data=form.serialize(true);data.product_id=self.variationProductManagePopup.productId;new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_manage/setMatchedAttributes'),{method:'post',parameters:data,onSuccess:function(transport){var response=self.parseResponse(transport);if(response.success){self.reloadVariationsGrid();if(response['vocabulary_attributes']){self.openVocabularyAttributesPopUp(response['vocabulary_attributes']);}}}});}});tdBtns.insert({bottom:cancelBtn});tdBtns.insert({bottom:confirmBtn});tr.insert({bottom:tdBtns});tBody.insert({bottom:tr});prematchedAttributes.each(function(el){el.simulate('change');});},showVirtualMagentoAttributes:function(lastAttributeIndex){var self=this,form=$('variation_manager_attributes_form'),buttonsRow=form.down('.buttons-row');form.select('tr.virtual-attribute').each(function(el){el.remove();});var selectedValues=[];form.select('select.amazon-attribute-name').each(function(el){selectedValues.push(el.value);});var i=lastAttributeIndex;self.destinationAttributes.each(function(attribute){if(selectedValues.indexOf(attribute)!==-1){return true;}\nvar tr=new Element('tr',{class:'virtual-attribute'}),tdLabel=new Element('td',{class:'label',style:'line-height: 26px; border-right: 1px solid #D6D6D6 !important;'}),labelMagentoAttr=new Element('label'),spanLeftHelpIcon=new Element('span',{class:'left-help-icon'}),tdValue=new Element('td',{class:'value'}),inputMagentoAttr=new Element('input',{value:attribute,type:'hidden',name:'variation_attributes[virtual_magento_attributes]['+i+']'}),spanVirtualAttribute=new Element('span',{style:'display: none'}),spanRightHelpIcon=new Element('span',{class:'right-help-icon'});var helpIconTpl=$('variation_settings_form_help_icon_tpl');spanLeftHelpIcon.update(helpIconTpl.innerHTML);spanLeftHelpIcon.down('.tool-tip-message-text').update(M2ePro.translator.translate('help_icon_amazon_greater_left'));spanRightHelpIcon.update(helpIconTpl.innerHTML);spanRightHelpIcon.down('.tool-tip-message-text').update(M2ePro.translator.translate('help_icon_amazon_greater_right'));var attributeStr=attribute;if(attribute.length>13){attributeStr=attribute.substr(0,12)+'...';labelMagentoAttr.title=attribute;spanVirtualAttribute.title=attribute;}\nlabelMagentoAttr.update(attributeStr+' (<span>&ndash;</span>)');if(self.amazonVariationSet===false){spanVirtualAttribute.update(attributeStr+' (<span></span>)');spanVirtualAttribute.show();var virtualAttrOption=new Element('input',{type:'text',style:'width: 153px;',class:'required-entry',name:'variation_attributes[virtual_magento_option]['+i+']'});virtualAttrOption.observe('keyup',function(event){var value=virtualAttrOption.value;if(value==''){labelMagentoAttr.down('span').update('&ndash;');labelMagentoAttr.down('span').title='';return;}\nif(attributeStr.length+value.length<21){labelMagentoAttr.down('span').update(value);labelMagentoAttr.down('span').title='';}else{labelMagentoAttr.down('span').update(value.substr(0,20-attributeStr.length)+'...');labelMagentoAttr.down('span').title=value;}});labelMagentoAttr.insert({bottom:spanLeftHelpIcon});spanVirtualAttribute.down('span').insert({bottom:virtualAttrOption});tdLabel.insert({bottom:labelMagentoAttr});tdValue.insert({bottom:inputMagentoAttr});tdValue.insert({bottom:spanVirtualAttribute});tdValue.insert({bottom:spanRightHelpIcon});}else{var virtualAttrOption=new Element('select',{style:'width: 255px;',class:'admin__control-select required-entry virtual-magento-option',name:'variation_attributes[virtual_magento_option]['+i+']'}),virtualAttrOptionGroup=new Element('optgroup',{label:attribute});spanVirtualAttribute.update(attributeStr+' (<a href=\"javascript:void(0);\"></a>)');spanVirtualAttribute.down('a').title='';spanVirtualAttribute.down('a').observe('click',function(event){spanVirtualAttribute.hide();virtualAttrOption.show();virtualAttrOption.value='';labelMagentoAttr.down('span').update('&ndash;');labelMagentoAttr.down('span').title='';});var option=new Element('option',{value:''});virtualAttrOption.insert({bottom:option});self.amazonVariationSet[attribute].each(function(optionValue){var option=new Element('option',{value:optionValue});option.update(optionValue);virtualAttrOptionGroup.insert({bottom:option});});virtualAttrOption.insert({bottom:virtualAttrOptionGroup});virtualAttrOption.observe('change',function(event){var value=virtualAttrOption.value;spanVirtualAttribute.show();virtualAttrOption.hide();if(attributeStr.length+value.length<28){labelMagentoAttr.down('span').update(value);labelMagentoAttr.down('span').title='';}else{labelMagentoAttr.down('span').update(value.substr(0,22-attributeStr.length)+'...');labelMagentoAttr.down('span').title=value;}\nif(attributeStr.length+value.length<45){spanVirtualAttribute.down('a').update(value);}else{spanVirtualAttribute.down('a').update(value.substr(0,40-attributeStr.length)+'...');}\nspanVirtualAttribute.down('a').title=M2ePro.translator.translate('change_option')+' \"'+value+'\"';});labelMagentoAttr.insert({bottom:spanLeftHelpIcon});tdLabel.insert({bottom:labelMagentoAttr});tdValue.insert({bottom:inputMagentoAttr});tdValue.insert({bottom:spanVirtualAttribute});tdValue.insert({bottom:virtualAttrOption});tdValue.insert({bottom:spanRightHelpIcon});}\ntr.insert({bottom:tdLabel});tr.insert({bottom:tdValue});buttonsRow.insert({before:tr});i++;});form.select('.tool-tip-image').each(function(element){element.observe('mouseover',MagentoFieldTipObj.showToolTip);element.observe('mouseout',MagentoFieldTipObj.onToolTipIconMouseLeave);});form.select('.tool-tip-message').each(function(element){element.observe('mouseout',MagentoFieldTipObj.onToolTipMouseLeave);element.observe('mouseover',MagentoFieldTipObj.onToolTipMouseEnter);});},hideVirtualMagentoAttributes:function(){var self=this,form=$('variation_manager_attributes_form');form.select('tr.virtual-attribute').each(function(el){el.remove();});},reloadSettings:function(callback){var self=this;new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_manage/viewVariationsSettingsAjax'),{method:'post',parameters:{product_id:self.variationProductManagePopup.productId},onSuccess:function(transport){var response=self.parseResponse(transport);$('amazonVariationProductManageTabs_settings_content').update(response.html);self.initSettingsTab();var img=$('amazonVariationProductManageTabs_settings').down('img');img.hide();if(response.error_icon!=''){img.src=M2ePro.url.get('m2epro_skin_url')+'/images/'+response.error_icon+'.png';img.show();}\nif(callback){callback.call();}}});},reloadVariationsGrid:function(){ListingProductVariationManageVariationsGridObj.actionHandler.gridHandler.unselectAllAndReload();},openVariationsTab:function(createNewAsin){jQuery('#amazonVariationProductManageTabs').tabs('option','active',0);ListingProductVariationManageVariationsGridObj.showNewChildForm(createNewAsin,ListingGridHandlerObj.variationProductManageHandler.variationProductManagePopup.productId);},reloadVocabulary:function(){var self=this;new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_vocabulary/viewVocabularyAjax'),{method:'post',parameters:{product_id:self.variationProductManagePopup.productId},onSuccess:function(transport){$('amazonVariationProductManageTabs_vocabulary_content').update(transport.responseText);}});},saveAutoActionSettings:function(){new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_manage/saveAutoActionSettings'),{method:'post',parameters:$('auto_action_settings_form').serialize(true)});},removeAttributeFromVocabulary:function(el){var self=this;self.confirm({actions:{confirm:function(){new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_vocabulary/removeAttribute'),{method:'post',parameters:{magento_attr:decodeHtmlentities(el.up().down('.magento-attribute-name').innerHTML),channel_attr:decodeHtmlentities(el.up().down('.channel-attribute-name').innerHTML)},onSuccess:function(transport){self.reloadVocabulary();}});},cancel:function(){return false;}}});},removeOptionFromVocabulary:function(el){var self=this,optionGroupRowEl=el.up('.channel-attribute-options-group');self.confirm({actions:{confirm:function(){new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_vocabulary/removeOption'),{method:'post',parameters:{product_option:decodeHtmlentities(optionGroupRowEl.down('.product-option').innerHTML),product_options_group:decodeHtmlentities(optionGroupRowEl.down('.product-options-group').innerHTML),channel_attr:decodeHtmlentities(optionGroupRowEl.down('.channel-attribute-name').innerHTML)},onSuccess:function(transport){self.reloadVocabulary();}});},cancel:function(){return false;}}});}});});","Ess_M2ePro/js/Amazon/Listing/Product/Variation/Manage/Tabs/Variations/Grid.min.js":"define(['M2ePro/Plugin/Messages','Magento_Ui/js/modal/modal','M2ePro/Listing/View/Grid','M2ePro/Amazon/Listing/View/Action','M2ePro/Amazon/Listing/Product/Template/Description'],function(MessageObj,modal){window.AmazonListingProductVariationManageTabsVariationsGrid=Class.create(ListingViewGrid,{initialize:function($super,gridId,listingId)\n{this.messageObj=Object.create(MessageObj);this.messageObj.setContainer('#listing_product_variation_action_messages_container');$super(gridId,listingId);},getLogViewUrl:function(rowId){var idField=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Block\\\\Adminhtml\\\\Log\\\\Listing\\\\Product\\\\AbstractGrid::LISTING_PRODUCT_ID_FIELD');var params={};params[idField]=rowId;return M2ePro.url.get('amazon_log_listing_product/index',params);},getComponent:function(){return'amazon';},getMaxProductsInPart:function(){return 1000;},prepareActions:function($super){this.actionHandler=new AmazonListingViewAction(this);this.actions={listAction:this.actionHandler.listAction.bind(this.actionHandler),relistAction:this.actionHandler.relistAction.bind(this.actionHandler),reviseAction:this.actionHandler.reviseAction.bind(this.actionHandler),stopAction:this.actionHandler.stopAction.bind(this.actionHandler),stopAndRemoveAction:this.actionHandler.stopAndRemoveAction.bind(this.actionHandler),previewItemsAction:this.actionHandler.previewItemsAction.bind(this.actionHandler),startTranslateAction:this.actionHandler.startTranslateAction.bind(this.actionHandler),stopTranslateAction:this.actionHandler.stopTranslateAction.bind(this.actionHandler)};this.templateDescriptionHandler=new AmazonListingProductTemplateDescription(this);this.actions=Object.extend(this.actions,{deleteAndRemoveAction:this.actionHandler.deleteAndRemoveAction.bind(this.actionHandler)});},parseResponse:function(response){if(!response.responseText.isJSON()){return;}\nreturn response.responseText.evalJSON();},afterInitPage:function($super){$super();$$('.attributes-options-filter').each(this.initAttributesOptionsFilter,this);},initAttributesOptionsFilter:function(filterEl){var srcElement=Element.down(filterEl,'select');srcElement.observe('change',this.onAttributesOptionsFilterChange.bind(this));var valuesDiv=Element.down(filterEl,'.attributes-options-filter-values');valuesDiv.optionsCount=valuesDiv.childElementCount;if(valuesDiv.optionsCount==srcElement.childElementCount-1){srcElement.hide();}\nvaluesDiv.optionsIterator=0;valuesDiv.childElements().each(function(attrValue){var removeImg=Element.down(attrValue,'.filter-param-remove'),attrName=Element.down(attrValue,'input[type=\"hidden\"]'),selectedOption=Element.down(filterEl,'select option[value=\"'+attrName.value+'\"]');selectedOption.hide();valuesDiv.optionsIterator++;removeImg.show();removeImg.observe('click',function(){valuesDiv.optionsCount--;selectedOption.show();srcElement.show();Element.remove(attrValue);});},this);},onAttributesOptionsFilterChange:function(e){var srcElement=e.target||e.srcElement,parentDiv=Element.up(srcElement,'.attributes-options-filter'),valuesDiv=Element.down(parentDiv,'.attributes-options-filter-values'),selectedOption=Element.down(srcElement,'[value=\"'+srcElement.value+'\"]');selectedOption.hide();valuesDiv.optionsCount++;valuesDiv.optionsIterator++;srcElement.enable();if(valuesDiv.optionsCount==srcElement.childElementCount-1){srcElement.hide();}\nvar filterName=parentDiv.id.replace('attributes-options-filter_','');var newOptionContainer=new Element('div'),newOptionLabel=new Element('div'),newOptionValue=new Element('input',{type:'text',style:'width: 85%;',name:filterName+'['+valuesDiv.optionsIterator+'][value]'}),newOptionAttr=new Element('input',{type:'hidden',name:filterName+'['+valuesDiv.optionsIterator+'][attr]',value:srcElement.value}),removeImg=Element.clone(Element.down(parentDiv,'.attributes-options-filter-selector .filter-param-remove'));newOptionLabel.innerHTML=srcElement.value+': ';removeImg.show();Event.observe(newOptionValue,'keypress',this.getGridObj().filterKeyPress.bind(this.getGridObj()));newOptionContainer.insert({bottom:newOptionLabel});newOptionContainer.insert({bottom:newOptionValue});newOptionContainer.insert({bottom:newOptionAttr});newOptionContainer.insert({bottom:removeImg});valuesDiv.insert({bottom:newOptionContainer});removeImg.observe('click',function(){valuesDiv.optionsCount--;selectedOption.show();srcElement.show();newOptionContainer.remove();},this);srcElement.value='';},editProductOptions:function(el,attributes,variationsTree,listingProductId){this.renderProductOptionsForm(el,attributes,variationsTree,listingProductId);this.validateAttributeOptions(el,variationsTree);var mainContainer=Element.up(el,'.product-options-main'),listContainer=Element.down(mainContainer,'.product-options-list'),form=mainContainer.down('.product-options-edit'),options=form.select('select.product-option');var productOptions=[];listContainer.select('.attribute-row').each(function(el){productOptions.push(el.down('.value').innerHTML);});var i=0;options.each(function(el){el.setValue(productOptions[i]).simulate('change');i++;});},renderProductOptionsForm:function(el,attributes,variationsTree,listingProductId){var mainContainer=Element.up(el,'.product-options-main'),editContainer=Element.down(mainContainer,'.product-options-edit'),listContainer=Element.down(mainContainer,'.product-options-list'),self=this;el.hide();listContainer&&listContainer.hide();for(var i=0;i<attributes.length;i++){var optionContainer=new Element('div'),optionLabel=new Element('div'),optionValue=new Element('select',{class:'product-option admin__control-select',style:'width: 100%',name:'product_options[values][]'}),optionAttr=new Element('input',{class:'product-attribute',type:'hidden',name:'product_options[attr][]',value:attributes[i]});optionLabel.update(attributes[i]+': ');optionValue.observe('change',function(){self.validateAttributeOptions(el,variationsTree);});optionContainer.insert({bottom:optionLabel});optionContainer.insert({bottom:optionValue});optionContainer.insert({bottom:optionAttr});editContainer.insert({bottom:optionContainer});}\nvar confirmBtn=new Element('button',{class:'action primary confirm-btn',style:'font-size: 1.1rem; margin-top: 8px; margin-right: 9px;'}),cancelBtn=new Element('a',{href:'javascript:void(0);',class:'scalable',style:'line-height: 27px; margin: 7px 8px;'}),listingProductIdEl=new Element('input',{type:'hidden',name:'product_id',value:listingProductId}),errorMsg=new Element('p',{class:'error',style:'display: none;'});confirmBtn.update(M2ePro.translator.translate('Confirm'));confirmBtn.observe('click',function(event){event.stop();var data=editContainer.serialize(true);if(!self.validateAttributeOptions(el,variationsTree)){var errorMsg=editContainer.down('p.error');errorMsg.show();errorMsg.innerHTML=M2ePro.translator.translate('error_changing_product_options');return;}\nnew Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_manage/setChildListingProductOptions'),{method:'post',parameters:data,onSuccess:function(transport){var response=self.parseResponse(transport);if(response['vocabulary_attribute_options']){ListingGridHandlerObj.variationProductManageHandler.openVocabularyOptionsPopUp(response['vocabulary_attribute_options']);return;}\nif(response.success){self.actionHandler.gridHandler.unselectAllAndReload();}}});el.show();listContainer&&listContainer.show();editContainer.childElements().each(Element.remove);});cancelBtn.update(M2ePro.translator.translate('Cancel'));cancelBtn.observe('click',function(event){event.stop();el.show();listContainer&&listContainer.show();editContainer.childElements().each(Element.remove);});editContainer.insert({bottom:listingProductIdEl});editContainer.insert({bottom:errorMsg});editContainer.insert({bottom:cancelBtn});editContainer.insert({bottom:confirmBtn});},validateAttributeOptions:function(el,variations,i){var variation=$H(variations),mainContainer=Element.up(el,'.product-options-main'),form=mainContainer.down('.product-options-edit'),attributes=form.select('input.product-attribute'),options=form.select('select.product-option'),index=i||0,valid=false;if(index===0){options.each(function(el){el.disable();});}\nif(!attributes[index]||!options[index]){if(variation.size()===0){valid=true;options.each(function(el){if(el.value==''){valid=false;throw $break;}});return valid;}}\nvar attr=variation.keys()[0];attributes[index].value=attr;var oldValue=options[index].value;options[index].update();options[index].enable();options[index].appendChild(new Element('option',{style:'display: none'}));$H(variation.get(attr)).each(function(option){options[index].appendChild(new Element('option',{value:option[0]})).insert(option[0]);if(option[0]==oldValue){options[index].value=oldValue;}});if(oldValue&&variation.get(attr)[oldValue]){index++;valid=this.validateAttributeOptions(el,variation.get(attr)[oldValue],index);}\nreturn valid;},showNewChildForm:function(createNewAsin,productId){var self=this;new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_manage/getNewChildForm'),{method:'post',parameters:{product_id:productId},onSuccess:function(transport){var containerEl=$('variation_manager_product_options_form_container');if(containerEl){containerEl.remove();}\n$('html-body').insert({bottom:transport.responseText});self.newChildPopup=jQuery('#variation_manager_product_options_form_container');modal({title:M2ePro.translator.translate('Add New Child Product'),type:'slide',buttons:[{text:M2ePro.translator.translate('Close'),click:function(){self.newChildPopup.modal('closeModal')}},{text:M2ePro.translator.translate('Confirm'),class:'action primary ',click:function(){self.addNewChildProduct();self.newChildPopup.modal('closeModal')}}]},self.newChildPopup);self.newChildPopup.modal('openModal');$$('#manage_variations_new_child_product_variation select').each(function(el){el.select('option').invoke('remove');});$$('#manage_variations_new_child_channel_variation select').each(function(el){el.select('option').invoke('remove');});$('new_child_product_product_options_error').hide();$('new_child_product_channel_options_error').hide();self.validateNewChildAttributeOptions('product');self.validateNewChildAttributeOptions('channel');if(createNewAsin){self.createNewAsinBtn();}else{self.selectOptionsBtn();}}});},validateNewChildAttributeOptions:function(type,variations,i){if(!$('variation_manager_unused_'+type+'_variations_tree')){return true;}\nvar variation=$H(variations||decodeHtmlentities($('variation_manager_unused_'+type+'_variations_tree').innerHTML).evalJSON()),attributes=$$('.new-child-'+type+'-attribute'),options=$$('.new-child-'+type+'-option'),index=i||0,valid=false;if(type=='product'){var channelOptions=$$('.new-child-channel-option'),formData=$('variation_manager_product_options_form').serialize(true);}\nif(index===0){options.each(function(el){el.disable();});}\nif(!attributes[index]||!options[index]){if(variation.size()===0){valid=this.validateNewChild();}\nreturn valid;}\nvar attr=variation.keys()[0];attributes[index].value=attr;var oldValue=options[index].value;options[index].update();options[index].enable();options[index].appendChild(new Element('option',{style:'display: none'}));if(type=='product'&&formData.create_new_asin==1){var channelEl=$('new_child_product_channel_option_'+index);channelEl.update();channelEl.appendChild(new Element('option',{value:oldValue})).insert(oldValue);channelEl.value=oldValue;}\n$H(variation.get(attr)).each(function(option){options[index].appendChild(new Element('option',{value:option[0]})).insert(option[0]);if(option[0]==oldValue){options[index].value=oldValue;}});if(oldValue){index++;valid=this.validateNewChildAttributeOptions(type,variation.get(attr)[oldValue],index);}\nreturn valid;},validateNewChild:function(showErrors){var data=$('variation_manager_product_options_form').serialize(true),valid=true;$('new_child_product_product_options_error').hide();$$('#manage_variations_new_child_product_variation select').each(function(el){if(el.value==''){showErrors&&$('new_child_product_product_options_error').show();valid=false;throw $break;}});if(data.create_new_asin!=1){$('new_child_product_channel_options_error').hide();$$('#manage_variations_new_child_channel_variation select').each(function(el){if(el.value==''){showErrors&&$('new_child_product_channel_options_error').show();valid=false;throw $break;}});}\nreturn valid;},addNewChildProduct:function(){var self=this,data;if(!self.validateNewChild(true)){return;}\ndata=$('variation_manager_product_options_form').serialize(true);new Ajax.Request(M2ePro.url.get('amazon_listing_product_variation_manage/createNewChild'),{method:'post',parameters:data,onSuccess:function(transport){var response=self.parseResponse(transport);if(response.msg){self.messageObj.clear();self.messageObj['add'+response.type[0].toUpperCase()+response.type.slice(1)+'Message'](response.msg);}\nif(response['vocabulary_attribute_options']){ListingGridHandlerObj.variationProductManageHandler.openVocabularyOptionsPopUp(response['vocabulary_attribute_options']);return;}\nself.actionHandler.gridHandler.unselectAllAndReload();}});},createNewAsinBtn:function(){var optEl=$('manage_variations_select_options'),newAsinLinkEl=$('manage_variations_create_new_asin');optEl&&optEl.show().down('input').enable();$('new_child_product_channel_options_error_row').setStyle({visibility:'hidden'});newAsinLinkEl&&newAsinLinkEl.hide();$$('.new-child-channel-option').each(function(el){el.disable();});$('manage_variations_create_new_asin_title').show();ListingProductVariationManageVariationsGridObj.validateNewChildAttributeOptions('product');},selectOptionsBtn:function(){var optEl=$('manage_variations_select_options'),newAsinEl=$('manage_variations_create_new_asin');optEl&&optEl.hide().down('input').disable();$('new_child_product_channel_options_error_row').setStyle({visibility:'visible'});newAsinEl&&newAsinEl.show();$$('.new-child-channel-option').each(function(el){el.enable();el.update();});$('manage_variations_create_new_asin_title').hide();ListingProductVariationManageVariationsGridObj.validateNewChildAttributeOptions('channel');},unselectAllAndReload:function($super){$super();ListingGridHandlerObj.variationProductManageHandler.reloadSettings(null);ListingGridHandlerObj.variationProductManageHandler.reloadVocabulary(null);}});});","Ess_M2ePro/js/Amazon/Template/Edit.min.js":"define(['M2ePro/Template/Edit'],function(){window.AmazonTemplateEdit=Class.create(TemplateEdit,{getComponent:function()\n{return'amazon';},saveAndCloseClick:function(confirmText,templateNick)\n{if(!this.isValidForm()){return;}\nif(confirmText&&this.showConfirmMsg){this.confirm(templateNick,confirmText,this.saveFormUsingAjax);return;}\nthis.saveFormUsingAjax();},saveFormUsingAjax:function()\n{new Ajax.Request(M2ePro.url.get('formSubmit'),{method:'post',parameters:Form.serialize($('edit_form')),onSuccess:function(transport){var result=transport.responseText.evalJSON();if(result.status){window.close();}else{console.error('Policy Saving Error');}}});}});});","Ess_M2ePro/js/Amazon/Template/Synchronization.min.js":"define(['M2ePro/Amazon/Template/Edit','Magento_Ui/js/modal/confirm'],function(){window.AmazonTemplateSynchronization=Class.create(AmazonTemplateEdit,{initialize:function()\n{this.setValidationCheckRepetitionValue('M2ePro-synchronization-tpl-title',M2ePro.translator.translate('The specified Title is already used for other Policy. Policy Title must be unique.'),'Template\\\\Synchronization','title','id',M2ePro.formData.id,M2ePro.php.constant('Ess_M2ePro_Helper_Component_Amazon::NICK'));jQuery.validator.addMethod('M2ePro-input-time',function(value){return value.match(/^\\d{2}:\\d{2}$/g);},M2ePro.translator.translate('Wrong time format string.'));jQuery.validator.addMethod('validate-qty',function(value,el){if(!el.up('.admin__field').visible()){return true;}\nif(value.match(/[^\\d]+/g)){return false;}\nif(value<=0){return false;}\nreturn true;},M2ePro.translator.translate('Wrong value. Only integer numbers.'));jQuery.validator.addMethod('M2ePro-validate-conditions-between',function(value,el){var minValue=$(el.id.replace('_max','')).value;if(!el.up('.admin__field').visible()){return true;}\nreturn parseInt(value)>parseInt(minValue);},M2ePro.translator.translate('Must be greater than \"Min\".'));jQuery.validator.addMethod('M2ePro-validate-stop-relist-conditions-product-status',function(value,el){if(AmazonTemplateSynchronizationObj.isRelistModeDisabled()){return true;}\nif($('stop_status_disabled').value==1&&$('relist_status_enabled').value==0){return false;}\nreturn true;},M2ePro.translator.translate('Inconsistent Settings in Relist and Stop Rules.'));jQuery.validator.addMethod('M2ePro-validate-stop-relist-conditions-stock-availability',function(value,el){if(AmazonTemplateSynchronizationObj.isRelistModeDisabled()){return true;}\nif($('stop_out_off_stock').value==1&&$('relist_is_in_stock').value==0){return false;}\nreturn true;},M2ePro.translator.translate('Inconsistent Settings in Relist and Stop Rules.'));jQuery.validator.addMethod('M2ePro-validate-stop-relist-conditions-item-qty',function(value,el){if(AmazonTemplateSynchronizationObj.isRelistModeDisabled()){return true;}\nvar stopMaxQty=0,relistMinQty=0;var qtyType=el.getAttribute('qty_type');switch(parseInt($('stop_qty_'+qtyType).value)){case M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::STOP_QTY_NONE'):return true;break;case M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::STOP_QTY_LESS'):stopMaxQty=parseInt($('stop_qty_'+qtyType+'_value').value);break;case M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::STOP_QTY_BETWEEN'):stopMaxQty=parseInt($('stop_qty_'+qtyType+'_value_max').value);break;}\nswitch(parseInt($('relist_qty_'+qtyType).value)){case M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::RELIST_QTY_NONE'):return false;break;case M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::RELIST_QTY_MORE'):case M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::RELIST_QTY_BETWEEN'):relistMinQty=parseInt($('relist_qty_'+qtyType+'_value').value);break;}\nif(relistMinQty<=stopMaxQty){return false;}\nreturn true;},M2ePro.translator.translate('Inconsistent Settings in Relist and Stop Rules.'));},initObservers:function()\n{$('list_mode').observe('change',AmazonTemplateSynchronizationObj.listMode_change).simulate('change');$('list_qty_magento').observe('change',AmazonTemplateSynchronizationObj.listQty_change).simulate('change');$('list_qty_calculated').observe('change',AmazonTemplateSynchronizationObj.listQty_change).simulate('change');$('list_advanced_rules_mode').observe('change',AmazonTemplateSynchronizationObj.listAdvancedRules_change).simulate('change');$('relist_mode').observe('change',AmazonTemplateSynchronizationObj.relistMode_change).simulate('change');$('relist_qty_magento').observe('change',AmazonTemplateSynchronizationObj.relistQty_change).simulate('change');$('relist_qty_calculated').observe('change',AmazonTemplateSynchronizationObj.relistQty_change).simulate('change');$('relist_advanced_rules_mode').observe('change',AmazonTemplateSynchronizationObj.relistAdvancedRules_change).simulate('change');$('revise_update_qty').observe('change',AmazonTemplateSynchronizationObj.reviseQty_change).simulate('change');$('revise_update_qty_max_applied_value_mode').observe('change',AmazonTemplateSynchronizationObj.reviseQtyMaxAppliedValueMode_change).simulate('change');$('revise_update_price').observe('change',AmazonTemplateSynchronizationObj.revisePrice_change).simulate('change');$('revise_update_price_max_allowed_deviation_mode').observe('change',AmazonTemplateSynchronizationObj.revisePriceMaxAllowedDeviationMode_change).simulate('change');$('stop_qty_magento').observe('change',AmazonTemplateSynchronizationObj.stopQty_change).simulate('change');$('stop_qty_calculated').observe('change',AmazonTemplateSynchronizationObj.stopQty_change).simulate('change');$('stop_advanced_rules_mode').observe('change',AmazonTemplateSynchronizationObj.stopAdvancedRules_change).simulate('change');},isRelistModeDisabled:function()\n{return $('relist_mode').value==0;},duplicateClick:function($super,$headId)\n{this.setValidationCheckRepetitionValue('M2ePro-synchronization-tpl-title',M2ePro.translator.translate('The specified Title is already used for other Policy. Policy Title must be unique.'),'Template\\\\Synchronization','title','','',M2ePro.php.constant('Ess_M2ePro_Helper_Component_Amazon::NICK'));$super($headId,M2ePro.translator.translate('Add Synchronization Policy'));},stopQty_change:function()\n{var qtyType=this.getAttribute('qty_type');var valueContainer=$('stop_qty_'+qtyType+'_value_container'),valueMaxContainer=$('stop_qty_'+qtyType+'_value_max_container'),item=valueContainer.select('label span')[0];valueContainer.hide();valueMaxContainer.hide();if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::STOP_QTY_LESS')||this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::STOP_QTY_MORE')){item.innerHTML=M2ePro.translator.translate('Quantity');valueContainer.show();}\nif(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::STOP_QTY_BETWEEN')){item.innerHTML=M2ePro.translator.translate('Min Quantity');valueContainer.show();valueMaxContainer.show();}},stopAdvancedRules_change:function()\n{var rulesContainer=$('stop_advanced_rules_filters_container'),warningContainer=$('stop_advanced_rules_filters_warning');rulesContainer.hide();warningContainer.hide();if(this.value==1){rulesContainer.show();warningContainer.show();}},listMode_change:function()\n{var rulesContainer=$('magento_block_amazon_template_synchronization_list_rules'),advancedRulesContainer=$('magento_block_amazon_template_synchronization_list_advanced_filters');if($('list_mode').value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::LIST_MODE_NONE')){rulesContainer.hide();advancedRulesContainer.hide();}else if($('list_mode').value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::LIST_MODE_YES')){rulesContainer.show();advancedRulesContainer.show();}else{rulesContainer.hide();advancedRulesContainer.hide();}},listQty_change:function()\n{var qtyType=this.getAttribute('qty_type');var valueContainer=$('list_qty_'+qtyType+'_value_container'),valueMaxContainer=$('list_qty_'+qtyType+'_value_max_container'),item=valueContainer.select('label span')[0];valueContainer.hide();valueMaxContainer.hide();if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::LIST_QTY_LESS')||this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::LIST_QTY_MORE')){item.innerHTML=M2ePro.translator.translate('Quantity');valueContainer.show();}\nif(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::LIST_QTY_BETWEEN')){item.innerHTML=M2ePro.translator.translate('Min Quantity');valueContainer.show();valueMaxContainer.show();}},listAdvancedRules_change:function()\n{var rulesContainer=$('list_advanced_rules_filters_container'),warningContainer=$('list_advanced_rules_filters_warning');rulesContainer.hide();warningContainer.hide();if(this.value==1){rulesContainer.show();warningContainer.show();}},relistMode_change:function()\n{var rulesContainer=$('magento_block_amazon_template_synchronization_relist_rules'),advancedRulesContainer=$('magento_block_amazon_template_synchronization_relist_advanced_filters'),userLockContainer=$('relist_filter_user_lock_tr_container'),sendDataContainer=$('relist_send_data_tr_container');if($('relist_mode').value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::RELIST_MODE_NONE')){userLockContainer.hide();sendDataContainer.hide();rulesContainer.hide();advancedRulesContainer.hide();}else if($('relist_mode').value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::RELIST_MODE_YES')){userLockContainer.show();sendDataContainer.show();rulesContainer.show();advancedRulesContainer.show();}else{userLockContainer.hide();sendDataContainer.hide();rulesContainer.hide();advancedRulesContainer.hide();}},relistQty_change:function()\n{var qtyType=this.getAttribute('qty_type');var valueContainer=$('relist_qty_'+qtyType+'_value_container'),valueMaxContainer=$('relist_qty_'+qtyType+'_value_max_container'),item=valueContainer.select('label span')[0];valueContainer.hide();valueMaxContainer.hide();if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::RELIST_QTY_LESS')||this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::RELIST_QTY_MORE')){item.innerHTML=M2ePro.translator.translate('Quantity');valueContainer.show();}\nif(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::RELIST_QTY_BETWEEN')){item.innerHTML=M2ePro.translator.translate('Min Quantity');valueContainer.show();valueMaxContainer.show();}},relistAdvancedRules_change:function()\n{var rulesContainer=$('relist_advanced_rules_filters_container'),warningContainer=$('relist_advanced_rules_filters_warning');rulesContainer.hide();warningContainer.hide();if(this.value==1){rulesContainer.show();warningContainer.show();}},reviseQty_change:function()\n{if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::REVISE_UPDATE_QTY_YES')){$('revise_update_qty_max_applied_value_mode_tr').show();$('revise_update_qty_max_applied_value_line_tr').show();$('revise_update_qty_max_applied_value_mode').simulate('change');}else{$('revise_update_qty_max_applied_value_mode_tr').hide();$('revise_update_qty_max_applied_value_line_tr').hide();$('revise_update_qty_max_applied_value_tr').hide();$('revise_update_qty_max_applied_value_mode').value=M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::REVISE_MAX_AFFECTED_QTY_MODE_OFF');}},reviseQtyMaxAppliedValueMode_change:function(event)\n{var self=AmazonTemplateSynchronizationObj;$('revise_update_qty_max_applied_value_tr').hide();if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::REVISE_MAX_AFFECTED_QTY_MODE_ON')){$('revise_update_qty_max_applied_value_tr').show();}else if(!event.cancelable){self.openReviseMaxAppliedQtyDisableConfirmationPopUp();}},openReviseMaxAppliedQtyDisableConfirmationPopUp:function()\n{var self=this;var element=jQuery('#revise_qty_max_applied_value_confirmation_popup_template').clone();element.confirm({title:M2ePro.translator.translate('Are you sure?'),actions:{confirm:self.reviseQtyMaxAppliedValueDisableConfirm,cancel:self.reviseQtyMaxAppliedValueDisableCancel},buttons:[{text:M2ePro.translator.translate('Cancel'),class:'action-secondary action-dismiss',click:function(event){this.closeModal(event);}},{text:M2ePro.translator.translate('Confirm'),class:'action-primary action-accept',click:function(event){this.closeModal(event,true);}}]});},reviseQtyMaxAppliedValueDisableCancel:function()\n{$('revise_update_qty_max_applied_value_mode').selectedIndex=1;$('revise_update_qty_max_applied_value_mode').simulate('change');},reviseQtyMaxAppliedValueDisableConfirm:function()\n{$('revise_update_qty_max_applied_value_mode').selectedIndex=0;$('revise_update_qty_max_applied_value_mode').simulate('change');},revisePrice_change:function()\n{if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::REVISE_UPDATE_PRICE_YES')){$('revise_update_price_max_allowed_deviation_mode_tr').show();$('revise_update_price_max_allowed_deviation_tr').show();$('revise_update_price_line').show();$('revise_update_price_max_allowed_deviation_mode').simulate('change');}else{$('revise_update_price_max_allowed_deviation_mode_tr').hide();$('revise_update_price_max_allowed_deviation_tr').hide();$('revise_update_price_line').hide();$('revise_update_price_max_allowed_deviation_mode').value=M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::REVISE_MAX_ALLOWED_PRICE_DEVIATION_MODE_OFF');}},revisePriceMaxAllowedDeviationMode_change:function(event)\n{var self=AmazonTemplateSynchronizationObj;$('revise_update_price_max_allowed_deviation_tr').hide();if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_Synchronization::REVISE_MAX_ALLOWED_PRICE_DEVIATION_MODE_ON')){$('revise_update_price_max_allowed_deviation_tr').show();}else if(!event.cancelable){self.openReviseMaxAllowedDeviationPriceDisableConfirmationPopUp();}},openReviseMaxAllowedDeviationPriceDisableConfirmationPopUp:function()\n{var self=this;var element=jQuery('#revise_price_max_max_allowed_deviation_confirmation_popup_template').clone();element.confirm({title:M2ePro.translator.translate('Are you sure?'),actions:{confirm:self.revisePriceMaxAllowedDeviationDisableConfirm,cancel:self.revisePriceMaxAllowedDeviationDisableCancel},buttons:[{text:M2ePro.translator.translate('Cancel'),class:'action-secondary action-dismiss',click:function(event){this.closeModal(event);}},{text:M2ePro.translator.translate('Confirm'),class:'action-primary action-accept',click:function(event){this.closeModal(event,true);}}]});},revisePriceMaxAllowedDeviationDisableCancel:function()\n{$('revise_update_price_max_allowed_deviation_mode').selectedIndex=1;$('revise_update_price_max_allowed_deviation_mode').simulate('change');},revisePriceMaxAllowedDeviationDisableConfirm:function()\n{$('revise_update_price_max_allowed_deviation_mode').selectedIndex=0;$('revise_update_price_max_allowed_deviation_mode').simulate('change');}});});","Ess_M2ePro/js/Amazon/Template/ShippingOverride.min.js":"define(['M2ePro/Amazon/Template/Edit'],function(){window.AmazonTemplateShippingOverride=Class.create(AmazonTemplateEdit,{rulesIndex:0,initialize:function(){this.setValidationCheckRepetitionValue('M2ePro-shipping-override-tpl-title',M2ePro.translator.translate('The specified Title is already used for other Policy. Policy Title must be unique.'),'Amazon\\\\Template\\\\ShippingOverride','title','id',M2ePro.formData.id);},duplicateClick:function($super,$headId){this.setValidationCheckRepetitionValue('M2ePro-shipping-override-tpl-title',M2ePro.translator.translate('The specified Title is already used for other Policy. Policy Title must be unique.'),'Amazon\\\\Template\\\\ShippingOverride','title','id','');$super($headId,M2ePro.translator.translate('Add Shipping Override Policy'));},addRow:function(ruleData){var self=this,marketplaceId=$('marketplace_id').value;ruleData=ruleData||{};this.rulesIndex++;var tpl=$('shipping_override_rule_table_row_template').down('tbody').innerHTML;tpl=tpl.replace(/%i%/g,this.rulesIndex);$('shipping_override_rules_table_tbody').insert(tpl);var row=$('shipping_override_rule_'+this.rulesIndex+'_tr');row.show();var serviceEl=row.down('.shipping-override-service');var option=new Element('option',{class:'empty',value:''});serviceEl.insert({bottom:option});var services=[];$H(self.overrideServicesData).each(function(data){if(data.value.marketplace_id==marketplaceId&&services.indexOf(data.value.service)==-1){services.push(data.value.service);}});services.each(function(service){var option=new Element('option',{value:service});option.innerHTML=service;serviceEl.insert(option);});if(ruleData.service){serviceEl.value=ruleData.service;self.ruleServiceChange.call(self,serviceEl,ruleData);}\nvar attributeEl=row.down('.shipping-override-cost-custom-attribute');attributeEl.addClassName('M2ePro-custom-attribute-can-be-created');attributeEl.id='shipping_override_cost_custom_attribute_'+this.rulesIndex;attributeEl.setAttribute('allowed_attribute_types','text,price,select');var handlerObj=new AttributeCreator('shipping_override_cost_custom_attribute_'+this.rulesIndex);handlerObj.setSelectObj(attributeEl);handlerObj.injectAddOption();},removeRow:function(el){el.up('.shipping-override-rule').remove();if($('shipping_override_rules_table_tbody').select('tr').length==0){AmazonTemplateShippingOverrideObj.addRow();}},renderRules:function(data){var self=this;$('magento_block_amazon_template_shipping_override_rules').show();data.each(function(rule){self.addRow(rule);});},marketplaceChange:function(){if(this.value!=''){if(this.down('.empty-option')){this.down('.empty-option').hide();}\n$('magento_block_amazon_template_shipping_override_rules').show();}\n$('shipping_override_rules_table_tbody').update();if(this.type=='select-one'){$('shipping_override_rule_table_row_template').down('.shipping-override-rule-currency').update(this[this.selectedIndex].getAttribute('currency'));}\nAmazonTemplateShippingOverrideObj.addRow();},ruleServiceChange:function(el,ruleData){var self=this,location=el.up('tr').down('.shipping-override-location'),marketplaceId=$('marketplace_id').value;ruleData=ruleData||{};if(el.value==''){location.value='';location.simulate('change');location.disable().hide();return;}\nlocation.update().enable().show();var option=new Element('option',{class:'empty',value:''});location.insert({bottom:option});$H(self.overrideServicesData).each(function(data){if(data.value.marketplace_id==marketplaceId&&data.value.service==el.value){var option=new Element('option',{value:data.value.location});option.innerHTML=data.value.location;location.insert(option);}});if(ruleData.location){location.value=ruleData.location;self.ruleLocationChange.call(self,location,ruleData);}},ruleLocationChange:function(el,ruleData){var self=this,service=el.up('tr').down('.shipping-override-service'),location=el.up('tr').down('.shipping-override-location'),type=el.up('tr').down('.shipping-override-type'),option=el.up('tr').down('.shipping-override-option');ruleData=ruleData||{};if(el.value==''){type.value='';type.simulate('change');type.disable().hide();option.value='';return;}\ntype.enable().show();$H(self.overrideServicesData).each(function(data){if(service.value==data.value.service&&location.value==data.value.location){option.value=data.value.option;throw $break;}});if(ruleData.type){type.value=ruleData.type;self.ruleTypeChange.call(self,type,ruleData);}},ruleTypeChange:function(el,ruleData){var self=this,costMode=el.up('tr').down('.shipping-override-cost-mode');ruleData=ruleData||{};if(el.value==''||el.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_ShippingOverride_Service::TYPE_RESTRICTIVE')){costMode.value='';costMode.simulate('change');costMode.disable().hide();return;}\ncostMode.enable().show();if(ruleData.cost_mode){costMode.value=ruleData.cost_mode;self.ruleCostModeChange.call(self,costMode,ruleData);}},ruleCostModeChange:function(el,ruleData){var self=this,costCustomValue=el.up('tr').down('.shipping-override-cost-custom-value'),costCustomAttribute=el.up('tr').down('.shipping-override-cost-custom-attribute');ruleData=ruleData||{};costCustomValue.removeAttribute('readonly');if(el.value==''||el.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_ShippingOverride_Service::COST_MODE_FREE')){costCustomValue.disable().hide();costCustomAttribute.disable().hide();costCustomValue.value='';costCustomAttribute.value='';if(el.value!=''&&el.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_ShippingOverride_Service::COST_MODE_FREE')){costCustomValue.enable().show();costCustomValue.value=0;costCustomValue.setAttribute('readonly','readonly');}\nreturn;}\nif(el.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_ShippingOverride_Service::COST_MODE_CUSTOM_VALUE')){costCustomValue.enable().show();costCustomAttribute.disable().hide();if(ruleData.cost_value){costCustomValue.value=ruleData.cost_value;}}else if(el.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_ShippingOverride_Service::COST_MODE_CUSTOM_ATTRIBUTE')){costCustomValue.disable().hide();costCustomAttribute.enable().show();if(ruleData.cost_value){costCustomAttribute.value=ruleData.cost_value;}}}});});","Ess_M2ePro/js/Amazon/Template/SellingFormat.min.js":"define(['jquery','M2ePro/Amazon/Template/Edit'],function(jQuery){window.AmazonTemplateSellingFormat=Class.create(AmazonTemplateEdit,{discountRulesCount:0,initialize:function()\n{var self=this;this.setValidationCheckRepetitionValue('M2ePro-price-tpl-title',M2ePro.translator.translate('The specified Title is already used for other Policy. Policy Title must be unique.'),'Template\\\\SellingFormat','title','id',M2ePro.formData.id,M2ePro.php.constant('Ess_M2ePro_Helper_Component_Amazon::NICK'));jQuery.validator.addMethod('M2ePro-validate-price-coefficient',function(value){if(value==''){return true;}\nif(value=='0'||value=='0%'){return false;}\nreturn value.match(/^[+-]?\\d+[.]?\\d*[%]?$/g);},M2ePro.translator.translate('Coefficient is not valid.'));jQuery.validator.addMethod('M2ePro-validate-qty',function(value,el){if(self.isElementHiddenFromPage(el)){return true;}\nif(value.match(/[^\\d]+/g)){return false;}\nif(value<=0){return false;}\nreturn true;},M2ePro.translator.translate('Wrong value. Only integer numbers.'));jQuery.validator.addMethod('M2ePro-validate-vat-percent',function(value){if(value.length>6){return false;}\nif(value<0){return false;}\nvalue=Math.ceil(value);return value>0&&value<=30;},M2ePro.translator.translate('Wrong value. Must be no more than 30. Max applicable length is 6 characters, including the decimal (e.g., 12.345).'));jQuery.validator.addMethod('M2ePro-date-range-to',function(value){var fromTime=$('regular_sale_price_start_date_value'),toTime=$('regular_sale_price_end_date_value');if(fromTime.value==''||toTime.value==''||!jQuery(fromTime).is(':visible')||!jQuery(toTime).is(':visible')){return true;}\nfromTime=new Date(fromTime.value);toTime=new Date(toTime.value);if(!fromTime||!toTime){return true;}\nreturn toTime.getTime()>fromTime.getTime();},M2ePro.translator.translate('Wrong date range.'));jQuery.validator.addMethod('M2ePro-customer-allowed-types',function(value,element){return!($('is_regular_customer_allowed').value==0&&$('is_business_customer_allowed').value==0);},M2ePro.translator.translate('At least one Selling Type should be enabled.'));jQuery.validator.addMethod('M2ePro-business-discount-availability',function(value,element){if(!$('is_business_customer_allowed')||$('is_business_customer_allowed').value==0||element.value!=M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_SellingFormat::BUSINESS_DISCOUNTS_MODE_CUSTOM_VALUE')){return true;}\nreturn $$('#business_discounts_custom_value_discount_table_tbody .business-discount-rule').length>0;},M2ePro.translator.translate('You should add at least one Discount Rule.'));jQuery.validator.addMethod('M2ePro-business-discount-qty-unique',function(value,element){return!(element.up('tbody').select('.M2ePro-business-discount-qty-unique[value=\"'+value+'\"]').length>1);},M2ePro.translator.translate('The Quantity value should be unique.'));jQuery.validator.addMethod('M2ePro-business-discount-attribute-coefficient-unique',function(value,element){if(Validation.get('IsEmpty').test(value)){return true;}\nvar similarValues;if(value==M2ePro.php.constant('Ess_M2ePro_Model_Template_SellingFormat::PRICE_MODE_ATTRIBUTE')){var attribute=element.up('tr').down('.business-discount-attribute').value;similarValues=element.up('tbody').select('.business-discount-attribute[value=\"'+attribute+'\"]');}else{similarValues=element.up('tbody').select('.M2ePro-business-discount-attribute-coefficient-unique[value=\"'+value+'\"]');}\nif(similarValues.length===1){return true;}\nvar coefficientValue=element.up('tr').down('.business-discount-coefficient').value;var similarValues=similarValues.filter(function(el){return el.up('tr').down('.business-discount-coefficient').value==coefficientValue});return!(similarValues.length>1);},M2ePro.translator.translate('You should specify a unique pair of Magento Attribute and Price Change value for each Discount Rule.'));},initObservers:function()\n{if($('is_regular_customer_allowed')){$('is_regular_customer_allowed').observe('change',AmazonTemplateSellingFormatObj.is_regular_customer_allowed_change).simulate('change');}\nif($('is_business_customer_allowed')){$('is_business_customer_allowed').observe('change',AmazonTemplateSellingFormatObj.is_business_customer_allowed_change).simulate('change');}\n$('qty_mode').observe('change',AmazonTemplateSellingFormatObj.qty_mode_change).simulate('change');$('qty_modification_mode').observe('change',AmazonTemplateSellingFormatObj.qtyPostedMode_change).simulate('change');if($('regular_price_mode')){$('regular_price_mode').observe('change',AmazonTemplateSellingFormatObj.regular_price_mode_change).simulate('change');}\nif($('regular_map_price_mode')){$('regular_map_price_mode').observe('change',AmazonTemplateSellingFormatObj.regular_map_price_mode_change).simulate('change');}\nif($('regular_sale_price_start_date_mode')){$('regular_sale_price_start_date_mode').observe('change',AmazonTemplateSellingFormatObj.regular_sale_price_start_date_mode_change).simulate('change');}\nif($('regular_sale_price_end_date_mode')){$('regular_sale_price_end_date_mode').observe('change',AmazonTemplateSellingFormatObj.regular_sale_price_end_date_mode_change).simulate('change');}\nif($('regular_sale_price_mode')){$('regular_sale_price_mode').observe('change',AmazonTemplateSellingFormatObj.regular_sale_price_mode_change).simulate('change');}\nif($('regular_price_increase_vat_percent')){$('regular_price_increase_vat_percent').observe('change',AmazonTemplateSellingFormatObj.regular_price_increase_vat_percent_mode_change).simulate('change');}\nif($('business_price_mode')){$('business_price_mode').observe('change',AmazonTemplateSellingFormatObj.business_price_mode_change).simulate('change');}\nif($('business_price_increase_vat_percent')){$('business_price_increase_vat_percent').observe('change',AmazonTemplateSellingFormatObj.business_price_increase_vat_percent_mode_change).simulate('change');}\nif($('business_discounts_mode')){$('business_discounts_mode').observe('change',AmazonTemplateSellingFormatObj.business_discounts_mode_change).simulate('change');}\nif($('business_discounts_custom_value_discount_table_tbody')){$('business_discounts_custom_value_discount_table_tbody').on('change','select.business-discount-mode',AmazonTemplateSellingFormatObj.business_discount_price_mode_change);}\nif($('business_discounts_mode')){AmazonTemplateSellingFormatObj.renderDiscountRules(M2ePro.formData.discount_rules);}},duplicateClick:function($super,$headId)\n{this.setValidationCheckRepetitionValue('M2ePro-price-tpl-title',M2ePro.translator.translate('The specified Title is already used for other Policy. Policy Title must be unique.'),'Template\\\\SellingFormat','title','','',M2ePro.php.constant('Ess_M2ePro_Helper_Component_Amazon::NICK'));$super($headId,M2ePro.translator.translate('Add Price, Quantity and Format Policy'));},qty_mode_change:function()\n{$('qty_custom_value_tr','qty_percentage_tr','qty_modification_mode_tr').invoke('hide');$('qty_custom_attribute').value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Template_SellingFormat::QTY_MODE_NUMBER')){$('qty_custom_value_tr').show();}else if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Template_SellingFormat::QTY_MODE_ATTRIBUTE')){AmazonTemplateSellingFormatObj.updateHiddenValue(this,$('qty_custom_attribute'));}\n$('qty_modification_mode').value=M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_SellingFormat::QTY_MODIFICATION_MODE_OFF');if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Template_SellingFormat::QTY_MODE_PRODUCT')||this.value==M2ePro.php.constant('Ess_M2ePro_Model_Template_SellingFormat::QTY_MODE_ATTRIBUTE')||this.value==M2ePro.php.constant('Ess_M2ePro_Model_Template_SellingFormat::QTY_MODE_PRODUCT_FIXED')){$('qty_modification_mode_tr').show();$('qty_modification_mode').value=M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_SellingFormat::QTY_MODIFICATION_MODE_ON');if(M2ePro.formData.qty_mode==M2ePro.php.constant('Ess_M2ePro_Model_Template_SellingFormat::QTY_MODE_PRODUCT')||M2ePro.formData.qty_mode==M2ePro.php.constant('Ess_M2ePro_Model_Template_SellingFormat::QTY_MODE_ATTRIBUTE')||M2ePro.formData.qty_mode==M2ePro.php.constant('Ess_M2ePro_Model_Template_SellingFormat::QTY_MODE_PRODUCT_FIXED')){$('qty_modification_mode').value=M2ePro.formData.qty_modification_mode;}}\n$('qty_modification_mode').simulate('change');if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Template_SellingFormat::QTY_MODE_PRODUCT')||this.value==M2ePro.php.constant('Ess_M2ePro_Model_Template_SellingFormat::QTY_MODE_ATTRIBUTE')||this.value==M2ePro.php.constant('Ess_M2ePro_Model_Template_SellingFormat::QTY_MODE_PRODUCT_FIXED')){$('qty_percentage_tr').show();}},qtyPostedMode_change:function()\n{$('qty_min_posted_value_tr').hide();$('qty_max_posted_value_tr').hide();if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_SellingFormat::QTY_MODIFICATION_MODE_ON')){$('qty_min_posted_value_tr').show();$('qty_max_posted_value_tr').show();}},regular_price_mode_change:function()\n{var self=AmazonTemplateSellingFormatObj;$('regular_price_custom_attribute').value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Template_SellingFormat::PRICE_MODE_ATTRIBUTE')){self.updateHiddenValue(this,$('regular_price_custom_attribute'));}\n$('regular_price_note').innerHTML=M2ePro.translator.translate('Product Price for Amazon Listing(s).');},regular_map_price_mode_change:function()\n{var self=AmazonTemplateSellingFormatObj;$('regular_map_price_custom_attribute').value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Template_SellingFormat::PRICE_MODE_ATTRIBUTE')){self.updateHiddenValue(this,$('regular_map_price_custom_attribute'));}},regular_sale_price_mode_change:function()\n{var self=AmazonTemplateSellingFormatObj;if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Template_SellingFormat::PRICE_MODE_NONE')){$('regular_sale_price_start_date_mode_tr','regular_sale_price_end_date_mode_tr','regular_sale_price_coefficient_td').invoke('hide');$('regular_sale_price_start_date_value_tr','regular_sale_price_end_date_value_tr').invoke('hide');}else if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Template_SellingFormat::PRICE_MODE_SPECIAL')){$('regular_sale_price_coefficient_td').show();$('regular_sale_price_start_date_mode_tr','regular_sale_price_end_date_mode_tr').invoke('hide');$('regular_sale_price_start_date_value_tr','regular_sale_price_end_date_value_tr').invoke('hide');}else{$('regular_sale_price_start_date_mode_tr','regular_sale_price_end_date_mode_tr','regular_sale_price_coefficient_td').invoke('show');$('regular_sale_price_start_date_mode').simulate('change');$('regular_sale_price_end_date_mode').simulate('change');}\n$('regular_sale_price_custom_attribute').value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Template_SellingFormat::PRICE_MODE_ATTRIBUTE')){self.updateHiddenValue(this,$('regular_sale_price_custom_attribute'));}\n$('regular_sale_price_note').innerHTML=M2ePro.translator.translate('The Price, at which you want to sell your Product(s) at specific time.');},regular_sale_price_start_date_mode_change:function()\n{$('regular_sale_price_start_date_custom_attribute').value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_SellingFormat::DATE_VALUE')){$('regular_sale_price_start_date_value_tr').show();}else{$('regular_sale_price_start_date_value_tr').hide();AmazonTemplateSellingFormatObj.updateHiddenValue(this,$('regular_sale_price_start_date_custom_attribute'));}},regular_sale_price_end_date_mode_change:function()\n{$('regular_sale_price_end_date_custom_attribute').value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_SellingFormat::DATE_VALUE')){$('regular_sale_price_end_date_value_tr').show();}else{$('regular_sale_price_end_date_value_tr').hide();AmazonTemplateSellingFormatObj.updateHiddenValue(this,$('regular_sale_price_end_date_custom_attribute'));}},regular_price_increase_vat_percent_mode_change:function()\n{var vatPercentTr=$('regular_price_vat_percent_tr'),vatPercent=$('regular_price_vat_percent');vatPercentTr.hide();vatPercent.removeClassName('M2ePro-validate-vat-percent');vatPercent.removeClassName('required-entry');if(+this.value){vatPercentTr.show();vatPercent.addClassName('M2ePro-validate-vat-percent');vatPercent.addClassName('required-entry');}else{vatPercent.value='';}},is_regular_customer_allowed_change:function()\n{var regularCustomer=$('is_regular_customer_allowed'),businessCustomer=$('is_regular_customer_allowed'),regularBlock=$('magento_block_amazon_template_selling_format_prices');regularBlock.hide();if(regularCustomer.value==1){regularBlock.show();}},is_business_customer_allowed_change:function()\n{var businessCustomer=$('is_business_customer_allowed'),businessBlock=$('magento_block_amazon_template_selling_format_business_prices');businessBlock.hide();if(businessCustomer.value==1){businessBlock.show();}},business_price_mode_change:function()\n{var self=AmazonTemplateSellingFormatObj;$('business_price_custom_attribute').value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Template_SellingFormat::PRICE_MODE_ATTRIBUTE')){self.updateHiddenValue(this,$('business_price_custom_attribute'));}\n$('business_price_note').innerHTML=M2ePro.translator.translate('Business Product Price for Amazon Listing(s).');},business_price_increase_vat_percent_mode_change:function()\n{var vatPercentTr=$('business_price_vat_percent_tr'),vatPercent=$('business_price_vat_percent');vatPercentTr.hide();vatPercent.removeClassName('M2ePro-validate-vat-percent');vatPercent.removeClassName('required-entry');if(+this.value){vatPercentTr.show();vatPercent.addClassName('M2ePro-validate-vat-percent');vatPercent.addClassName('required-entry');}else{vatPercent.value='';}},business_discounts_mode_change:function()\n{var qtyPriceMode=$('business_discounts_mode');$('business_discounts_tier_customer_group_id_tr','business_discounts_tier_coefficient_td','business_discounts_custom_value_discount_table','business_discounts_not_set_table').invoke('hide');$('business_discounts_custom_value_discount_table_tbody').update();AmazonTemplateSellingFormatObj.discountRulesCount=0;$$('.add_discount_rule_button').each(function(el){el.show();});if(qtyPriceMode.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_SellingFormat::BUSINESS_DISCOUNTS_MODE_TIER')){$('business_discounts_tier_customer_group_id_tr').show();$('business_discounts_tier_coefficient_td').show();return;}\nif(qtyPriceMode.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_SellingFormat::BUSINESS_DISCOUNTS_MODE_CUSTOM_VALUE')){$('business_discounts_not_set_table').show();return;}},addRow:function()\n{$('business_discounts_custom_value_discount_table').show();$('business_discounts_not_set_table').hide();var id='business_discounts_custom_value_discount_table_tbody';var i=AmazonTemplateSellingFormatObj.discountRulesCount;var tpl=$$('#business_discounts_custom_value_discount_table_row_template tbody')[0].innerHTML;tpl=tpl.replace(/%i%/g,i);$(id).insert(tpl);AmazonTemplateSellingFormatObj.discountRulesCount++;if(AmazonTemplateSellingFormatObj.discountRulesCount>=5){$$('.add_discount_rule_button').each(function(el){el.hide();});}\nvar handlerObj=new AttributeCreator('business_discount[mode]['+i+']');handlerObj.setSelectObj($(id).select('select[name=\"business_discount[mode]['+i+']\"]').first());handlerObj.injectAddOption();return $('custom_value_discount_rule_'+i+'_tr');},removeRow:function(btnEl)\n{btnEl.up('tr').remove();AmazonTemplateSellingFormatObj.discountRulesCount--;if(AmazonTemplateSellingFormatObj.discountRulesCount<5){$$('.add_discount_rule_button').each(function(el){el.show();});}\nif(AmazonTemplateSellingFormatObj.discountRulesCount==0){$('business_discounts_custom_value_discount_table').hide();$('business_discounts_not_set_table').show();}},renderDiscountRules:function(discountRules)\n{if(discountRules.length===0){return;}\nif($('business_discounts_mode').value!=M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_SellingFormat::BUSINESS_DISCOUNTS_MODE_CUSTOM_VALUE')){return;}\ndiscountRules.each(function(rule,i){var row=AmazonTemplateSellingFormatObj.addRow();row.down('.business-discount-qty').value=rule.qty;if(rule.mode==M2ePro.php.constant('Ess_M2ePro_Model_Template_SellingFormat::PRICE_MODE_ATTRIBUTE')){var modeOption=row.down('.business-discount-mode option[attribute_code=\"'+rule.attribute+'\"]');if(modeOption)modeOption.selected=true;row.down('.business-discount-attribute').value=rule.attribute;}else{row.down('.business-discount-mode').value=rule.mode;}\nrow.down('.business-discount-coefficient').value=rule.coefficient;});},business_discount_price_mode_change:function(event,target)\n{var self=AmazonTemplateSellingFormatObj;target.previous().value='';if(target.value==M2ePro.php.constant('Ess_M2ePro_Model_Template_SellingFormat::PRICE_MODE_ATTRIBUTE')){self.updateHiddenValue(target,target.previous());}}});});","Ess_M2ePro/js/Amazon/Template/ProductTaxCode.min.js":"define(['M2ePro/Amazon/Template/Edit'],function(){window.AmazonTemplateProductTaxCode=Class.create(AmazonTemplateEdit,{rulesIndex:0,initialize:function()\n{this.setValidationCheckRepetitionValue('M2ePro-tpl-title',M2ePro.translator.translate('The specified Title is already used for other Policy. Policy Title must be unique.'),'Amazon\\\\Template\\\\ProductTaxCode','title','id',M2ePro.formData.id);},duplicateClick:function($headId)\n{this.setValidationCheckRepetitionValue('M2ePro-tpl-title',M2ePro.translator.translate('The specified Title is already used for other Policy. Policy Title must be unique.'),'Amazon\\\\Template\\\\ProductTaxCode','title','id','');CommonObj.duplicateClick($headId,M2ePro.translator.translate('Add Product Tax Code Policy'));},initObservers:function()\n{$('product_tax_code_mode').observe('change',AmazonTemplateProductTaxCodeObj.productTaxCodeModeChange).simulate('change');},productTaxCodeModeChange:function()\n{$('product_tax_code_custom_value_tr').hide();$('product_tax_code_attribute').value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_ProductTaxCode::PRODUCT_TAX_CODE_MODE_VALUE')){$('product_tax_code_custom_value_tr').show();}else if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_ProductTaxCode::PRODUCT_TAX_CODE_MODE_ATTRIBUTE')){AmazonTemplateProductTaxCodeObj.updateHiddenValue(this,$('product_tax_code_attribute'));}}});});","Ess_M2ePro/js/Amazon/Template/ShippingTemplate.min.js":"define(['M2ePro/Amazon/Template/Edit'],function(){window.AmazonTemplateShippingTemplate=Class.create(AmazonTemplateEdit,{initialize:function()\n{this.setValidationCheckRepetitionValue('M2ePro-shipping-tpl-title',M2ePro.translator.translate('The specified Title is already used for other Policy. Policy Title must be unique.'),'Amazon\\\\Template\\\\ShippingTemplate','title','id',M2ePro.formData.id);},initObservers:function()\n{$('template_name_mode').observe('change',this.templateNameModeChange).simulate('change');},duplicateClick:function($headId)\n{this.setValidationCheckRepetitionValue('M2ePro-shipping-tpl-title',M2ePro.translator.translate('The specified Title is already used for other Policy. Policy Title must be unique.'),'Amazon\\\\Template\\\\ShippingTemplate','title','id','');CommonObj.duplicateClick($headId,M2ePro.translator.translate('Add Shipping Template Policy'));},templateNameModeChange:function()\n{$('template_name_custom_value_tr').hide();$('template_name_attribute').value='';if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_ShippingTemplate::TEMPLATE_NAME_VALUE')){$('template_name_custom_value_tr').show();}else if(this.value==M2ePro.php.constant('Ess_M2ePro_Model_Amazon_Template_ShippingTemplate::TEMPLATE_NAME_ATTRIBUTE')){CommonObj.updateHiddenValue(this,$('template_name_attribute'));}}});});","Ess_M2ePro/js/Amazon/Template/Description/Definition.min.js":"define(['M2ePro/Common'],function(){window.AmazonTemplateDescriptionDefinition=Class.create(Common,{initialize:function(){},initObservers:function()\n{$('title_mode').observe('change',AmazonTemplateDescriptionDefinitionObj.title_mode_change).simulate('change');$('brand_mode').observe('change',AmazonTemplateDescriptionDefinitionObj.brand_mode_change).simulate('change');$('manufacturer_mode').observe('change',AmazonTemplateDescriptionDefinitionObj.manufacturer_mode_change).simulate('change');$('manufacturer_part_number_mode').observe('change',AmazonTemplateDescriptionDefinitionObj.manufacturer_part_number_mode_change).simulate('change');$('item_package_quantity_mode').observe('change',AmazonTemplateDescriptionDefinitionObj.onChangeItemPackageQuantityMode).simulate('change');$('number_of_items_mode').observe('change',AmazonTemplateDescriptionDefinitionObj.onChangeNumberOfItemsMode).simulate('change');$('item_dimensions_volume_mode').observe('change',AmazonTemplateDescriptionDefinitionObj.item_dimensions_volume_mode_change).simulate('change');$('item_dimensions_volume_unit_of_measure_mode').observe('change',AmazonTemplateDescriptionDefinitionObj.item_dimensions_volume_unit_of_measure_mode_change).simulate('change');$('item_dimensions_weight_mode').observe('change',AmazonTemplateDescriptionDefinitionObj.item_dimensions_weight_mode_change).simulate('change');$('item_dimensions_weight_unit_of_measure_mode').observe('change',AmazonTemplateDescriptionDefinitionObj.item_dimensions_weight_unit_of_measure_mode_change).simulate('change');$('package_dimensions_volume_mode').observe('change',AmazonTemplateDescriptionDefinitionObj.package_dimensions_volume_mode_change).simulate('change');$('package_dimensions_volume_unit_of_measure_mode').observe('change',AmazonTemplateDescriptionDefinitionObj.package_dimensions_volume_unit_of_measure_mode_change).simulate('change');$('package_weight_mode').observe('change',AmazonTemplateDescriptionDefinitionObj.package_weight_mode_change).simulate('change');$('package_weight_unit_of_measure_mode').observe('change',AmazonTemplateDescriptionDefinitionObj.package_weight_unit_of_measure_mode_change).simulate('change');$('shipping_weight_mode').observe('change',AmazonTemplateDescriptionDefinitionObj.shipping_weight_mode_change).simulate('change');$('shipping_weight_unit_of_measure_mode').observe('change',AmazonTemplateDescriptionDefinitionObj.shipping_weight_unit_of_measure_mode_change).simulate('change');$('target_audience_mode').observe('change',function(){AmazonTemplateDescriptionDefinitionObj.multi_element_mode_change.call(this,'target_audience',4);}).simulate('change');$('bullet_points_mode').observe('change',function(){AmazonTemplateDescriptionDefinitionObj.multi_element_mode_change.call(this,'bullet_points',5);}).simulate('change');$('search_terms_mode').observe('change',function(){AmazonTemplateDescriptionDefinitionObj.multi_element_mode_change.call(this,'search_terms',5);}).simulate('change');$('description_mode').observe('change',AmazonTemplateDescriptionDefinitionObj.description_mode_change).simulate('change');$('image_main_mode').observe('change',AmazonTemplateDescriptionDefinitionObj.image_main_mode_change).simulate('change');$('image_variation_difference_mode').observe('change',AmazonTemplateDescriptionDefinitionObj.image_variation_difference_mode_change).simulate('change');$('gallery_images_mode').observe('change',AmazonTemplateDescriptionDefinitionObj.gallery_images_mode_change).simulate('change');AmazonTemplateDescriptionObj.onChangeNewAsinAccepted.bind($('new_asin_accepted'))();},title_mode_change:function()\n{var customTitle=$('custom_title_tr');this.value==1?customTitle.show():customTitle.hide();},brand_mode_change:function()\n{var customAttribute=$('brand_custom_attribute'),customValueTr=$('brand_custom_value_tr');customValueTr.hide();customAttribute.value='';if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::BRAND_MODE_CUSTOM_VALUE')){customValueTr.show();}\nif(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::BRAND_MODE_CUSTOM_ATTRIBUTE')){AmazonTemplateDescriptionDefinitionObj.updateHiddenValue(this,customAttribute);}},manufacturer_mode_change:function()\n{var customAttribute=$('manufacturer_custom_attribute'),customValueTr=$('manufacturer_custom_value_tr');customValueTr.hide();customAttribute.value='';if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::MANUFACTURER_MODE_CUSTOM_VALUE')){customValueTr.show();}\nif(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::MANUFACTURER_MODE_CUSTOM_ATTRIBUTE')){AmazonTemplateDescriptionDefinitionObj.updateHiddenValue(this,customAttribute);}},manufacturer_part_number_mode_change:function()\n{var customAttribute=$('manufacturer_part_number_custom_attribute'),customValueTr=$('manufacturer_part_number_custom_value_tr');customValueTr.hide();customAttribute.value='';if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::MANUFACTURER_PART_NUMBER_MODE_CUSTOM_VALUE')){customValueTr.show();}\nif(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::MANUFACTURER_PART_NUMBER_MODE_CUSTOM_ATTRIBUTE')){AmazonTemplateDescriptionDefinitionObj.updateHiddenValue(this,customAttribute);}},onChangeItemPackageQuantityMode:function()\n{var targetCustomValue=$('item_package_quantity_custom_value_tr'),targetCustomAttribute=$('item_package_quantity_custom_attribute');targetCustomValue.hide();targetCustomAttribute.value='';if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::ITEM_PACKAGE_QUANTITY_MODE_CUSTOM_VALUE')){targetCustomValue.show();}\nif(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::ITEM_PACKAGE_QUANTITY_MODE_CUSTOM_ATTRIBUTE')){AmazonTemplateDescriptionObj.updateHiddenValue(this,targetCustomAttribute);}},onChangeNumberOfItemsMode:function()\n{var targetCustomValue=$('number_of_items_custom_value_tr'),targetCustomAttribute=$('number_of_items_custom_attribute');targetCustomValue.hide();targetCustomAttribute.value='';if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::NUMBER_OF_ITEMS_MODE_CUSTOM_VALUE')){targetCustomValue.show();}\nif(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::NUMBER_OF_ITEMS_MODE_CUSTOM_ATTRIBUTE')){AmazonTemplateDescriptionObj.updateHiddenValue(this,targetCustomAttribute);}},volumeModeChange:function(customValueTr,customAttributeTr,weightUnitTr,weightUnitMode,value)\n{customValueTr.hide();customAttributeTr.hide();weightUnitTr.hide();if(value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::DIMENSION_VOLUME_MODE_NONE')){weightUnitMode.value='';}\nif(value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::DIMENSION_VOLUME_MODE_CUSTOM_VALUE')){customValueTr.show();weightUnitTr.show();}\nif(value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::DIMENSION_VOLUME_MODE_CUSTOM_ATTRIBUTE')){customAttributeTr.show();weightUnitTr.show();}\nweightUnitMode.simulate('change');},weightModeChange:function(customValueTr,customAttribute,weightUnitTr,weightUnitMode,value)\n{customValueTr.hide();weightUnitTr.hide();customAttribute.value='';if(value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::DIMENSION_VOLUME_MODE_NONE')){weightUnitMode.value='';}\nif(value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::DIMENSION_VOLUME_MODE_CUSTOM_VALUE')){customValueTr.show();weightUnitTr.show();}\nif(value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::DIMENSION_VOLUME_MODE_CUSTOM_ATTRIBUTE')){AmazonTemplateDescriptionDefinitionObj.updateHiddenValue(this,customAttribute);weightUnitTr.show();}\nweightUnitMode.simulate('change');},weightUnitOfMeasureChangeAll:function(customValue,customAttribute,value)\n{var self=AmazonTemplateDescriptionDefinitionObj;customValue.value='';customAttribute.value='';if(value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::WEIGHT_UNIT_OF_MEASURE_MODE_CUSTOM_VALUE')){self.updateHiddenValue(this,customValue);}\nif(value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::WEIGHT_UNIT_OF_MEASURE_MODE_CUSTOM_ATTRIBUTE')){self.updateHiddenValue(this,customAttribute);}},item_dimensions_volume_mode_change:function()\n{var self=AmazonTemplateDescriptionDefinitionObj;self.volumeModeChange($('item_dimensions_volume_custom_value_tr'),$('item_dimensions_volume_custom_attribute_tr'),$('item_dimensions_volume_unit_of_measure_mode_tr'),$('item_dimensions_volume_unit_of_measure_mode'),this.value);},item_dimensions_volume_unit_of_measure_mode_change:function()\n{var self=AmazonTemplateDescriptionDefinitionObj;self.weightUnitOfMeasureChangeAll.call(this,$('item_dimensions_volume_unit_of_measure_custom_value'),$('item_dimensions_volume_unit_of_measure_custom_attribute'),this.value);},item_dimensions_weight_mode_change:function()\n{var self=AmazonTemplateDescriptionDefinitionObj;self.weightModeChange.call(this,$('item_dimensions_weight_custom_value_tr'),$('item_dimensions_weight_custom_attribute'),$('item_dimensions_weight_unit_of_measure_mode_tr'),$('item_dimensions_weight_unit_of_measure_mode'),this.value);},item_dimensions_weight_unit_of_measure_mode_change:function()\n{var self=AmazonTemplateDescriptionDefinitionObj;self.weightUnitOfMeasureChangeAll.call(this,$('item_dimensions_weight_unit_of_measure_custom_value'),$('item_dimensions_weight_unit_of_measure_custom_attribute'),this.value);},package_dimensions_volume_mode_change:function()\n{var self=AmazonTemplateDescriptionDefinitionObj;self.volumeModeChange($('package_dimensions_volume_custom_value_tr'),$('package_dimensions_volume_custom_attribute_tr'),$('package_dimensions_volume_unit_of_measure_mode_tr'),$('package_dimensions_volume_unit_of_measure_mode'),this.value);},package_dimensions_volume_unit_of_measure_mode_change:function()\n{var self=AmazonTemplateDescriptionDefinitionObj;self.weightUnitOfMeasureChangeAll.call(this,$('package_dimensions_volume_unit_of_measure_custom_value'),$('package_dimensions_volume_unit_of_measure_custom_attribute'),this.value);},package_weight_mode_change:function()\n{var self=AmazonTemplateDescriptionDefinitionObj;self.weightModeChange.call(this,$('package_weight_custom_value_tr'),$('package_weight_custom_attribute'),$('package_weight_unit_of_measure_mode_tr'),$('package_weight_unit_of_measure_mode'),this.value);},package_weight_unit_of_measure_mode_change:function()\n{var self=AmazonTemplateDescriptionDefinitionObj;self.weightUnitOfMeasureChangeAll.call(this,$('package_weight_unit_of_measure_custom_value'),$('package_weight_unit_of_measure_custom_attribute'),this.value);},shipping_weight_mode_change:function()\n{var self=AmazonTemplateDescriptionDefinitionObj;self.weightModeChange.call(this,$('shipping_weight_custom_value_tr'),$('shipping_weight_custom_attribute'),$('shipping_weight_unit_of_measure_mode_tr'),$('shipping_weight_unit_of_measure_mode'),this.value);},shipping_weight_unit_of_measure_mode_change:function()\n{var self=AmazonTemplateDescriptionDefinitionObj;self.weightUnitOfMeasureChangeAll.call(this,$('shipping_weight_unit_of_measure_custom_value'),$('shipping_weight_unit_of_measure_custom_attribute'),this.value);},multi_element_mode_change:function(type,max)\n{var self=AmazonTemplateDescriptionDefinitionObj;if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::'+type.toUpperCase()+'_MODE_NONE')){$$('.'+type+'_tr').invoke('hide');$$('input[name^=\"definition['+type+']\"]').each(function(obj){obj.value='';});$(type+'_actions_tr').hide();}else{var visibleElementsCounter=0,emptyVisibleElements=0;$$('.'+type+'_tr').each(function(obj){if(visibleElementsCounter==0||$(obj).select('input[name^=\"definition['+type+']\"]')[0].value!=''){$(obj).show();visibleElementsCounter++;}});$(type+'_actions_tr').show();if(visibleElementsCounter>1){$('hide_'+type+'_action').removeClassName('action-disabled');}\nvisibleElementsCounter<max?$('show_'+type+'_action').removeClassName('action-disabled'):$('show_'+type+'_action').addClassName('action-disabled');if(visibleElementsCounter==1&&$(type+'_0').value==''){$('show_'+type+'_action').addClassName('action-disabled');}}},multi_element_keyup:function(type,element)\n{if(!element.value){return $('show_'+type+'_action').addClassName('action-disabled');}\nvar hiddenElements=$$('.'+type+'_tr').findAll(function(obj){return!$(obj).visible();});if(hiddenElements.size()!=0){$('show_'+type+'_action').removeClassName('action-disabled');}},description_mode_change:function()\n{this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::DESCRIPTION_MODE_CUSTOM')?$$('.c-custom_description_tr').invoke('show'):$$('.c-custom_description_tr').invoke('hide');},image_main_mode_change:function()\n{var self=AmazonTemplateDescriptionDefinitionObj;if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::IMAGE_MAIN_MODE_NONE')){$('gallery_images_mode_tr').hide();$('gallery_images_mode').value=0;$('gallery_images_mode').simulate('change');}else{$('gallery_images_mode_tr').show();}\n$('image_main_attribute').value='';if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::IMAGE_MAIN_MODE_ATTRIBUTE')){self.updateHiddenValue(this,$('image_main_attribute'));}},image_variation_difference_mode_change:function()\n{var self=AmazonTemplateDescriptionDefinitionObj;$('image_variation_difference_attribute').value='';if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::IMAGE_VARIATION_DIFFERENCE_MODE_ATTRIBUTE')){self.updateHiddenValue(this,$('image_variation_difference_attribute'));}},gallery_images_mode_change:function()\n{$('gallery_images_limit').value='';$('gallery_images_attribute').value='';if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::GALLERY_IMAGES_MODE_PRODUCT')){AmazonTemplateDescriptionDefinitionObj.updateHiddenValue(this,$('gallery_images_limit'));}\nif(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::GALLERY_IMAGES_MODE_ATTRIBUTE')){AmazonTemplateDescriptionDefinitionObj.updateHiddenValue(this,$('gallery_images_attribute'));}},showElement:function(type)\n{var emptyVisibleElementsExist=$$('.'+type+'_tr').any(function(obj){return $(obj).visible()&&$(obj).select('input[name^=\"definition['+type+']\"]')[0].value=='';});if(emptyVisibleElementsExist){return;}\nvar hiddenElements=$$('.'+type+'_tr').findAll(function(obj){return!$(obj).visible();});if(hiddenElements.size()==0){return;}\nhiddenElements.shift().show();$('hide_'+type+'_action').removeClassName('action-disabled');$('show_'+type+'_action').addClassName('action-disabled');},hideElement:function(type,force)\n{force=force||false;var visibleElements=[];$$('.'+type+'_tr').each(function(el){if(el.visible())visibleElements.push(el);});if(visibleElements.length<=0||(!force&&visibleElements[visibleElements.length-1].getAttribute('undeletable'))){return;}\nif(visibleElements.length==1){var elementMode=$(type+'_mode');elementMode.value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::'+type.toUpperCase()+'_MODE_NONE');elementMode.simulate('change');}\nif(visibleElements.size()>1){var lastVisibleElement=visibleElements.pop();lastVisibleElement.select('input[name^=\"definition['+type+']\"]')[0].value='';lastVisibleElement.hide();var nextVisibleElement=visibleElements.pop();if(!force&&nextVisibleElement.getAttribute('undeletable')){$('hide_'+type+'_action').addClassName('action-disabled');}}\n$('show_'+type+'_action').removeClassName('action-disabled');},forceFillUpElement:function(type,value)\n{var neededTr=null;$$('.'+type+'_tr').each(function(obj){if($(obj).visible()&&$(obj).select('input[name^=\"definition['+type+']\"]')[0].value==value){neededTr=obj;return false;}});if(!neededTr){this.showElement(type);var emptyVisibleTrs=$$('.'+type+'_tr').findAll(function(obj){return $(obj).visible()&&$(obj).select('input[name^=\"definition['+type+']\"]')[0].value=='';});neededTr=emptyVisibleTrs.pop();}\nvar input=neededTr.down('input[type=\"text\"]');input.setAttribute('disabled','disabled');input.value=value;neededTr.down('.admin__field').appendChild(new Element('input',{name:input.name,type:'hidden',value:value}));neededTr.setAttribute('undeletable','1');neededTr.down('.attributes-container-td').hide();$('hide_'+type+'_action').addClassName('action-disabled');this.multi_element_keyup(type,{value:' '});},forceClearElements:function(type)\n{var self=this;var visibleTrs=$$('.'+type+'_tr').findAll(function(obj){return $(obj).visible();});visibleTrs.each(function(el){el.removeAttribute('undeletable');el.down('input[type=\"text\"]').removeAttribute('disabled');el.down('.attributes-container-td').show();var hiddenInput=el.down('input[type=\"hidden\"]');hiddenInput&&hiddenInput.remove();self.hideElement(type,true);});$('hide_'+type+'_action').removeClassName('action-disabled');}});});","Ess_M2ePro/js/Amazon/Template/Description/Description.min.js":"define(['jquery','underscore','M2ePro/Amazon/Template/Edit'],function(jQuery,_){window.AmazonTemplateDescription=Class.create(AmazonTemplateEdit,{initialize:function()\n{var self=this;self.specificHandler=null;self.categoryInfo={};self.categoryPathHiddenInput=$('category_path');self.categoryNodeIdHiddenInput=$('browsenode_id');self.categoryProductDataNickHiddenInput=$('product_data_nick');self.productDataNicksInfo={};self.variationThemes=[];self.initValidation();},initValidation:function()\n{var self=this;self.setValidationCheckRepetitionValue('M2ePro-description-template-title',M2ePro.translator.translate('The specified Title is already used for another Policy. Policy Title must be unique.'),'Template\\\\Description','title','id',M2ePro.formData.id,M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Helper\\\\Component\\\\Amazon::NICK'));jQuery.validator.addMethod('M2ePro-validate-greater-than',function(value,el){if(!el.up('div.admin__field').visible()){return true;}\nvalue=str_replace(',','.',value);if(value.match(/[^\\d.]+/g)||value<0){return false;}\nreturn value>=el.getAttribute('min_value');},M2ePro.translator.translate('Please enter a valid number value in a specified range.'));jQuery.validator.addMethod('M2ePro-validate-category',function(value){if(!self.isNewAsinAccepted()){return true;}\nreturn $('category_path').value!='';},M2ePro.translator.translate('You should select Category and Product Type first'));},initObservers:function()\n{$('marketplace_id').observe('change',AmazonTemplateDescriptionObj.onChangeMarketplace);$('new_asin_accepted').observe('change',AmazonTemplateDescriptionObj.onChangeNewAsinAccepted);$('edit_category_link').observe('click',AmazonTemplateDescriptionObj.onClickEditCategory);$('product_data_nick_select').observe('change',AmazonTemplateDescriptionObj.onChangeProductDataNick);$('worldwide_id_mode').observe('change',AmazonTemplateDescriptionObj.onChangeWorldwideId).simulate('change');$('registered_parameter').observe('change',AmazonTemplateDescriptionObj.onChangeRegisteredParameter).simulate('change');$('amazonTemplateDescriptionEditTabs_specifics').observe('click',AmazonTemplateDescriptionObj.checkSpecificsReady);},setSpecificHandler:function(object)\n{var self=this;self.specificHandler=object;},isNewAsinAccepted:function()\n{return $('new_asin_accepted').value==1;},checkMarketplaceSelection:function()\n{return $('marketplace_id').value!='';},checkSpecificsReady:function()\n{var self=AmazonTemplateDescriptionObj;if(!self.specificHandler.isReady()){alert(M2ePro.translator.translate('You should select Category and Product Type first'));self.goToGeneralTab();}},duplicateClick:function($super,$headId)\n{this.setValidationCheckRepetitionValue('M2ePro-description-template-title',M2ePro.translator.translate('The specified Title is already used for another Policy. Policy Title must be unique.'),'Template\\\\Description','title','','',M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Helper\\\\Component\\\\Amazon::NICK'));if(M2ePro.customData.category_locked){M2ePro.customData.category_locked=false;this.hideCategoryWarning('category_locked_warning_message');$('edit_category_link').show();$('product_data_nick_select').removeAttribute('disabled');}\nif(M2ePro.customData.marketplace_locked){M2ePro.customData.marketplace_locked=false;$('marketplace_locked_warning_message').remove();if(!M2ePro.customData.marketplace_force_set){$('marketplace_hidden_input').remove();$('marketplace_id').removeAttribute('disabled');}}\nif(M2ePro.customData.new_asin_switcher_locked){M2ePro.customData.new_asin_switcher_locked=false;$('new_asin_locked_warning_message').remove();if(!M2ePro.customData.new_asin_switcher_force_set){$('new_asin_accepted_hidden_input').remove();$('new_asin_accepted').removeAttribute('disabled');}}\n$super($headId,M2ePro.translator.translate('Add Description Policy'));},saveClick:function($super,url,confirmText,templateNick)\n{var self=AmazonTemplateDescriptionObj;self.specificHandler.prepareSpecificsDataToPost();$super(url,confirmText,templateNick);},saveAndEditClick:function($super,url,tabsId,confirmText,templateNick)\n{var self=AmazonTemplateDescriptionObj;self.specificHandler.prepareSpecificsDataToPost();$super(url,tabsId,confirmText,templateNick);},saveAndCloseClick:function($super,confirmText,templateNick)\n{var self=AmazonTemplateDescriptionObj;self.specificHandler.prepareSpecificsDataToPost();$super(confirmText,templateNick);},onChangeMarketplace:function()\n{var self=AmazonTemplateDescriptionObj;self.resetCategory();},onClickEditCategory:function()\n{var self=AmazonTemplateDescriptionObj;if(!self.checkMarketplaceSelection()){self.alert(M2ePro.translator.translate('You should select Marketplace first.'));return;}\nAmazonTemplateDescriptionCategoryChooserObj.showEditCategoryPopUp();},onChangeProductDataNick:function()\n{var self=AmazonTemplateDescriptionObj;self.saveRecentProductDataNick(this.value);self.resetRequiredAttributesForProductType();self.setProductDataNick(this.value);},onChangeNewAsinAccepted:function()\n{var self=AmazonTemplateDescriptionObj;var onlyAsinBlocks=$$('.hide-when-asin-is-disabled');onlyAsinBlocks.invoke('hide');if(this.value==1){onlyAsinBlocks.invoke('show');var worldWideIdMode=$('worldwide_id_mode');worldWideIdMode.simulate('change');if($('registered_parameter').value==''&&$('worldwide_id_custom_attribute').value==''){worldWideIdMode.value=-1;}\n$('item_package_quantity_mode').simulate('change');$('number_of_items_mode').simulate('change');}\nparseInt(this.value)?$('category_path').addClassName('M2ePro-required-when-visible'):$('category_path').removeClassName('M2ePro-required-when-visible');self.updateSpanRequirements($('template_description_edit_category_container'),this.value);self.updateFieldRequirements($('manufacturer_mode'),this.value);self.updateFieldRequirements($('brand_mode'),this.value);self.updateFieldRequirements($('image_main_mode'),this.value);var chooser=$('number_of_items_mode');if(chooser.getAttribute('required_attribute_for_new_asin')){if(this.value==0)chooser.value='';self.updateFieldRequirements(chooser,this.value,'M2ePro-required-when-visible');}\nchooser=$('item_package_quantity_mode');if(chooser.getAttribute('required_attribute_for_new_asin')){if(this.value==0)chooser.value='';self.updateFieldRequirements(chooser,this.value,'M2ePro-required-when-visible');}},onChangeWorldwideId:function()\n{var target=$('worldwide_id_custom_attribute');target.value='';if(this.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description::WORLDWIDE_ID_MODE_CUSTOM_ATTRIBUTE')){AmazonTemplateDescriptionObj.updateHiddenValue(this,target);}},onChangeRegisteredParameter:function()\n{var worldwideIdMode=$('worldwide_id_mode'),noneOption=worldwideIdMode.down('option'),currentValue=worldwideIdMode.getAttribute('data-current-value');if(!this.value){noneOption.hide();worldwideIdMode.simulate('change');if($('worldwide_id_custom_attribute').value==''){worldwideIdMode.selectedIndex=-1;}}else{noneOption.show();if(currentValue==''){worldwideIdMode.value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description::WORLDWIDE_ID_MODE_NONE');}\n$('worldwide_id_custom_attribute').value=''}\nworldwideIdMode.setAttribute('data-current-value','');},setCategory:function(categoryInfo,notSetProductTypeForceIfOnlyOne)\n{var self=this;notSetProductTypeForceIfOnlyOne=notSetProductTypeForceIfOnlyOne||false;this.categoryInfo=categoryInfo;this.categoryPathHiddenInput.value=this.getInterfaceCategoryPath(categoryInfo);this.categoryNodeIdHiddenInput.value=categoryInfo.browsenode_id;this.updateCategoryPathSpan(this.getInterfaceCategoryPath(categoryInfo,true));this.updateAvailableProductTypes();if(self.categoryInfo.product_data_nicks.length==1&&!notSetProductTypeForceIfOnlyOne){self.setProductDataNickFromTree(self.categoryInfo.product_data_nicks[0]);}\nthis.hideCategoryWarning('category_is_not_accessible_message');},setProductDataNickFromTree:function(productDataNick)\n{$$('#product_data_nick_select option').each(function(el){var optGroup=$(el).up('optgroup');if(el.value==productDataNick&&optGroup&&optGroup.getAttribute('is_recent')===null&&optGroup.getAttribute('is_recommended')===null)\n{el.setAttribute('selected','selected');return true;}});AmazonTemplateDescriptionObj.setProductDataNick(productDataNick);},setProductDataNick:function(productDataNick)\n{var self=this;this.categoryProductDataNickHiddenInput.value=productDataNick;self.categoryInfo['required_attributes']={};$H(this.productDataNicksInfo).each(function(item){if(item.key==productDataNick){self.categoryInfo['required_attributes']=item.value.required_attributes;return true;}});this.updateRequiredAttributesForProductType();this.updateWarningMessagesVisibility();this.specificHandler.reset();this.specificHandler.run(this.categoryInfo,productDataNick);},saveRecentProductDataNick:function(productDataNick)\n{if(productDataNick==''){return;}\nnew Ajax.Request(M2ePro.url.get('amazon_template_description/saveRecentProductDataNick'),{method:'post',parameters:{marketplace_id:$('marketplace_id').value,product_data_nick:productDataNick}});},resetCategory:function()\n{this.categoryInfo={};this.categoryPathHiddenInput.value='';this.categoryNodeIdHiddenInput.value='';this.resetCategoryPathSpan();this.resetProductDataNick();this.hideCategoryWarning('category_variation_warning_message');},resetProductDataNick:function()\n{this.categoryProductDataNickHiddenInput.value='';this.resetRequiredAttributesForProductType();$('product_data_nick_tr').hide();$('product_data_nick_select').update();this.specificHandler.reset();},prepareEditMode:function()\n{var self=AmazonTemplateDescriptionObj;if(M2ePro.formData.product_data_nick==''||M2ePro.formData.browsenode_id==''||M2ePro.formData.category_path==''){return;}\nvar callback=function(transport){if(!transport.responseText){self.resetCategory();self.showCategoryWarning('category_is_not_accessible_message');}else{var categoryInfo=transport.responseText.evalJSON();self.setCategory(categoryInfo,true);var isProductTypeAvailable=self.isProductTypeAvailable(M2ePro.formData.product_data_nick);if(isProductTypeAvailable){self.setProductDataNickFromTree(M2ePro.formData.product_data_nick);}else{self.specificHandler.resetFormDataSpecifics();}\nif(M2ePro.customData.category_locked){self.showCategoryWarning('category_locked_warning_message');$('edit_category_link').hide();$('product_data_nick_select').setAttribute('disabled','disabled');}\nif(!isProductTypeAvailable){self.showCategoryWarning('category_is_not_accessible_message');$('product_data_nick_select').removeAttribute('disabled');}}};AmazonTemplateDescriptionCategoryChooserObj.getCategoryInfoFromDictionaryBrowseNodeId(M2ePro.formData.browsenode_id,M2ePro.formData.category_path,callback);},showCategoryWarning:function(item)\n{var me=$(item);var atLeastOneWarningShown=$$('#category_warning_messages .category-warning-item').any(function(obj){return $(obj).id!=me.id&&$(obj).visible();});if(atLeastOneWarningShown&&me.previous('span.additional-br')){me.previous('span.additional-br').show();}\n$(item).show();$('category_warning_messages').show();},hideCategoryWarning:function(item)\n{var me=$(item);$(item).hide();var atLeastOneWarningShown=$$('#category_warning_messages .category-warning-item').any(function(obj){return $(obj).visible();});if(me.previous('span.additional-br')){me.previous('span.additional-br').hide();}!atLeastOneWarningShown&&$('category_warning_messages').hide();},updateCategoryPathSpan:function(path)\n{$('category_path_span').update(path);},resetCategoryPathSpan:function()\n{var span=$('category_path_span');span.innerHTML='<span style=\"color: grey; font-style: italic\">'+M2ePro.translator.translate('Not Selected')+'</span>';},resetRequiredAttributesForProductType:function()\n{this.resetManufacturerPartNumberRequired();this.resetTargetAudienceRequired();this.resetItemDimensionWeightRequired();this.resetItemPackageQuantityRequired();this.resetNumberOfItemsRequired();},updateRequiredAttributesForProductType:function()\n{this.updateManufacturerPartNumberRequired();this.updateTargetAudienceRequired();this.updateItemDimensionWeightRequired();this.updateItemPackageQuantityRequired();this.updateNumberOfItemsRequired();},updateWarningMessagesVisibility:function()\n{var self=AmazonTemplateDescriptionObj;new Ajax.Request(M2ePro.url.get('amazon_template_description/getVariationThemes'),{method:'get',asynchronous:true,parameters:{marketplace_id:$('marketplace_id').value,product_data_nick:self.categoryProductDataNickHiddenInput.value},onSuccess:function(transport){self.variationThemes=transport.responseText.evalJSON();_.isEmpty(self.variationThemes)?self.showCategoryWarning('category_variation_warning_message'):self.hideCategoryWarning('category_variation_warning_message');}});},resetManufacturerPartNumberRequired:function()\n{this.updateFieldRequirements($('manufacturer_part_number_mode'),0);},resetItemDimensionWeightRequired:function()\n{var chooser=$('item_dimensions_weight_mode');chooser.down('option').show();},resetTargetAudienceRequired:function()\n{var targetAudienceChooser=$('target_audience_mode');targetAudienceChooser.removeAttribute('disabled');var hiddenInput=targetAudienceChooser.up('div.admin__field-control').down('input[type=\"hidden\"]');hiddenInput&&hiddenInput.remove();AmazonTemplateDescriptionDefinitionObj.forceClearElements('target_audience');},resetItemPackageQuantityRequired:function()\n{var chooser=$('item_package_quantity_mode');this.updateFieldRequirements(chooser,0);chooser.removeAttribute('required_attribute_for_new_asin');},resetNumberOfItemsRequired:function()\n{var chooser=$('number_of_items_mode');this.updateFieldRequirements(chooser,0);chooser.removeAttribute('required_attribute_for_new_asin');},updateManufacturerPartNumberRequired:function()\n{if(!this.categoryInfo.required_attributes.hasOwnProperty('/DescriptionData/MfrPartNumber')){return;}\nthis.updateFieldRequirements($('manufacturer_part_number_mode'),1);},updateTargetAudienceRequired:function()\n{if(!this.categoryInfo.required_attributes.hasOwnProperty('/DescriptionData/TargetAudience')){return;}\nvar targetAudienceChooser=$('target_audience_mode');targetAudienceChooser.value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::TARGET_AUDIENCE_MODE_CUSTOM');targetAudienceChooser.simulate('change');targetAudienceChooser.setAttribute('disabled','disabled');targetAudienceChooser.up('.admin__field').appendChild(new Element('input',{name:targetAudienceChooser.name,type:'hidden',value:M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::TARGET_AUDIENCE_MODE_CUSTOM')}));this.categoryInfo.required_attributes['/DescriptionData/TargetAudience'].each(function(value){AmazonTemplateDescriptionDefinitionObj.forceFillUpElement('target_audience',value);});},updateItemDimensionWeightRequired:function()\n{if(!this.categoryInfo.required_attributes.hasOwnProperty('/DescriptionData/ItemDimensions/Weight')){return;}\nvar chooser=$('item_dimensions_weight_mode');chooser.down('option').hide();if(chooser.value==M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::WEIGHT_MODE_NONE')){chooser.value=M2ePro.php.constant('\\\\Ess\\\\M2ePro\\\\Model\\\\Amazon\\\\Template\\\\Description\\\\Definition::WEIGHT_MODE_CUSTOM_VALUE');}\nchooser.simulate('change');},updateItemPackageQuantityRequired:function()\n{if(!this.categoryInfo.required_attributes.hasOwnProperty('/ItemPackageQuantity')){return;}\nvar chooser=$('item_package_quantity_mode');chooser.setAttribute('required_attribute_for_new_asin','true');if(this.isNewAsinAccepted()){this.updateFieldRequirements(chooser,1,'M2ePro-required-when-visible');}},updateNumberOfItemsRequired:function()\n{if(!this.categoryInfo.required_attributes.hasOwnProperty('/NumberOfItems')){return;}\nvar chooser=$('number_of_items_mode');chooser.setAttribute('required_attribute_for_new_asin','true');if(this.isNewAsinAccepted()){this.updateFieldRequirements(chooser,1,'M2ePro-required-when-visible');}},updateAvailableProductTypes:function()\n{var self=AmazonTemplateDescriptionObj;$('product_data_nick_tr').show();var renderingCallback=function(transport){var response=transport.responseText.evalJSON();if(!response){return;}\nvar html='';$H(response['grouped_data']).each(function(data){var group=data.key,productDataNicks=data.value;html+='<optgroup label=\"'+group+'\">';$H(productDataNicks).each(function(el){html+='<option value=\"'+el.value.product_data_nick+'\">'+el.value.title+'</option>';});html+='</optgroup>';});var recommendedHtml='';if(self.categoryInfo.product_data_nicks.length>0){recommendedHtml+='<optgroup is_recommended=\"1\" label=\"'+M2ePro.translator.translate('Recommended')+'\">';self.categoryInfo.product_data_nicks.each(function(el){var title=typeof response['product_data'][el]!='undefined'?response['product_data'][el]['group']+' > '+response['product_data'][el]['title']:el;recommendedHtml+='<option value=\"'+el+'\">'+title+'</option>';});recommendedHtml+='</optgroup>';}\nvar recentHtml='';if(Object.keys(response['recent_data']).length>0){recentHtml+='<optgroup is_recent=\"1\" label=\"'+M2ePro.translator.translate('Recent')+'\">';$H(response['recent_data']).each(function(data){var title=data.value['group']+' > '+data.value['title'];recentHtml+='<option value=\"'+data.key+'\">'+title+'</option>';});recentHtml+='</optgroup>';}\nhtml='<option style=\"display: none;\"></option>'+recommendedHtml+recentHtml+html;$('product_data_nick_select').update(html);};new Ajax.Request(M2ePro.url.get('amazon_template_description/getAvailableProductTypes'),{method:'post',asynchronous:false,parameters:{marketplace_id:$('marketplace_id').value,browsenode_id:self.categoryNodeIdHiddenInput.value},onSuccess:function(transport){self.productDataNicksInfo=transport.responseText.evalJSON()['product_data'];renderingCallback.call(self,transport);}});},isProductTypeAvailable:function(productType)\n{var result=false;$H(this.productDataNicksInfo).each(function(el){if(productType==el.key){result=true;return true;}});return result;},updateSpanRequirements:function(element,dependence)\n{parseInt(dependence)?element.up('.field').addClassName('_required'):element.up('.field').removeClassName('_required');},updateFieldRequirements:function(element,dependence,className)\n{className=className||'required-entry';var firstOption=element.select('option').first();if(firstOption.value=='0'){firstOption.show();var hiddenOpt=element.select('option.hidden-opt').first();hiddenOpt&&hiddenOpt.remove();if(parseInt(dependence)){firstOption.hide();element.appendChild(new Element('option',{style:'display: none;',class:'hidden-opt'}));}}\nif(parseInt(dependence)&&element.value==0){element.value='';}\nparseInt(dependence)?element.addClassName(className):element.removeClassName(className);element.simulate('change');this.updateSpanRequirements(element,dependence);},getInterfaceCategoryPath:function(categoryInfo,withBrowseNodeId)\n{withBrowseNodeId=withBrowseNodeId||false;var path=categoryInfo.path!=null?categoryInfo.path.replace(/>/g,' > ')+' > '+categoryInfo.title:categoryInfo.title;return!withBrowseNodeId?path:path+' ('+categoryInfo.browsenode_id+')';},goToGeneralTab:function()\n{jQuery('#amazonTemplateDescriptionEditTabs').tabs('option','active',0);}});});","Ess_M2ePro/js/Amazon/Template/Description/Category/Chooser.min.js":"define(['jquery','Magento_Ui/js/modal/modal','M2ePro/Common'],function(jQuery,modal){window.AmazonTemplateDescriptionCategoryChooser=Class.create(Common,{specificHandler:null,selectedCategoryIdBefore:null,selectedCategoryId:null,preloadedSelectedCategoryObj:null,variationThemes:{},initialize:function()\n{this.categoryNodeIdHiddenInput=$('browsenode_id');this.categoryPathHiddenInput=$('category_path');},setSpecificHandler:function(object)\n{this.specificHandler=object;},showEditCategoryPopUp:function()\n{var self=this;new Ajax.Request(M2ePro.url.get('amazon_template_description/getCategoryChooserHtml'),{method:'post',parameters:{marketplace_id:$('marketplace_id').value,browsenode_id:self.categoryNodeIdHiddenInput.value,category_path:self.categoryPathHiddenInput.value},onSuccess:function(transport){if(typeof self.popUp!='undefined'){self.popUp.modal('closeModal');}\nvar html=transport.responseText;var callback=function(transport){var categoryInfo=transport.responseText.evalJSON();self.selectedCategoryId=null;self.selectedCategoryIdBefore=null;self.preloadedSelectedCategoryObj=null;if(typeof categoryInfo.category_id!='undefined'){self.selectedCategoryId=categoryInfo.category_id;self.selectedCategoryIdBefore=categoryInfo.category_id;self.preloadedSelectedCategoryObj=categoryInfo;}};self.openPopUp(html);if(self.categoryNodeIdHiddenInput.value&&self.categoryPathHiddenInput.value){self.getCategoryInfoFromDictionaryBrowseNodeId(self.categoryNodeIdHiddenInput.value,self.categoryPathHiddenInput.value,callback);}}});},openPopUp:function(html)\n{var self=this,modalDialogMessage=$('modal_dialog_message');if(self.popUp){self.popUp.modal('openModal');modalDialogMessage.innerHTML='';modalDialogMessage.insert(html);modalDialogMessage.innerHTML.evalScripts();AmazonTemplateDescriptionCategoryChooserObj.renderTopLevelCategories('chooser_browser');return;}\nmodalDialogMessage=new Element('div',{id:'modal_dialog_message'});modalDialogMessage.insert(html);modalDialogMessage.innerHTML.evalScripts();self.popUp=jQuery(modalDialogMessage).modal({title:M2ePro.translator.translate('Change Category'),type:'slide',buttons:[{text:M2ePro.translator.translate('Cancel'),click:function(){this.closeModal();}},{text:M2ePro.translator.translate('Confirm'),class:'action-primary',id:'save_popup_button',click:function(){this.closeModal();AmazonTemplateDescriptionCategoryChooserObj.confirmCategory();}}]});self.popUp.modal('openModal');},cancelPopUp:function()\n{var self=this;self.popUp.modal('closeModal');},renderTopLevelCategories:function(containerId)\n{this.prepareDomStructure(null,$(containerId));this.renderChildCategories(null);},renderChildCategories:function(parentCategoryId)\n{var self=this;new Ajax.Request(M2ePro.url.get('amazon_template_description/getChildCategories'),{method:'post',parameters:{marketplace_id:$('marketplace_id').value,parent_category_id:parentCategoryId},onSuccess:function(transport){if(transport.responseText.length<=2){return;}\nvar categories=transport.responseText.evalJSON();self.tempCategories=categories;var selectEl=$(self.getCategoriesSelectElementId(parentCategoryId));categories.each(function(category){var option=new Element('option',{value:category.category_id});option.observe('click',function(){self.browseClickCategory.call(self,selectEl,category.category_id);});var arrowString=category.is_leaf==0?' > ':'';selectEl.appendChild(option).update(category.title+arrowString);});selectEl.style.display='inline-block';$('chooser_browser').scrollLeft=$('chooser_browser').scrollWidth;}});},browseClickCategory:function(selectObj,categoryId)\n{var callback=function(transport){var categoryInfo=transport.responseText.evalJSON();if(categoryInfo.is_leaf==1){this.selectedCategoryId=categoryInfo.category_id;this.preloadedSelectedCategoryObj=categoryInfo;this.updateCurrentlySelectedCategorySpan(categoryInfo);}\nvar parentCategoryId=selectObj.id.replace(this.getCategoriesSelectElementId(''),'');var parentDiv=$(this.getCategoryChildrenElementId(parentCategoryId));parentDiv.innerHTML='';this.prepareDomStructure(categoryId,parentDiv);this.renderChildCategories(categoryId);};this.getCategoryInfoFromDictionaryByCategoryId(categoryId,callback);},prepareDomStructure:function(categoryId,parentDiv)\n{var childrenSelect=new Element('select',{id:this.getCategoriesSelectElementId(categoryId),style:'min-width: 200px; max-height: none; display: none;',size:'10',class:'multiselect admin__control-multiselect'});parentDiv.appendChild(childrenSelect);var childrenDiv=new Element('div',{id:this.getCategoryChildrenElementId(categoryId),class:'category-children-block'});parentDiv.appendChild(childrenDiv);},getCategoriesSelectElementId:function(categoryId)\n{if(categoryId===null)categoryId=0;return'category_chooser_select_'+categoryId;},getCategoryChildrenElementId:function(categoryId)\n{if(categoryId===null)categoryId=0;return'category_chooser_children_'+categoryId;},confirmCategory:function()\n{var self=AmazonTemplateDescriptionCategoryChooserObj;if(self.selectedCategoryId==self.selectedCategoryIdBefore){return;}\nAmazonTemplateDescriptionObj.resetCategory();self.specificHandler.resetFormDataSpecifics();if(self.preloadedSelectedCategoryObj){AmazonTemplateDescriptionObj.setCategory(self.preloadedSelectedCategoryObj);self.saveRecentCategory();}},unSelectCategory:function()\n{var self=AmazonTemplateDescriptionCategoryChooserObj;self.selectedCategoryId=null;self.preloadedSelectedCategoryObj=null;$('category_reset_link').hide();$('selected_category_path').innerHTML='<span style=\"color: grey; font-style: italic\">'+M2ePro.translator.translate('Not Selected')+'</span>';},refreshAmazonCategories:function()\n{var self=AmazonTemplateDescriptionCategoryChooserObj;var win=window.open(M2ePro.url.get('amazon_marketplace/index'));var intervalId=setInterval(function(){if(!win.closed){return;}\nclearInterval(intervalId);self.renderTopLevelCategories('chooser_browser');if($('query').value.length!=0){self.search();}},1000);},saveRecentCategory:function()\n{if(this.categoryNodeIdHiddenInput.value==''||this.categoryPathHiddenInput.value==''){return;}\nnew Ajax.Request(M2ePro.url.get('amazon_template_description/saveRecentCategory'),{method:'post',parameters:{marketplace_id:$('marketplace_id').value,browsenode_id:this.categoryNodeIdHiddenInput.value,category_path:this.categoryPathHiddenInput.value}});},search:function()\n{var self=AmazonTemplateDescriptionCategoryChooserObj;var query=$('query').value;if(query.length<3){return;}\nself.beforeSearch();new Ajax.Request(M2ePro.url.get('amazon_template_description/searchCategory'),{method:'post',parameters:{marketplace_id:$('marketplace_id').value,query:query.trim()},onSuccess:function(transport){if(transport.responseText.length<=2){$('search_results_no_results_tr').show();$('search_results_update_sites_data_tr').show();return;}\nvar categories=transport.responseText.evalJSON();var resultsTable=$('search_results_table');categories.each(function(categoryInfo){var tr=new Element('tr',{class:'search_results_results_tr'});tr.appendChild(new Element('td').update(AmazonTemplateDescriptionObj.getInterfaceCategoryPath(categoryInfo,true)));var link=new Element('a',{href:'#'}).update(M2ePro.translator.translate('Select'));link.observe('click',function(){var categoryPath=AmazonTemplateDescriptionObj.getInterfaceCategoryPath(categoryInfo);self.searchClickCategory.call(self,categoryInfo.browsenode_id,categoryPath);});tr.appendChild(new Element('td')).appendChild(link);resultsTable.down('tbody').appendChild(tr);});}});},beforeSearch:function()\n{var self=AmazonTemplateDescriptionCategoryChooserObj;$('search_results_no_results_tr').hide();$('search_results_update_sites_data_tr').hide();$$('.search_results_results_tr').invoke('remove');},searchReset:function()\n{var self=AmazonTemplateDescriptionCategoryChooserObj;self.beforeSearch();$('query').value='';$('query').focus();},searchClickCategory:function(browseNodeId,categoryPath)\n{this.selectAndLoadCategory(browseNodeId,categoryPath);},keyPressQuery:function(event)\n{var self=AmazonTemplateDescriptionCategoryChooserObj;if(event.keyCode==13){self.search();}},recentClickCategory:function(browseNodeId,categoryPath)\n{this.selectAndLoadCategory(browseNodeId,categoryPath);},selectAndLoadCategory:function(browseNodeId,categoryPath)\n{var callback=function(transport){var categoryInfo=transport.responseText.evalJSON();this.selectedCategoryId=categoryInfo.category_id;this.preloadedSelectedCategoryObj=categoryInfo;this.updateCurrentlySelectedCategorySpan(categoryInfo);};this.getCategoryInfoFromDictionaryBrowseNodeId(browseNodeId,categoryPath,callback);},getCategoryInfoFromDictionaryByCategoryId:function(categoryId,callback)\n{var self=this;new Ajax.Request(M2ePro.url.get('amazon_template_description/getCategoryInfoByCategoryId'),{method:'post',asynchronous:true,parameters:{marketplace_id:$('marketplace_id').value,category_id:categoryId},onSuccess:function(transport){callback.call(self,transport);}});},getCategoryInfoFromDictionaryBrowseNodeId:function(browsenodeId,categoryPath,callback)\n{var self=this;new Ajax.Request(M2ePro.url.get('amazon_template_description/getCategoryInfoByBrowseNodeId'),{method:'post',asynchronous:true,parameters:{marketplace_id:$('marketplace_id').value,browsenode_id:browsenodeId,category_path:categoryPath},onSuccess:function(transport){callback.call(self,transport);}});},updateCurrentlySelectedCategorySpan:function(categoryInfo)\n{var path=AmazonTemplateDescriptionObj.getInterfaceCategoryPath(categoryInfo,true);$('selected_category_path').innerHTML=path;$('category_reset_link').show();}});});","Ess_M2ePro/js/Amazon/Template/Description/Category/Specific.min.js":"define(['jquery','M2ePro/Common'],function(jQuery){window.AmazonTemplateDescriptionCategorySpecific=Class.create(Common,{initialize:function()\n{var self=this;self.dictionaryHelper=new AmazonTemplateDescriptionCategorySpecificDictionary();self.specificsContainer=$('specifics_container');self.specificsHiddenInput=$('encoded_specifics_data');self.categoryInfo=null;self.productDataNick=null;self.formDataSpecifics=[];self.selectedSpecifics={};self.renderedSpecifics=[];self.themeAttributes=[];self.initValidation();},initValidation:function()\n{var self=this;jQuery.validator.addMethod('M2ePro-specifics-validation',function(value,element){if(!element.visible()){return true;}\nvar params=self.dictionaryHelper.dictionarySpecifics[element.getAttribute('specific_id')].params;if(params.type=='int')return self.intTypeValidator(value,params,element);if(params.type=='float')return self.floatTypeValidator(value,params,element);if(params.type=='string')return self.stringTypeValidator(value,params,element);if(params.type=='date_time')return self.dateTimeTypeValidator(value,params,element);return true;},M2ePro.translator.translate('The value is incorrect.'));jQuery.validator.addMethod('M2ePro-specificAttributes-validation',function(value,element){if(!element.visible()){return true;}\nvar specific=self.dictionaryHelper.dictionarySpecifics[element.getAttribute('specific_id')];var params=specific.params.attributes[element.getAttribute('attribute_index')];if(params.type=='int')return self.intTypeValidator(value,params,element);if(params.type=='float')return self.floatTypeValidator(value,params,element);if(params.type=='string')return self.stringTypeValidator(value,params,element);if(params.type=='date_time')return self.dateTimeTypeValidator(value,params,element);return true;},M2ePro.translator.translate('The value is incorrect.'));},intTypeValidator:function(value,params,element){value=value.replace(',','.');if(isNaN(parseInt(value))||substr_count(value,'.')>0){return false;}\nvar validators={'min_value':function(value,restriction){return parseInt(value)>=parseInt(restriction);},'max_value':function(value,restriction){return parseInt(value)<=parseInt(restriction);},'total_digits':function(value,restriction){return value.length<=parseInt(restriction);}};for(var paramName in params){if(params.hasOwnProperty(paramName)&&validators[paramName]){if(!validators[paramName](value,params[paramName])){return false;}}}\nreturn true;},floatTypeValidator:function(value,params,element){value=value.replace(',','.');if(isNaN(parseFloat(value))||substr_count(value,'.')>1||value.substr(-1)=='.'){return false;}\nvar validators={'min_value':function(value,restriction){return parseFloat(value)>=parseFloat(restriction);},'max_value':function(value,restriction){return parseFloat(value)<=parseFloat(restriction);},'total_digits':function(value,restriction){return value.replace('.','').length<=restriction;},'decimal_places':function(value,restriction){return value.indexOf('.')!=-1?(value.replace(/\\d*\\./,'').length<=restriction.value):true;}};for(var paramName in params){if(params.hasOwnProperty(paramName)&&validators[paramName]){if(!validators[paramName](value,params[paramName])){return false;}}}\nreturn true;},dateTimeTypeValidator:function(value,params,element){return /^\\d{4}-\\d{2}-\\d{2}\\s\\d{2}:\\d{2}:\\d{2}$/g.test(value);},stringTypeValidator:function(value,params,element){var validators={'min_length':function(value,restriction){return value.length>=parseInt(restriction);},'max_length':function(value,restriction){return value.length<=parseInt(restriction);},'pattern':function(value,restriction){return value.match(new RegExp('^'+restriction+'$'));}};for(var paramName in params){if(params.hasOwnProperty(paramName)&&validators[paramName]){if(!validators[paramName](value,params[paramName])){return false;}}}\nreturn true;},setFormDataSpecifics:function(values)\n{this.formDataSpecifics=values;},resetFormDataSpecifics:function()\n{this.formDataSpecifics=[];},run:function(categoryInfo,productDataNick)\n{this.specificsContainer.update();this.categoryInfo=categoryInfo;this.productDataNick=productDataNick;this.initThemeAttributes();this.initSpecifics();},reset:function()\n{this.categoryInfo=null;this.productDataNick=null;this.selectedSpecifics={};this.renderedSpecifics=[];this.themeAttributes={};this.specificsContainer.update();},isReady:function()\n{return this.categoryInfo!=null&&this.productDataNick!=null;},initThemeAttributes:function()\n{var self=this;new Ajax.Request(M2ePro.url.get('amazon_template_description/getVariationThemeAttributes'),{method:'get',asynchronous:false,parameters:{marketplace_id:$('marketplace_id').value,product_data_nick:self.productDataNick},onSuccess:function(transport){self.themeAttributes=transport.responseText.evalJSON();}});},initSpecifics:function()\n{var self=this;new Ajax.Request(M2ePro.url.get('amazon_template_description/getAllSpecifics'),{method:'get',asynchronous:true,parameters:{marketplace_id:$('marketplace_id').value,product_data_nick:self.productDataNick},onSuccess:function(transport){try{self.dictionaryHelper.setDictionarySpecifics(transport.responseText.evalJSON());self.renderRootContainer();self.renderRequiredSpecifics();self.renderSpecifics(self.formDataSpecifics);}catch(e){console.log(e.message);console.log(e.stack);self.alert(e.name+': '+e.message);}}});},renderRootContainer:function()\n{var specifics=this.dictionaryHelper.getChildSpecifics({'parent_specific_id':null});if(specifics.length<=0){return;}\nthis.renderSpecific(specifics[0].xpath+'-1');},renderRequiredSpecifics:function()\n{var self=this,specifics=[];if(this.categoryInfo.required_attributes.length<=0){return;}\n$H(this.categoryInfo.required_attributes).each(function(spInfo){var xpath=spInfo.key;if(!xpath.match('/ProductData')){return false;}\nxpath=xpath.replace(/^\\/ProductData\\//,'').split('/');xpath='/'+xpath.join('-1/');if(spInfo.value.length<=0){specifics.push({xpath:xpath+'-1',value:''});}\nspInfo.value.each(function(spValue,index){specifics.push({xpath:xpath+'-'+(index+1),value:spValue});});});specifics.each(function(sp){self.renderSpecific(sp.xpath,{force_value:sp.value});});},renderSpecifics:function(specifics)\n{var self=this;if(specifics<=0){return'';}\nspecifics.sort(function(spA,spB){return spA.xpath==spB.xpath?0:(spA.xpath>spB.xpath)?1:-1;});specifics.each(function(specific){self.renderSpecific(specific.xpath);});},renderSpecific:function(indexedXpath,params)\n{params=params||{};var renderer=null;var dictionarySpecific=this.dictionaryHelper.getDictionarySpecific(indexedXpath);if(!dictionarySpecific){console.log('Specific not found in dictionary. '+indexedXpath);return;}\nif(this.dictionaryHelper.isSpecificTypeContainer(dictionarySpecific)){renderer=new AmazonTemplateDescriptionCategorySpecificBlockRenderer();}\nif(this.dictionaryHelper.isSpecificTypeSelect(dictionarySpecific)||this.dictionaryHelper.isSpecificTypeText(dictionarySpecific)){renderer=new AmazonTemplateDescriptionCategorySpecificGridRowRenderer();}\ntry{renderer.setSpecificsHandler(this);renderer.setIndexedXpath(indexedXpath);renderer.setParams(params);renderer.process();}catch(e){console.log(e.message);console.log(e.stack);this.alert(e.name+' '+e.message);}},isSpecificRendered:function(xPathWithIndex)\n{return(this.renderedSpecifics.indexOf(xPathWithIndex)>=0);},markSpecificAsRendered:function(xPathWithIndex)\n{this.renderedSpecifics.push(xPathWithIndex);},unMarkSpecificAsRendered:function(xPathWithIndex)\n{var regexpObj=new RegExp('^'+xPathWithIndex);for(var i=0;i<this.renderedSpecifics.length;i++){if(this.renderedSpecifics[i].match(regexpObj)){this.renderedSpecifics.splice(i,1);i--;}}},getRealXpathesOfRenderedSpecifics:function()\n{var realRenderedXpathes=[];this.renderedSpecifics.each(function(sp){var realPath=sp.replace(/\\-\\d*/g,'');if(realRenderedXpathes.indexOf(realPath)>=0){return true;}\nrealRenderedXpathes.push(realPath);});return realRenderedXpathes;},getXpathesOfTheSameRenderedSpecific:function(xPathWithIndex)\n{var xpathes=[];var tempXpath=xPathWithIndex.replace(/-\\d+$/,'');this.renderedSpecifics.each(function(xPath){if(tempXpath==xPath.replace(/-\\d+$/,'')){xpathes.push(xPath);}});return xpathes;},getLatestXpathFromTheSame:function(xPathWithIndex)\n{var latestIndex=0;this.getXpathesOfTheSameRenderedSpecific(xPathWithIndex).each(function(xpath){var index=parseInt(xpath.replace(/^.*-/,''));if(index>latestIndex){latestIndex=index;}});return xPathWithIndex.replace(/\\d+$/,'')+latestIndex;},markSpecificAsSelected:function(xPathWithIndex,data)\n{var self=this;if(!this.selectedSpecifics.hasOwnProperty(xPathWithIndex)){this.selectedSpecifics[xPathWithIndex]=data;return'';}\n$H(data).each(function(dataItem){self.selectedSpecifics[xPathWithIndex][dataItem.key]=dataItem.value;});},unMarkSpecificAsSelected:function(xPathWithIndex)\n{var self=this;var regexpObj=new RegExp('^'+xPathWithIndex);$H(this.selectedSpecifics).each(function(el){var specificKey=el.key;if(specificKey.match(regexpObj))delete self.selectedSpecifics[specificKey];});},isMarkedAsSelected:function(xPathWithIndex)\n{return this.selectedSpecifics.hasOwnProperty(xPathWithIndex);},getSelectionInfo:function(xPathWithIndex)\n{if(this.isMarkedAsSelected(xPathWithIndex)){return this.selectedSpecifics[xPathWithIndex];}\nreturn this.isInFormData(xPathWithIndex);},isInFormData:function(xPathWithIndex)\n{var searchResult=false;this.formDataSpecifics.each(function(el){if(el.xpath==xPathWithIndex){searchResult=el;return false;}});return searchResult;},prepareSpecificsDataToPost:function()\n{this.specificsHiddenInput.value=Object.toJSON(this.selectedSpecifics);},canSpecificBeOverwrittenByVariationTheme:function(specific)\n{return typeof this.themeAttributes[specific.xml_tag]!='undefined'&&this.themeAttributes[specific.xml_tag].length>0;}});});","Ess_M2ePro/js/Amazon/Template/Description/Category/Specific/Dictionary.min.js":"define([],function(){window.AmazonTemplateDescriptionCategorySpecificDictionary=Class.create();AmazonTemplateDescriptionCategorySpecificDictionary.prototype={TYPE_TEXT:1,TYPE_SELECT:2,TYPE_CONTAINER:3,dictionarySpecifics:{},initialize:function(){},setDictionarySpecifics:function(specifics)\n{this.dictionarySpecifics=specifics;},isSpecificRequired:function(specific)\n{return specific.min_occurs>=1;},isSpecificDesired:function(specific)\n{return specific.data_definition.hasOwnProperty('is_desired')?specific.data_definition.is_desired:false;},isSpecificTypeContainer:function(specific)\n{return parseInt(specific.type)==this.TYPE_CONTAINER;},isSpecificTypeText:function(specific)\n{return parseInt(specific.type)==this.TYPE_TEXT;},isSpecificTypeTextArea:function(specific)\n{return this.isSpecificTypeText(specific)&&specific.params.max_length&&specific.params.max_length>=100;},isSpecificTypeSelect:function(specific)\n{return parseInt(specific.type)==this.TYPE_SELECT;},getParentSpecific:function(specific)\n{if(specific.parent_specific_id==null){return null;}\nreturn this.dictionarySpecifics[specific.parent_specific_id];},getChildSpecifics:function(parentSpecific)\n{var self=this,specifics=[];if(self.dictionarySpecifics.length<=0){return specifics;}\n$H(self.dictionarySpecifics).each(function(specificData){var specific=specificData.value;specific.parent_specific_id==parentSpecific.specific_id&&specifics.push(specific);});if(specifics.length<=0){return specifics;}\nspecifics.sort(this.sortSpecific);return specifics;},getAllChildSpecifics:function(parentSpecific)\n{var specifics=[],regexpObj=new RegExp('^'+parentSpecific.xpath+'/');$H(this.dictionarySpecifics).each(function(specificData){var specific=specificData.value;specific.xpath.match(regexpObj)&&specifics.push(specific);});return specifics;},sortSpecific:function(spA,spB)\n{var aIsDesired=parseInt(spA.data_definition.is_desired);var bIsDesired=parseInt(spB.data_definition.is_desired);if(aIsDesired&&!bIsDesired){return-1;}\nif(bIsDesired&&!aIsDesired){return 1;}\nreturn spA.title==spB.title?0:(spA.title>spB.title)?1:-1;},getDictionarySpecific:function(xPathWithIndex)\n{var self=this;var dictionarySpecific;xPathWithIndex=xPathWithIndex.replace(/\\/\\-\\d{1,}\\//g,'/').replace(/\\-\\d*/g,'');$H(self.dictionarySpecifics).each(function(specificData){var specific=specificData.pop();if(specific.xpath==xPathWithIndex){dictionarySpecific=specific;throw $break;}});return dictionarySpecific;}};});","Ess_M2ePro/js/Amazon/Template/Description/Category/Specific/BlockRenderer.min.js":"define(['M2ePro/Amazon/Template/Description/Category/Specific/Renderer'],function(){window.AmazonTemplateDescriptionCategorySpecificBlockRenderer=Class.create(AmazonTemplateDescriptionCategorySpecificRenderer,{isRootBlock:false,isFlatBlock:false,withOneBlockOnly:false,parentWithOneBlockOnly:false,childFilteredSpecifics:{all:[],containers:[],rows:[]},process:function()\n{if(this.specificHandler.isSpecificRendered(this.indexedXPath)){return'';}\nif(!this.load()){return'';}\nthis.prepareFilteredChildSpecifics();this.renderParentSpecific();this.renderSelf();this.renderChildRequiredBlocks();this.tuneStyles();this.throwEventsToParent();},load:function($super)\n{var loadResult=$super();if(this.specific.parent_specific_id==null){this.isRootBlock=true;return loadResult;}\nvar specifics=this.dictionaryHelper.getChildSpecifics(this.specific);if(specifics.length==1&&this.dictionaryHelper.isSpecificTypeContainer(specifics[0])){this.withOneBlockOnly=true;return loadResult;}\nif(this.indexedXPath.split('/').length>=4){this.isFlatBlock=true;}\nreturn loadResult;},prepareFilteredChildSpecifics:function()\n{var self=this,all=[],containers=[],rows=[];var specifics=self.dictionaryHelper.getChildSpecifics(this.specific);specifics.each(function(specific){self.dictionaryHelper.isSpecificTypeContainer(specific)?containers.push(specific):rows.push(specific);all.push(specific);});self.childFilteredSpecifics={all:all,containers:containers,rows:rows};},renderParentSpecific:function()\n{if(this.specific.parent_specific_id==null){return'';}\nif(!this.dictionaryHelper.isSpecificTypeContainer(this.parentSpecific)){return'';}\nvar parentBlockRenderer=new AmazonTemplateDescriptionCategorySpecificBlockRenderer();parentBlockRenderer.setSpecificsHandler(this.specificHandler);parentBlockRenderer.setIndexedXpath(this.getParentIndexedXpath());parentBlockRenderer.process();},renderSelf:function()\n{this.prepareDomStructure();$(this.indexedXPath).observe('my-duplicate-is-rendered',this.onMyDuplicateRendered.bind(this));$(this.indexedXPath).observe('undeleteble-specific-appear',this.onWhenUndeletebleSpecificAppears.bind(this));this.specificHandler.markSpecificAsRendered(this.indexedXPath);var selectedObj={};selectedObj['mode']=this.MODE_NONE;selectedObj['is_required']=this.dictionaryHelper.isSpecificRequired(this.specific)?1:0;this.specificHandler.markSpecificAsSelected(this.indexedXPath,selectedObj);this.renderButtons();this.renderAddSpecificsRow();this.renderGrid();},renderChildRequiredBlocks:function()\n{var self=this;this.childFilteredSpecifics.containers.each(function(specific){if(!self.dictionaryHelper.isSpecificRequired(specific)){return true;}\nvar renderer=new AmazonTemplateDescriptionCategorySpecificBlockRenderer();renderer.setSpecificsHandler(self.specificHandler);renderer.setIndexedXpath(self.getChildIndexedPart(specific));if(self.withOneBlockOnly)renderer.parentWithOneBlockOnly=true;renderer.process();});},tuneStyles:function()\n{var block=$(this.indexedXPath),header=$$('fieldset[id=\"'+this.indexedXPath+'\"] legend').first();var blockStyles={},headerStyles={};if(this.isRootBlock){headerStyles['display']='none';blockStyles={};blockStyles['width']='100%';}\nif(this.withOneBlockOnly){headerStyles['display']='none';blockStyles={};blockStyles['width']='100%';}\nif(this.parentWithOneBlockOnly){header.down('span').innerHTML=this.parentSpecific.title+' > '+header.down('span').innerHTML;}\nvar parentGrid=$(this.getParentIndexedXpath()+'_grid');if(parentGrid){blockStyles['margin-top']='20px';}\nif(this.isFlatBlock&&!this.parentWithOneBlockOnly){delete(blockStyles['border-right']);delete(blockStyles['border-left']);delete(blockStyles['border-bottom']);blockStyles['padding']='0 15px 0 15px';}\nvar compuledHeaderStyle='';$H(headerStyles).each(function(el){compuledHeaderStyle+=el.key+': '+el.value+'; ';});header.setAttribute('style',compuledHeaderStyle);var compuledBlockStyle='';$H(blockStyles).each(function(el){compuledBlockStyle+=el.key+': '+el.value+'; ';});block.setAttribute('style',compuledBlockStyle);},throwEventsToParent:function()\n{var parentXpath=this.getParentIndexedXpath();var myEvent=new CustomEvent('child-specific-rendered');parentXpath&&$(parentXpath).dispatchEvent(myEvent);this.touchMyNeighbors();},prepareDomStructure:function()\n{var table=new Element('fieldset',{'id':this.indexedXPath,'class':'fieldset admin__fieldset m2epro-fieldset specifics-block','cellspacing':0,'cellpadding':0});var td=table.appendChild(new Element('legend',{class:'admin__legend legend'}));td.appendChild(new Element('span',{})).insert(this.specific.title);this.getContainer().appendChild(table);},renderAddSpecificsRow:function()\n{var renderer=new AmazonTemplateDescriptionCategorySpecificBlockGridAddSpecificRenderer();renderer.setSpecificsHandler(this.specificHandler);renderer.setIndexedXpath(this.indexedXPath);renderer.childAllSpecifics=this.childFilteredSpecifics.all;renderer.childRowsSpecifics=this.childFilteredSpecifics.rows;renderer.process();},renderGrid:function()\n{var renderer=new AmazonTemplateDescriptionCategorySpecificBlockGridRenderer();renderer.setSpecificsHandler(this.specificHandler);renderer.setIndexedXpath(this.indexedXPath);renderer.childRowsSpecifics=this.childFilteredSpecifics.rows;renderer.process();},renderButtons:function()\n{var buttonsBlock=new Element('div',{'style':'float: right; margin-top: 7px;'});buttonsBlock.appendChild(this.getAddSpecificButton());var cloneButton=this.getCloneButton();if(cloneButton!==null)buttonsBlock.appendChild(cloneButton);var removeButton=this.getRemoveButton();if(removeButton!==null)buttonsBlock.appendChild(removeButton);var div=$$('fieldset[id=\"'+this.indexedXPath+'\"] legend').first();div.appendChild(buttonsBlock);},getAddSpecificButton:function()\n{var button=new Element('a',{'id':this.indexedXPath+'_add_button','indexedxpath':this.indexedXPath,'href':'javascript:void(0);','class':'specific-add-button','style':'vertical-align: middle;','title':M2ePro.translator.translate('Add Specific into current container')});return button;},removeAction:function($super,event)\n{var deleteResult=$super(event);this.throwEventsToParent();return deleteResult;},getContainer:function()\n{if(this.isRootBlock){return $('specifics_container');}\nreturn $(this.getParentIndexedXpath());}});});","Ess_M2ePro/js/Amazon/Template/Description/Category/Specific/Renderer.min.js":"define(['Magento_Ui/js/modal/alert'],function(alert){window.AmazonTemplateDescriptionCategorySpecificRenderer=Class.create();AmazonTemplateDescriptionCategorySpecificRenderer.prototype={MODE_NONE:'none',MODE_RECOMMENDED_VALUE:'recommended_value',MODE_CUSTOM_VALUE:'custom_value',MODE_CUSTOM_ATTRIBUTE:'custom_attribute',indexedXPath:null,params:{},specific:null,parentSpecific:null,specificHandler:null,dictionaryHelper:null,initialize:function(){},load:function()\n{this.dictionaryHelper=this.specificHandler.dictionaryHelper;this.specific=this.dictionaryHelper.getDictionarySpecific(this.indexedXPath);if(this.specific===null){alert({content:'Unable to load Dictionary Specific.'});return false;}\nthis.parentSpecific=this.dictionaryHelper.getParentSpecific(this.specific);return true;},setSpecificsHandler:function(handler)\n{this.specificHandler=handler;},setIndexedXpath:function(xPath)\n{this.indexedXPath=xPath;},setParams:function(params)\n{this.params=params;},getRootIndexedXpath:function()\n{var splitedPath=this.indexedXPath.replace(/^\\//,'').split('/');return'/'+splitedPath[0];},getParentIndexedXpath:function()\n{if(this.specific.parent_specific_id===null){return null;}\nvar splitedPath=this.indexedXPath.replace(/^\\//,'').split('/');splitedPath.pop();return'/'+splitedPath.join('/');},getChildIndexedPart:function(childSpecific)\n{return this.indexedXPath+'/'+childSpecific.xml_tag+'-1'},isValueForceSet:function()\n{return this.getForceSetValue()!==false;},getForceSetValue:function()\n{return this.params.hasOwnProperty('force_value')?this.params['force_value']:false;},isRemoveActionAllowed:function()\n{if(!this.specificHandler.isSpecificRendered(this.indexedXPath)){return false;}\nreturn!this.isValueForceSet()&&this.specificHandler.getXpathesOfTheSameRenderedSpecific(this.indexedXPath).length>this.specific.min_occurs;},getRemoveButton:function()\n{var button=new Element('a',{'id':this.indexedXPath+'_remove_button','indexedxpath':this.indexedXPath,'href':'javascript:void(0);','class':'specific-remove-button','style':'vertical-align: middle;','title':M2ePro.translator.translate('Delete specific')});button.observe('click',this.removeAction.bind(this));if(!this.isRemoveActionAllowed()){this.hideButton(button);}\nreturn button;},removeAction:function(event)\n{if(!this.isRemoveActionAllowed()){return null;}\nthis.specificHandler.unMarkSpecificAsRendered(this.indexedXPath);this.specificHandler.unMarkSpecificAsSelected(this.indexedXPath);$(this.indexedXPath).remove();var theSameSpecifics=this.specificHandler.getXpathesOfTheSameRenderedSpecific(this.indexedXPath);if(theSameSpecifics.length<this.specific.max_occurs){var latestIndexedXpath=this.specificHandler.getLatestXpathFromTheSame(this.indexedXPath);var previousCloneButton=$(latestIndexedXpath+'_clone_button');previousCloneButton&&this.showButton(previousCloneButton);}\nreturn this.indexedXPath;},isCloneActionAllowed:function()\n{return this.specificHandler.isSpecificRendered(this.indexedXPath)&&this.specificHandler.getXpathesOfTheSameRenderedSpecific(this.indexedXPath).length<this.specific.max_occurs;},getCloneButton:function()\n{var button=new Element('a',{'id':this.indexedXPath+'_clone_button','indexedxpath':this.indexedXPath,'href':'javascript:void(0);','class':'specific-clone-button','style':'vertical-align: middle;','title':M2ePro.translator.translate('Duplicate specific')});button.observe('click',this.cloneAction.bind(this));if(!this.isCloneActionAllowed()){this.hideButton(button);}\nreturn button;},cloneAction:function(event)\n{if(!this.isCloneActionAllowed()){return null;}\nthis.hideButton(event.target);var newIndexedXpath=this.indexedXPath.replace(/\\d$/,'');newIndexedXpath+=parseInt(this.indexedXPath.match(/\\d$/)[0])+1;this.specificHandler.renderSpecific(newIndexedXpath);return newIndexedXpath;},hideButton:function(button)\n{button=(typeof button=='object')?button:$(this.indexedXPath+'_'+button+'_button');button.style.display='none';},showButton:function(button)\n{button=(typeof button=='object')?button:$(this.indexedXPath+'_'+button+'_button');button.style.display='inline-block';},touchMyNeighbors:function()\n{var theSameSpecifics=this.specificHandler.getXpathesOfTheSameRenderedSpecific(this.indexedXPath);if(theSameSpecifics.length<=0){return;}\nvar latestIndexedXpath=this.specificHandler.getLatestXpathFromTheSame(this.indexedXPath),myEvent=new CustomEvent('my-duplicate-is-rendered');theSameSpecifics.each(function(xpath){latestIndexedXpath!=xpath&&$(xpath).dispatchEvent(myEvent);});},onMyDuplicateRendered:function()\n{this.hideButton('clone');},onWhenUndeletebleSpecificAppears:function()\n{this.hideButton('remove');if(this.getParentIndexedXpath()!=null){var myEvent=new CustomEvent('undeleteble-specific-appear');$(this.getParentIndexedXpath()).dispatchEvent(myEvent);}},simulateAction:function(obj,action)\n{if(obj.hasAttribute('disabled')){obj.removeAttribute('disabled');obj.simulate(action);obj.setAttribute('disabled','disabled');}else{obj.simulate(action);}}};});","Ess_M2ePro/js/Amazon/Template/Description/Category/Specific/Grid/RowRenderer.min.js":"define(['M2ePro/Amazon/Template/Description/Category/Specific/Renderer'],function(){window.AmazonTemplateDescriptionCategorySpecificGridRowRenderer=Class.create(AmazonTemplateDescriptionCategorySpecificRenderer,{attributeHandler:null,process:function()\n{if(this.specificHandler.isSpecificRendered(this.indexedXPath)&&!this.isValueForceSet()){return'';}\nif(!this.load()){return'';}\nthis.renderParentSpecific();if(this.specificHandler.isSpecificRendered(this.indexedXPath)&&!this.isValueForceSet()){return'';}\nif(this.specificHandler.isSpecificRendered(this.indexedXPath)){this.forceSelectAndDisable(this.getForceSetValue());this.hideButton($(this.indexedXPath+'_remove_button'));var myEvent=new CustomEvent('undeleteble-specific-appear');$(this.getParentIndexedXpath()).dispatchEvent(myEvent);return'';}\nthis.renderSelf();if(this.isValueForceSet()){this.forceSelectAndDisable(this.getForceSetValue());}\nthis.observeToolTips(this.indexedXPath);this.checkSelection();this.renderSpecificAttributes();},load:function($super)\n{this.attributeHandler=AttributeObj;return $super();},renderParentSpecific:function()\n{if(this.specific.parent_specific_id==null){return'';}\nif(!this.dictionaryHelper.isSpecificTypeContainer(this.parentSpecific)){return'';}\nvar parentBlockRenderer=new AmazonTemplateDescriptionCategorySpecificBlockRenderer();parentBlockRenderer.setSpecificsHandler(this.specificHandler);parentBlockRenderer.setIndexedXpath(this.getParentIndexedXpath());parentBlockRenderer.process();},renderSelf:function()\n{this.renderLabel();this.renderChooseMode();this.renderValueInputs();this.specificHandler.markSpecificAsRendered(this.indexedXPath);this.renderButtons();$(this.indexedXPath).observe('my-duplicate-is-rendered',this.onMyDuplicateRendered.bind(this));this.throwEventsToParents();},renderSpecificAttributes:function()\n{var self=this;if(!this.specific.params.hasOwnProperty('attributes')){return'';}\nthis.specific.params.attributes.each(function(attribute,index){var renderer=new AmazonTemplateDescriptionCategorySpecificGridRowAttributeRenderer();renderer.setSpecificsHandler(self.specificHandler);renderer.setIndexedXpath(self.indexedXPath);renderer.attribute=attribute;renderer.attributeIndex=index;renderer.process();});},renderLabel:function()\n{var td=new Element('td');var title=this.specific.title;if(this.dictionaryHelper.isSpecificRequired(this.specific)||this.isValueForceSet()){title+=' <span class=\"required\">*</span>';}else if(this.dictionaryHelper.isSpecificDesired(this.specific)){title+=' <span style=\"color: grey; font-style: italic;\">('+M2ePro.translator.translate('Desired')+')</span>';}\ntd.appendChild((new Element('span').insert(title)));var note=this.getDefinitionNote(this.specific.data_definition);if(note){var toolTip=this.getToolTipBlock(this.indexedXPath+'_definition_note',note);toolTip.show();td.appendChild(toolTip);}\nvar notice=this.getSpecificOverriddenNotice();if(notice)td.appendChild(notice);notice=this.getSpecificParentageNotice();if(notice)td.appendChild(notice);this.getRowContainer().appendChild(td);},renderChooseMode:function()\n{var select=new Element('select',{'id':this.indexedXPath+'_mode','name':this.indexedXPath+'_mode','indexedxpath':this.indexedXPath,'class':'M2ePro-required-when-visible select admin__control-select','style':'width: 85%;'});select.appendChild(new Element('option',{'style':'display: none'}));if(this.specific.recommended_values.length>0){select.appendChild(new Element('option',{'value':this.MODE_RECOMMENDED_VALUE})).insert(M2ePro.translator.translate('Recommended Values'));}\nselect.appendChild(new Element('option',{'value':this.MODE_CUSTOM_VALUE})).insert(M2ePro.translator.translate('Custom Value'));select.appendChild(new Element('option',{'value':this.MODE_CUSTOM_ATTRIBUTE})).insert(M2ePro.translator.translate('Custom Attribute'));select.observe('change',this.onChangeChooseMode.bind(this));this.getRowContainer().appendChild(new Element('td')).appendChild(select);},onChangeChooseMode:function(event)\n{var customAttribute=$(this.indexedXPath+'_'+this.MODE_CUSTOM_ATTRIBUTE),customAttributeNote=$(this.indexedXPath+'_custom_attribute_note');var customValue=$(this.indexedXPath+'_'+this.MODE_CUSTOM_VALUE),customValueNote=$(this.indexedXPath+'_custom_value_note');var recommendedValue=$(this.indexedXPath+'_'+this.MODE_RECOMMENDED_VALUE);customAttribute&&customAttribute.hide();customAttributeNote&&customAttributeNote.hide();customValue&&customValue.hide();customValueNote&&customValueNote.hide();recommendedValue&&recommendedValue.hide();if(event.target.value==this.MODE_CUSTOM_VALUE){customValue&&customValue.show();customValueNote&&customValueNote.show();}\nif(event.target.value==this.MODE_CUSTOM_ATTRIBUTE){customAttribute&&customAttribute.show();customAttributeNote&&customAttributeNote.show();}\nif(event.target.value==this.MODE_RECOMMENDED_VALUE){recommendedValue&&recommendedValue.show();}},renderValueInputs:function()\n{var td=this.getRowContainer().appendChild(new Element('td'));if(this.dictionaryHelper.isSpecificTypeText(this.specific)){var note=this.getCustomValueTypeNote();if(note)td.appendChild(this.getToolTipBlock(this.indexedXPath+'_custom_value_note',note));td.appendChild(this.getTextTypeInput());}\nif(this.dictionaryHelper.isSpecificTypeSelect(this.specific)){td.appendChild(this.getSelectTypeInput());}\nnote=this.getCustomAttributeTypeNote();if(note){var tooltip=td.appendChild(this.getToolTipBlock(this.indexedXPath+'_custom_attribute_note',note));tooltip.hide();}\ntd.appendChild(this.getCustomAttributeSelect());td.appendChild(this.getRecommendedValuesSelect());},getTextTypeInput:function()\n{if(this.dictionaryHelper.isSpecificTypeTextArea(this.specific)){var input=new Element('textarea',{'id':this.indexedXPath+'_'+this.MODE_CUSTOM_VALUE,'name':this.indexedXPath+'_'+this.MODE_CUSTOM_VALUE,'indexedxpath':this.indexedXPath,'specific_id':this.specific.specific_id,'specific_type':this.specific.params.type,'mode':this.MODE_CUSTOM_VALUE,'class':'textarea admin__control-textarea M2ePro-required-when-visible M2ePro-specifics-validation','style':'width: 85%; display: none;'});}else{var input=new Element('input',{'id':this.indexedXPath+'_'+this.MODE_CUSTOM_VALUE,'name':this.indexedXPath+'_'+this.MODE_CUSTOM_VALUE,'indexedxpath':this.indexedXPath,'specific_id':this.specific.specific_id,'mode':this.MODE_CUSTOM_VALUE,'specific_type':this.specific.params.type,'type':'text','class':'input-text admin__control-text M2ePro-required-when-visible M2ePro-specifics-validation','style':'display: none; width: 85%;'});this.specific.params.type=='date_time'&&Calendar.setup({'inputField':input,'ifFormat':\"%Y-%m-%d %H:%M:%S\",'showsTime':true,'button':input,'align':'Bl','singleClick':true});this.specific.params.type=='date'&&Calendar.setup({'inputField':input,'ifFormat':\"%Y-%m-%d\",'showsTime':true,'button':input,'align':'Bl','singleClick':true});}\ninput.observe('change',this.onChangeValue.bind(this));return input;},getSelectTypeInput:function()\n{var self=this;var select=new Element('select',{'id':this.indexedXPath+'_'+this.MODE_CUSTOM_VALUE,'name':this.indexedXPath+'_'+this.MODE_CUSTOM_VALUE,'indexedxpath':this.indexedXPath,'specific_id':this.specific.specific_id,'mode':this.MODE_CUSTOM_VALUE,'class':'M2ePro-required-when-visible select admin__control-select','style':'display: none; width: 85%;'});select.appendChild(new Element('option',{'style':'display: none;'}));var specificOptions=this.specific.values;specificOptions.each(function(option){var label=option=='true'?'Yes':(option=='false'?'No':option),tempOption=new Element('option',{'value':option});select.appendChild(tempOption).insert(label);});select.observe('change',this.onChangeValue.bind(this));return select;},getCustomAttributeSelect:function()\n{var select=new Element('select',{'id':this.indexedXPath+'_'+this.MODE_CUSTOM_ATTRIBUTE,'name':this.indexedXPath+'_'+this.MODE_CUSTOM_ATTRIBUTE,'indexedxpath':this.indexedXPath,'specific_id':this.specific.specific_id,'mode':this.MODE_CUSTOM_ATTRIBUTE,'class':'attributes M2ePro-required-when-visible select admin__control-select','style':'display: none; width: 85%;','apply_to_all_attribute_sets':'0'});select.appendChild(new Element('option',{'style':'display: none','value':''}));this.attributeHandler.availableAttributes.each(function(el){select.appendChild(new Element('option',{'value':el.code})).insert(el.label);});select.value='';select.observe('change',this.onChangeValue.bind(this));var handlerObj=new AttributeCreator(select.id);handlerObj.setSelectObj(select);handlerObj.injectAddOption();return select;},getRecommendedValuesSelect:function()\n{var select=new Element('select',{'id':this.indexedXPath+'_'+this.MODE_RECOMMENDED_VALUE,'name':this.indexedXPath+'_'+this.MODE_RECOMMENDED_VALUE,'indexedxpath':this.indexedXPath,'specific_id':this.specific.specific_id,'mode':this.MODE_RECOMMENDED_VALUE,'class':'M2ePro-required-when-visible select admin__control-select','style':'display: none; width: 85%;'});select.appendChild(new Element('option',{'style':'display: none','value':''}));this.specific.recommended_values.each(function(value){select.appendChild(new Element('option',{'value':value})).insert(value);});select.value='';select.observe('change',this.onChangeValue.bind(this));return select;},onChangeValue:function(event)\n{var selectedObj={};selectedObj['mode']=event.target.getAttribute('mode');selectedObj['type']=event.target.getAttribute('specific_type');selectedObj['is_required']=(this.dictionaryHelper.isSpecificRequired(this.specific)||this.isValueForceSet())?1:0;selectedObj[selectedObj.mode]=event.target.value;this.specificHandler.markSpecificAsSelected(this.indexedXPath,selectedObj);},renderButtons:function()\n{var td=this.getRowContainer().appendChild(new Element('td'));var cloneButton=this.getCloneButton();if(cloneButton!==null)td.appendChild(cloneButton);var removeButton=this.getRemoveButton();if(removeButton!==null)td.appendChild(removeButton);},throwEventsToParents:function()\n{var myEvent,parentXpath;myEvent=new CustomEvent('child-specific-rendered');parentXpath=this.getParentIndexedXpath();$(parentXpath+'_grid').dispatchEvent(myEvent);$(parentXpath+'_add_row').dispatchEvent(myEvent);this.touchMyNeighbors();if(this.isValueForceSet()){this.hideButton($(this.indexedXPath+'_remove_button'));myEvent=new CustomEvent('undeleteble-specific-appear');$(this.getParentIndexedXpath()).dispatchEvent(myEvent);}},checkSelection:function()\n{if(this.specific.values.length==1){this.forceSelectAndDisable(this.specific.values[0]);return'';}\nif(!this.specificHandler.isMarkedAsSelected(this.indexedXPath)&&!this.specificHandler.isInFormData(this.indexedXPath)){return'';}\nvar selectionInfo=this.specificHandler.getSelectionInfo(this.indexedXPath);var id=this.indexedXPath+'_mode';$(id).value=selectionInfo.mode;this.simulateAction($(id),'change');if(selectionInfo.mode==this.MODE_CUSTOM_VALUE){id=this.indexedXPath+'_'+this.MODE_CUSTOM_VALUE;$(id).value=selectionInfo['custom_value'];this.simulateAction($(id),'change');}\nif(selectionInfo.mode==this.MODE_CUSTOM_ATTRIBUTE){id=this.indexedXPath+'_'+this.MODE_CUSTOM_ATTRIBUTE;$(id).value=selectionInfo['custom_attribute'];this.simulateAction($(id),'change');}\nif(selectionInfo.mode==this.MODE_RECOMMENDED_VALUE){id=this.indexedXPath+'_'+this.MODE_RECOMMENDED_VALUE;$(id).value=selectionInfo['recommended_value'];this.simulateAction($(id),'change');}},forceSelectAndDisable:function(value)\n{if(!value){return;}\nvar modeSelect=$(this.indexedXPath+'_mode');modeSelect.value=this.MODE_CUSTOM_VALUE;this.simulateAction(modeSelect,'change');modeSelect.setAttribute('disabled','disabled');var valueObj=$(this.indexedXPath+'_'+this.MODE_CUSTOM_VALUE);valueObj.value=value;this.simulateAction(valueObj,'change');valueObj.setAttribute('disabled','disabled');},getToolTipBlock:function(id,messageHtml)\n{var container=new Element('div',{'id':id,'class':'m2epro-field-tooltip admin__field-tooltip',});container.appendChild(new Element('a',{'class':'admin__field-tooltip-action','style':'margin-left: 0;'}));var htmlCont=container.appendChild(new Element('div',{'class':'admin__field-tooltip-content','style':'max-width: 500px;'}));htmlCont.insert(messageHtml);return container;},getCustomValueTypeNote:function()\n{if(this.specific.data_definition.definition){return null;}\nif(this.specific.params.type=='int')return this.getIntTypeNote(this.specific.params);if(this.specific.params.type=='float')return this.getFloatTypeNote(this.specific.params);if(this.specific.params.type=='string')return this.getStringTypeNote(this.specific.params);if(this.specific.params.type=='date_time')return this.getDatTimeTypeNote(this.specific.params);return this.getAnyTypeNote(this.specific.params);},getIntTypeNote:function(params)\n{var notes=[];var handler={'type':function(){notes[0]=M2ePro.translator.translate('Type: Numeric.')+' ';},'min_value':function(restriction){notes[1]=M2ePro.translator.translate('Min:')+' '+restriction+'. ';},'max_value':function(restriction){notes[2]=M2ePro.translator.translate('Max:')+' '+restriction+'. ';},'total_digits':function(restriction){notes[3]=M2ePro.translator.translate('Total digits (not more):')+' '+restriction+'. ';}};for(var paramName in params){params.hasOwnProperty(paramName)&&handler[paramName]&&handler[paramName](params[paramName]);}\nreturn notes.join('');},getFloatTypeNote:function(params)\n{var notes=[];var handler={'type':function(){notes[0]=M2ePro.translator.translate('Type: Numeric floating point.')+' ';},'min_value':function(restriction){notes[1]=M2ePro.translator.translate('Min:')+' '+restriction+'. ';},'max_value':function(restriction){notes[2]=M2ePro.translator.translate('Max:')+' '+restriction+'. ';},'decimal_places':function(restriction){notes[3]=M2ePro.translator.translate('Decimal places (not more):')+' '+restriction.value+'. ';},'total_digits':function(restriction){notes[4]=M2ePro.translator.translate('Total digits (not more):')+' '+restriction+'. ';}};for(var paramName in params){params.hasOwnProperty(paramName)&&handler[paramName]&&handler[paramName](params[paramName]);}\nreturn notes.join('');},getStringTypeNote:function(params)\n{var notes=[];var handler={'type':function(){notes[0]=M2ePro.translator.translate('Type: String.')+' ';},'min_length':function(restriction){notes[1]=restriction!=1?M2ePro.translator.translate('Min length:')+' '+restriction:'';},'max_length':function(restriction){notes[2]=M2ePro.translator.translate('Max length:')+' '+restriction;},'pattern':function(restriction){if(restriction=='[a-zA-Z][a-zA-Z]|unknown'){notes[3]=M2ePro.translator.translate('Two uppercase letters or \"unknown\".');}}};for(var paramName in params){params.hasOwnProperty(paramName)&&handler[paramName]&&handler[paramName](params[paramName]);}\nreturn notes.join('');},getDatTimeTypeNote:function(params)\n{var notes=[];var handler={'type':function(restriction){notes.push(M2ePro.translator.translate('Type: Date time. Format: YYYY-MM-DD hh:mm:ss'));}};for(var paramName in params){params.hasOwnProperty(paramName)&&handler[paramName]&&handler[paramName](params[paramName]);}\nreturn notes.join('');},getAnyTypeNote:function(params)\n{return M2ePro.translator.translate('Can take any value.');},getCustomAttributeTypeNote:function()\n{if(this.specific.values.length<=0&&this.specific.recommended_values.length<=0){return null;}\nvar span=new Element('span');var title=this.specific.values.length>0?M2ePro.translator.translate('Allowed Values'):M2ePro.translator.translate('Recommended Values');span.appendChild(new Element('span')).insert('<b>'+title+': </b>');var ul=span.appendChild(new Element('ul'));var noteValues=this.specific.values.length>0?this.specific.values:this.specific.recommended_values;noteValues.each(function(value){ul.appendChild(new Element('li')).insert(value);});return span.outerHTML;},getDefinitionNote:function(definitionPart)\n{if(!definitionPart.definition){return;}\nvar div=new Element('div');div.appendChild(new Element('div',{style:'padding: 2px 0; margin-top: 5px;'})).insert('<b>'+M2ePro.translator.translate('Definition:')+'</b>');div.appendChild(new Element('div')).insert(definitionPart.definition);if(definitionPart.tips&&definitionPart.tips.match(/[a-z0-9]/i)){div.appendChild(new Element('div',{style:'padding: 2px 0; margin-top: 5px;'})).insert('<b>'+M2ePro.translator.translate('Tips:')+'</b>');div.appendChild(new Element('div')).insert(definitionPart.tips);}\nif(definitionPart.example&&definitionPart.example.match(/[a-z0-9]/i)){div.appendChild(new Element('div',{style:'padding: 2px 0; margin-top: 5px;'})).insert('<b>'+M2ePro.translator.translate('Examples:')+'</b>');div.appendChild(new Element('div')).insert(definitionPart.example);}\nreturn div.outerHTML;},getSpecificOverriddenNotice:function()\n{if(!this.specificHandler.canSpecificBeOverwrittenByVariationTheme(this.specific)){return null;}\nvar variationThemesList=this.specificHandler.themeAttributes[this.specific.xml_tag];var message='<b>'+M2ePro.translator.translate('Value of this Specific can be automatically overwritten by M2E Pro.')+'</b>';message+='<br/><br/>'+variationThemesList.join(', ');return this.constructNotice(message);},getSpecificParentageNotice:function()\n{if(this.specific.xml_tag!='Parentage'){return null;}\nreturn this.constructNotice(M2ePro.translator.translate('Amazon Parentage Specific will be overridden notice.'));},constructNotice:function(message)\n{var container=new Element('div',{'class':'m2epro-field-tooltip admin__field-tooltip',});container.appendChild(new Element('a',{'class':'admin__field-tooltip-action tool-tip-image-warning','style':'margin-left: 0;'}));var htmlCont=container.appendChild(new Element('div',{'class':'admin__field-tooltip-content','style':'max-width: 500px;'}));htmlCont.insert(message);return container;},observeToolTips:function(indexedXpath)\n{},removeAction:function($super,event)\n{var myEvent=new CustomEvent('parent-specific-row-is-removed');$(this.indexedXPath).dispatchEvent(myEvent);var deleteResult=$super(event);this.throwEventsToParents();return deleteResult;},cloneAction:function($super,event)\n{var newIndexedXpath=$super(event);this.observeToolTips(newIndexedXpath);var myEvent=new CustomEvent('parent-specific-row-is-cloned',{'new_indexed_xpath':newIndexedXpath});$(this.indexedXPath).dispatchEvent(myEvent);return newIndexedXpath;},getRowContainer:function()\n{if($(this.indexedXPath)){return $(this.indexedXPath);}\nvar grid=$$('table[id=\"'+this.getParentIndexedXpath()+'_grid\"] table.border tbody').first();return grid.appendChild(new Element('tr',{id:this.indexedXPath}));}});});","Ess_M2ePro/js/Amazon/Template/Description/Category/Specific/Grid/RowAttributeRenderer.min.js":"define(['M2ePro/Amazon/Template/Description/Category/Specific/Grid/RowRenderer'],function(){window.AmazonTemplateDescriptionCategorySpecificGridRowAttributeRenderer=Class.create(AmazonTemplateDescriptionCategorySpecificGridRowRenderer,{attribute:null,attributeIndex:null,process:function()\n{if(!this.load()){return'';}\nthis.renderSelf();this.observeToolTips(this.indexedXPath);this.checkSelection();},load:function($super)\n{try{var values=this.attribute.hasOwnProperty('values')?this.attribute.values:'[]';JSON.parse(values);this.attribute.values=values.evalJSON();}catch(e){}\nreturn $super();},renderSelf:function()\n{this.renderLabel();this.renderChooseMode();this.renderValueInputs();this.renderButtons();$(this.indexedXPath).observe('parent-specific-row-is-cloned',this.onParentClonedAction.bind(this));$(this.indexedXPath).observe('parent-specific-row-is-removed',this.onParentRemovedAction.bind(this));},renderLabel:function()\n{var td=new Element('td');var title=this.specific.title+' ('+this.attribute.title+')';if(this.isAttributeRequired()){title+=' <span class=\"required\">*</span>';}\ntd.appendChild((new Element('span').insert(title)));var note=this.getDefinitionNote(this.attribute.data_definition);if(note){var toolTip=this.getToolTipBlock(this.indexedXPath+'_attribute_'+this.attribute.title+'_definition_note',note);toolTip.show();td.appendChild(toolTip);}\nthis.getRowContainer().appendChild(td);},renderChooseMode:function()\n{var select=new Element('select',{'id':this.indexedXPath+'_attribute_'+this.attribute.title+'_mode','indexedxpath':this.indexedXPath,'class':'select admin__control-select '+(this.isAttributeRequired()?'M2ePro-required-when-visible':''),'style':'width: 85%;'});select.appendChild(new Element('option',{'style':'display: none'}));select.appendChild(new Element('option',{'value':this.MODE_CUSTOM_VALUE})).insert(M2ePro.translator.translate('Custom Value'));select.appendChild(new Element('option',{'value':this.MODE_CUSTOM_ATTRIBUTE})).insert(M2ePro.translator.translate('Custom Attribute'));select.observe('change',this.onChangeChooseMode.bind(this));this.getRowContainer().appendChild(new Element('td')).appendChild(select);},onChangeChooseMode:function(event)\n{var customAttribute=$(this.indexedXPath+'_attribute_'+this.attribute.title+'_'+this.MODE_CUSTOM_ATTRIBUTE),customAttributeNote=$(this.indexedXPath+'_attribute_'+this.attribute.title+'_custom_attribute_note');var customValue=$(this.indexedXPath+'_attribute_'+this.attribute.title+'_'+this.MODE_CUSTOM_VALUE),customValueNote=$(this.indexedXPath+'_attribute_'+this.attribute.title+'_custom_value_note');customAttribute&&customAttribute.hide();customAttributeNote&&customAttributeNote.hide();customValue&&customValue.hide();customValueNote&&customValueNote.hide();if(event.target.value==this.MODE_CUSTOM_VALUE){customValue&&customValue.show();customValueNote&&customValueNote.show();}\nif(event.target.value==this.MODE_CUSTOM_ATTRIBUTE){customAttribute&&customAttribute.show();customAttributeNote&&customAttributeNote.show();}},renderValueInputs:function()\n{var td=this.getRowContainer().appendChild(new Element('td'));if(this.isAttributeTypeText()){var note=this.getCustomValueTypeNote();if(note)td.appendChild(this.getToolTipBlock(this.indexedXPath+'_attribute_'+this.attribute.title+'_custom_value_note',note));td.appendChild(this.getTextTypeInput());}\nif(this.isAttributeTypeSelect()){td.appendChild(this.getSelectTypeInput());}\nvar note=this.getCustomAttributeTypeNote();if(note){var tooltip=td.appendChild(this.getToolTipBlock(this.indexedXPath+'_attribute_'+this.attribute.title+'_custom_attribute_note',note));tooltip.hide();}\ntd.appendChild(this.getCustomAttributeSelect());},getTextTypeInput:function()\n{var input=new Element('input',{'id':this.indexedXPath+'_attribute_'+this.attribute.title+'_'+this.MODE_CUSTOM_VALUE,'name':this.indexedXPath+'_attribute_'+this.attribute.title+'_'+this.MODE_CUSTOM_VALUE,'indexedxpath':this.indexedXPath,'specific_id':this.specific.specific_id,'attribute_index':this.attributeIndex,'mode':this.MODE_CUSTOM_VALUE,'type':'text','class':'input-text admin__control-text M2ePro-specificAttributes-validation '+(this.isAttributeRequired()?' M2ePro-required-when-visible':''),'style':'display: none; width: 85%;'});input.observe('change',this.onChangeValue.bind(this));return input;},getSelectTypeInput:function()\n{var select=new Element('select',{'id':this.indexedXPath+'_attribute_'+this.attribute.title+'_'+this.MODE_CUSTOM_VALUE,'name':this.indexedXPath+'_attribute_'+this.attribute.title+'_'+this.MODE_CUSTOM_VALUE,'indexedxpath':this.indexedXPath,'specific_id':this.specific.specific_id,'attribute_index':this.attributeIndex,'mode':this.MODE_CUSTOM_VALUE,'class':'select admin__control-select '+(this.isAttributeRequired()?'M2ePro-required-when-visible':''),'style':'width: 85%; display: none;'});select.appendChild(new Element('option',{'style':'display: none'}));this.attribute.values.each(function(value){select.appendChild(new Element('option',{'value':value}).insert(value));});select.observe('change',this.onChangeValue.bind(this));return select;},getCustomAttributeSelect:function()\n{var select=new Element('select',{'id':this.indexedXPath+'_attribute_'+this.attribute.title+'_'+this.MODE_CUSTOM_ATTRIBUTE,'name':this.indexedXPath+'_attribute_'+this.attribute.title+'_'+this.MODE_CUSTOM_ATTRIBUTE,'indexedxpath':this.indexedXPath,'specific_id':this.specific.specific_id,'attribute_index':this.attributeIndex,'mode':this.MODE_CUSTOM_ATTRIBUTE,'class':'attributes M2ePro-required-when-visible select admin__control-select','style':'display: none; width: 85%;','apply_to_all_attribute_sets':'0'});select.appendChild(new Element('option',{'style':'display: none','value':''}));this.attributeHandler.availableAttributes.each(function(el){select.appendChild(new Element('option',{'value':el.code})).insert(el.label);});select.value='';select.observe('change',this.onChangeValue.bind(this));var handlerObj=new AttributeCreator(select.id);handlerObj.setSelectObj(select);handlerObj.injectAddOption();return select;},onChangeValue:function(event)\n{var selectedObj={};selectedObj.attributes=[];selectedObj.attributes[this.attributeIndex]={};selectedObj.attributes[this.attributeIndex][this.attribute.title]={};var mode=event.target.getAttribute('mode');selectedObj.attributes[this.attributeIndex][this.attribute.title]['mode']=mode;selectedObj.attributes[this.attributeIndex][this.attribute.title][mode]=event.target.value;this.specificHandler.markSpecificAsSelected(this.indexedXPath,selectedObj);},renderButtons:function()\n{this.getRowContainer().appendChild(new Element('td'));},checkSelection:function()\n{var self=this;var selectionInfo=this.specificHandler.getSelectionInfo(this.indexedXPath);if(!selectionInfo.hasOwnProperty('attributes')||selectionInfo['attributes'].length<=0){selectionInfo=this.specificHandler.isInFormData(this.indexedXPath);}\nif(!selectionInfo.hasOwnProperty('attributes')||selectionInfo['attributes'].length<=0){return'';}\nvar attributeSelectionInfo=null;selectionInfo['attributes'].each(function(el){if(el.hasOwnProperty(self.attribute.title)){attributeSelectionInfo=el[self.attribute.title];return false;}});if(attributeSelectionInfo==null){return'';}\nvar id=this.indexedXPath+'_attribute_'+this.attribute.title+'_mode';$(id).value=attributeSelectionInfo.mode;this.simulateAction($(id),'change');if(attributeSelectionInfo.mode==this.MODE_CUSTOM_VALUE){id=this.indexedXPath+'_attribute_'+this.attribute.title+'_'+this.MODE_CUSTOM_VALUE;$(id).value=attributeSelectionInfo['custom_value'];this.simulateAction($(id),'change');}\nif(attributeSelectionInfo.mode==this.MODE_CUSTOM_ATTRIBUTE){id=this.indexedXPath+'_attribute_'+this.attribute.title+'_'+this.MODE_CUSTOM_ATTRIBUTE;$(id).value=attributeSelectionInfo['custom_attribute'];this.simulateAction($(id),'change');}},getCustomValueTypeNote:function()\n{if(this.attribute.data_definition.definition){return null;}\nif(this.attribute.type=='int')return this.getIntTypeNote(this.attribute);if(this.attribute.type=='float')return this.getFloatTypeNote(this.attribute);if(this.attribute.type=='string')return this.getStringTypeNote(this.attribute);if(this.attribute.type=='date_time')return this.getDatTimeTypeNote(this.attribute);return this.getAnyTypeNote(this.attribute);},getCustomAttributeTypeNote:function()\n{if(this.attribute.values.length<=0){return null;}\nvar span=new Element('span');span.appendChild(new Element('span')).insert('<b>'+M2ePro.translator.translate('Allowed Values')+': </b>');var ul=span.appendChild(new Element('ul'));this.attribute.values.each(function(value){ul.appendChild(new Element('li')).insert(value);});return span.outerHTML;},isAttributeRequired:function()\n{return this.attribute.required;},isAttributeTypeText:function()\n{return!this.isAttributeTypeSelect();},isAttributeTypeSelect:function()\n{return this.attribute.values&&this.attribute.values.length>0;},observeToolTips:function(indexedXpath)\n{},onParentClonedAction:function(event)\n{this.observeToolTips(event.new_indexed_xpath);},onParentRemovedAction:function(event)\n{var attributesRows=$$('tr[class=\"'+this.indexedXPath+'_attributes\"]');attributesRows.invoke('remove');},getRowContainer:function()\n{var id=this.indexedXPath+'_attribute_'+this.attribute.title;if($(id)){return $(id);}\nvar grid=$$('table[id=\"'+this.getParentIndexedXpath()+'_grid\"] table.border tbody').first();return grid.appendChild(new Element('tr',{id:id,class:this.indexedXPath+'_attributes'}));}});});","Ess_M2ePro/js/Amazon/Template/Description/Category/Specific/Block/GridRenderer.min.js":"define(['M2ePro/Amazon/Template/Description/Category/Specific/Renderer'],function(){window.AmazonTemplateDescriptionCategorySpecificBlockGridRenderer=Class.create(AmazonTemplateDescriptionCategorySpecificRenderer,{childRowsSpecifics:[],process:function()\n{if(this.childRowsSpecifics.length<=0){return'';}\nif(!this.load()){return'';}\nthis.prepareDomStructure();this.renderRequiredRows();this.tuneStyles();},prepareDomStructure:function()\n{this.getContainer().appendChild(this.getTemplate());$(this.indexedXPath+'_grid').observe('child-specific-rendered',this.onChildSpecificRendered.bind(this));},renderRequiredRows:function()\n{var self=this;this.childRowsSpecifics.each(function(specific){if(!self.dictionaryHelper.isSpecificRequired(specific)){return true;}\nvar renderer=new AmazonTemplateDescriptionCategorySpecificGridRowRenderer();renderer.setSpecificsHandler(self.specificHandler);renderer.setIndexedXpath(self.getChildIndexedPart(specific));renderer.process();});},onChildSpecificRendered:function()\n{this.tuneStyles();if(this.indexedXPath!=this.getRootIndexedXpath()&&$(this.getParentIndexedXpath()+'_grid')){var myEvent=new CustomEvent('child-specific-rendered');$(this.getParentIndexedXpath()+'_grid').dispatchEvent(myEvent);}},tuneStyles:function()\n{if(this.childRowsSpecifics.length<=0){return'';}\nvar gridObj=$(this.indexedXPath+'_grid');this.isAnyOfChildSpecificsRendered()?gridObj.show():gridObj.hide();},isAnyOfChildSpecificsRendered:function()\n{var countOfRenderedSpecifics=0;var realRenderedXpathes=this.specificHandler.getRealXpathesOfRenderedSpecifics();this.childRowsSpecifics.each(function(sp){if(realRenderedXpathes.indexOf(sp.xpath)>=0)countOfRenderedSpecifics++;});return countOfRenderedSpecifics>0;},isAlreadyRendered:function()\n{return $(this.indexedXPath+'_grid')==null;},getTemplate:function()\n{var template=$('specifics_list_grid_template').down('table').cloneNode(true);template.setAttribute('id',this.indexedXPath+'_grid');return template;},getContainer:function()\n{return $(this.indexedXPath);}});});","Ess_M2ePro/js/Amazon/Template/Description/Category/Specific/Block/AddSpecificRenderer.min.js":"define(['jquery','Magento_Ui/js/modal/modal','M2ePro/Amazon/Template/Description/Category/Specific/Renderer'],function(jQuery,modal){window.AmazonTemplateDescriptionCategorySpecificBlockGridAddSpecificRenderer=Class.create(AmazonTemplateDescriptionCategorySpecificRenderer,{childAllSpecifics:[],childRowsSpecifics:[],selectedSpecifics:[],process:function()\n{if(!this.load()){return'';}\nthis.prepareDomStructure();this.tuneStyles();},prepareDomStructure:function()\n{this.getContainer().appendChild(this.getTemplate());$(this.indexedXPath+'_add_row').observe('child-specific-rendered',this.onChildSpecificRendered.bind(this));$(this.indexedXPath).observe('child-specific-rendered',this.onChildSpecificRendered.bind(this));var addSpecificBlockButtonObj=$(this.indexedXPath+'_add_button');addSpecificBlockButtonObj.observe('click',this.addSpecificAction.bind(this));},onChildSpecificRendered:function()\n{this.tuneStyles();if(this.indexedXPath==this.getRootIndexedXpath()){return;}\nvar myEvent=new CustomEvent('child-specific-rendered');$(this.getParentIndexedXpath()+'_add_row')&&$(this.getParentIndexedXpath()+'_add_row').dispatchEvent(myEvent);$(this.getParentIndexedXpath())&&$(this.getParentIndexedXpath()).dispatchEvent(myEvent);},tuneStyles:function()\n{var addSpecificsRowObj=$(this.indexedXPath+'_add_row'),addSpecificBlockButtonObj=$(this.indexedXPath+'_add_button');addSpecificsRowObj&&addSpecificsRowObj.show();if((this.getRootIndexedXpath()!=this.indexedXPath&&this.isAnyOfChildSpecificsRendered())||this.isAllOfSpecificsRendered())\n{addSpecificsRowObj&&addSpecificsRowObj.hide();}\naddSpecificBlockButtonObj&&addSpecificBlockButtonObj.show();if(this.getRootIndexedXpath()==this.indexedXPath||this.isAllOfSpecificsRendered()||!this.isAnyOfChildSpecificsRendered()){addSpecificBlockButtonObj&&addSpecificBlockButtonObj.hide();}},isAnyOfChildSpecificsRendered:function()\n{var countOfRenderedSpecifics=0;var realRenderedXpathes=this.specificHandler.getRealXpathesOfRenderedSpecifics();this.childAllSpecifics.each(function(sp){if(realRenderedXpathes.indexOf(sp.xpath)>=0)countOfRenderedSpecifics++;});return countOfRenderedSpecifics>0;},isAllOfSpecificsRendered:function()\n{var countOfRenderedSpecifics=0;var realRenderedXpathes=this.specificHandler.getRealXpathesOfRenderedSpecifics(),allChildSpecifics=this.specificHandler.dictionaryHelper.getAllChildSpecifics(this.specific);allChildSpecifics.each(function(sp){if(realRenderedXpathes.indexOf(sp.xpath)>=0)countOfRenderedSpecifics++;});return countOfRenderedSpecifics==allChildSpecifics.length;},isAlreadyRendered:function()\n{return $(this.indexedXPath+'_add_row')==null;},getTemplate:function()\n{var template=$('specifics_add_row_template').down('table').cloneNode(true);template.down('button.add_custom_specific_button').observe('click',this.addSpecificAction.bind(this));template.setAttribute('id',this.indexedXPath+'_add_row');return template;},getContainer:function()\n{return $(this.indexedXPath);},addSpecificAction:function(event)\n{var self=this;new Ajax.Request(M2ePro.url.get('amazon_template_description/getAddSpecificsHtml'),{method:'post',parameters:{marketplace_id:$('marketplace_id').value,product_data_nick:$('product_data_nick').value,current_indexed_xpath:self.indexedXPath,rendered_specifics:Object.toJSON(self.specificHandler.renderedSpecifics)},onSuccess:function(transport){self.selectedSpecifics=[];self.openPopUp(transport.responseText);}});},openPopUp:function(html)\n{var self=this,doneCallback=self.specificsDoneButton.bind(self);if(!M2ePro.popUp){var modalDialogMessage=new Element('div',{id:'modal_dialog_message_specifics'});modalDialogMessage.insert(html);modalDialogMessage.innerHTML.evalScripts();M2ePro.popUp=jQuery(modalDialogMessage).modal({title:modalDialogMessage.down('#specific_popup_title').value,type:'slide',buttons:[{text:M2ePro.translator.translate('Cancel'),click:function(){this.closeModal();}},{text:M2ePro.translator.translate('Confirm'),class:'action-primary',id:'save_popup_button',click:function(){doneCallback();this.closeModal();}}]});}else{modalDialogMessage=$('modal_dialog_message_specifics');modalDialogMessage.innerHTML='';modalDialogMessage.insert(html);modalDialogMessage.innerHTML.evalScripts();}\nM2ePro.popUp.modal('openModal');self.observePopupButtonsActions();self.observePopupGridRowsActions();self.tunePopupStyles();},observePopupButtonsActions:function()\n{$$('#modal_dialog_message_specifics button.specifics_filter_button').first().observe('click',this.specificsFilterButton.bind(this));$$('#modal_dialog_message_specifics button.specifics_reset_filter_button').first().observe('click',this.specificsResetFilterButton.bind(this));$$('#modal_dialog_message_specifics a.specifics_reset_selected_button').first().observe('click',this.specificsResetSelectedButton.bind(this));$$('#modal_dialog_message_specifics #query').first().observe('keypress',this.specificsKeyPressQuery.bind(this));},observePopupGridRowsActions:function()\n{var self=this;$$('#specifics_grid_container a.specific_search_result_row').each(function(el){el.stopObserving('click');el.observe('click',self.specificsSelectRow.bind(self));});},tunePopupStyles:function()\n{$$('#amazonTemplateDescriptionCategorySpecificAddGrid div.grid th').each(function(el){el.style.padding='1px 1px';});$$('#amazonTemplateDescriptionCategorySpecificAddGrid div.grid td').each(function(el){el.style['padding']='1px 1px';el.style['vertical-align']='middle';});},specificsDoneButton:function(event)\n{var self=this;self.selectedSpecifics.each(function(indexedXpath){self.specificHandler.renderSpecific(indexedXpath);});},specificsFilterButton:function(event)\n{this.reloadSearchingGrid(jQuery('#query',M2ePro.popUp).val(),+jQuery('#only_desired').prop('checked'));},specificsKeyPressQuery:function(event)\n{if(event.keyCode==13){this.specificsFilterButton(event);}},specificsResetFilterButton:function(event)\n{jQuery('#query',M2ePro.popUp).val('').focus();jQuery('#only_desired').prop('checked',false);this.reloadSearchingGrid('','');},specificsResetSelectedButton:function(event)\n{var selectedSpecificsBox=$('selected_specifics_box');selectedSpecificsBox.update('');$('selected_specifics_container').hide();$('specifics_grid_container').style.height='370px';this.selectedSpecifics=[];this.specificsFilterButton(event);},specificsSelectRow:function(event)\n{var selectedSpecificsBox=$('selected_specifics_box'),newIndexedXpath=this.getNewSpecificXpath(event.target.getAttribute('xpath'));selectedSpecificsBox.appendChild(new Element('span',{class:'selected-specific-box-item',xml_tag:event.target.getAttribute('xml_tag'),xpath:newIndexedXpath})).update('<div>'+event.target.getAttribute('xml_tag')+'</div>').appendChild(new Element('a',{href:'javascript:void(0);',class:'remove-link-button',align:'center',title:M2ePro.translator.translate('Remove this specific')})).observe('click',this.specificsUnSelectRow.bind(this));$('selected_specifics_container').show();$('specifics_grid_container').style.height=(370-$('selected_specifics_container').offsetHeight-6)+'px';this.selectedSpecifics.push(newIndexedXpath);this.specificsFilterButton(event);},specificsUnSelectRow:function(event)\n{var newPreparedXpath=event.target.up('span').getAttribute('xpath');event.target.up('span').remove();var index=this.selectedSpecifics.indexOf(newPreparedXpath);index>=0&&this.selectedSpecifics.splice(index,1);if(this.selectedSpecifics.length<=0){return this.specificsResetSelectedButton(event);}\nthis.specificsFilterButton(event);},reloadSearchingGrid:function(query,onlyDesired)\n{var self=this;new Ajax.Request(M2ePro.url.get('amazon_template_description/getAddSpecificsGridHtml'),{method:'post',parameters:{marketplace_id:$('marketplace_id').value,product_data_nick:$('product_data_nick').value,current_indexed_xpath:self.indexedXPath,rendered_specifics:Object.toJSON(self.specificHandler.renderedSpecifics),selected_specifics:Object.toJSON(self.selectedSpecifics),only_desired:onlyDesired,query:query},onSuccess:function(transport){$('specifics_grid_container').down('div.grid-wrapper').update(transport.responseText);self.tunePopupStyles();self.observePopupGridRowsActions();}});},getNewSpecificXpath:function(dictionaryXpath)\n{var currentRealXpath=this.indexedXPath.replace(/-\\d+/g,'');var newIndexedXpath='';var temp=dictionaryXpath.replace(currentRealXpath+'/','');temp.split('/').each(function(pathPart){newIndexedXpath+='/'+pathPart+'-1';});return this.indexedXPath+newIndexedXpath;}});});","Ess_M2ePro/js/Wizard/InstallationAmazon.min.js":"define(['M2ePro/Plugin/Messages'],function(MessagesObj){window.WizardInstallationAmazon=Class.create(Common,{continueStep:function()\n{if(WizardObj.steps.current.length){this[WizardObj.steps.current+'Step']();}},registrationStep:function()\n{WizardObj.registrationStep(M2ePro.url.get('wizard_installationAmazon/createLicense'));},marketplaceChange:function()\n{var marketplaceId=$('marketplace_id').value;if(!marketplaceId){return;}\nif(!$('manual_authorization_marketplace_developer_key_container_'+marketplaceId)){$$('.manual-authorization').each(function(el){el.hide();});return;}\n$('amazon_wizard_installation_account_manual_authorization').show();$('manual_authorization_marketplace_application_name_container').show();$('manual_authorization_marketplace_developer_key_container_'+marketplaceId).show();$('manual_authorization_marketplace_register_url_container_'+marketplaceId).show();$('manual_authorization_marketplace_merchant_id_container_'+marketplaceId).show();$('manual_authorization_marketplace_token_container_'+marketplaceId).show();},accountStep:function()\n{if(!$('marketplace_id').value){this.alert(M2ePro.translator.translate('Please select Marketplace first.'));return;}\nvar marketplaceId=$('marketplace_id').value;if($('manual_authorization_marketplace_developer_key_container_'+marketplaceId)){var merchantId=$('manual_authorization_marketplace_merchant_id_'+marketplaceId).value;var token=$('manual_authorization_marketplace_token_'+marketplaceId).value;if(!merchantId||!token){this.alert(M2ePro.translator.translate('Please fill Merchant ID and MWS Auth Token fields.'));return;}\nvar checkResult=false;var checkReason=null;new Ajax.Request(M2ePro.url.get('amazon_account/checkAuth'),{method:'post',asynchronous:false,parameters:{merchant_id:merchantId,token:token,marketplace_id:marketplaceId},onSuccess:function(transport){var response=transport.responseText.evalJSON();checkResult=response['result'];checkReason=response['reason'];}});if(!checkResult){if(checkReason){this.alert(M2ePro.translator.translate('M2E Pro was not able to get access to the Amazon Account. Reason: %error_message%').replace('%error_message%',checkReason));return;}\nthis.alert(M2ePro.translator.translate('M2E Pro was not able to get access to the Amazon Account. Please, make sure, that you choose correct Option on MWS Authorization Page and enter correct Merchant ID.'));return;}\nreturn setLocation(M2ePro.url.get('wizard_installationAmazon/afterGetTokenManual',{\"merchant_id\":merchantId,\"token\":token,\"marketplace_id\":marketplaceId}));}\nnew Ajax.Request(M2ePro.url.get('wizard_installationAmazon/beforeToken'),{method:'post',asynchronous:true,parameters:$('edit_form').serialize(),onSuccess:function(transport){var response=transport.responseText.evalJSON();if(response&&response['message']){MessagesObj.addErrorMessage(response['message']);return CommonObj.scrollPageToTop();}\nif(!response['url']){MessagesObj.addErrorMessage(M2ePro.translator.translate('An error during of account creation.'));return CommonObj.scrollPageToTop();}\nreturn setLocation(response['url']);}});},listingTutorialStep:function()\n{WizardObj.setStep(WizardObj.getNextStep(),setLocation.bind(window,location.href))}});});","Ess_M2ePro/js/Wizard/MigrationFromMagento1.min.js":"define(function(){window.MigrationFromMagento1=Class.create(Common,{continueStep:function()\n{if(WizardObj.steps.current.length){this[WizardObj.steps.current+'Step']();}},synchronizationStep:function()\n{jQuery('#continue').prop('disabled',true);var nextMarketplace=jQuery('.marketplace-id:not([synchronized]):first');if(!nextMarketplace.length){MarketplaceSynchProgressObj.end();return;}\nnextMarketplace.attr('synchronized',1);this.synchronizeMarketplace(nextMarketplace.attr('component'),nextMarketplace.val());},congratulationStep:function()\n{WizardObj.setStatus(M2ePro.php.constant('Ess_M2ePro_Helper_Module_Wizard::STATUS_COMPLETED'),function(){setLocation(M2ePro.url.get('complete'));});},synchronizeMarketplace:function(component,marketplaceId)\n{var title=component+' '+$('marketplace_'+marketplaceId).innerHTML;MarketplaceSynchProgressObj.runTask(title,M2ePro.url.get('wizard_migrationFromMagento1/runSynchNow')+'marketplace_id/'+marketplaceId,'','MigrationFromMagento1Obj.synchronizationStep()');}});});","Ess_M2ePro/js/Wizard/InstallationEbay.min.js":"define(['M2ePro/Plugin/Messages',],function(MessageObj){window.WizardInstallationEbay=Class.create(Common,{continueStep:function()\n{if(WizardObj.steps.current.length){this[WizardObj.steps.current+'Step']();}},registrationStep:function()\n{WizardObj.registrationStep(M2ePro.url.get('wizard_installationEbay/createLicense'));},accountStep:function()\n{if(!this.isValidForm()){return false;}\nnew Ajax.Request(M2ePro.url.get('wizard_installationEbay/beforeToken'),{method:'post',asynchronous:true,parameters:$('edit_form').serialize(),onSuccess:function(transport){var response=transport.responseText.evalJSON();if(response&&response['message']){MessageObj.addErrorMessage(response['message']);return CommonObj.scrollPageToTop();}\nif(!response['url']){MessageObj.addErrorMessage(M2ePro.translator.translate('An error during of account creation.'));return CommonObj.scrollPageToTop();}\nreturn setLocation(response['url']);}});},listingTutorialStep:function()\n{WizardObj.setStep(WizardObj.getNextStep(),function(){WizardObj.complete();});}});});","Ess_M2ePro/js/Wizard/MigrationFromMagento1/MarketplaceSynchProgress.min.js":"define(['M2ePro/SynchProgress'],function(){MigrationFromMagento1MarketplaceSynchProgress=Class.create(SynchProgress,{start:function(title,status){title=title||'';status=status||'';var self=this;self.progressBarObj.reset();if(title!=''){self.progressBarObj.setTitle(title);}\nif(status!=''){self.progressBarObj.setStatus(status);}\nself.progressBarObj.show();$$('.loading-mask').invoke('setStyle',{visibility:'hidden'});},end:function(){var self=this;self.progressBarObj.reset();self.progressBarObj.hide();$$('.loading-mask').invoke('setStyle',{visibility:'visible'});WizardObj.setStep(WizardObj.getNextStep(),function(){WizardObj.complete();});},startGetExecutingInfo:function(callBackWhenEnd){callBackWhenEnd=callBackWhenEnd||'';var self=this;new Ajax.Request(M2ePro.url.get('general/synchGetExecutingInfo'),{method:'get',asynchronous:true,onSuccess:function(transport){var data=transport.responseText.evalJSON(true);if(data.mode==self.stateExecuting){self.progressBarObj.setTitle(data.title);if(data.percents<=0){self.progressBarObj.setPercents(0,0);}else if(data.percents>=100){self.progressBarObj.setPercents(100,0);}else{self.progressBarObj.setPercents(data.percents,1);}\nself.progressBarObj.setStatus(data.status);setTimeout(function(){self.startGetExecutingInfo(callBackWhenEnd);},3000);}else{self.progressBarObj.setPercents(100,0);setTimeout(function(){if(callBackWhenEnd!=''){eval(callBackWhenEnd);}else{self.end();}},1500);}}});}});});","Ess_M2ePro/js/Wizard/Amazon/Custom.min.js":"define(function(){window.WizardAmazonCustom=Class.create();WizardAmazonCustom.prototype={initialize:function()\n{this.marketplaces=[];this.index=0;this.marketplacesLastIndex=0;this.percent=0;},marketplacesSynchronizationAction:function(obj)\n{obj.hide();var self=this;self.progressBarStartLoad(0);setTimeout(function(){self.synchronizeMarketplaces();},0);},setNextStep:function(nextStep)\n{var currentStep=WizardObj.steps.current;WizardObj.setStep(nextStep,function(){WizardObj.renderStep(currentStep);});return this;},setMarketplacesData:function(marketplaces)\n{this.marketplaces=marketplaces;this.marketplacesLastIndex=marketplaces.length-1;return this;},getMarketplacesData:function()\n{return this.marketplaces;},completeStep:function(step)\n{WizardObj.skipStep(step);$('wizard_complete').show();},synchronizeMarketplaces:function()\n{if(this.index>this.marketplacesLastIndex){$('custom-progressbar').hide();this.completeStep('marketplacesSynchronization');return;}\nvar self=this,marketplaces=this.getMarketplacesData(),marketplaceId=marketplaces[self.index]!=undefined?marketplaces[self.index].id:0,current=$$('.code-'+marketplaces[self.index].code)[0];if(marketplaceId<=0){this.completeStep('marketplacesSynchronization');}\n++this.index;var startPercent=self.percent;self.percent+=Math.round(100 / marketplaces.length);self.marketplaceSynchProcess(current);new Ajax.Request(M2ePro.url.get('marketplacesSynchronization'),{method:'get',parameters:{id:marketplaceId},asynchronous:true,onSuccess:(function(transport){if(transport.responseText=='success'){self.progressBarStartLoad(startPercent+1,self.percent,function(){self.marketplaceSynchComplete(current);self.synchronizeMarketplaces();});}\nreturn false;}).bind(this)})},progressBarStartLoad:function(from,to,callback)\n{var self=this,progressBar=$('custom-progressbar'),progressBarLoad=$('custom-progressbar-load'),progressBarPercent=$('custom-progressbar-percentage'),step=2,total=from;if(from==0||to==0){progressBarLoad.style.width='0px';progressBarPercent.innerHTML='0%';progressBar.show();return;}\nprogressBarLoad.style.width=0+'px';progressBarPercent.innerHTML=0+'%';progressBar.show();var interval=setInterval(function(){progressBarLoad.style.width=total*3+'px';progressBarPercent.innerHTML=total+'%';total+=step;if(total>=to){clearInterval(interval);callback&&callback();}},100);},marketplaceSynchComplete:function(element)\n{var span=new Element('span',{class:'synchComplete'});span.innerHTML=' (Completed)';$$('.status-process').each(function(el){el.hide();});element.appendChild(span);element.removeClassName('synchProcess');element.addClassName('synchComplete');},marketplaceSynchProcess:function(element)\n{var span=new Element('span',{class:'synchProcess status-process'});span.innerHTML=' (In Progress)';element.appendChild(span);element.addClassName('synchProcess');}};});","Ess_M2ePro/js/Wizard/Amazon/Marketplace.min.js":"define(['M2ePro/Plugin/Messages','M2ePro/Marketplace'],function(MessageObj){window.WizardAmazonMarketplace=Class.create(Marketplace,{proceedAction:function()\n{MessageObj.clear();if(!this.checkAllOptions()){return;}\nvar changedStatuses=this.saveWizardSettings(this.runAllSynchronization.bind(this));for(var i=0;i<changedStatuses.length;i++){$('changed_'+changedStatuses[i].marketplace_id).style.display='none';this.changeStatus($('status_'+changedStatuses[i].marketplace_id));}\nvar waitingForEnd=setInterval(function(){if(this.completeStatus===true){this.disableAllOptions();WizardObj.setStep(WizardObj.getNextStep());WizardObj.complete();clearInterval(waitingForEnd);}}.bind(this),300);},saveWizardSettings:function(callback)\n{var currentStatuses=this.getCurrentStatuses();var storedStatuses=this.getStoredStatuses();var changedStatuses=new Array();this.marketplacesForUpdate=new Array();for(var i=0;i<storedStatuses.length;i++){if((storedStatuses[i].marketplace_id==currentStatuses[i].marketplace_id)&&(storedStatuses[i].status!=currentStatuses[i].status)){this.storedStatuses[i].status=currentStatuses[i].status;changedStatuses.push({marketplace_id:currentStatuses[i].marketplace_id,status:currentStatuses[i].status});this.changeStatusInfo(currentStatuses[i].marketplace_id,currentStatuses[i].status);if(currentStatuses[i].status){this.marketplacesForUpdate[this.marketplacesForUpdate.length]=currentStatuses[i].marketplace_id;}}}\nthis.marketplacesForUpdateCurrentIndex=0;this.synchErrors=0;this.synchWarnings=0;this.synchSuccess=0;new Ajax.Request(M2ePro.url.get('formSubmit',$('edit_form').serialize(true)),{method:'get',asynchronous:true,onSuccess:function(transport){if(callback){callback();}}});return changedStatuses;},runNextMarketplaceNow:function()\n{var self=this;if(self.marketplacesForUpdateCurrentIndex>0){$('synch_info_wait_'+self.marketplacesForUpdate[self.marketplacesForUpdateCurrentIndex-1]).hide();$('synch_info_process_'+self.marketplacesForUpdate[self.marketplacesForUpdateCurrentIndex-1]).hide();$('synch_info_complete_'+self.marketplacesForUpdate[self.marketplacesForUpdateCurrentIndex-1]).show();var tempEndFlag=0;if(self.marketplacesForUpdateCurrentIndex>=self.marketplacesForUpdate.length){tempEndFlag=1;}\nnew Ajax.Request(M2ePro.url.get('general/synchGetLastResult'),{method:'get',asynchronous:true,onSuccess:function(transport){if(transport.responseText==self.synchProgressObj.resultTypeError){self.synchErrors++;}else if(transport.responseText==self.synchProgressObj.resultTypeWarning){self.synchWarnings++;}else{self.synchSuccess++;}\nif(tempEndFlag==1){if(self.synchErrors>0){self.synchProgressObj.printFinalMessage(self.synchProgressObj.resultTypeError);}else if(self.synchWarnings>0){self.synchProgressObj.printFinalMessage(self.synchProgressObj.resultTypeWarning);}else{self.synchProgressObj.printFinalMessage(self.synchProgressObj.resultTypeSuccess);}\nself.synchErrors=0;self.synchWarnings=0;self.synchSuccess=0;}}});}\nif(self.marketplacesForUpdateCurrentIndex>=self.marketplacesForUpdate.length){self.marketplacesForUpdate=new Array();self.marketplacesForUpdateCurrentIndex=0;self.marketplacesUpdateFinished=true;self.synchProgressObj.end();self.completeStatus=true;return;}\nvar marketplaceId=self.marketplacesForUpdate[self.marketplacesForUpdateCurrentIndex];self.marketplacesForUpdateCurrentIndex++;$('synch_info_wait_'+marketplaceId).hide();$('synch_info_process_'+marketplaceId).show();$('synch_info_complete_'+marketplaceId).hide();var titleProgressBar=$('marketplace_title_'+marketplaceId).innerHTML;var marketplaceComponentName=$('status_'+marketplaceId).readAttribute('markeptlace_component_name');if(marketplaceComponentName!=''){titleProgressBar=marketplaceComponentName+' '+titleProgressBar;}\nself.synchProgressObj.runTask(titleProgressBar,M2ePro.url.get('runSynchNow',{'marketplace_id':marketplaceId}),'','WizardAmazonMarketplaceObj.runNextMarketplaceNow();');return true;},checkAllOptions:function()\n{var isAnyOptionsEnabled=$$('select[id*=\"status_\"]').some(function(element){return element.value==1;});if(!isAnyOptionsEnabled){MessageObj.addErrorMessage(M2ePro.translator.translate('You must select at least one Marketplace you will work with.'));CommonObj.scrollPageToTop();return false;}\nreturn true;},disableAllOptions:function()\n{var allSelect=$$('select[id*=\"status_\"]');if(allSelect.length){allSelect.each(function(element){element.disabled=true;});}}});});","Ess_M2ePro/js/Order/Debug.min.js":"define(function(){var debugKeys=[68,69,66,85,71];var debugPressedKeys=[];document.observe('keydown',function(event){if(debugPressedKeys.length<debugKeys.length){if(debugKeys[debugPressedKeys.length]==event.keyCode){debugPressedKeys.push(event.keyCode);if(debugPressedKeys.length==debugKeys.length){if(!$('magento_block_debug_information')){new Ajax.Request(M2ePro.url.get('order/getDebugInformation'),{method:'get',asynchronous:true,onSuccess:function(transport)\n{$$('.content-header')[0].insert({after:transport.responseText});}});}\ndebugPressedKeys=[];}}else{debugPressedKeys=[];}}});});","Ess_M2ePro/js/Order/Edit/Item.min.js":"define(['M2ePro/Plugin/Messages','M2ePro/Common','Magento_Ui/js/modal/modal'],function(MessageObj){OrderEditItem=Class.create(Common,{initialize:function()\n{this.popUp=null;this.gridId=null;this.orderItemId=null;},openPopUpMappingProduct:function(title,content)\n{var self=this;var mappingProductModal=$('mapping_product_modal');if(!mappingProductModal){mappingProductModal=new Element('div',{id:'mapping_product_modal'});}\nmappingProductModal.innerHTML='';this.mappingProductPopUp=jQuery(mappingProductModal).modal({closed:function(){self.reloadGrid();self.orderItemId=null;self.gridId=null;self.mappingProductPopUp=null;},title:title,type:'slide',buttons:[]});this.mappingProductPopUp.modal('openModal');mappingProductModal.insert(content);},openPopUpMappingOptions:function(title,content)\n{var self=this;var mappingOptions=$('mapping_product_options');if(!mappingOptions){mappingOptions=new Element('div',{id:'mapping_product_options'});}\nmappingOptions.innerHTML='';this.mappingOptionsPopUp=jQuery(mappingOptions).modal({closed:function(){if(self.mappingProductPopUp){self.mappingProductPopUp.modal('closeModal');return;}\nself.reloadGrid();self.orderItemId=null;self.gridId=null;self.mappingOptionsPopUp=null;},title:title,type:'slide',buttons:[{text:M2ePro.translator.translate('Cancel'),click:function(){self.closePopUp();}},{text:M2ePro.translator.translate('Confirm'),class:'primary',click:function(){self.assignProductDetails();}}]});this.mappingOptionsPopUp.modal('openModal');mappingOptions.insert(content);self.initMappingOptionsPopUp();},initMappingOptionsPopUp:function()\n{$$('.form-element').each(function(element){element.observe('change',function(){if(element.selectedIndex!=0){CommonObj.hideEmptyOption(element);}\nvar hasEmptyOptions=$$('.form-element').any(function(element){return element.value==''});if(hasEmptyOptions){return;}\nnew Ajax.Request(M2ePro.url.get('order/checkProductOptionStockAvailability'),{method:'get',parameters:Form.serialize('mapping_product_options'),onSuccess:function(transport){var isInStock=transport.responseText.evalJSON()['is_in_stock'];if(!isInStock){$('selected_product_option_is_out_of_stock').show();}else{$('selected_product_option_is_out_of_stock').hide();}}});});element.simulate('change');});},closePopUp:function()\n{if(this.mappingProductPopUp){this.mappingProductPopUp.modal('closeModal');}\nif(this.mappingOptionsPopUp){this.mappingOptionsPopUp.modal('closeModal');}},reloadGrid:function()\n{var grid=window[this.gridId+'JsObject'];if(grid){grid.doFilter();}},edit:function(gridId,orderItemId)\n{var self=this;self.gridId=gridId;self.orderItemId=orderItemId;self.getItemEditHtml(orderItemId,function(transport){var response=transport.responseText.evalJSON();if(response.error){if(self.popUp){self.alert(response.error,function(){self.closePopUp();});}else{MessageObj.addErrorMessage(response.error);}\nreturn;}\nvar title=response.title;var content=response.html;if(response.type==M2ePro.php.constant('Ess_M2ePro_Controller_Adminhtml_Order_EditItem::MAPPING_PRODUCT')){self.openPopUpMappingProduct(title,content);}else if(response.type==M2ePro.php.constant('Ess_M2ePro_Controller_Adminhtml_Order_EditItem::MAPPING_OPTIONS')){self.openPopUpMappingOptions(title,content);}});},getItemEditHtml:function(itemId,callback)\n{new Ajax.Request(M2ePro.url.get('order/editItem'),{method:'get',parameters:{item_id:itemId},onSuccess:function(transport){if(typeof callback=='function'){callback(transport);}}});},afterActionCallback:function(transport)\n{var self=this;var response=transport.responseText.evalJSON();if(response.error){MessageObj.addErrorMessage(response.error);return;}\nif(response.continue){self.edit(self.gridId,self.orderItemId);return;}\nif(response.success){self.closePopUp();self.scrollPageToTop();MessageObj.addSuccessMessage(response.success);}},assignProduct:function(id,productSku)\n{var self=this;var productId=+id||'';var sku=productSku||'';var orderItemId=self.orderItemId;MessageObj.clear();if(orderItemId==''||(/^\\s*(\\d)*\\s*$/i).test(orderItemId)==false){return;}\nif(sku==''&&productId==''){self.alert(M2ePro.translator.translate('Please enter correct Product ID or SKU.'));return;}\nif(((/^\\s*(\\d)*\\s*$/i).test(productId)==false)){self.alert(M2ePro.translator.translate('Please enter correct Product ID.'));return;}\nself.confirm({actions:{confirm:function(){new Ajax.Request(M2ePro.url.get('order/assignProduct'),{method:'post',parameters:{product_id:productId,sku:sku,order_item_id:orderItemId},onSuccess:self.afterActionCallback.bind(self)});},cancel:function(){return false;}}});},assignProductDetails:function()\n{var self=this,confirmAction,validationResult=$$('.form-element').collect(Validation.validate);if(validationResult.indexOf(false)!=-1){return;}\nconfirmAction=function(){new Ajax.Request(M2ePro.url.get('order/assignProductDetails'),{method:'post',parameters:Form.serialize('mapping_product_options'),onSuccess:self.afterActionCallback.bind(self)});};if($('save_repair')&&$('save_repair').checked){self.confirm({actions:{confirm:function(){confirmAction();},cancel:function(){return false;}}});}else{confirmAction();}},unassignProduct:function(gridId,orderItemId)\n{var self=this;self.confirm({actions:{confirm:function(){self.gridId=gridId;self.orderItemId=orderItemId;new Ajax.Request(M2ePro.url.get('order/unassignProduct'),{method:'post',parameters:{order_item_id:orderItemId},onSuccess:function(transport){self.afterActionCallback(transport);self.reloadGrid();self.gridId=null;self.orderItemId=null;}});},cancel:function(){return false;}}});},openEditShippingAddressPopup:function(orderId)\n{var self=this;var shippingAddressModal=$('shipping_address_modal');if(!shippingAddressModal){shippingAddressModal=new Element('div',{id:'shipping_address_modal'});}\nshippingAddressModal.innerHTML='';this.editShippingAddressPopUp=jQuery(shippingAddressModal).modal({closed:function(){},title:M2ePro.translator.translate('Edit Shipping Address'),type:'slide',buttons:[{text:M2ePro.translator.translate('Cancel'),click:function(){self.editShippingAddressPopUp.modal('closeModal');}},{text:M2ePro.translator.translate('Save'),class:'primary',click:function(){self.saveShippingAddress();}}]});new Ajax.Request(M2ePro.url.get('getEditShippingAddressForm'),{method:'post',parameters:{id:orderId},onSuccess:function(transport){shippingAddressModal.insert(transport.responseText);self.initFormValidation('#edit_form');self.editShippingAddressPopUp.modal('openModal');}});},saveShippingAddress:function()\n{var self=this;if(!self.isValidForm()){return;}\nnew Ajax.Request(M2ePro.url.get('saveShippingAddress'),{method:'post',parameters:Form.serialize($('edit_form')),onSuccess:function(transport){var result=transport.responseText.evalJSON();if(result.success){$('shipping_address_container').update(result.html);self.editShippingAddressPopUp.modal('closeModal');}}});}});});","Ess_M2ePro/js/Order/Edit/ShippingAddress.min.js":"define(['M2ePro/Common'],function(){OrderEditShippingAddress=Class.create(Common,{initialize:function(countryElementId,regionContainerElementId,regionElementName)\n{this.countryElementId=countryElementId;this.regionContainerElementId=regionContainerElementId;this.regionElementName=regionElementName;},initObservers:function()\n{$('country_code').observe('change',OrderEditShippingAddressObj.countryCodeChange).simulate('change');},countryCodeChange:function()\n{var self=OrderEditShippingAddressObj;new Ajax.Request(M2ePro.url.get('order/getCountryRegions'),{method:'get',asynchronous:true,parameters:{country:$(self.countryElementId).value},onSuccess:function(transport){self.renderRegions(transport.responseText.evalJSON(true));}});},renderRegions:function(data)\n{var self=OrderEditShippingAddressObj,regionContainer=$(self.regionContainerElementId).select('.control')[0],html='';if(data.length==0){html='<input type=\"text\" name=\"%name%\" class=\"input-text admin__control-text\" value=\"%value%\" />'.replace(/%name%/,self.regionElementName).replace(/%value%/,M2ePro.formData.region);}else{html+='<select class=\"admin__control-select\" name=\"'+self.regionElementName+'\">';data.each(function(item){var selected=(item.value==M2ePro.formData.region)?'selected=\"selected\"':'';html+='<option value=\"'+item.value+'\" '+selected+'>'+item.label+'</option>';});html+='</select>';}\nregionContainer.innerHTML=html;}});});","Dsync_Dsync/js/grid/columns/status.min.js":"define(['Magento_Ui/js/grid/columns/column'],function(Column){'use strict';return Column.extend({defaults:{bodyTmpl:'ui/grid/cells/html'},getLabel:function(row){return row[this.index+'_html'];}});});","Dsync_Dsync/js/system/config/keys.min.js":"define(['jquery'],function($){'use strict';return{disableKeys:function(){$('.dsnyc-primary-key').prop('disabled',true);},enableKeys:function(){$('.dsnyc-primary-key').prop('disabled',false);}};});","js/theme.min.js":"define('globalNavigationScroll',['jquery'],function($){'use strict';var win=$(window),subMenuClass='.submenu',fixedClassName='_fixed',menu=$('.menu-wrapper'),content=$('.page-wrapper'),menuItems=$('#nav').children('li'),winHeight,menuHeight=menu.height(),menuScrollMax=0,submenuHeight=0,contentHeight,winTop=0,winTopLast=0,scrollStep=0,nextTop=0;function isMenuFixed(){return menuHeight<contentHeight&&contentHeight>winHeight;}\nfunction checkAddClass(el,$class){if(!el.hasClass($class)){el.addClass($class);}}\nfunction checkRemoveClass(el,$class){if(el.hasClass($class)){el.removeClass($class);}}\nfunction positionMenu(){winHeight=win.height();contentHeight=content.height();winTop=win.scrollTop();scrollStep=winTop-winTopLast;if(isMenuFixed()){checkAddClass(menu,fixedClassName);if(menuHeight>winHeight){if(winTop>winTopLast){menuScrollMax=menuHeight-winHeight;nextTop<menuScrollMax-scrollStep?nextTop+=scrollStep:nextTop=menuScrollMax;menu.css('top',-nextTop);}else if(winTop<=winTopLast){nextTop>-scrollStep?nextTop+=scrollStep:nextTop=0;menu.css('top',-nextTop);}}}else{checkRemoveClass(menu,fixedClassName);}\nwinTopLast=winTop;}\npositionMenu();win.on('scroll',function(){positionMenu();});win.on('resize',function(){winHeight=win.height();if(menuHeight<contentHeight&&menuHeight<=winHeight){menu.removeAttr('style');menuItems.off();}});menuItems.on('click',function(){var submenu=$(this).children(subMenuClass),delta,logo=$('.logo')[0].offsetHeight;submenuHeight=submenu.height();if(submenuHeight>menuHeight&&menuHeight+logo>winHeight){menu.height(submenuHeight-logo);delta=-menu.position().top;window.scrollTo(0,0);positionMenu();window.scrollTo(0,delta);positionMenu();menuHeight=submenuHeight;}});});define('globalNavigation',['jquery','jquery/ui','globalNavigationScroll'],function($){'use strict';$.widget('mage.globalNavigation',{options:{selectors:{menu:'#nav',currentItem:'._current',topLevelItem:'.level-0',topLevelHref:'> a',subMenu:'> .submenu',closeSubmenuBtn:'[data-role=\"close-submenu\"]'},overlayTmpl:'<div class=\"admin__menu-overlay\"></div>'},_create:function(){var selectors=this.options.selectors;this.menu=this.element;this.menuLinks=$(selectors.topLevelHref,selectors.topLevelItem);this.closeActions=$(selectors.closeSubmenuBtn);this._initOverlay()._bind();},_initOverlay:function(){this.overlay=$(this.options.overlayTmpl).appendTo('body').hide(0);return this;},_bind:function(){var focus=this._focus.bind(this),open=this._open.bind(this),blur=this._blur.bind(this),keyboard=this._keyboard.bind(this);this.menuLinks.on('focus',focus).on('click',open);this.menuLinks.last().on('blur',blur);this.closeActions.on('keydown',keyboard);},_blur:function(e){var selectors=this.options.selectors,menuItem=$(e.target).closest(selectors.topLevelItem),currentItem=$(selectors.menu).find(selectors.currentItem);menuItem.removeClass('_active');currentItem.addClass('_active');},_keyboard:function(e){var selectors=this.options.selectors,menuItem=$(e.target).closest(selectors.topLevelItem);if(e.which===13){this._close(e);$(selectors.topLevelHref,menuItem).focus();}},_focus:function(e){var selectors=this.options.selectors,menuItem=$(e.target).closest(selectors.topLevelItem);menuItem.addClass('_active').siblings(selectors.topLevelItem).removeClass('_active');},_closeSubmenu:function(e){var selectors=this.options.selectors,currentItem=$(selectors.menu).find(selectors.currentItem);this._close(e);currentItem.addClass('_active');},_open:function(e){var selectors=this.options.selectors,menuItemSelector=selectors.topLevelItem,menuItem=$(e.target).closest(menuItemSelector),subMenu=$(selectors.subMenu,menuItem),close=this._closeSubmenu.bind(this),closeBtn=subMenu.find(selectors.closeSubmenuBtn);if(subMenu.length){e.preventDefault();}\nmenuItem.addClass('_show').siblings(menuItemSelector).removeClass('_show');subMenu.attr('aria-expanded','true');closeBtn.on('click',close);this.overlay.show(0).on('click',close);this.menuLinks.last().off('blur');},_close:function(e){var selectors=this.options.selectors,menuItem=this.menu.find(selectors.topLevelItem+'._show'),subMenu=$(selectors.subMenu,menuItem),closeBtn=subMenu.find(selectors.closeSubmenuBtn),blur=this._blur.bind(this);e.preventDefault();this.overlay.hide(0).off('click');this.menuLinks.last().on('blur',blur);closeBtn.off('click');subMenu.attr('aria-expanded','false');menuItem.removeClass('_show _active');}});return $.mage.globalNavigation;});define('globalSearch',['jquery','jquery/ui'],function($){'use strict';$.widget('mage.globalSearch',{options:{field:'.search-global-field',fieldActiveClass:'_active',input:'#search-global'},_create:function(){this.field=$(this.options.field);this.input=$(this.options.input);this._events();},_events:function(){var self=this;this.input.on('blur.resetGlobalSearchForm',function(){if(!self.input.val()){self.field.removeClass(self.options.fieldActiveClass);}});this.input.on('focus.activateGlobalSearchForm',function(){self.field.addClass(self.options.fieldActiveClass);});}});return $.mage.globalSearch;});define('modalPopup',['jquery','jquery/ui'],function($){'use strict';$.widget('mage.modalPopup',{options:{popup:'.popup',btnDismiss:'[data-dismiss=\"popup\"]',btnHide:'[data-hide=\"popup\"]'},_create:function(){this.fade=this.element;this.popup=$(this.options.popup,this.fade);this.btnDismiss=$(this.options.btnDismiss,this.popup);this.btnHide=$(this.options.btnHide,this.popup);this._events();},_events:function(){var self=this;this.btnDismiss.on('click.dismissModalPopup',function(){self.fade.remove();});this.btnHide.on('click.hideModalPopup',function(){self.fade.hide();});}});return $.mage.modalPopup;});define('useDefault',['jquery','jquery/ui'],function($){'use strict';$.widget('mage.useDefault',{options:{field:'.field',useDefault:'.use-default',checkbox:'.use-default-control',label:'.use-default-label'},_create:function(){this.el=this.element;this.field=$(this.el).closest(this.options.field);this.useDefault=$(this.options.useDefault,this.field);this.checkbox=$(this.options.checkbox,this.useDefault);this.label=$(this.options.label,this.useDefault);this.origValue=this.el.attr('data-store-label');this._events();},_events:function(){var self=this;this.el.on('change.toggleUseDefaultVisibility keyup.toggleUseDefaultVisibility',$.proxy(this._toggleUseDefaultVisibility,this)).trigger('change.toggleUseDefaultVisibility');this.checkboxon('change.setOrigValue',function(){if($(this).prop('checked')){self.el.val(self.origValue).trigger('change.toggleUseDefaultVisibility');$(this).prop('checked',false);}});},_toggleUseDefaultVisibility:function(){var curValue=this.el.val(),origValue=this.origValue;this[curValue!=origValue?'_show':'_hide']();},_show:function(){this.useDefault.show();},_hide:function(){this.useDefault.hide();}});return $.mage.useDefault;});define('loadingPopup',['jquery','jquery/ui'],function($){'use strict';$.widget('mage.loadingPopup',{options:{message:'Please wait...',timeout:5000,timeoutId:null,callback:null,template:null},_create:function(){this.template='<div class=\"popup popup-loading\">'+'<div class=\"popup-inner\">'+this.options.message+'</div>'+'</div>';this.popup=$(this.template);this._show();this._events();},_events:function(){var self=this;this.element.on('showLoadingPopup',function(){self._show();}).on('hideLoadingPopup',function(){self._hide();});},_show:function(){var options=this.options,timeout=options.timeout;$('body').trigger('processStart');if(timeout){options.timeoutId=setTimeout(this._delayedHide.bind(this),timeout);}},_hide:function(){$('body').trigger('processStop');},_delayedHide:function(){this._hide();this.options.callback&&this.options.callback();this.options.timeoutId&&clearTimeout(this.options.timeoutId);}});return $.mage.loadingPopup;});define('collapsable',['jquery','jquery/ui','jquery/jquery.tabs'],function($){'use strict';$.widget('mage.collapsable',{options:{parent:null,openedClass:'opened',wrapper:'.fieldset-wrapper'},_create:function(){this._events();},_events:function(){var self=this;this.element.on('show',function(e){var fieldsetWrapper=$(this).closest(self.options.wrapper);fieldsetWrapper.addClass(self.options.openedClass);e.stopPropagation();}).on('hide',function(e){var fieldsetWrapper=$(this).closest(self.options.wrapper);fieldsetWrapper.removeClass(self.options.openedClass);e.stopPropagation();});}});return $.mage.collapsable;});define('js/theme',['jquery','mage/smart-keyboard-handler','mage/ie-class-fixer','collapsable','domReady!'],function($,keyboardHandler){'use strict';$('.collapse').collapsable();$.each($('.entry-edit'),function(i,entry){$('.collapse:first',entry).filter(function(){return $(this).data('collapsed')!==true;}).collapse('show');});keyboardHandler.apply();});"}
}});
